<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Admin Dashboard | BitHash LLC - Institutional Bitcoin Mining</title>
    <meta name="description" content="BitHash LLC Admin Dashboard for managing institutional-grade Bitcoin mining operations with enterprise security standards.">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rowdies:wght@300;400;700&family=Inter:wght@300;400;500;600;700&family=Manrope:wght@500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" type="image/png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- DataTables -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
    
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- Socket.io -->
    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
    
    <style>
        :root {
            --primary: #00D395;
            --primary-dark: #00B783;
            --primary-light: #00E5A1;
            --secondary: #1E1E1E;
            --secondary-dark: #121212;
            --dark: #E5E5E5;
            --darker: #0A0A0A;
            --light: #121212;
            --lighter: #1E1E1E;
            --gray: #8E8E8E;
            --gray-light: #2E2E2E;
            --gray-lighter: #252525;
            --success: #00D395;
            --warning: #FFB800;
            --error: #FF3D57;
            --gold: #D4AF37;
            --gold-light: #FFD700;
            --gold-dark: #996515;
            --blue: #003366;
            --blue-dark: #002244;
            --blue-light: #004488;
            --purple: #784FED;
            --pink: #EC4899;
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            --gold-gradient: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            --blue-gradient: linear-gradient(135deg, var(--blue) 0%, var(--blue-dark) 100%);
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --box-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            --visa-blue: #1A1F71;
            --visa-gold: #F7B600;
            --security-blue: #1A73E8;
            --security-green: #34A853;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: var(--secondary-dark);
            color: var(--dark);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .admin-sidebar {
            width: 280px;
            background-color: var(--secondary);
            border-right: 1px solid var(--gray-light);
            padding: 20px 0;
            height: 100vh;
            position: fixed;
            z-index: 1000;
            transition: var(--transition);
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 20px 20px;
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 20px;
        }

        .sidebar-header img {
            height: 40px;
            margin-right: 10px;
        }

        .sidebar-header h2 {
            font-family: 'Rowdies', sans-serif;
            color: var(--primary);
            font-size: 1.5rem;
            font-weight: 700;
        }

        .sidebar-menu {
            padding: 0 15px;
        }

        .menu-item {
            margin-bottom: 5px;
        }

        .menu-item a {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: var(--gray);
            text-decoration: none;
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .menu-item a:hover, .menu-item a.active {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        .menu-item a i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .menu-item a .badge {
            margin-left: auto;
            background-color: var(--primary);
            color: var(--secondary-dark);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .submenu {
            padding-left: 35px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .submenu.show {
            max-height: 500px;
        }

        .submenu-item a {
            padding: 8px 15px;
            font-size: 0.9rem;
        }

        .sidebar-footer {
            position: absolute;
            bottom: 0;
            width: 100%;
            padding: 20px;
            border-top: 1px solid var(--gray-light);
        }

        .admin-profile {
            display: flex;
            align-items: center;
        }

        .admin-profile img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
        }

        .admin-info h4 {
            font-size: 0.9rem;
            margin-bottom: 3px;
        }

        .admin-info p {
            font-size: 0.8rem;
            color: var(--gray);
        }

        /* Main Content Styles */
        .admin-main {
            flex: 1;
            margin-left: 280px;
            padding: 20px;
            transition: var(--transition);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--gray-light);
        }

        .page-title h1 {
            font-family: 'Manrope', sans-serif;
            font-weight: 700;
            font-size: 1.8rem;
            color: var(--dark);
        }

        .page-title p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .header-actions {
            display: flex;
            align-items: center;
        }

        .search-bar {
            position: relative;
            margin-right: 15px;
        }

        .search-bar input {
            background-color: var(--lighter);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            padding: 10px 15px 10px 40px;
            color: var(--dark);
            width: 250px;
            transition: var(--transition);
        }

        .search-bar input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 211, 149, 0.2);
        }

        .search-bar i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .notifications {
            position: relative;
            margin-right: 15px;
        }

        .notifications i {
            font-size: 1.2rem;
            color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
        }

        .notifications i:hover {
            color: var(--dark);
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--error);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .user-menu {
            position: relative;
        }

        .user-menu-btn {
            display: flex;
            align-items: center;
            background: none;
            border: none;
            color: var(--dark);
            cursor: pointer;
        }

        .user-menu-btn img {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
        }

        .user-menu-dropdown {
            position: absolute;
            right: 0;
            top: 50px;
            background-color: var(--secondary);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            width: 200px;
            box-shadow: var(--box-shadow-lg);
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .user-menu-dropdown.show {
            opacity: 1;
            visibility: visible;
            top: 45px;
        }

        .user-menu-dropdown a {
            display: block;
            padding: 10px 15px;
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
        }

        .user-menu-dropdown a:hover {
            background-color: var(--gray-light);
            color: var(--primary);
        }

        .user-menu-dropdown a i {
            margin-right: 8px;
            width: 18px;
            text-align: center;
        }

        .user-menu-dropdown .divider {
            height: 1px;
            background-color: var(--gray-light);
            margin: 5px 0;
        }

        /* Dashboard Cards */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            padding: 20px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow-lg);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .card-icon.users {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--primary);
        }

        .card-icon.deposits {
            background-color: rgba(212, 175, 55, 0.1);
            color: var(--gold);
        }

        .card-icon.withdrawals {
            background-color: rgba(120, 79, 237, 0.1);
            color: var(--purple);
        }

        .card-icon.revenue {
            background-color: rgba(236, 72, 153, 0.1);
            color: var(--pink);
        }

        .card-title {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .card-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .card-change {
            font-size: 0.8rem;
            display: flex;
            align-items: center;
        }

        .card-change.positive {
            color: var(--success);
        }

        .card-change.negative {
            color: var(--error);
        }

        .card-change i {
            margin-right: 5px;
        }

        /* Charts Section */
        .charts-section {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            padding: 20px;
            box-shadow: var(--box-shadow);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
        }

        .chart-actions select {
            background-color: var(--lighter);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            padding: 5px 10px;
            color: var(--dark);
            cursor: pointer;
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        /* Recent Activity */
        .recent-activity {
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            padding: 20px;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
        }

        .activity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .activity-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
        }

        .activity-list {
            list-style: none;
        }

        .activity-item {
            display: flex;
            padding: 15px 0;
            border-bottom: 1px solid var(--gray-light);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: var(--primary);
            font-size: 1rem;
        }

        .activity-content {
            flex: 1;
        }

        .activity-message {
            color: var(--dark);
            margin-bottom: 5px;
        }

        .activity-meta {
            display: flex;
            justify-content: space-between;
            color: var(--gray);
            font-size: 0.8rem;
        }

        .activity-time {
            color: var(--gray);
        }

        /* Data Tables */
        .data-table-container {
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            padding: 20px;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .table-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
        }

        .table-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 15px;
            border-radius: var(--border-radius);
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn i {
            margin-right: 5px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: var(--secondary-dark);
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        .btn-secondary:hover {
            background-color: var(--gray);
        }

        .btn-danger {
            background-color: var(--error);
            color: white;
        }

        .btn-danger:hover {
            background-color: #e23245;
        }

        .btn-success {
            background-color: var(--success);
            color: var(--secondary-dark);
        }

        .btn-success:hover {
            background-color: #00b783;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.8rem;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-slow);
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--box-shadow-lg);
            transform: translateY(20px);
            transition: var(--transition-slow);
        }

        .modal-overlay.show .modal {
            transform: translateY(0);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark);
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--error);
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 10px 15px;
            background-color: var(--lighter);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            color: var(--dark);
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 211, 149, 0.2);
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%238E8E8E' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 16px 12px;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Login Page */
        .login-container {
            display: flex;
            min-height: 100vh;
            background-color: var(--secondary-dark);
        }

        .login-left {
            flex: 1;
            background: url('https://images.unsplash.com/photo-1639762681057-408e52192e55?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2232&q=80') no-repeat center center;
            background-size: cover;
            position: relative;
        }

        .login-left::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.6) 100%);
        }

        .login-left-content {
            position: absolute;
            bottom: 50px;
            left: 50px;
            right: 50px;
            z-index: 1;
        }

        .login-left-content h1 {
            font-family: 'Rowdies', sans-serif;
            font-size: 2.5rem;
            color: white;
            margin-bottom: 20px;
        }

        .login-left-content p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 600px;
        }

        .login-right {
            width: 500px;
            background-color: var(--secondary);
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 50px;
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .login-header img {
            height: 50px;
            margin-bottom: 20px;
        }

        .login-header h2 {
            font-family: 'Manrope', sans-serif;
            font-weight: 700;
            font-size: 1.8rem;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .login-header p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .login-form .form-group {
            margin-bottom: 25px;
        }

        .login-form .form-label {
            font-size: 0.9rem;
            color: var(--dark);
            margin-bottom: 8px;
        }

        .login-form .form-control {
            padding: 12px 15px;
        }

        .form-remember {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
        }

        .form-check {
            display: flex;
            align-items: center;
        }

        .form-check input {
            margin-right: 8px;
            cursor: pointer;
        }

        .form-check label {
            color: var(--gray);
            font-size: 0.9rem;
            cursor: pointer;
        }

        .forgot-password {
            color: var(--primary);
            font-size: 0.9rem;
            text-decoration: none;
            transition: var(--transition);
        }

        .forgot-password:hover {
            text-decoration: underline;
        }

        .login-btn {
            width: 100%;
            padding: 14px;
            background-color: var(--primary);
            color: var(--secondary-dark);
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 20px;
        }

        .login-btn:hover {
            background-color: var(--primary-dark);
        }

        .login-footer {
            text-align: center;
            margin-top: 30px;
            color: var(--gray);
            font-size: 0.9rem;
        }

        .login-footer a {
            color: var(--primary);
            text-decoration: none;
            transition: var(--transition);
        }

        .login-footer a:hover {
            text-decoration: underline;
        }

        /* 2FA Modal */
        .twofa-modal {
            text-align: center;
        }

        .twofa-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 20px;
        }

        .twofa-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 15px;
        }

        .twofa-description {
            color: var(--gray);
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .twofa-input {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
        }

        .twofa-input input {
            width: 40px;
            height: 50px;
            text-align: center;
            font-size: 1.5rem;
            background-color: var(--lighter);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            color: var(--dark);
        }

        .twofa-input input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 211, 149, 0.2);
        }

        /* Responsive Styles */
        @media (max-width: 1200px) {
            .charts-section {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .admin-sidebar {
                transform: translateX(-100%);
            }
            .admin-sidebar.show {
                transform: translateX(0);
            }
            .admin-main {
                margin-left: 0;
            }
            .sidebar-toggle {
                display: block !important;
            }
        }

        @media (max-width: 768px) {
            .login-container {
                flex-direction: column;
            }
            .login-left {
                display: none;
            }
            .login-right {
                width: 100%;
                padding: 30px;
            }
            .dashboard-cards {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            .header-actions {
                flex-direction: column;
                align-items: flex-end;
                gap: 10px;
            }
            .search-bar {
                margin-right: 0;
                width: 100%;
            }
            .search-bar input {
                width: 100%;
            }
        }

        @media (max-width: 576px) {
            .dashboard-cards {
                grid-template-columns: 1fr 1fr;
            }
            .login-right {
                padding: 20px;
            }
            .modal {
                width: 95%;
            }
        }

        /* Custom DataTables Styles */
        .dataTables_wrapper {
            width: 100%;
        }

        .dataTables_filter input {
            background-color: var(--lighter) !important;
            border: 1px solid var(--gray-light) !important;
            color: var(--dark) !important;
            padding: 5px 10px !important;
            border-radius: var(--border-radius) !important;
        }

        .dataTables_length select {
            background-color: var(--lighter) !important;
            border: 1px solid var(--gray-light) !important;
            color: var(--dark) !important;
            padding: 5px 10px !important;
            border-radius: var(--border-radius) !important;
        }

        .dataTables_info {
            color: var(--gray) !important;
        }

        .dataTables_paginate .paginate_button {
            color: var(--dark) !important;
            border: 1px solid var(--gray-light) !important;
            background-color: var(--lighter) !important;
            margin-left: 5px !important;
            border-radius: var(--border-radius) !important;
        }

        .dataTables_paginate .paginate_button:hover {
            background-color: var(--gray-light) !important;
            color: var(--dark) !important;
        }

        .dataTables_paginate .paginate_button.current {
            background-color: var(--primary) !important;
            color: var(--secondary-dark) !important;
            border-color: var(--primary) !important;
        }

        table.dataTable {
            border-collapse: collapse !important;
            margin-top: 10px !important;
            margin-bottom: 15px !important;
        }

        table.dataTable thead th {
            background-color: var(--gray-light) !important;
            color: var(--dark) !important;
            border-bottom: 1px solid var(--gray) !important;
            padding: 12px 15px !important;
        }

        table.dataTable tbody td {
            padding: 12px 15px !important;
            border-bottom: 1px solid var(--gray-light) !important;
            color: var(--gray) !important;
        }

        table.dataTable tbody tr:hover td {
            background-color: var(--gray-light) !important;
            color: var(--dark) !important;
        }

        /* Status Badges */
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-success {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background-color: rgba(255, 184, 0, 0.1);
            color: var(--warning);
        }

        .badge-danger {
            background-color: rgba(255, 61, 87, 0.1);
            color: var(--error);
        }

        .badge-info {
            background-color: rgba(56, 139, 253, 0.1);
            color: #388bfd;
        }

        .badge-secondary {
            background-color: rgba(142, 142, 142, 0.1);
            color: var(--gray);
        }

        /* Toggle Switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--gray-light);
            transition: var(--transition);
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: var(--transition);
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--success);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-light);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            color: var(--gray);
            font-weight: 500;
            position: relative;
        }

        .tab.active {
            color: var(--primary);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--primary);
        }

        /* Sidebar Toggle */
        .sidebar-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: var(--secondary);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            width: 40px;
            height: 40px;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1001;
            cursor: pointer;
            color: var(--dark);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
        }

        .empty-state i {
            font-size: 3rem;
            color: var(--gray-light);
            margin-bottom: 20px;
        }

        .empty-state h3 {
            color: var(--dark);
            margin-bottom: 10px;
        }

        .empty-state p {
            color: var(--gray);
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <!-- Login Page (shown when not authenticated) -->
    <div id="login-page" class="login-container">
        <div class="login-left">
            <div class="login-left-content">
                <h1>BitHash LLC</h1>
                <p>Institutional-grade Bitcoin mining platform with enterprise security standards. Manage millions of users with our powerful admin dashboard.</p>
            </div>
        </div>
        <div class="login-right">
            <div class="login-header">
                <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash Logo">
                <h2>Admin Dashboard</h2>
                <p>Sign in to access the control panel</p>
            </div>
            <form id="login-form" class="login-form">
                <div class="form-group">
                    <label for="email" class="form-label">Email Address</label>
                    <input type="email" id="email" class="form-control" placeholder="admin@bithash.com" required>
                </div>
                <div class="form-group">
                    <label for="password" class="form-label">Password</label>
                    <input type="password" id="password" class="form-control" placeholder="••••••••" required>
                </div>
                <div class="form-remember">
                    <div class="form-check">
                        <input type="checkbox" id="remember">
                        <label for="remember">Remember me</label>
                    </div>
                    <a href="#" class="forgot-password" id="forgot-password">Forgot password?</a>
                </div>
                <button type="submit" class="login-btn" id="login-btn">
                    <span id="login-btn-text">Sign In</span>
                    <span id="login-spinner" class="spinner" style="display: none;"></span>
                </button>
            </form>
            <div class="login-footer">
                <p>© 2023 BitHash LLC. All rights reserved.</p>
            </div>
        </div>
    </div>

    <!-- 2FA Verification Modal -->
    <div class="modal-overlay" id="twofa-modal">
        <div class="modal twofa-modal">
            <div class="modal-header">
                <h3 class="modal-title">Two-Factor Authentication</h3>
                <button class="modal-close" id="twofa-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="twofa-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h3 class="twofa-title">Enter Verification Code</h3>
                <p class="twofa-description">Please enter the 6-digit code from your authenticator app to continue.</p>
                <div class="twofa-input">
                    <input type="text" maxlength="1" pattern="[0-9]">
                    <input type="text" maxlength="1" pattern="[0-9]">
                    <input type="text" maxlength="1" pattern="[0-9]">
                    <input type="text" maxlength="1" pattern="[0-9]">
                    <input type="text" maxlength="1" pattern="[0-9]">
                    <input type="text" maxlength="1" pattern="[0-9]">
                </div>
                <button type="button" class="btn btn-primary" id="verify-2fa-btn">
                    <span id="verify-2fa-text">Verify</span>
                    <span id="verify-2fa-spinner" class="spinner" style="display: none;"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div class="modal-overlay" id="forgot-password-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Reset Password</h3>
                <button class="modal-close" id="forgot-password-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="reset-email" class="form-label">Email Address</label>
                    <input type="email" id="reset-email" class="form-control" placeholder="admin@bithash.com" required>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="forgot-password-cancel">Cancel</button>
                <button type="button" class="btn btn-primary" id="reset-password-btn">
                    <span id="reset-password-text">Send Reset Link</span>
                    <span id="reset-password-spinner" class="spinner" style="display: none;"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard (shown after authentication) -->
    <div id="admin-dashboard" class="admin-container" style="display: none;">
        <!-- Sidebar Toggle Button -->
        <div class="sidebar-toggle" id="sidebar-toggle">
            <i class="fas fa-bars"></i>
        </div>

        <!-- Sidebar -->
        <div class="admin-sidebar" id="admin-sidebar">
            <div class="sidebar-header">
                <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash Logo">
                <h2>BitHash</h2>
            </div>
            <div class="sidebar-menu">
                <div class="menu-item">
                    <a href="#" class="active" data-section="dashboard">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </div>
                <div class="menu-item">
                    <a href="#" data-section="users">
                        <i class="fas fa-users"></i>
                        <span>Users</span>
                        <span class="badge" id="new-users-badge">0</span>
                    </a>
                </div>
                <div class="menu-item">
                    <a href="#" data-section="transactions">
                        <i class="fas fa-exchange-alt"></i>
                        <span>Transactions</span>
                    </a>
                </div>
                <div class="menu-item">
                    <a href="#" data-section="investments">
                        <i class="fas fa-chart-line"></i>
                        <span>Investments</span>
                    </a>
                </div>
                <div class="menu-item">
                    <a href="#" data-section="withdrawals">
                        <i class="fas fa-money-bill-wave"></i>
                        <span>Withdrawals</span>
                        <span class="badge" id="pending-withdrawals-badge">0</span>
                    </a>
                </div>
                <div class="menu-item">
                    <a href="#" data-section="deposits">
                        <i class="fas fa-wallet"></i>
                        <span>Deposits</span>
                    </a>
                </div>
                <div class="menu-item has-submenu">
                    <a href="#" data-section="support">
                        <i class="fas fa-headset"></i>
                        <span>Support</span>
                        <span class="badge" id="open-tickets-badge">0</span>
                    </a>
                    <div class="submenu">
                        <div class="submenu-item">
                            <a href="#" data-section="support-tickets">Tickets</a>
                        </div>
                        <div class="submenu-item">
                            <a href="#" data-section="support-chat">Live Chat</a>
                        </div>
                    </div>
                </div>
                <div class="menu-item">
                    <a href="#" data-section="notifications">
                        <i class="fas fa-bell"></i>
                        <span>Notifications</span>
                    </a>
                </div>
                <div class="menu-item">
                    <a href="#" data-section="reports">
                        <i class="fas fa-file-alt"></i>
                        <span>Reports</span>
                    </a>
                </div>
                <div class="menu-item has-submenu">
                    <a href="#" data-section="settings">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                    <div class="submenu">
                        <div class="submenu-item">
                            <a href="#" data-section="settings-general">General</a>
                        </div>
                        <div class="submenu-item">
                            <a href="#" data-section="settings-security">Security</a>
                        </div>
                        <div class="submenu-item">
                            <a href="#" data-section="settings-email">Email</a>
                        </div>
                        <div class="submenu-item">
                            <a href="#" data-section="settings-plans">Plans</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sidebar-footer">
                <div class="admin-profile">
                    <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="Admin" id="admin-avatar">
                    <div class="admin-info">
                        <h4 id="admin-name">Admin</h4>
                        <p id="admin-role">Super Admin</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="admin-main" id="admin-main">
            <div class="admin-header">
                <div class="page-title">
                    <h1 id="page-title">Dashboard</h1>
                    <p id="page-description">Welcome back! Here's what's happening with your platform today.</p>
                </div>
                <div class="header-actions">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                    <div class="notifications">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notification-count">0</span>
                    </div>
                    <div class="user-menu">
                        <button class="user-menu-btn" id="user-menu-btn">
                            <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="Admin" id="header-admin-avatar">
                            <span id="header-admin-name">Admin</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="user-menu-dropdown" id="user-menu-dropdown">
                            <a href="#" data-section="profile"><i class="fas fa-user"></i> Profile</a>
                            <a href="#" data-section="settings"><i class="fas fa-cog"></i> Settings</a>
                            <div class="divider"></div>
                            <a href="#" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Content -->
            <div id="dashboard-content" class="dashboard-section">
                <div class="dashboard-cards">
                    <div class="card">
                        <div class="card-header">
                            <div>
                                <div class="card-title">Total Users</div>
                                <div class="card-value" id="total-users">0</div>
                                <div class="card-change positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span id="users-change">0%</span> from yesterday
                                </div>
                            </div>
                            <div class="card-icon users">
                                <i class="fas fa-users"></i>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div>
                                <div class="card-title">Total Deposits</div>
                                <div class="card-value" id="total-deposits">$0</div>
                                <div class="card-change positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span id="deposits-change">0%</span> from yesterday
                                </div>
                            </div>
                            <div class="card-icon deposits">
                                <i class="fas fa-wallet"></i>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div>
                                <div class="card-title">Pending Withdrawals</div>
                                <div class="card-value" id="pending-withdrawals">$0</div>
                                <div class="card-change negative">
                                    <i class="fas fa-arrow-down"></i>
                                    <span id="withdrawals-change">0%</span> from yesterday
                                </div>
                            </div>
                            <div class="card-icon withdrawals">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div>
                                <div class="card-title">Platform Revenue</div>
                                <div class="card-value" id="platform-revenue">$0</div>
                                <div class="card-change positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span id="revenue-change">0%</span> from yesterday
                                </div>
                            </div>
                            <div class="card-icon revenue">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="charts-section">
                    <div class="chart-card">
                        <div class="chart-header">
                            <div class="chart-title">User Growth</div>
                            <div class="chart-actions">
                                <select id="user-growth-period">
                                    <option value="7">Last 7 Days</option>
                                    <option value="30" selected>Last 30 Days</option>
                                    <option value="90">Last 90 Days</option>
                                    <option value="365">Last Year</option>
                                </select>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="user-growth-chart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-header">
                            <div class="chart-title">Revenue Breakdown</div>
                            <div class="chart-actions">
                                <select id="revenue-period">
                                    <option value="7">Last 7 Days</option>
                                    <option value="30" selected>Last 30 Days</option>
                                    <option value="90">Last 90 Days</option>
                                </select>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="revenue-chart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="recent-activity">
                    <div class="activity-header">
                        <div class="activity-title">Recent Activity</div>
                        <a href="#" class="btn btn-secondary btn-sm" id="view-all-activity">View All</a>
                    </div>
                    <ul class="activity-list" id="activity-list">
                        <!-- Activities will be loaded here -->
                    </ul>
                </div>
            </div>

            <!-- Users Content -->
            <div id="users-content" class="dashboard-section" style="display: none;">
                <div class="data-table-container">
                    <div class="table-header">
                        <div class="table-title">User Management</div>
                        <div class="table-actions">
                            <button class="btn btn-primary" id="add-user-btn">
                                <i class="fas fa-plus"></i> Add User
                            </button>
                            <button class="btn btn-secondary" id="export-users-btn">
                                <i class="fas fa-file-export"></i> Export
                            </button>
                        </div>
                    </div>
                    <table id="users-table" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Balance</th>
                                <th>Status</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Users will be loaded via AJAX -->
                        </tbody>
                    </table>
                </div>
            </div>

               <!-- Transactions Content -->
            <div id="transactions-content" class="dashboard-section" style="display: none;">
                <div class="tabs">
                    <div class="tab active" data-tab="all">All Transactions</div>
                    <div class="tab" data-tab="pending">Pending</div>
                    <div class="tab" data-tab="completed">Completed</div>
                    <div class="tab" data-tab="failed">Failed</div>
                </div>
                <div class="data-table-container">
                    <div class="table-header">
                        <div class="table-title">Transaction Management</div>
                        <div class="table-actions">
                            <button class="btn btn-secondary" id="export-transactions-btn">
                                <i class="fas fa-file-export"></i> Export
                            </button>
                            <button class="btn btn-primary" id="refresh-transactions-btn">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>
                    <table id="transactions-table" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>User</th>
                                <th>Type</th>
                                <th>Amount</th>
                                <th>Method</th>
                                <th>Status</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Transactions will be loaded via AJAX -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Transaction Details Modal -->
            <div class="modal-overlay" id="transaction-details-modal">
                <div class="modal">
                    <div class="modal-header">
                        <h3 class="modal-title">Transaction Details #<span id="transaction-id"></span></h3>
                        <button class="modal-close" id="transaction-details-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="transaction-details-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                            <div class="detail-item">
                                <label class="form-label">User</label>
                                <p id="transaction-user" class="detail-value"></p>
                            </div>
                            <div class="detail-item">
                                <label class="form-label">Type</label>
                                <p id="transaction-type" class="detail-value"></p>
                            </div>
                            <div class="detail-item">
                                <label class="form-label">Amount</label>
                                <p id="transaction-amount" class="detail-value"></p>
                            </div>
                            <div class="detail-item">
                                <label class="form-label">Method</label>
                                <p id="transaction-method" class="detail-value"></p>
                            </div>
                            <div class="detail-item">
                                <label class="form-label">Status</label>
                                <p id="transaction-status" class="detail-value"></p>
                            </div>
                            <div class="detail-item">
                                <label class="form-label">Date</label>
                                <p id="transaction-date" class="detail-value"></p>
                            </div>
                            <div class="detail-item" id="transaction-reference-group">
                                <label class="form-label">Reference</label>
                                <p id="transaction-reference" class="detail-value"></p>
                            </div>
                            <div class="detail-item" id="transaction-wallet-group">
                                <label class="form-label">Wallet/Account</label>
                                <p id="transaction-wallet" class="detail-value"></p>
                            </div>
                        </div>
                        
                        <div class="transaction-actions" id="transaction-actions" style="display: none;">
                            <h4 style="margin-bottom: 15px;">Transaction Actions</h4>
                            <form id="transaction-action-form">
                                <input type="hidden" id="transaction-action-id">
                                <div class="form-group">
                                    <label for="transaction-action" class="form-label">Action</label>
                                    <select id="transaction-action" class="form-control form-select" required>
                                        <option value="">Select Action</option>
                                        <option value="approve">Approve</option>
                                        <option value="decline">Decline</option>
                                    </select>
                                </div>
                                <div class="form-group" id="transaction-decline-reason-group" style="display: none;">
                                    <label for="transaction-decline-reason" class="form-label">Reason for Decline</label>
                                    <textarea id="transaction-decline-reason" class="form-control form-textarea" placeholder="Provide a reason for declining this transaction"></textarea>
                                </div>
                                <div class="form-group" id="transaction-reference-input-group" style="display: none;">
                                    <label for="transaction-reference-input" class="form-label">Transaction Reference</label>
                                    <input type="text" id="transaction-reference-input" class="form-control" placeholder="Enter the transaction reference">
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="transaction-details-cancel">Close</button>
                        <button type="button" class="btn btn-primary" id="transaction-action-submit" style="display: none;">
                            <span id="transaction-action-text">Submit</span>
                            <span id="transaction-action-spinner" class="spinner" style="display: none;"></span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Investments Content -->
            <div id="investments-content" class="dashboard-section" style="display: none;">
                <div class="data-table-container">
                    <div class="table-header">
                        <div class="table-title">Investment Plans</div>
                        <div class="table-actions">
                            <button class="btn btn-primary" id="add-plan-btn">
                                <i class="fas fa-plus"></i> Add Plan
                            </button>
                        </div>
                    </div>
                    <table id="plans-table" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Min Amount</th>
                                <th>Max Amount</th>
                                <th>Duration</th>
                                <th>Daily Profit</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Plans will be loaded via AJAX -->
                        </tbody>
                    </table>
                </div>

                <div class="data-table-container" style="margin-top: 30px;">
                    <div class="table-header">
                        <div class="table-title">Active Investments</div>
                        <div class="table-actions">
                            <button class="btn btn-secondary" id="export-investments-btn">
                                <i class="fas fa-file-export"></i> Export
                            </button>
                        </div>
                    </div>
                    <table id="investments-table" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>User</th>
                                <th>Plan</th>
                                <th>Amount</th>
                                <th>Daily Profit</th>
                                <th>Start Date</th>
                                <th>End Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Investments will be loaded via AJAX -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Withdrawals Content -->
            <div id="withdrawals-content" class="dashboard-section" style="display: none;">
                <div class="tabs">
                    <div class="tab active" data-tab="pending">Pending</div>
                    <div class="tab" data-tab="processed">Processed</div>
                    <div class="tab" data-tab="rejected">Rejected</div>
                </div>
                <div class="data-table-container">
                    <div class="table-header">
                        <div class="table-title">Withdrawal Requests</div>
                        <div class="table-actions">
                            <button class="btn btn-secondary" id="export-withdrawals-btn">
                                <i class="fas fa-file-export"></i> Export
                            </button>
                        </div>
                    </div>
                    <table id="withdrawals-table" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>User</th>
                                <th>Amount</th>
                                <th>Method</th>
                                <th>Wallet/Account</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Withdrawals will be loaded via AJAX -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Deposits Content -->
            <div id="deposits-content" class="dashboard-section" style="display: none;">
                <div class="tabs">
                    <div class="tab active" data-tab="all">All Deposits</div>
                    <div class="tab" data-tab="pending">Pending</div>
                    <div class="tab" data-tab="completed">Completed</div>
                </div>
                <div class="data-table-container">
                    <div class="table-header">
                        <div class="table-title">Deposit History</div>
                        <div class="table-actions">
                            <button class="btn btn-secondary" id="export-deposits-btn">
                                <i class="fas fa-file-export"></i> Export
                            </button>
                        </div>
                    </div>
                    <table id="deposits-table" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>User</th>
                                <th>Amount</th>
                                <th>Method</th>
                                <th>Transaction ID</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Deposits will be loaded via AJAX -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Support Tickets Content -->
            <div id="support-tickets-content" class="dashboard-section" style="display: none;">
                <div class="tabs">
                    <div class="tab active" data-tab="open">Open</div>
                    <div class="tab" data-tab="pending">Pending</div>
                    <div class="tab" data-tab="resolved">Resolved</div>
                </div>
                <div class="data-table-container">
                    <div class="table-header">
                        <div class="table-title">Support Tickets</div>
                        <div class="table-actions">
                            <button class="btn btn-secondary" id="export-tickets-btn">
                                <i class="fas fa-file-export"></i> Export
                            </button>
                        </div>
                    </div>
                    <table id="tickets-table" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>User</th>
                                <th>Subject</th>
                                <th>Category</th>
                                <th>Priority</th>
                                <th>Last Updated</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Tickets will be loaded via AJAX -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Live Chat Content -->
            <div id="support-chat-content" class="dashboard-section" style="display: none;">
                <div class="data-table-container">
                    <div class="table-header">
                        <div class="table-title">Live Chat Conversations</div>
                    </div>
                    <div class="chat-container" style="display: flex; height: 600px;">
                        <div class="chat-sidebar" style="width: 300px; border-right: 1px solid var(--gray-light); overflow-y: auto;">
                            <div class="chat-search" style="padding: 15px; border-bottom: 1px solid var(--gray-light);">
                                <div class="search-bar">
                                    <i class="fas fa-search"></i>
                                    <input type="text" placeholder="Search conversations...">
                                </div>
                            </div>
                            <div class="chat-list" id="chat-list" style="overflow-y: auto;">
                                <!-- Chat conversations will be loaded here -->
                            </div>
                        </div>
                        <div class="chat-main" style="flex: 1; display: flex; flex-direction: column;">
                            <div class="chat-header" style="padding: 15px; border-bottom: 1px solid var(--gray-light); display: flex; align-items: center;">
                                <div id="current-chat-user" style="flex: 1;">
                                    <h4 style="margin-bottom: 5px;">Select a conversation</h4>
                                </div>
                            </div>
                            <div class="chat-messages" id="chat-messages" style="flex: 1; padding: 20px; overflow-y: auto;">
                                <div class="empty-state">
                                    <i class="fas fa-comments"></i>
                                    <h3>No conversation selected</h3>
                                    <p>Select a conversation from the sidebar to start chatting</p>
                                </div>
                            </div>
                            <div class="chat-input" style="padding: 15px; border-top: 1px solid var(--gray-light);">
                                <div class="form-group" style="display: flex;">
                                    <input type="text" id="chat-message-input" class="form-control" placeholder="Type your message..." style="flex: 1; margin-right: 10px;" disabled>
                                    <button class="btn btn-primary" id="send-message-btn" disabled>
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notifications Content -->
            <div id="notifications-content" class="dashboard-section" style="display: none;">
                <div class="data-table-container">
                    <div class="table-header">
                        <div class="table-title">System Notifications</div>
                        <div class="table-actions">
                            <button class="btn btn-primary" id="send-notification-btn">
                                <i class="fas fa-bell"></i> Send Notification
                            </button>
                            <button class="btn btn-secondary" id="mark-all-read-btn">
                                <i class="fas fa-check-circle"></i> Mark All as Read
                            </button>
                        </div>
                    </div>
                    <table id="notifications-table" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Title</th>
                                <th>Message</th>
                                <th>Recipients</th>
                                <th>Date Sent</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Notifications will be loaded via AJAX -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Reports Content -->
            <div id="reports-content" class="dashboard-section" style="display: none;">
                <div class="data-table-container">
                    <div class="table-header">
                        <div class="table-title">Generate Reports</div>
                    </div>
                    <div class="report-options" style="padding: 20px;">
                        <div class="form-group">
                            <label class="form-label">Report Type</label>
                            <select id="report-type" class="form-control form-select">
                                <option value="users">User Registration</option>
                                <option value="deposits">Deposits</option>
                                <option value="withdrawals">Withdrawals</option>
                                <option value="investments">Investments</option>
                                <option value="revenue">Revenue</option>
                                <option value="transactions">All Transactions</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Date Range</label>
                            <div style="display: flex; gap: 10px;">
                                <input type="date" id="report-start-date" class="form-control">
                                <input type="date" id="report-end-date" class="form-control">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Format</label>
                            <div style="display: flex; gap: 10px;">
                                <label class="form-check" style="display: flex; align-items: center;">
                                    <input type="radio" name="report-format" value="pdf" checked>
                                    <span style="margin-left: 5px;">PDF</span>
                                </label>
                                <label class="form-check" style="display: flex; align-items: center;">
                                    <input type="radio" name="report-format" value="csv">
                                    <span style="margin-left: 5px;">CSV</span>
                                </label>
                                <label class="form-check" style="display: flex; align-items: center;">
                                    <input type="radio" name="report-format" value="excel">
                                    <span style="margin-left: 5px;">Excel</span>
                                </label>
                            </div>
                        </div>
                        <button class="btn btn-primary" id="generate-report-btn">
                            <i class="fas fa-file-download"></i> Generate Report
                        </button>
                    </div>
                </div>
            </div>

            <!-- Settings Content -->
            <div id="settings-content" class="dashboard-section" style="display: none;">
                <div class="tabs">
                    <div class="tab active" data-tab="general">General</div>
                    <div class="tab" data-tab="security">Security</div>
                    <div class="tab" data-tab="email">Email</div>
                    <div class="tab" data-tab="plans">Plans</div>
                </div>
                <div class="data-table-container">
                    <div class="settings-form" id="general-settings" style="padding: 20px;">
                        <form id="general-settings-form">
                            <div class="form-group">
                                <label class="form-label">Platform Name</label>
                                <input type="text" id="platform-name" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Platform URL</label>
                                <input type="url" id="platform-url" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Logo</label>
                                <input type="file" id="platform-logo" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Favicon</label>
                                <input type="file" id="platform-favicon" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Timezone</label>
                                <select id="platform-timezone" class="form-control form-select">
                                    <option value="UTC">UTC</option>
                                    <option value="America/New_York">Eastern Time (ET)</option>
                                    <option value="America/Chicago">Central Time (CT)</option>
                                    <option value="America/Denver">Mountain Time (MT)</option>
                                    <option value="America/Los_Angeles">Pacific Time (PT)</option>
                                    <option value="Europe/London">London</option>
                                    <option value="Europe/Paris">Paris</option>
                                    <option value="Asia/Tokyo">Tokyo</option>
                                    <option value="Asia/Singapore">Singapore</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Default Currency</label>
                                <select id="platform-currency" class="form-control form-select">
                                    <option value="USD">US Dollar (USD)</option>
                                    <option value="EUR">Euro (EUR)</option>
                                    <option value="GBP">British Pound (GBP)</option>
                                    <option value="BTC">Bitcoin (BTC)</option>
                                    <option value="ETH">Ethereum (ETH)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Maintenance Mode</label>
                                <div style="display: flex; align-items: center;">
                                    <label class="switch">
                                        <input type="checkbox" id="maintenance-mode">
                                        <span class="slider"></span>
                                    </label>
                                    <span style="margin-left: 10px;" id="maintenance-status">Disabled</span>
                                </div>
                            </div>
                            <div class="form-group" id="maintenance-message-group" style="display: none;">
                                <label class="form-label">Maintenance Message</label>
                                <textarea id="maintenance-message" class="form-control form-textarea"></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Settings</button>
                        </form>
                    </div>

                    <div class="settings-form" id="security-settings" style="padding: 20px; display: none;">
                        <form id="security-settings-form">
                            <div class="form-group">
                                <label class="form-label">Enable Two-Factor Authentication</label>
                                <div style="display: flex; align-items: center;">
                                    <label class="switch">
                                        <input type="checkbox" id="enable-2fa">
                                        <span class="slider"></span>
                                    </label>
                                    <span style="margin-left: 10px;" id="2fa-status">Disabled</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Password Requirements</label>
                                <div style="display: flex; flex-direction: column; gap: 10px;">
                                    <label class="form-check" style="display: flex; align-items: center;">
                                        <input type="checkbox" id="require-uppercase" checked>
                                        <span style="margin-left: 5px;">At least one uppercase letter</span>
                                    </label>
                                    <label class="form-check" style="display: flex; align-items: center;">
                                        <input type="checkbox" id="require-lowercase" checked>
                                        <span style="margin-left: 5px;">At least one lowercase letter</span>
                                    </label>
                                    <label class="form-check" style="display: flex; align-items: center;">
                                        <input type="checkbox" id="require-number" checked>
                                        <span style="margin-left: 5px;">At least one number</span>
                                    </label>
                                    <label class="form-check" style="display: flex; align-items: center;">
                                        <input type="checkbox" id="require-special" checked>
                                        <span style="margin-left: 5px;">At least one special character</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Minimum Password Length</label>
                                <input type="number" id="min-password-length" class="form-control" min="6" value="8">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Session Timeout (minutes)</label>
                                <input type="number" id="session-timeout" class="form-control" min="5" value="30">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Login Attempts Before Lockout</label>
                                <input type="number" id="max-login-attempts" class="form-control" min="1" value="5">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Lockout Duration (minutes)</label>
                                <input type="number" id="lockout-duration" class="form-control" min="1" value="15">
                            </div>
                            <button type="submit" class="btn btn-primary">Save Settings</button>
                        </form>
                    </div>

                    <div class="settings-form" id="email-settings" style="padding: 20px; display: none;">
                        <form id="email-settings-form">
                            <div class="form-group">
                                <label class="form-label">SMTP Host</label>
                                <input type="text" id="smtp-host" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">SMTP Port</label>
                                <input type="number" id="smtp-port" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">SMTP Username</label>
                                <input type="text" id="smtp-username" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">SMTP Password</label>
                                <input type="password" id="smtp-password" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">SMTP Encryption</label>
                                <select id="smtp-encryption" class="form-control form-select">
                                    <option value="tls">TLS</option>
                                    <option value="ssl">SSL</option>
                                    <option value="none">None</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">From Email</label>
                                <input type="email" id="from-email" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">From Name</label>
                                <input type="text" id="from-name" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Test Email Address</label>
                                <input type="email" id="test-email" class="form-control" placeholder="Enter email to test configuration">
                            </div>
                            <button type="button" class="btn btn-secondary" id="test-email-btn">Send Test Email</button>
                            <button type="submit" class="btn btn-primary">Save Settings</button>
                        </form>
                    </div>

                    <div class="settings-form" id="plans-settings" style="padding: 20px; display: none;">
                        <div class="table-header">
                            <div class="table-title">Investment Plans</div>
                            <div class="table-actions">
                                <button class="btn btn-primary" id="add-plan-settings-btn">
                                    <i class="fas fa-plus"></i> Add Plan
                                </button>
                            </div>
                        </div>
                        <table id="plans-settings-table" class="display" style="width:100%">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Min Amount</th>
                                    <th>Max Amount</th>
                                    <th>Duration</th>
                                    <th>Daily Profit</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Plans will be loaded via AJAX -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Add User Modal -->
            <div class="modal-overlay" id="add-user-modal">
                <div class="modal">
                    <div class="modal-header">
                        <h3 class="modal-title">Add New User</h3>
                        <button class="modal-close" id="add-user-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="add-user-form">
                            <div class="form-group">
                                <label for="user-first-name" class="form-label">First Name</label>
                                <input type="text" id="user-first-name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="user-last-name" class="form-label">Last Name</label>
                                <input type="text" id="user-last-name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="user-email" class="form-label">Email Address</label>
                                <input type="email" id="user-email" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="user-password" class="form-label">Password</label>
                                <input type="password" id="user-password" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="user-phone" class="form-label">Phone Number</label>
                                <input type="tel" id="user-phone" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="user-country" class="form-label">Country</label>
                                <select id="user-country" class="form-control form-select">
                                    <option value="">Select Country</option>
                                    <option value="US">United States</option>
                                    <option value="GB">United Kingdom</option>
                                    <option value="CA">Canada</option>
                                    <option value="AU">Australia</option>
                                    <!-- More countries would be added here -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="user-balance" class="form-label">Initial Balance</label>
                                <input type="number" id="user-balance" class="form-control" min="0" step="0.01" value="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <div style="display: flex; align-items: center;">
                                    <label class="switch">
                                        <input type="checkbox" id="user-status" checked>
                                        <span class="slider"></span>
                                    </label>
                                    <span style="margin-left: 10px;" id="user-status-text">Active</span>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="add-user-cancel">Cancel</button>
                        <button type="button" class="btn btn-primary" id="add-user-submit">
                            <span id="add-user-text">Add User</span>
                            <span id="add-user-spinner" class="spinner" style="display: none;"></span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Edit User Modal -->
            <div class="modal-overlay" id="edit-user-modal">
                <div class="modal">
                    <div class="modal-header">
                        <h3 class="modal-title">Edit User</h3>
                        <button class="modal-close" id="edit-user-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="edit-user-form">
                            <input type="hidden" id="edit-user-id">
                            <div class="form-group">
                                <label for="edit-user-first-name" class="form-label">First Name</label>
                                <input type="text" id="edit-user-first-name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="edit-user-last-name" class="form-label">Last Name</label>
                                <input type="text" id="edit-user-last-name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="edit-user-email" class="form-label">Email Address</label>
                                <input type="email" id="edit-user-email" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="edit-user-phone" class="form-label">Phone Number</label>
                                <input type="tel" id="edit-user-phone" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="edit-user-country" class="form-label">Country</label>
                                <select id="edit-user-country" class="form-control form-select">
                                    <option value="">Select Country</option>
                                    <option value="US">United States</option>
                                    <option value="GB">United Kingdom</option>
                                    <option value="CA">Canada</option>
                                    <option value="AU">Australia</option>
                                    <!-- More countries would be added here -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="edit-user-balance" class="form-label">Balance</label>
                                <input type="number" id="edit-user-balance" class="form-control" min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label for="edit-user-investment" class="form-label">Investment Balance</label>
                                <input type="number" id="edit-user-investment" class="form-control" min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <div style="display: flex; align-items: center;">
                                    <label class="switch">
                                        <input type="checkbox" id="edit-user-status">
                                        <span class="slider"></span>
                                    </label>
                                    <span style="margin-left: 10px;" id="edit-user-status-text">Active</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Verified</label>
                                <div style="display: flex; align-items: center;">
                                    <label class="switch">
                                        <input type="checkbox" id="edit-user-verified">
                                        <span class="slider"></span>
                                    </label>
                                    <span style="margin-left: 10px;" id="edit-user-verified-text">No</span>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="edit-user-cancel">Cancel</button>
                        <button type="button" class="btn btn-primary" id="edit-user-submit">
                            <span id="edit-user-text">Save Changes</span>
                            <span id="edit-user-spinner" class="spinner" style="display: none;"></span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Add Plan Modal -->
            <div class="modal-overlay" id="add-plan-modal">
                <div class="modal">
                    <div class="modal-header">
                        <h3 class="modal-title">Add Investment Plan</h3>
                        <button class="modal-close" id="add-plan-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="add-plan-form">
                            <div class="form-group">
                                <label for="plan-name" class="form-label">Plan Name</label>
                                <input type="text" id="plan-name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="plan-description" class="form-label">Description</label>
                                <textarea id="plan-description" class="form-control form-textarea"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="plan-min-amount" class="form-label">Minimum Amount</label>
                                <input type="number" id="plan-min-amount" class="form-control" min="0" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label for="plan-max-amount" class="form-label">Maximum Amount</label>
                                <input type="number" id="plan-max-amount" class="form-control" min="0" step="0.01">
                                <small class="form-text" style="color: var(--gray);">Leave empty for no maximum</small>
                            </div>
                            <div class="form-group">
                                <label for="plan-duration" class="form-label">Duration (days)</label>
                                <input type="number" id="plan-duration" class="form-control" min="1" required>
                            </div>
                            <div class="form-group">
                                <label for="plan-daily-profit" class="form-label">Daily Profit (%)</label>
                                <input type="number" id="plan-daily-profit" class="form-control" min="0" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <div style="display: flex; align-items: center;">
                                    <label class="switch">
                                        <input type="checkbox" id="plan-status" checked>
                                        <span class="slider"></span>
                                    </label>
                                    <span style="margin-left: 10px;" id="plan-status-text">Active</span>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="add-plan-cancel">Cancel</button>
                        <button type="button" class="btn btn-primary" id="add-plan-submit">
                            <span id="add-plan-text">Add Plan</span>
                            <span id="add-plan-spinner" class="spinner" style="display: none;"></span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Edit Plan Modal -->
            <div class="modal-overlay" id="edit-plan-modal">
                <div class="modal">
                    <div class="modal-header">
                        <h3 class="modal-title">Edit Investment Plan</h3>
                        <button class="modal-close" id="edit-plan-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="edit-plan-form">
                            <input type="hidden" id="edit-plan-id">
                            <div class="form-group">
                                <label for="edit-plan-name" class="form-label">Plan Name</label>
                                <input type="text" id="edit-plan-name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="edit-plan-description" class="form-label">Description</label>
                                <textarea id="edit-plan-description" class="form-control form-textarea"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="edit-plan-min-amount" class="form-label">Minimum Amount</label>
                                <input type="number" id="edit-plan-min-amount" class="form-control" min="0" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label for="edit-plan-max-amount" class="form-label">Maximum Amount</label>
                                <input type="number" id="edit-plan-max-amount" class="form-control" min="0" step="0.01">
                                <small class="form-text" style="color: var(--gray);">Leave empty for no maximum</small>
                            </div>
                            <div class="form-group">
                                <label for="edit-plan-duration" class="form-label">Duration (days)</label>
                                <input type="number" id="edit-plan-duration" class="form-control" min="1" required>
                            </div>
                            <div class="form-group">
                                <label for="edit-plan-daily-profit" class="form-label">Daily Profit (%)</label>
                                <input type="number" id="edit-plan-daily-profit" class="form-control" min="0" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <div style="display: flex; align-items: center;">
                                    <label class="switch">
                                        <input type="checkbox" id="edit-plan-status">
                                        <span class="slider"></span>
                                    </label>
                                    <span style="margin-left: 10px;" id="edit-plan-status-text">Active</span>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="edit-plan-cancel">Cancel</button>
                        <button type="button" class="btn btn-primary" id="edit-plan-submit">
                            <span id="edit-plan-text">Save Changes</span>
                            <span id="edit-plan-spinner" class="spinner" style="display: none;"></span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Process Withdrawal Modal -->
            <div class="modal-overlay" id="process-withdrawal-modal">
                <div class="modal">
                    <div class="modal-header">
                        <h3 class="modal-title">Process Withdrawal</h3>
                        <button class="modal-close" id="process-withdrawal-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="process-withdrawal-form">
                            <input type="hidden" id="withdrawal-id">
                            <div class="form-group">
                                <label class="form-label">User</label>
                                <p id="withdrawal-user" style="padding: 10px; background-color: var(--gray-light); border-radius: var(--border-radius);"></p>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Amount</label>
                                <p id="withdrawal-amount" style="padding: 10px; background-color: var(--gray-light); border-radius: var(--border-radius);"></p>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Method</label>
                                <p id="withdrawal-method" style="padding: 10px; background-color: var(--gray-light); border-radius: var(--border-radius);"></p>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Wallet/Account</label>
                                <p id="withdrawal-wallet" style="padding: 10px; background-color: var(--gray-light); border-radius: var(--border-radius);"></p>
                            </div>
                            <div class="form-group">
                                <label for="withdrawal-action" class="form-label">Action</label>
                                <select id="withdrawal-action" class="form-control form-select" required>
                                    <option value="">Select Action</option>
                                    <option value="approve">Approve</option>
                                    <option value="reject">Reject</option>
                                </select>
                            </div>
                            <div class="form-group" id="withdrawal-reject-reason-group" style="display: none;">
                                <label for="withdrawal-reject-reason" class="form-label">Reason for Rejection</label>
                                <textarea id="withdrawal-reject-reason" class="form-control form-textarea" placeholder="Provide a reason for rejecting this withdrawal"></textarea>
                            </div>
                            <div class="form-group" id="withdrawal-transaction-id-group" style="display: none;">
                                <label for="withdrawal-transaction-id" class="form-label">Transaction ID</label>
                                <input type="text" id="withdrawal-transaction-id" class="form-control" placeholder="Enter the transaction ID from payment processor">
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="process-withdrawal-cancel">Cancel</button>
                        <button type="button" class="btn btn-primary" id="process-withdrawal-submit">
                            <span id="process-withdrawal-text">Submit</span>
                            <span id="process-withdrawal-spinner" class="spinner" style="display: none;"></span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- View Ticket Modal -->
            <div class="modal-overlay" id="view-ticket-modal">
                <div class="modal" style="max-width: 800px;">
                    <div class="modal-header">
                        <h3 class="modal-title">Support Ticket #<span id="ticket-id"></span></h3>
                        <button class="modal-close" id="view-ticket-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="ticket-header" style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <div>
                                    <strong>Subject:</strong> <span id="ticket-subject"></span>
                                </div>
                                <div>
                                    <span class="badge" id="ticket-status-badge">Open</span>
                                </div>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <div>
                                    <strong>User:</strong> <span id="ticket-user"></span>
                                </div>
                                <div>
                                    <strong>Priority:</strong> <span id="ticket-priority"></span>
                                </div>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <div>
                                    <strong>Category:</strong> <span id="ticket-category"></span>
                                </div>
                                <div>
                                    <strong>Date:</strong> <span id="ticket-date"></span>
                                </div>
                            </div>
                        </div>
                        <div class="ticket-message" style="padding: 15px; background-color: var(--gray-light); border-radius: var(--border-radius); margin-bottom: 20px;">
                            <p id="ticket-message"></p>
                        </div>
                        <div class="ticket-replies" id="ticket-replies" style="margin-bottom: 20px;">
                            <!-- Replies will be loaded here -->
                        </div>
                        <div class="ticket-reply-form">
                            <div class="form-group">
                                <label for="ticket-reply-message" class="form-label">Reply</label>
                                <textarea id="ticket-reply-message" class="form-control form-textarea" placeholder="Type your reply here..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <select id="ticket-reply-status" class="form-control form-select">
                                    <option value="open">Open</option>
                                    <option value="pending">Pending</option>
                                    <option value="resolved">Resolved</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="ticket-reply-cancel">Cancel</button>
                        <button type="button" class="btn btn-primary" id="ticket-reply-submit">
                            <span id="ticket-reply-text">Submit Reply</span>
                            <span id="ticket-reply-spinner" class="spinner" style="display: none;"></span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Send Notification Modal -->
            <div class="modal-overlay" id="send-notification-modal">
                <div class="modal">
                    <div class="modal-header">
                        <h3 class="modal-title">Send Notification</h3>
                        <button class="modal-close" id="send-notification-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="send-notification-form">
                            <div class="form-group">
                                <label for="notification-title" class="form-label">Title</label>
                                <input type="text" id="notification-title" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="notification-message" class="form-label">Message</label>
                                <textarea id="notification-message" class="form-control form-textarea" required></textarea>
                            </div>
                            <div class="form-group">
                                <label for="notification-type" class="form-label">Type</label>
                                <select id="notification-type" class="form-control form-select">
                                    <option value="info">Information</option>
                                    <option value="warning">Warning</option>
                                    <option value="success">Success</option>
                                    <option value="error">Error</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="notification-recipients" class="form-label">Recipients</label>
                                <select id="notification-recipients" class="form-control form-select">
                                    <option value="all">All Users</option>
                                    <option value="active">Active Users</option>
                                    <option value="inactive">Inactive Users</option>
                                    <option value="investors">Investors</option>
                                    <option value="non-investors">Non-Investors</option>
                                    <option value="custom">Custom Selection</option>
                                </select>
                            </div>
                            <div class="form-group" id="custom-recipients-group" style="display: none;">
                                <label for="custom-recipients" class="form-label">Select Users</label>
                                <select id="custom-recipients" class="form-control form-select" multiple>
                                    <!-- Users will be loaded here -->
                                </select>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="send-notification-cancel">Cancel</button>
                        <button type="button" class="btn btn-primary" id="send-notification-submit">
                            <span id="send-notification-text">Send Notification</span>
                            <span id="send-notification-spinner" class="spinner" style="display: none;"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let adminToken = localStorage.getItem('admin_jwt');
        let csrfToken = localStorage.getItem('csrf_token');
        let socket = null;
        let userGrowthChart = null;
        let revenueChart = null;
        let currentSection = 'dashboard';
        let currentTab = 'pending'; // For withdrawals, deposits, etc.
        let currentChatUserId = null;

        // DOM Ready
        $(document).ready(function() {
            // Check authentication status
            checkAuth();

            // Initialize DataTables
            initDataTables();

            // Initialize event listeners
            initEventListeners();

            // Initialize socket connection if authenticated
            if (adminToken) {
                initSocket();
            }
        });

        // Check authentication status
        function checkAuth() {
            if (adminToken) {
                verifyToken();
            } else {
                showLoginPage();
            }
        }

        // Verify JWT token with backend
        function verifyToken() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/verify',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        showAdminDashboard(response.data.admin);
                        loadDashboardData();
                    } else {
                        showLoginPage();
                    }
                },
                error: function(xhr, status, error) {
                    showLoginPage();
                }
            });
        }

        // Show login page
        function showLoginPage() {
            $('#login-page').show();
            $('#admin-dashboard').hide();
            localStorage.removeItem('admin_jwt');
            localStorage.removeItem('csrf_token');
            adminToken = null;
            csrfToken = null;
        }

        // Show admin dashboard
        function showAdminDashboard(admin) {
            $('#login-page').hide();
            $('#admin-dashboard').show();
            
            // Set admin info
            $('#admin-name').text(admin.name);
            $('#admin-role').text(admin.role);
            $('#header-admin-name').text(admin.name);
        }

        // Initialize DataTables
        function initDataTables() {
            // Users table
            $('#users-table').DataTable({
                responsive: true,
                serverSide: true,
                ajax: {
                    url: 'https://website-backendd-1.onrender.com/api/admin/users',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    dataSrc: 'data'
                },
                columns: [
                    { data: 'id' },
                    { data: 'name' },
                    { data: 'email' },
                    { 
                        data: 'balance',
                        render: function(data, type, row) {
                            return '$' + parseFloat(data).toFixed(2);
                        }
                    },
                    { 
                        data: 'status',
                        render: function(data, type, row) {
                            let badgeClass = 'badge-success';
                            let statusText = 'Active';
                            
                            if (data === 'inactive') {
                                badgeClass = 'badge-danger';
                                statusText = 'Inactive';
                            } else if (data === 'suspended') {
                                badgeClass = 'badge-warning';
                                statusText = 'Suspended';
                            } else if (data === 'pending') {
                                badgeClass = 'badge-secondary';
                                statusText = 'Pending';
                            }
                            
                            return '<span class="badge ' + badgeClass + '">' + statusText + '</span>';
                        }
                    },
                    { 
                        data: 'created_at',
                        render: function(data, type, row) {
                            return new Date(data).toLocaleString();
                        }
                    },
                    {
                        data: null,
                        render: function(data, type, row) {
                            return `
                                <div style="display: flex; gap: 5px;">
                                    <button class="btn btn-sm btn-primary edit-user-btn" data-id="${row.id}">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    ${row.status === 'active' ? `
                                        <button class="btn btn-sm btn-warning suspend-user-btn" data-id="${row.id}">
                                            <i class="fas fa-ban"></i>
                                        </button>
                                    ` : `
                                        <button class="btn btn-sm btn-success activate-user-btn" data-id="${row.id}">
                                            <i class="fas fa-check"></i>
                                        </button>
                                    `}
                                    <button class="btn btn-sm btn-danger delete-user-btn" data-id="${row.id}">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            `;
                        }
                    }
                ]
            });

            // Transactions table


     // Initialize DataTables for transactions
        function initTransactionsTable() {
            $('#transactions-table').DataTable({
                responsive: true,
                dom: 'Bfrtip',
                buttons: [
                    {
                        extend: 'excel',
                        text: '<i class="fas fa-file-excel"></i> Excel',
                        className: 'btn btn-success btn-sm',
                        exportOptions: {
                            columns: ':visible'
                        }
                    },
                    {
                        extend: 'pdf',
                        text: '<i class="fas fa-file-pdf"></i> PDF',
                        className: 'btn btn-danger btn-sm',
                        exportOptions: {
                            columns: ':visible'
                        }
                    },
                    {
                        extend: 'print',
                        text: '<i class="fas fa-print"></i> Print',
                        className: 'btn btn-info btn-sm',
                        exportOptions: {
                            columns: ':visible'
                        }
                    },
                    {
                        extend: 'colvis',
                        text: '<i class="fas fa-columns"></i> Columns',
                        className: 'btn btn-secondary btn-sm'
                    }
                ],
                serverSide: true,
                ajax: {
                    url: 'https://website-backendd-1.onrender.com/api/admin/transactions/all',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: function(d) {
                        // Add tab filter to the request
                        d.tab = currentTab;
                    },
                    dataSrc: 'data'
                },
                columns: [
                    { data: 'id' },
                    { 
                        data: 'user',
                        render: function(data, type, row) {
                            return data ? data.name : 'System';
                        }
                    },
                    { 
                        data: 'type',
                        render: function(data, type, row) {
                            return data ? data.charAt(0).toUpperCase() + data.slice(1) : 'N/A';
                        }
                    },
                    { 
                        data: 'amount',
                        render: function(data, type, row) {
                            return data ? '$' + parseFloat(data).toFixed(2) : '$0.00';
                        }
                    },
                    { 
                        data: 'method',
                        render: function(data, type, row) {
                            return data ? data.charAt(0).toUpperCase() + data.slice(1) : 'N/A';
                        }
                    },
                    { 
                        data: 'status',
                        render: function(data, type, row) {
                            let badgeClass = 'badge-secondary';
                            let statusText = 'Pending';
                            
                            if (data === 'completed') {
                                badgeClass = 'badge-success';
                                statusText = 'Completed';
                            } else if (data === 'failed') {
                                badgeClass = 'badge-danger';
                                statusText = 'Failed';
                            } else if (data === 'cancelled') {
                                badgeClass = 'badge-warning';
                                statusText = 'Cancelled';
                            }
                            
                            return '<span class="badge ' + badgeClass + '">' + statusText + '</span>';
                        }
                    },
                    { 
                        data: 'created_at',
                        render: function(data, type, row) {
                            return data ? new Date(data).toLocaleString() : 'N/A';
                        }
                    },
                    {
                        data: null,
                        render: function(data, type, row) {
                            let buttons = `
                                <div style="display: flex; gap: 5px;">
                                    <button class="btn btn-sm btn-primary view-transaction-btn" data-id="${row.id}">
                                        <i class="fas fa-eye"></i>
                                    </button>
                            `;
                            
                            if (row.status === 'pending') {
                                buttons += `
                                    <button class="btn btn-sm btn-success approve-transaction-btn" data-id="${row.id}">
                                        <i class="fas fa-check"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger decline-transaction-btn" data-id="${row.id}">
                                        <i class="fas fa-times"></i>
                                    </button>
                                `;
                            }
                            
                            buttons += `</div>`;
                            
                            return buttons;
                        },
                        orderable: false
                    }
                ],
                order: [[6, 'desc']],
                createdRow: function(row, data, dataIndex) {
                    // Highlight pending transactions
                    if (data.status === 'pending') {
                        $(row).addClass('pending-transaction');
                    }
                }
            });
        }

        // Load transactions data
        function loadTransactionsData() {
            if (!$.fn.DataTable.isDataTable('#transactions-table')) {
                initTransactionsTable();
            } else {
                $('#transactions-table').DataTable().ajax.reload();
            }
        }

        // View transaction details
        $(document).on('click', '.view-transaction-btn', function() {
            const transactionId = $(this).data('id');
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/transactions/${transactionId}`,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        const transaction = response.data;
                        
                        // Fill transaction details
                        $('#transaction-id').text(transaction.id);
                        $('#transaction-user').text(transaction.user ? transaction.user.name : 'System');
                        $('#transaction-type').text(transaction.type ? transaction.type.charAt(0).toUpperCase() + transaction.type.slice(1) : 'N/A');
                        $('#transaction-amount').text('$' + parseFloat(transaction.amount).toFixed(2));
                        $('#transaction-method').text(transaction.method ? transaction.method.charAt(0).toUpperCase() + transaction.method.slice(1) : 'N/A');
                        $('#transaction-status').html(`<span class="badge ${getStatusBadgeClass(transaction.status)}">${getStatusText(transaction.status)}</span>`);
                        $('#transaction-date').text(new Date(transaction.created_at).toLocaleString());
                        
                        // Show/hide reference and wallet fields based on transaction type
                        if (transaction.reference) {
                            $('#transaction-reference').text(transaction.reference);
                            $('#transaction-reference-group').show();
                        } else {
                            $('#transaction-reference-group').hide();
                        }
                        
                        if (transaction.wallet_address) {
                            $('#transaction-wallet').text(transaction.wallet_address);
                            $('#transaction-wallet-group').show();
                        } else {
                            $('#transaction-wallet-group').hide();
                        }
                        
                        // Show action buttons if transaction is pending
                        if (transaction.status === 'pending') {
                            $('#transaction-actions').show();
                            $('#transaction-action-submit').show();
                            $('#transaction-action-id').val(transaction.id);
                        } else {
                            $('#transaction-actions').hide();
                            $('#transaction-action-submit').hide();
                        }
                        
                        // Show modal
                        $('#transaction-details-modal').addClass('show');
                    }
                },
                error: function(xhr, status, error) {
                    showError('Failed to load transaction details');
                }
            });
        });

        // Get status badge class
        function getStatusBadgeClass(status) {
            switch(status) {
                case 'completed': return 'badge-success';
                case 'failed': return 'badge-danger';
                case 'cancelled': return 'badge-warning';
                default: return 'badge-secondary';
            }
        }

        // Get status text
        function getStatusText(status) {
            switch(status) {
                case 'completed': return 'Completed';
                case 'failed': return 'Failed';
                case 'cancelled': return 'Cancelled';
                default: return 'Pending';
            }
        }

        // Transaction action change
        $('#transaction-action').change(function() {
            const action = $(this).val();
            
            $('#transaction-decline-reason-group').toggle(action === 'decline');
            $('#transaction-reference-input-group').toggle(action === 'approve');
        });

        // Submit transaction action
        $('#transaction-action-submit').click(function() {
            const transactionId = $('#transaction-action-id').val();
            const action = $('#transaction-action').val();
            const declineReason = $('#transaction-decline-reason').val();
            const reference = $('#transaction-reference-input').val();
            
            if (!action) {
                showError('Please select an action');
                return;
            }
            
            if (action === 'decline' && !declineReason) {
                showError('Please provide a reason for declining');
                return;
            }
            
            if (action === 'approve' && !reference) {
                showError('Please provide a transaction reference');
                return;
            }
            
            $('#transaction-action-text').hide();
            $('#transaction-action-spinner').show();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/transactions/${transactionId}/process`,
                type: 'POST',
                data: JSON.stringify({
                    action: action,
                    decline_reason: declineReason,
                    reference: reference
                }),
                contentType: 'application/json',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        showSuccess(`Transaction ${action}d successfully`);
                        $('#transaction-details-modal').removeClass('show');
                        loadTransactionsData();
                    } else {
                        showError(response.message || `Failed to ${action} transaction`);
                    }
                    $('#transaction-action-text').show();
                    $('#transaction-action-spinner').hide();
                },
                error: function(xhr, status, error) {
                    showError(xhr.responseJSON?.message || `Failed to ${action} transaction`);
                    $('#transaction-action-text').show();
                    $('#transaction-action-spinner').hide();
                }
            });
        });

        // Quick approve transaction
        $(document).on('click', '.approve-transaction-btn', function(e) {
            e.stopPropagation();
            const transactionId = $(this).data('id');
            
            Swal.fire({
                title: 'Approve Transaction',
                text: 'Are you sure you want to approve this transaction?',
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: 'var(--success)',
                cancelButtonColor: 'var(--error)',
                confirmButtonText: 'Yes, approve it!',
                background: 'var(--secondary)',
                color: 'var(--dark)'
            }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                        url: `https://website-backendd-1.onrender.com/api/admin/transactions/${transactionId}/process`,
                        type: 'POST',
                        data: JSON.stringify({
                            action: 'approve'
                        }),
                        contentType: 'application/json',
                        headers: {
                            'Authorization': 'Bearer ' + adminToken,
                            'X-CSRF-TOKEN': csrfToken
                        },
                        success: function(response) {
                            if (response.status === 'success') {
                                showSuccess('Transaction approved successfully');
                                loadTransactionsData();
                            } else {
                                showError(response.message || 'Failed to approve transaction');
                            }
                        },
                        error: function(xhr, status, error) {
                            showError(xhr.responseJSON?.message || 'Failed to approve transaction');
                        }
                    });
                }
            });
        });

        // Quick decline transaction
        $(document).on('click', '.decline-transaction-btn', function(e) {
            e.stopPropagation();
            const transactionId = $(this).data('id');
            
            Swal.fire({
                title: 'Decline Transaction',
                html: `
                    <div class="form-group">
                        <label for="swal-decline-reason" class="form-label">Reason for Decline</label>
                        <textarea id="swal-decline-reason" class="form-control" style="width: 100%; min-height: 100px;" placeholder="Provide a reason for declining this transaction"></textarea>
                    </div>
                `,
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: 'var(--error)',
                cancelButtonColor: 'var(--secondary)',
                confirmButtonText: 'Decline',
                cancelButtonText: 'Cancel',
                background: 'var(--secondary)',
                color: 'var(--dark)',
                preConfirm: () => {
                    const reason = $('#swal-decline-reason').val();
                    if (!reason) {
                        Swal.showValidationMessage('Please provide a reason for declining');
                        return false;
                    }
                    return reason;
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    const declineReason = result.value;
                    
                    $.ajax({
                        url: `https://website-backendd-1.onrender.com/api/admin/transactions/${transactionId}/process`,
                        type: 'POST',
                        data: JSON.stringify({
                            action: 'decline',
                            decline_reason: declineReason
                        }),
                        contentType: 'application/json',
                        headers: {
                            'Authorization': 'Bearer ' + adminToken,
                            'X-CSRF-TOKEN': csrfToken
                        },
                        success: function(response) {
                            if (response.status === 'success') {
                                showSuccess('Transaction declined successfully');
                                loadTransactionsData();
                            } else {
                                showError(response.message || 'Failed to decline transaction');
                            }
                        },
                        error: function(xhr, status, error) {
                            showError(xhr.responseJSON?.message || 'Failed to decline transaction');
                        }
                    });
                }
            });
        });

        // Export transactions
        $('#export-transactions-btn').click(function() {
            // Trigger DataTable export
            const table = $('#transactions-table').DataTable();
            const buttons = table.buttons(['excel', 'pdf', 'print']);
            buttons.containers().appendTo('#transactions-table_wrapper .col-md-6:eq(0)');
            
            // Show export options
            table.button('excel:name').trigger();
        });

        // Refresh transactions
        $('#refresh-transactions-btn').click(function() {
            loadTransactionsData();
            showSuccess('Transactions refreshed successfully');
        });

        // Tab change for transactions
        $(document).on('click', '#transactions-content .tab', function() {
            const tab = $(this).data('tab');
            
            $('#transactions-content .tab').removeClass('active');
            $(this).addClass('active');
            
            currentTab = tab;
            loadTransactionsData();
        });

        // Close transaction details modal
        $('#transaction-details-close, #transaction-details-cancel, #transaction-details-modal .modal-overlay').click(function(e) {
            if (e.target === this) {
                $('#transaction-details-modal').removeClass('show');
            }
        });
          }  






            
        // Initialize event listeners
        function initEventListeners() {
            // Login form submission
            $('#login-form').submit(function(e) {
                e.preventDefault();
                loginAdmin();
            });

            // Forgot password link
            $('#forgot-password').click(function(e) {
                e.preventDefault();
                $('#forgot-password-modal').addClass('show');
            });

            // Two-factor authentication modal
            $('#twofa-close, #twofa-modal .modal-overlay').click(function(e) {
                if (e.target === this) {
                    $('#twofa-modal').removeClass('show');
                }
            });

            // Forgot password modal
            $('#forgot-password-close, #forgot-password-cancel, #forgot-password-modal .modal-overlay').click(function(e) {
                if (e.target === this) {
                    $('#forgot-password-modal').removeClass('show');
                }
            });

            // Reset password button
            $('#reset-password-btn').click(function() {
                resetPassword();
            });

            // Verify 2FA button
            $('#verify-2fa-btn').click(function() {
                verifyTwoFactor();
            });

            // Sidebar menu items
            $('.menu-item a').click(function(e) {
                e.preventDefault();
                const section = $(this).data('section');
                navigateToSection(section);
            });

            // Submenu toggle
            $('.has-submenu > a').click(function(e) {
                e.preventDefault();
                $(this).siblings('.submenu').toggleClass('show');
            });

            // User menu toggle
            $('#user-menu-btn').click(function() {
                $('#user-menu-dropdown').toggleClass('show');
            });

            // Close user menu when clicking outside
            $(document).click(function(e) {
                if (!$(e.target).closest('#user-menu-btn, #user-menu-dropdown').length) {
                    $('#user-menu-dropdown').removeClass('show');
                }
            });

            // Logout button
            $('#logout-btn').click(function(e) {
                e.preventDefault();
                logoutAdmin();
            });

            // Sidebar toggle for mobile
            $('#sidebar-toggle').click(function() {
                $('#admin-sidebar').toggleClass('show');
            });

            // Tab navigation
            $('.tab').click(function() {
                const tab = $(this).data('tab');
                const parentSection = $(this).closest('.dashboard-section').attr('id').replace('-content', '');
                
                $('.tab').removeClass('active');
                $(this).addClass('active');
                
                currentTab = tab;
                
                // Reload data for the current section with the new tab
                if (parentSection === 'withdrawals') {
                    loadWithdrawalsData();
                } else if (parentSection === 'deposits') {
                    loadDepositsData();
                } else if (parentSection === 'support-tickets') {
                    loadTicketsData();
                }
            });

            // Add more event listeners for modals, buttons, etc.
        }

        // Initialize socket connection
        function initSocket() {
            socket = io('https://website-backendd-1.onrender.com', {
                transports: ['websocket'],
                query: {
                    token: adminToken
                }
            });

            socket.on('connect', function() {
                console.log('Socket connected');
            });

            socket.on('disconnect', function() {
                console.log('Socket disconnected');
            });

            socket.on('new_user', function(data) {
                // Update new users badge
                const currentCount = parseInt($('#new-users-badge').text());
                $('#new-users-badge').text(currentCount + 1);
                
                // Show notification
                showNotification('New User Registered', `${data.name} just registered on the platform.`, 'success');
                
                // Reload users table if on users page
                if (currentSection === 'users') {
                    $('#users-table').DataTable().ajax.reload();
                }
            });

            socket.on('new_deposit', function(data) {
                // Show notification
                showNotification('New Deposit', `${data.user.name} deposited $${data.amount}.`, 'success');
                
                // Update dashboard stats if on dashboard
                if (currentSection === 'dashboard') {
                    loadDashboardStats();
                }
                
                // Reload deposits table if on deposits page
                if (currentSection === 'deposits') {
                    $('#deposits-table').DataTable().ajax.reload();
                }
            });

            socket.on('new_withdrawal', function(data) {
                // Update pending withdrawals badge
                const currentCount = parseInt($('#pending-withdrawals-badge').text());
                $('#pending-withdrawals-badge').text(currentCount + 1);
                
                // Show notification
                showNotification('New Withdrawal Request', `${data.user.name} requested $${data.amount} withdrawal.`, 'warning');
                
                // Reload withdrawals table if on withdrawals page
                if (currentSection === 'withdrawals') {
                    loadWithdrawalsData();
                }
            });

            socket.on('new_ticket', function(data) {
                // Update open tickets badge
                const currentCount = parseInt($('#open-tickets-badge').text());
                $('#open-tickets-badge').text(currentCount + 1);
                
                // Show notification
                showNotification('New Support Ticket', `${data.user.name} created a new ticket: ${data.subject}.`, 'info');
                
                // Reload tickets table if on support page
                if (currentSection === 'support-tickets') {
                    loadTicketsData();
                }
            });

            socket.on('new_message', function(data) {
                if (currentSection === 'support-chat' && currentChatUserId === data.user_id) {
                    // Add new message to chat
                    addChatMessage(data, false);
                }
                
                // Show notification if not currently viewing this chat
                if (currentSection !== 'support-chat' || currentChatUserId !== data.user_id) {
                    showNotification('New Chat Message', `You have a new message from ${data.user.name}.`, 'info');
                }
            });

            socket.on('notification', function(data) {
                // Update notification count
                const currentCount = parseInt($('#notification-count').text());
                $('#notification-count').text(currentCount + 1);
                
                // Show notification
                showNotification(data.title, data.message, data.type);
            });
        }

        // Login admin
        function loginAdmin() {
            const email = $('#email').val();
            const password = $('#password').val();
            const remember = $('#remember').is(':checked');
            
            $('#login-btn-text').hide();
            $('#login-spinner').show();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/login',
                type: 'POST',
                data: JSON.stringify({
                    email: email,
                    password: password
                }),
                contentType: 'application/json',
                success: function(response) {
                    if (response.status === 'success') {
                        adminToken = response.token;
                        csrfToken = response.csrfToken;
                        
                        // Store tokens
                        localStorage.setItem('admin_jwt', adminToken);
                        localStorage.setItem('csrf_token', csrfToken);
                        
                        // Check if 2FA is required
                        if (response.twoFactorRequired) {
                            $('#twofa-modal').addClass('show');
                            $('#login-btn-text').show();
                            $('#login-spinner').hide();
                        } else {
                            // Show admin dashboard
                            showAdminDashboard(response.data.admin);
                            initSocket();
                        }
                    } else {
                        showError(response.message || 'Login failed');
                        $('#login-btn-text').show();
                        $('#login-spinner').hide();
                    }
                },
                error: function(xhr, status, error) {
                    showError(xhr.responseJSON?.message || 'Login failed');
                    $('#login-btn-text').show();
                    $('#login-spinner').hide();
                }
            });
        }

        // Verify two-factor authentication
        function verifyTwoFactor() {
            const email = $('#email').val();
            const token = $('#twofa-modal input[type="text"]').map(function() {
                return $(this).val();
            }).get().join('');
            
            $('#verify-2fa-text').hide();
            $('#verify-2fa-spinner').show();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/verify-2fa',
                type: 'POST',
                data: JSON.stringify({
                    email: email,
                    token: token
                }),
                contentType: 'application/json',
                headers: {
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        adminToken = response.token;
                        localStorage.setItem('admin_jwt', adminToken);
                        
                        $('#twofa-modal').removeClass('show');
                        showAdminDashboard(response.data.admin);
                        initSocket();
                    } else {
                        showError(response.message || 'Two-factor authentication failed');
                    }
                    $('#verify-2fa-text').show();
                    $('#verify-2fa-spinner').hide();
                },
                error: function(xhr, status, error) {
                    showError(xhr.responseJSON?.message || 'Two-factor authentication failed');
                    $('#verify-2fa-text').show();
                    $('#verify-2fa-spinner').hide();
                }
            });
        }

        // Reset password
        function resetPassword() {
            const email = $('#reset-email').val();
            
            $('#reset-password-text').hide();
            $('#reset-password-spinner').show();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/forgot-password',
                type: 'POST',
                data: JSON.stringify({
                    email: email
                }),
                contentType: 'application/json',
                headers: {
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        showSuccess(response.message || 'Password reset link sent to your email');
                        $('#forgot-password-modal').removeClass('show');
                    } else {
                        showError(response.message || 'Failed to send reset link');
                    }
                    $('#reset-password-text').show();
                    $('#reset-password-spinner').hide();
                },
                error: function(xhr, status, error) {
                    showError(xhr.responseJSON?.message || 'Failed to send reset link');
                    $('#reset-password-text').show();
                    $('#reset-password-spinner').hide();
                }
            });
        }

        // Logout admin
        function logoutAdmin() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/logout',
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        showLoginPage();
                    }
                },
                error: function(xhr, status, error) {
                    showLoginPage();
                }
            });
        }

        // Navigate to section
        function navigateToSection(section) {
            // Hide all sections
            $('.dashboard-section').hide();
            
            // Remove active class from all menu items
            $('.menu-item a').removeClass('active');
            
            // Add active class to current menu item
            $(`[data-section="${section}"]`).addClass('active');
            
            // Show the selected section
            $(`#${section}-content`).show();
            
            // Update current section
            currentSection = section;
            
            // Load data for the section
            switch(section) {
                case 'dashboard':
                    loadDashboardData();
                    break;
                case 'users':
                    loadUsersData();
                    break;
                case 'transactions':
                    loadTransactionsData();
                    break;
                case 'investments':
                    loadInvestmentsData();
                    break;
                case 'withdrawals':
                    loadWithdrawalsData();
                    break;
                case 'deposits':
                    loadDepositsData();
                    break;
                case 'support-tickets':
                    loadTicketsData();
                    break;
                case 'support-chat':
                    loadChatData();
                    break;
                case 'notifications':
                    loadNotificationsData();
                    break;
                case 'reports':
                    loadReportsData();
                    break;
                case 'settings':
                    loadSettingsData();
                    break;
            }
        }

        // Load dashboard data
        function loadDashboardData() {
            loadDashboardStats();
            loadUserGrowthChart();
            loadRevenueChart();
            loadRecentActivity();
        }

        // Load dashboard stats
        function loadDashboardStats() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/stats',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        const stats = response.data;
                        
                        $('#total-users').text(stats.total_users.toLocaleString());
                        $('#users-change').text(stats.users_change + '%');
                        
                        $('#total-deposits').text('$' + stats.total_deposits.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                        $('#deposits-change').text(stats.deposits_change + '%');
                        
                        $('#pending-withdrawals').text('$' + stats.pending_withdrawals.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                        $('#withdrawals-change').text(stats.withdrawals_change + '%');
                        
                        $('#platform-revenue').text('$' + stats.platform_revenue.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                        $('#revenue-change').text(stats.revenue_change + '%');
                        
                        // Update badges
                        $('#new-users-badge').text(stats.new_users);
                        $('#pending-withdrawals-badge').text(stats.pending_withdrawals_count);
                        $('#open-tickets-badge').text(stats.open_tickets);
                        $('#notification-count').text(stats.unread_notifications);
                    }
                },
                error: function(xhr, status, error) {
                    showError('Failed to load dashboard stats');
                }
            });
        }

        // Load user growth chart
        function loadUserGrowthChart() {
            const period = $('#user-growth-period').val();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/stats/user-growth?period=' + period,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        const data = response.data;
                        
                        // Destroy previous chart if it exists
                        if (userGrowthChart) {
                            userGrowthChart.destroy();
                        }
                        
                        const ctx = $('#user-growth-chart');
                        userGrowthChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: data.labels,
                                datasets: [{
                                    label: 'User Growth',
                                    data: data.values,
                                    backgroundColor: 'rgba(0, 211, 149, 0.1)',
                                    borderColor: 'rgba(0, 211, 149, 1)',
                                    borderWidth: 2,
                                    tension: 0.4,
                                    fill: true
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        grid: {
                                            color: 'rgba(142, 142, 142, 0.1)'
                                        },
                                        ticks: {
                                            color: 'rgba(229, 229, 229, 0.7)'
                                        }
                                    },
                                    x: {
                                        grid: {
                                            color: 'rgba(142, 142, 142, 0.1)'
                                        },
                                        ticks: {
                                            color: 'rgba(229, 229, 229, 0.7)'
                                        }
                                    }
                                }
                            }
                        });
                    }
                },
                error: function(xhr, status, error) {
                    showError('Failed to load user growth data');
                }
            });
        }

        // Load revenue chart
        function loadRevenueChart() {
            const period = $('#revenue-period').val();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/stats/revenue?period=' + period,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        const data = response.data;
                        
                        // Destroy previous chart if it exists
                        if (revenueChart) {
                            revenueChart.destroy();
                        }
                        
                        const ctx = $('#revenue-chart');
                        revenueChart = new Chart(ctx, {
                            type: 'bar',
                            data: {
                                labels: data.labels,
                                datasets: [
                                    {
                                        label: 'Deposits',
                                        data: data.deposits,
                                        backgroundColor: 'rgba(212, 175, 55, 0.7)',
                                        borderColor: 'rgba(212, 175, 55, 1)',
                                        borderWidth: 1
                                    },
                                    {
                                        label: 'Withdrawals',
                                        data: data.withdrawals,
                                        backgroundColor: 'rgba(120, 79, 237, 0.7)',
                                        borderColor: 'rgba(120, 79, 237, 1)',
                                        borderWidth: 1
                                    },
                                    {
                                        label: 'Revenue',
                                        data: data.revenue,
                                        backgroundColor: 'rgba(236, 72, 153, 0.7)',
                                        borderColor: 'rgba(236, 72, 153, 1)',
                                        borderWidth: 1
                                    }
                                ]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        position: 'top',
                                        labels: {
                                            color: 'rgba(229, 229, 229, 0.7)'
                                        }
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        grid: {
                                            color: 'rgba(142, 142, 142, 0.1)'
                                        },
                                        ticks: {
                                            color: 'rgba(229, 229, 229, 0.7)'
                                        }
                                    },
                                    x: {
                                        grid: {
                                            color: 'rgba(142, 142, 142, 0.1)'
                                        },
                                        ticks: {
                                            color: 'rgba(229, 229, 229, 0.7)'
                                        }
                                    }
                                }
                            }
                        });
                    }
                },
                error: function(xhr, status, error) {
                    showError('Failed to load revenue data');
                }
            });
        }

        // Load recent activity
        function loadRecentActivity() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/activity',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        const activities = response.data;
                        const activityList = $('#activity-list');
                        
                        activityList.empty();
                        
                        if (activities.length === 0) {
                            activityList.append('<li class="empty-state">No recent activity</li>');
                        } else {
                            activities.forEach(activity => {
                                const icon = getActivityIcon(activity.type);
                                const message = getActivityMessage(activity);
                                
                                activityList.append(`
                                    <li class="activity-item">
                                        <div class="activity-icon">
                                            <i class="fas fa-${icon}"></i>
                                        </div>
                                        <div class="activity-content">
                                            <p class="activity-message">${message}</p>
                                            <div class="activity-meta">
                                                <span class="activity-user">${activity.user?.name || 'System'}</span>
                                                <span class="activity-time">${new Date(activity.created_at).toLocaleString()}</span>
                                            </div>
                                        </div>
                                    </li>
                                `);
                            });
                        }
                    }
                },
                error: function(xhr, status, error) {
                    showError('Failed to load recent activity');
                }
            });
        }

        // Get activity icon based on type
        function getActivityIcon(type) {
            const icons = {
                'login': 'sign-in-alt',
                'logout': 'sign-out-alt',
                'deposit': 'money-bill-wave',
                'withdrawal': 'hand-holding-usd',
                'investment': 'chart-line',
                'registration': 'user-plus',
                'profile-update': 'user-edit',
                'password-change': 'key',
                'ticket-created': 'ticket-alt',
                'ticket-reply': 'reply',
                'notification': 'bell',
                'admin-action': 'user-shield'
            };
            
            return icons[type] || 'info-circle';
        }

        // Get activity message
        function getActivityMessage(activity) {
            switch(activity.type) {
                case 'login':
                    return `${activity.user?.name || 'User'} logged in`;
                case 'logout':
                    return `${activity.user?.name || 'User'} logged out`;
                case 'deposit':
                    return `Deposit of $${activity.amount} ${activity.status === 'completed' ? 'completed' : 'initiated'}`;
                case 'withdrawal':
                    return `Withdrawal request of $${activity.amount} ${activity.status === 'completed' ? 'processed' : 'submitted'}`;
                case 'investment':
                    return `Invested $${activity.amount} in ${activity.plan_name} plan`;
                case 'registration':
                    return `New user registered: ${activity.user?.name || 'Unknown'}`;
                case 'profile-update':
                    return `Profile information updated`;
                case 'password-change':
                    return `Password changed`;
                case 'ticket-created':
                    return `New support ticket created: ${activity.subject}`;
                case 'ticket-reply':
                    return `Replied to support ticket: ${activity.subject}`;
                case 'notification':
                    return `Notification sent: ${activity.title}`;
                case 'admin-action':
                    return `Admin action: ${activity.description}`;
                default:
                    return activity.description || 'Activity recorded';
            }
        }

        // Load users data
        function loadUsersData() {
            $('#users-table').DataTable().ajax.reload();
        }

        // Load transactions data
        function loadTransactionsData() {
            $('#transactions-table').DataTable().ajax.reload();
        }

        // Load investments data
        function loadInvestmentsData() {
            $('#plans-table').DataTable().ajax.reload();
            $('#investments-table').DataTable().ajax.reload();
        }

        // Load withdrawals data
        function loadWithdrawalsData() {
            $('#withdrawals-table').DataTable().ajax.url(`https://website-backendd-1.onrender.com/api/admin/withdrawals/${currentTab}`).load();
        }

        // Load deposits data
        function loadDepositsData() {
            $('#deposits-table').DataTable().ajax.url(`https://website-backendd-1.onrender.com/api/admin/deposits/${currentTab}`).load();
        }

        // Load tickets data
        function loadTicketsData() {
            $('#tickets-table').DataTable().ajax.url(`https://website-backendd-1.onrender.com/api/admin/support/tickets/${currentTab}`).load();
        }

        // Load chat data
        function loadChatData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/support/chat/conversations',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        const conversations = response.data;
                        const chatList = $('#chat-list');
                        
                        chatList.empty();
                        
                        if (conversations.length === 0) {
                            chatList.append('<div class="empty-state">No active conversations</div>');
                        } else {
                            conversations.forEach(conversation => {
                                const lastMessage = conversation.last_message;
                                const unreadCount = conversation.unread_count;
                                
                                chatList.append(`
                                    <div class="chat-item" data-user-id="${conversation.user.id}" style="padding: 10px; border-bottom: 1px solid var(--gray-light); cursor: pointer;">
                                        <div style="display: flex; align-items: center;">
                                            <img src="${conversation.user.avatar || 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'}" alt="${conversation.user.name}" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover; margin-right: 10px;">
                                            <div style="flex: 1;">
                                                <h4 style="margin-bottom: 5px;">${conversation.user.name}</h4>
                                                <p style="color: var(--gray); font-size: 0.8rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${lastMessage?.message || 'No messages yet'}</p>
                                            </div>
                                            ${unreadCount > 0 ? `
                                                <span class="badge" style="background-color: var(--primary); color: var(--secondary-dark);">${unreadCount}</span>
                                            ` : ''}
                                        </div>
                                    </div>
                                `);
                            });
                            
                            // Set click handler for chat items
                            $('.chat-item').click(function() {
                                const userId = $(this).data('user-id');
                                loadChatMessages(userId);
                            });
                        }
                    }
                },
                error: function(xhr, status, error) {
                    showError('Failed to load chat conversations');
                }
            });
        }

        // Load chat messages for a specific user
        function loadChatMessages(userId) {
            currentChatUserId = userId;
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/support/chat/messages/${userId}`,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        const user = response.data.user;
                        const messages = response.data.messages;
                        const chatMessages = $('#chat-messages');
                        
                        // Update chat header
                        $('#current-chat-user').html(`
                            <h4 style="margin-bottom: 5px;">${user.name}</h4>
                            <p style="color: var(--gray); font-size: 0.8rem;">${user.email}</p>
                        `);
                        
                        // Enable chat input
                        $('#chat-message-input').prop('disabled', false);
                        $('#send-message-btn').prop('disabled', false);
                        
                        // Load messages
                        chatMessages.empty();
                        
                        if (messages.length === 0) {
                            chatMessages.append('<div class="empty-state">No messages yet</div>');
                        } else {
                            messages.forEach(message => {
                                addChatMessage(message, message.is_admin);
                            });
                            
                            // Scroll to bottom
                            chatMessages.scrollTop(chatMessages[0].scrollHeight);
                        }
                    }
                },
                error: function(xhr, status, error) {
                    showError('Failed to load chat messages');
                }
            });
        }

        // Add chat message to the UI
        function addChatMessage(message, isAdmin) {
            const chatMessages = $('#chat-messages');
            
            // Remove empty state if present
            if (chatMessages.find('.empty-state').length) {
                chatMessages.empty();
            }
            
            const messageClass = isAdmin ? 'admin-message' : 'user-message';
            const alignClass = isAdmin ? 'align-right' : 'align-left';
            
            chatMessages.append(`
                <div class="chat-message ${messageClass} ${alignClass}" style="margin-bottom: 15px; max-width: 70%; ${isAdmin ? 'margin-left: auto;' : 'margin-right: auto;'}">
                    <div style="padding: 10px 15px; background-color: ${isAdmin ? 'var(--primary)' : 'var(--gray-light)'}; border-radius: ${isAdmin ? '15px 15px 0 15px' : '15px 15px 15px 0'}; color: ${isAdmin ? 'var(--secondary-dark)' : 'var(--dark)'};">
                        <p style="margin-bottom: 5px;">${message.message}</p>
                        <div style="text-align: right; font-size: 0.7rem; color: ${isAdmin ? 'rgba(30, 30, 30, 0.7)' : 'rgba(229, 229, 229, 0.7)'}">
                            ${new Date(message.created_at).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                        </div>
                    </div>
                </div>
            `);
            
            // Scroll to bottom
            chatMessages.scrollTop(chatMessages[0].scrollHeight);
        }

        // Send chat message
        $('#send-message-btn').click(function() {
            const message = $('#chat-message-input').val().trim();
            
            if (message && currentChatUserId) {
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/support/chat/send',
                    type: 'POST',
                    data: JSON.stringify({
                        user_id: currentChatUserId,
                        message: message
                    }),
                    contentType: 'application/json',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            // Add message to UI
                            addChatMessage(response.data, true);
                            
                            // Clear input
                            $('#chat-message-input').val('');
                        }
                    },
                    error: function(xhr, status, error) {
                        showError('Failed to send message');
                    }
                });
            }
        });

        // Load notifications data
        function loadNotificationsData() {
            $('#notifications-table').DataTable().ajax.reload();
        }

        // Load reports data
        function loadReportsData() {
            // Set default dates
            const today = new Date();
            const oneMonthAgo = new Date();
            oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
            
            $('#report-start-date').val(oneMonthAgo.toISOString().split('T')[0]);
            $('#report-end-date').val(today.toISOString().split('T')[0]);
        }

        // Load settings data
        function loadSettingsData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/settings',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'X-CSRF-TOKEN': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        const settings = response.data;
                        
                        // General settings
                        $('#platform-name').val(settings.general.platform_name);
                        $('#platform-url').val(settings.general.platform_url);
                        $('#platform-timezone').val(settings.general.timezone);
                        $('#platform-currency').val(settings.general.default_currency);
                        $('#maintenance-mode').prop('checked', settings.general.maintenance_mode);
                        $('#maintenance-status').text(settings.general.maintenance_mode ? 'Enabled' : 'Disabled');
                        $('#maintenance-message').val(settings.general.maintenance_message);
                        $('#maintenance-message-group').toggle(settings.general.maintenance_mode);
                        
                        // Security settings
                        $('#enable-2fa').prop('checked', settings.security.two_factor_enabled);
                        $('#2fa-status').text(settings.security.two_factor_enabled ? 'Enabled' : 'Disabled');
                        $('#require-uppercase').prop('checked', settings.security.password_require_uppercase);
                        $('#require-lowercase').prop('checked', settings.security.password_require_lowercase);
                        $('#require-number').prop('checked', settings.security.password_require_number);
                        $('#require-special').prop('checked', settings.security.password_require_special);
                        $('#min-password-length').val(settings.security.password_min_length);
                        $('#session-timeout').val(settings.security.session_timeout);
                        $('#max-login-attempts').val(settings.security.max_login_attempts);
                        $('#lockout-duration').val(settings.security.lockout_duration);
                        
                        // Email settings
                        $('#smtp-host').val(settings.email.smtp_host);
                        $('#smtp-port').val(settings.email.smtp_port);
                        $('#smtp-username').val(settings.email.smtp_username);
                        $('#smtp-password').val(settings.email.smtp_password);
                        $('#smtp-encryption').val(settings.email.smtp_encryption);
                        $('#from-email').val(settings.email.from_email);
                        $('#from-name').val(settings.email.from_name);
                    }
                },
                error: function(xhr, status, error) {
                    showError('Failed to load settings');
                }
            });
        }

        // Show success notification
        function showSuccess(message) {
            Swal.fire({
                icon: 'success',
                title: 'Success',
                text: message,
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 3000,
                background: 'var(--secondary)',
                color: 'var(--dark)'
            });
        }

        // Show error notification
        function showError(message) {
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: message,
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 3000,
                background: 'var(--secondary)',
                color: 'var(--dark)'
            });
        }

        // Show notification
        function showNotification(title, message, type) {
            const icon = {
                'success': 'check-circle',
                'error': 'exclamation-circle',
                'warning': 'exclamation-triangle',
                'info': 'info-circle'
            }[type] || 'info-circle';
            
            const notification = new Notification(title, {
                body: message,
                icon: 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'
            });
            
            notification.onclick = function() {
                window.focus();
            };
        }

        // Request notification permission
        function requestNotificationPermission() {
            if (Notification.permission !== 'granted') {
                Notification.requestPermission();
            }
        }

        // Initialize notification permission
        requestNotificationPermission();
    </script>
</body>
</html>
