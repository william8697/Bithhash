<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Admin Dashboard | BitHash LLC - Institutional Bitcoin Mining</title>
    <meta name="description" content="BitHash LLC Admin Dashboard for managing institutional-grade Bitcoin mining operations with enterprise security standards.">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rowdies:wght@300;400;700&family=Inter:wght@300;400;500;600;700&family=Manrope:wght@500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" type="image/png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- DataTables -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Select2 -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    
    <!-- Toastr -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <style>
        :root {
            --primary: #00D395;
            --primary-dark: #00B783;
            --primary-light: #00E5A1;
            --secondary: #1E1E1E;
            --secondary-dark: #121212;
            --dark: #E5E5E5;
            --darker: #0A0A0A;
            --light: #121212;
            --lighter: #1E1E1E;
            --gray: #8E8E8E;
            --gray-light: #2E2E2E;
            --gray-lighter: #252525;
            --success: #00D395;
            --warning: #FFB800;
            --error: #FF3D57;
            --gold: #D4AF37;
            --gold-light: #FFD700;
            --gold-dark: #996515;
            --blue: #003366;
            --blue-dark: #002244;
            --blue-light: #004488;
            --purple: #784FED;
            --pink: #EC4899;
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            --gold-gradient: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            --blue-gradient: linear-gradient(135deg, var(--blue) 0%, var(--blue-dark) 100%);
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --box-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            --visa-blue: #1A1F71;
            --visa-gold: #F7B600;
            --security-blue: #1A73E8;
            --security-green: #34A853;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: var(--secondary-dark);
            color: var(--dark);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Admin Layout */
        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .admin-sidebar {
            width: 280px;
            background-color: var(--secondary);
            border-right: 1px solid var(--gray-light);
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            z-index: 1000;
            transition: var(--transition);
        }

        .sidebar-collapsed .admin-sidebar {
            width: 80px;
        }

        .sidebar-collapsed .admin-main {
            margin-left: 80px;
        }

        .admin-brand {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 20px 20px;
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 20px;
        }

        .admin-brand img {
            height: 40px;
            margin-right: 10px;
        }

        .admin-brand h2 {
            font-family: 'Rowdies', sans-serif;
            font-size: 1.5rem;
            color: var(--primary);
            white-space: nowrap;
        }

        .sidebar-collapsed .admin-brand h2 {
            display: none;
        }

        .admin-menu {
            list-style: none;
            padding: 0 15px;
        }

        .admin-menu li {
            margin-bottom: 5px;
        }

        .admin-menu a {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: var(--gray);
            text-decoration: none;
            border-radius: var(--border-radius);
            transition: var(--transition);
            white-space: nowrap;
        }

        .admin-menu a:hover {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        .admin-menu a.active {
            background-color: var(--primary);
            color: var(--secondary-dark);
            font-weight: 600;
        }

        .admin-menu a i {
            margin-right: 10px;
            font-size: 1.1rem;
            width: 24px;
            text-align: center;
        }

        .sidebar-collapsed .admin-menu a span {
            display: none;
        }

        .sidebar-collapsed .admin-menu a i {
            margin-right: 0;
            font-size: 1.3rem;
        }

        .sidebar-collapsed .admin-menu a {
            justify-content: center;
            padding: 15px 0;
        }

        .menu-divider {
            border-top: 1px solid var(--gray-light);
            margin: 15px 0;
        }

        .menu-title {
            padding: 10px 15px;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray);
            font-weight: 600;
        }

        .sidebar-collapsed .menu-title {
            display: none;
        }

        /* Main Content */
        .admin-main {
            flex: 1;
            margin-left: 280px;
            transition: var(--transition);
        }

        /* Top Navigation */
        .admin-topnav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 25px;
            background-color: var(--secondary);
            border-bottom: 1px solid var(--gray-light);
            position: sticky;
            top: 0;
            z-index: 999;
        }

        .nav-left {
            display: flex;
            align-items: center;
        }

        .nav-toggle {
            background: none;
            border: none;
            color: var(--dark);
            font-size: 1.2rem;
            cursor: pointer;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            transition: var(--transition);
        }

        .nav-toggle:hover {
            background-color: var(--gray-light);
        }

        .nav-search {
            position: relative;
        }

        .nav-search input {
            background-color: var(--gray-light);
            border: none;
            padding: 8px 15px 8px 35px;
            border-radius: 20px;
            color: var(--dark);
            width: 250px;
            font-size: 0.9rem;
        }

        .nav-search i {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .nav-right {
            display: flex;
            align-items: center;
        }

        .nav-item {
            margin-left: 15px;
            position: relative;
        }

        .nav-link {
            display: flex;
            align-items: center;
            color: var(--dark);
            text-decoration: none;
            font-size: 0.9rem;
        }

        .nav-link i {
            font-size: 1.2rem;
        }

        .nav-link img {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 8px;
        }

        .nav-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--error);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
            font-weight: bold;
        }

        .dropdown-menu {
            position: absolute;
            right: 0;
            top: 100%;
            background-color: var(--secondary);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            min-width: 200px;
            box-shadow: var(--box-shadow-lg);
            z-index: 1000;
            display: none;
        }

        .dropdown-menu.show {
            display: block;
        }

        .dropdown-item {
            display: block;
            padding: 10px 15px;
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
        }

        .dropdown-item:hover {
            background-color: var(--gray-light);
        }

        .dropdown-divider {
            border-top: 1px solid var(--gray-light);
            margin: 5px 0;
        }

        /* Admin Content */
        .admin-content {
            padding: 25px;
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .content-title h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark);
        }

        .content-title p {
            color: var(--gray);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .content-actions .btn {
            margin-left: 10px;
        }

        /* Cards */
        .card {
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--gray-light);
            margin-bottom: 25px;
            box-shadow: var(--box-shadow);
        }

        .card-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
        }

        .card-tools {
            display: flex;
            align-items: center;
        }

        .card-tools .btn {
            padding: 5px 10px;
            font-size: 0.8rem;
        }

        .card-body {
            padding: 20px;
        }

        .card-footer {
            padding: 15px 20px;
            border-top: 1px solid var(--gray-light);
            background-color: var(--gray-lighter);
            border-bottom-left-radius: var(--border-radius-lg);
            border-bottom-right-radius: var(--border-radius-lg);
        }

        /* Stats Cards */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .stats-card {
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--gray-light);
            padding: 20px;
            display: flex;
            align-items: center;
            transition: var(--transition);
        }

        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow-lg);
        }

        .stats-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.5rem;
        }

        .stats-info {
            flex: 1;
        }

        .stats-title {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .stats-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .stats-change {
            font-size: 0.8rem;
            display: flex;
            align-items: center;
        }

        .stats-change.up {
            color: var(--success);
        }

        .stats-change.down {
            color: var(--error);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 8px 16px;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            text-decoration: none;
        }

        .btn i {
            margin-right: 8px;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.8rem;
        }

        .btn-lg {
            padding: 12px 24px;
            font-size: 1rem;
        }

        .btn-primary {
            background-color: var(--primary);
            color: var(--secondary-dark);
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        .btn-secondary:hover {
            background-color: var(--gray);
        }

        .btn-success {
            background-color: var(--success);
            color: var(--secondary-dark);
        }

        .btn-success:hover {
            background-color: #00b783;
        }

        .btn-danger {
            background-color: var(--error);
            color: white;
        }

        .btn-danger:hover {
            background-color: #e0354d;
        }

        .btn-warning {
            background-color: var(--warning);
            color: var(--secondary-dark);
        }

        .btn-warning:hover {
            background-color: #e6a600;
        }

        .btn-info {
            background-color: var(--blue);
            color: white;
        }

        .btn-info:hover {
            background-color: var(--blue-dark);
        }

        .btn-outline-primary {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline-primary:hover {
            background-color: var(--primary);
            color: var(--secondary-dark);
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 10px 15px;
            background-color: var(--gray-light);
            border: 1px solid var(--gray);
            border-radius: var(--border-radius);
            color: var(--dark);
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 211, 149, 0.2);
        }

        .form-text {
            font-size: 0.8rem;
            color: var(--gray);
            margin-top: 5px;
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%238E8E8E' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 16px 12px;
        }

        .input-group {
            display: flex;
        }

        .input-group .form-control {
            flex: 1;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }

        .input-group .btn {
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
        }

        /* Tables */
        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th, .table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--gray-light);
        }

        .table th {
            background-color: var(--gray-lighter);
            color: var(--dark);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
        }

        .table tr:hover td {
            background-color: var(--gray-light);
        }

        .table .actions {
            white-space: nowrap;
        }

        .table .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge-success {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background-color: rgba(255, 184, 0, 0.1);
            color: var(--warning);
        }

        .badge-danger {
            background-color: rgba(255, 61, 87, 0.1);
            color: var(--error);
        }

        .badge-info {
            background-color: rgba(0, 51, 102, 0.1);
            color: var(--blue);
        }

        .badge-primary {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--primary);
        }

        /* Modals */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1100;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-slow);
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-dialog {
            width: 100%;
            max-width: 600px;
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-lg);
            transform: translateY(-50px);
            transition: var(--transition-slow);
        }

        .modal.show .modal-dialog {
            transform: translateY(0);
        }

        .modal-lg {
            max-width: 900px;
        }

        .modal-sm {
            max-width: 400px;
        }

        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark);
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
        }

        .modal-body {
            padding: 20px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: flex-end;
        }

        .modal-footer .btn {
            margin-left: 10px;
        }

        /* Tabs */
        .nav-tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 20px;
        }

        .nav-tabs .nav-item {
            margin-right: 5px;
        }

        .nav-tabs .nav-link {
            padding: 10px 20px;
            border: 1px solid transparent;
            border-bottom: none;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            color: var(--gray);
            text-decoration: none;
            transition: var(--transition);
        }

        .nav-tabs .nav-link.active {
            background-color: var(--secondary);
            border-color: var(--gray-light) var(--gray-light) var(--secondary);
            color: var(--primary);
            font-weight: 600;
        }

        .nav-tabs .nav-link:hover:not(.active) {
            border-color: var(--gray-light);
            background-color: var(--gray-light);
        }

        .tab-content {
            padding: 20px 0;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        /* Alerts */
        .alert {
            padding: 15px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .alert i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        .alert-success {
            background-color: rgba(0, 211, 149, 0.1);
            border: 1px solid var(--success);
            color: var(--success);
        }

        .alert-danger {
            background-color: rgba(255, 61, 87, 0.1);
            border: 1px solid var(--error);
            color: var(--error);
        }

        .alert-warning {
            background-color: rgba(255, 184, 0, 0.1);
            border: 1px solid var(--warning);
            color: var(--warning);
        }

        .alert-info {
            background-color: rgba(0, 51, 102, 0.1);
            border: 1px solid var(--blue);
            color: var(--blue);
        }

        /* Login Page */
        .login-container {
            display: flex;
            min-height: 100vh;
            background-color: var(--secondary-dark);
        }

        .login-left {
            flex: 1;
            background: url('https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1') center/cover no-repeat;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 50px;
            position: relative;
        }

        .login-left::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
        }

        .login-content {
            position: relative;
            z-index: 1;
            max-width: 600px;
            color: white;
        }

        .login-content h1 {
            font-family: 'Rowdies', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--primary);
        }

        .login-content p {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .login-features {
            list-style: none;
        }

        .login-features li {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .login-features i {
            margin-right: 10px;
            color: var(--primary);
            font-size: 1.2rem;
        }

        .login-right {
            width: 500px;
            background-color: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 50px;
        }

        .login-form {
            width: 100%;
            max-width: 400px;
        }

        .login-logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-logo img {
            height: 50px;
        }

        .login-title {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-title h2 {
            font-size: 1.8rem;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .login-title p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .form-check {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .form-check-input {
            margin-right: 10px;
        }

        .form-check-label {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .login-footer {
            text-align: center;
            margin-top: 30px;
            font-size: 0.9rem;
            color: var(--gray);
        }

        .login-footer a {
            color: var(--primary);
            text-decoration: none;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .admin-sidebar {
                width: 80px;
            }
            .admin-main {
                margin-left: 80px;
            }
            .admin-brand h2, .menu-title, .admin-menu a span {
                display: none;
            }
            .admin-menu a {
                justify-content: center;
                padding: 15px 0;
            }
            .admin-menu a i {
                margin-right: 0;
                font-size: 1.3rem;
            }
        }

        @media (max-width: 992px) {
            .login-container {
                flex-direction: column;
            }
            .login-left {
                display: none;
            }
            .login-right {
                width: 100%;
                padding: 30px;
            }
        }

        @media (max-width: 768px) {
            .stats-cards {
                grid-template-columns: 1fr;
            }
            .nav-search {
                display: none;
            }
        }

        /* DataTables Overrides */
        .dataTables_wrapper .dataTables_length,
        .dataTables_wrapper .dataTables_filter,
        .dataTables_wrapper .dataTables_info,
        .dataTables_wrapper .dataTables_paginate {
            color: var(--gray) !important;
        }

        .dataTables_wrapper .dataTables_filter input {
            background-color: var(--gray-light) !important;
            border: 1px solid var(--gray) !important;
            color: var(--dark) !important;
        }

        .dataTables_wrapper .dataTables_length select {
            background-color: var(--gray-light) !important;
            border: 1px solid var(--gray) !important;
            color: var(--dark) !important;
        }

        .dataTables_wrapper .dataTables_paginate .paginate_button {
            color: var(--gray) !important;
        }

        .dataTables_wrapper .dataTables_paginate .paginate_button.current {
            background: var(--primary) !important;
            color: var(--secondary-dark) !important;
            border: none !important;
        }

        .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
            background: var(--gray-light) !important;
            color: var(--dark) !important;
            border: none !important;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-light);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 211, 149, 0.2);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
        }

        .empty-state i {
            font-size: 3rem;
            color: var(--gray);
            margin-bottom: 20px;
        }

        .empty-state h3 {
            font-size: 1.2rem;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .empty-state p {
            color: var(--gray);
            font-size: 0.9rem;
            max-width: 400px;
            margin: 0 auto 20px;
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: var(--secondary);
            color: var(--dark);
            text-align: center;
            border-radius: var(--border-radius);
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: var(--transition);
            border: 1px solid var(--gray-light);
            box-shadow: var(--box-shadow);
            font-size: 0.8rem;
        }

        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--secondary) transparent transparent transparent;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* Status Indicators */
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .status-active {
            background-color: var(--success);
        }

        .status-inactive {
            background-color: var(--error);
        }

        .status-pending {
            background-color: var(--warning);
        }

        /* Chat Widget */
        .chat-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--gray-light);
            box-shadow: var(--box-shadow-lg);
            z-index: 1050;
            display: none;
        }

        .chat-widget.show {
            display: block;
        }

        .chat-header {
            padding: 15px;
            background-color: var(--primary);
            color: var(--secondary-dark);
            border-top-left-radius: var(--border-radius-lg);
            border-top-right-radius: var(--border-radius-lg);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .chat-header h4 {
            font-weight: 600;
            margin: 0;
        }

        .chat-header .btn {
            padding: 0;
            background: none;
            border: none;
            color: var(--secondary-dark);
            font-size: 1.2rem;
        }

        .chat-body {
            height: 300px;
            overflow-y: auto;
            padding: 15px;
        }

        .chat-message {
            margin-bottom: 15px;
            display: flex;
        }

        .chat-message.user {
            justify-content: flex-end;
        }

        .chat-message.admin {
            justify-content: flex-start;
        }

        .chat-message-content {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            position: relative;
        }

        .chat-message.user .chat-message-content {
            background-color: var(--primary);
            color: var(--secondary-dark);
            border-bottom-right-radius: 0;
        }

        .chat-message.admin .chat-message-content {
            background-color: var(--gray-light);
            color: var(--dark);
            border-bottom-left-radius: 0;
        }

        .chat-message-meta {
            font-size: 0.7rem;
            margin-top: 5px;
            opacity: 0.7;
            display: flex;
            justify-content: space-between;
        }

        .chat-footer {
            padding: 15px;
            border-top: 1px solid var(--gray-light);
        }

        .chat-input {
            display: flex;
        }

        .chat-input input {
            flex: 1;
            padding: 10px 15px;
            background-color: var(--gray-light);
            border: 1px solid var(--gray);
            border-radius: var(--border-radius);
            color: var(--dark);
            font-size: 0.9rem;
        }

        .chat-input button {
            margin-left: 10px;
            background-color: var(--primary);
            color: var(--secondary-dark);
            border: none;
            border-radius: var(--border-radius);
            padding: 0 15px;
            cursor: pointer;
        }

        /* Toggle Switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--gray);
            transition: var(--transition);
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: var(--transition);
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Custom Checkbox */
        .custom-checkbox {
            display: inline-block;
            position: relative;
            padding-left: 30px;
            cursor: pointer;
            user-select: none;
        }

        .custom-checkbox input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .checkmark {
            position: absolute;
            top: 0;
            left: 0;
            height: 20px;
            width: 20px;
            background-color: var(--gray-light);
            border: 1px solid var(--gray);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .custom-checkbox:hover input ~ .checkmark {
            background-color: var(--gray);
        }

        .custom-checkbox input:checked ~ .checkmark {
            background-color: var(--primary);
            border-color: var(--primary);
        }

        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        .custom-checkbox input:checked ~ .checkmark:after {
            display: block;
        }

        .custom-checkbox .checkmark:after {
            left: 7px;
            top: 3px;
            width: 5px;
            height: 10px;
            border: solid var(--secondary-dark);
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }

        /* Custom Radio */
        .custom-radio {
            display: inline-block;
            position: relative;
            padding-left: 30px;
            cursor: pointer;
            user-select: none;
        }

        .custom-radio input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .radiomark {
            position: absolute;
            top: 0;
            left: 0;
            height: 20px;
            width: 20px;
            background-color: var(--gray-light);
            border: 1px solid var(--gray);
            border-radius: 50%;
            transition: var(--transition);
        }

        .custom-radio:hover input ~ .radiomark {
            background-color: var(--gray);
        }

        .custom-radio input:checked ~ .radiomark {
            background-color: var(--primary);
            border-color: var(--primary);
        }

        .radiomark:after {
            content: "";
            position: absolute;
            display: none;
        }

        .custom-radio input:checked ~ .radiomark:after {
            display: block;
        }

        .custom-radio .radiomark:after {
            top: 6px;
            left: 6px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--secondary-dark);
        }

        /* Datepicker */
        .datepicker {
            background-color: var(--secondary);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-lg);
            padding: 10px;
            z-index: 1000;
        }

        .datepicker-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .datepicker-title {
            font-weight: 600;
            color: var(--dark);
        }

        .datepicker-nav {
            display: flex;
            align-items: center;
        }

        .datepicker-nav button {
            background: none;
            border: none;
            color: var(--dark);
            cursor: pointer;
            padding: 5px;
        }

        .datepicker-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .datepicker-weekday {
            text-align: center;
            font-size: 0.8rem;
            color: var(--gray);
            padding: 5px;
        }

        .datepicker-day {
            text-align: center;
            padding: 5px;
            border-radius: var(--border-radius);
            cursor: pointer;
        }

        .datepicker-day:hover {
            background-color: var(--gray-light);
        }

        .datepicker-day.selected {
            background-color: var(--primary);
            color: var(--secondary-dark);
            font-weight: 600;
        }

        .datepicker-day.disabled {
            color: var(--gray);
            cursor: not-allowed;
        }

        /* Timepicker */
        .timepicker {
            background-color: var(--secondary);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-lg);
            padding: 10px;
            z-index: 1000;
        }

        .timepicker-header {
            text-align: center;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark);
        }

        .timepicker-body {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .timepicker-hour, .timepicker-minute, .timepicker-separator {
            font-size: 1.2rem;
            color: var(--dark);
        }

        .timepicker-separator {
            margin: 0 5px;
        }

        .timepicker-footer {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        /* Range Slider */
        .range-slider {
            width: 100%;
            position: relative;
            height: 5px;
            background-color: var(--gray-light);
            border-radius: 5px;
            margin: 15px 0;
        }

        .range-slider .range-selected {
            height: 100%;
            left: 0;
            right: 0;
            position: absolute;
            border-radius: 5px;
            background-color: var(--primary);
        }

        .range-slider .range-input {
            position: relative;
        }

        .range-slider .range-input input {
            position: absolute;
            width: 100%;
            height: 5px;
            top: -5px;
            background: none;
            pointer-events: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }

        .range-slider .range-input input::-webkit-slider-thumb {
            height: 15px;
            width: 15px;
            border-radius: 50%;
            background-color: var(--primary);
            pointer-events: auto;
            -webkit-appearance: none;
        }

        .range-slider .range-input input::-moz-range-thumb {
            height: 15px;
            width: 15px;
            border-radius: 50%;
            background-color: var(--primary);
            pointer-events: auto;
            -moz-appearance: none;
        }

        .range-slider .range-value {
            display: flex;
            justify-content: space-between;
            color: var(--gray);
            font-size: 0.8rem;
        }

        /* File Upload */
        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-upload-input {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-upload-label {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 30px;
            border: 2px dashed var(--gray);
            border-radius: var(--border-radius);
            background-color: var(--gray-light);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .file-upload-label:hover {
            border-color: var(--primary);
        }

        .file-upload-label i {
            font-size: 2rem;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .file-upload-label p {
            margin: 0;
            color: var(--gray);
        }

        .file-upload-label.has-file {
            border-color: var(--success);
            background-color: rgba(0, 211, 149, 0.1);
        }

        .file-upload-label.has-file i {
            color: var(--success);
        }

        .file-upload-label.has-file p {
            color: var(--success);
        }

        .file-upload-preview {
            margin-top: 15px;
            display: flex;
            align-items: center;
            padding: 10px;
            background-color: var(--gray-light);
            border-radius: var(--border-radius);
        }

        .file-upload-preview img {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: var(--border-radius);
            margin-right: 15px;
        }

        .file-upload-info {
            flex: 1;
        }

        .file-upload-info h6 {
            margin: 0;
            color: var(--dark);
            font-size: 0.9rem;
        }

        .file-upload-info p {
            margin: 5px 0 0;
            color: var(--gray);
            font-size: 0.8rem;
        }

        .file-upload-remove {
            background: none;
            border: none;
            color: var(--error);
            cursor: pointer;
            font-size: 1.2rem;
        }

        /* Color Picker */
        .color-picker {
            display: flex;
            align-items: center;
        }

        .color-picker-input {
            width: 30px;
            height: 30px;
            border: 1px solid var(--gray);
            border-radius: var(--border-radius);
            margin-right: 10px;
            cursor: pointer;
        }

        .color-picker-value {
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Progress Bar */
        .progress {
            height: 10px;
            background-color: var(--gray-light);
            border-radius: 5px;
            margin-bottom: 15px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--primary);
            border-radius: 5px;
            transition: width 0.3s ease;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--gray);
        }

        /* Avatar */
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .avatar-sm {
            width: 30px;
            height: 30px;
        }

        .avatar-lg {
            width: 60px;
            height: 60px;
        }

        .avatar-xl {
            width: 80px;
            height: 80px;
        }

        /* Badge */
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge-primary {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--primary);
        }

        .badge-secondary {
            background-color: rgba(142, 142, 142, 0.1);
            color: var(--gray);
        }

        .badge-success {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--success);
        }

        .badge-danger {
            background-color: rgba(255, 61, 87, 0.1);
            color: var(--error);
        }

        .badge-warning {
            background-color: rgba(255, 184, 0, 0.1);
            color: var(--warning);
        }

        .badge-info {
            background-color: rgba(0, 51, 102, 0.1);
            color: var(--blue);
        }

        /* Pagination */
        .pagination {
            display: flex;
            list-style: none;
            padding: 0;
            margin: 20px 0 0;
        }

        .page-item {
            margin-right: 5px;
        }

        .page-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: var(--border-radius);
            background-color: var(--gray-light);
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
        }

        .page-link:hover {
            background-color: var(--gray);
        }

        .page-item.active .page-link {
            background-color: var(--primary);
            color: var(--secondary-dark);
            font-weight: 600;
        }

        .page-item.disabled .page-link {
            background-color: var(--gray-light);
            color: var(--gray);
            cursor: not-allowed;
        }

        /* Breadcrumb */
        .breadcrumb {
            display: flex;
            list-style: none;
            padding: 0;
            margin: 0 0 20px;
        }

        .breadcrumb-item {
            display: flex;
            align-items: center;
        }

        .breadcrumb-item a {
            color: var(--primary);
            text-decoration: none;
            font-size: 0.9rem;
        }

        .breadcrumb-item.active {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .breadcrumb-item + .breadcrumb-item::before {
            content: "/";
            padding: 0 10px;
            color: var(--gray);
        }

        /* Accordion */
        .accordion {
            list-style: none;
            padding: 0;
        }

        .accordion-item {
            margin-bottom: 10px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        .accordion-header {
            padding: 15px 20px;
            background-color: var(--gray-light);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .accordion-header h5 {
            margin: 0;
            font-size: 1rem;
            color: var(--dark);
        }

        .accordion-header i {
            transition: var(--transition);
        }

        .accordion-header.collapsed i {
            transform: rotate(180deg);
        }

        .accordion-body {
            padding: 15px 20px;
            background-color: var(--secondary);
            border-top: 1px solid var(--gray-light);
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 30px;
            list-style: none;
        }

        .timeline::before {
            content: "";
            position: absolute;
            top: 0;
            bottom: 0;
            left: 10px;
            width: 2px;
            background-color: var(--gray-light);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 20px;
        }

        .timeline-item::before {
            content: "";
            position: absolute;
            left: -30px;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--primary);
            border: 2px solid var(--secondary);
        }

        .timeline-time {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .timeline-content {
            padding: 10px 15px;
            background-color: var(--gray-light);
            border-radius: var(--border-radius);
        }

        .timeline-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .timeline-text {
            font-size: 0.8rem;
            color: var(--gray);
        }

        /* Steps */
        .steps {
            display: flex;
            justify-content: space-between;
            list-style: none;
            padding: 0;
            margin: 0 0 20px;
        }

        .step {
            flex: 1;
            position: relative;
            text-align: center;
        }

        .step::before {
            content: "";
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--gray-light);
            z-index: 1;
        }

        .step:first-child::before {
            left: 50%;
        }

        .step:last-child::before {
            right: 50%;
        }

        .step.completed::before {
            background-color: var(--primary);
        }

        .step-icon {
            position: relative;
            z-index: 2;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--gray-light);
            color: var(--gray);
            margin-bottom: 5px;
        }

        .step.completed .step-icon {
            background-color: var(--primary);
            color: var(--secondary-dark);
        }

        .step.active .step-icon {
            background-color: var(--primary);
            color: var(--secondary-dark);
            box-shadow: 0 0 0 4px rgba(0, 211, 149, 0.2);
        }

        .step-title {
            font-size: 0.8rem;
            color: var(--gray);
        }

        .step.active .step-title {
            color: var(--dark);
            font-weight: 600;
        }

        /* Wizard */
        .wizard {
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--gray-light);
            overflow: hidden;
        }

        .wizard-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--gray-light);
        }

        .wizard-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark);
            margin: 0;
        }

        .wizard-body {
            padding: 20px;
        }

        .wizard-footer {
            padding: 15px 20px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 350px;
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            border: 1px solid var(--gray-light);
            box-shadow: var(--box-shadow-lg);
            z-index: 1100;
            display: flex;
            overflow: hidden;
            transform: translateX(100%);
            transition: var(--transition);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification-icon {
            width: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .notification-success .notification-icon {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--success);
        }

        .notification-error .notification-icon {
            background-color: rgba(255, 61, 87, 0.1);
            color: var(--error);
        }

        .notification-warning .notification-icon {
            background-color: rgba(255, 184, 0, 0.1);
            color: var(--warning);
        }

        .notification-info .notification-icon {
            background-color: rgba(0, 51, 102, 0.1);
            color: var(--blue);
        }

        .notification-body {
            flex: 1;
            padding: 15px;
        }

        .notification-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .notification-text {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .notification-close {
            padding: 10px;
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
        }

        /* Print Styles */
        @media print {
            .admin-sidebar, .admin-topnav, .content-actions, .card-tools {
                display: none !important;
            }
            .admin-main {
                margin-left: 0 !important;
            }
            .card {
                border: none !important;
                box-shadow: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="login-page" class="login-container">
        <div class="login-left">
            <div class="login-content">
                <h1>BitHash LLC</h1>
                <p>Enterprise-grade Bitcoin mining platform with institutional security standards and unmatched performance.</p>
                <ul class="login-features">
                    <li><i class="fas fa-shield-alt"></i> Military-grade security protocols</li>
                    <li><i class="fas fa-server"></i> 99.99% uptime guarantee</li>
                    <li><i class="fas fa-chart-line"></i> Real-time performance analytics</li>
                    <li><i class="fas fa-users-cog"></i> Advanced user management</li>
                </ul>
            </div>
        </div>
        <div class="login-right">
            <div class="login-form">
                <div class="login-logo">
                    <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash LLC">
                </div>
                <div class="login-title">
                    <h2>Admin Portal</h2>
                    <p>Sign in to access the management dashboard</p>
                </div>
                <form id="login-form">
                    <div class="form-group">
                        <label for="email" class="form-label">Email Address</label>
                        <input type="email" id="email" class="form-control" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="password" class="form-label">Password</label>
                        <input type="password" id="password" class="form-control" placeholder="Enter your password" required>
                    </div>
                    <div class="form-group">
                        <div class="form-check">
                            <input type="checkbox" id="remember" class="form-check-input">
                            <label for="remember" class="form-check-label">Remember me</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-lg w-100">Sign In</button>
                    </div>
                </form>
                <div class="login-footer">
                    <a href="#" id="forgot-password">Forgot password?</a>
                </div>
            </div>
        </div>
    </div>

    <!-- 2FA Verification Modal -->
    <div id="twofa-modal" class="modal">
        <div class="modal-dialog modal-sm">
            <div class="modal-header">
                <h3 class="modal-title">Two-Factor Authentication</h3>
                <button type="button" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p>Enter the 6-digit code from your authenticator app</p>
                <form id="twofa-form">
                    <div class="form-group">
                        <label for="twofa-code" class="form-label">Verification Code</label>
                        <input type="text" id="twofa-code" class="form-control" placeholder="123456" maxlength="6" required>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary w-100">Verify</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="admin-dashboard" class="admin-container" style="display: none;">
        <!-- Sidebar -->
        <div class="admin-sidebar">
            <div class="admin-brand">
                <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash LLC">
                <h2>BitHash LLC</h2>
            </div>
            <ul class="admin-menu">
                <li class="menu-title">Main</li>
                <li><a href="#" class="active" data-section="dashboard"><i class="fas fa-tachometer-alt"></i> <span>Dashboard</span></a></li>
                <li><a href="#" data-section="users"><i class="fas fa-users"></i> <span>Users</span></a></li>
                <li><a href="#" data-section="investments"><i class="fas fa-chart-line"></i> <span>Investments</span></a></li>
                <li><a href="#" data-section="transactions"><i class="fas fa-exchange-alt"></i> <span>Transactions</span></a></li>
                <li><a href="#" data-section="withdrawals"><i class="fas fa-money-bill-wave"></i> <span>Withdrawals</span></a></li>
                
                <li class="menu-divider"></li>
                <li class="menu-title">Management</li>
                <li><a href="#" data-section="plans"><i class="fas fa-boxes"></i> <span>Investment Plans</span></a></li>
                <li><a href="#" data-section="promotions"><i class="fas fa-bullhorn"></i> <span>Promotions</span></a></li>
                <li><a href="#" data-section="support"><i class="fas fa-headset"></i> <span>Support Tickets</span></a></li>
                <li><a href="#" data-section="notifications"><i class="fas fa-bell"></i> <span>Notifications</span></a></li>
                
                <li class="menu-divider"></li>
                <li class="menu-title">System</li>
                <li><a href="#" data-section="settings"><i class="fas fa-cog"></i> <span>Settings</span></a></li>
                <li><a href="#" data-section="security"><i class="fas fa-shield-alt"></i> <span>Security</span></a></li>
                <li><a href="#" data-section="logs"><i class="fas fa-clipboard-list"></i> <span>Activity Logs</span></a></li>
                <li><a href="#" id="logout-btn"><i class="fas fa-sign-out-alt"></i> <span>Logout</span></a></li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="admin-main">
            <!-- Top Navigation -->
            <div class="admin-topnav">
                <div class="nav-left">
                    <button class="nav-toggle" id="sidebar-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="nav-search">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                </div>
                <div class="nav-right">
                    <div class="nav-item">
                        <a href="#" class="nav-link" id="notifications-btn">
                            <i class="fas fa-bell"></i>
                            <span class="nav-badge">3</span>
                        </a>
                        <div class="dropdown-menu" id="notifications-dropdown">
                            <div class="dropdown-header">Notifications (3)</div>
                            <a href="#" class="dropdown-item">
                                <div class="notification-item">
                                    <div class="notification-icon">
                                        <i class="fas fa-exclamation-circle text-danger"></i>
                                    </div>
                                    <div class="notification-content">
                                        <div class="notification-title">Withdrawal Request</div>
                                        <div class="notification-text">New withdrawal request from user #4587</div>
                                        <div class="notification-time">2 min ago</div>
                                    </div>
                                </div>
                            </a>
                            <a href="#" class="dropdown-item">
                                <div class="notification-item">
                                    <div class="notification-icon">
                                        <i class="fas fa-check-circle text-success"></i>
                                    </div>
                                    <div class="notification-content">
                                        <div class="notification-title">New Investment</div>
                                        <div class="notification-text">User #8921 invested in Gold Plan</div>
                                        <div class="notification-time">15 min ago</div>
                                    </div>
                                </div>
                            </a>
                            <a href="#" class="dropdown-item">
                                <div class="notification-item">
                                    <div class="notification-icon">
                                        <i class="fas fa-ticket-alt text-warning"></i>
                                    </div>
                                    <div class="notification-content">
                                        <div class="notification-title">New Support Ticket</div>
                                        <div class="notification-text">Ticket #4567 opened by user #3245</div>
                                        <div class="notification-time">1 hour ago</div>
                                    </div>
                                </div>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item">View All Notifications</a>
                        </div>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" id="messages-btn">
                            <i class="fas fa-envelope"></i>
                            <span class="nav-badge">5</span>
                        </a>
                        <div class="dropdown-menu" id="messages-dropdown">
                            <div class="dropdown-header">Messages (5)</div>
                            <a href="#" class="dropdown-item">
                                <div class="message-item">
                                    <img src="https://via.placeholder.com/40" alt="User" class="avatar-sm">
                                    <div class="message-content">
                                        <div class="message-title">John Doe</div>
                                        <div class="message-text">Hello, I have a question about my investment</div>
                                        <div class="message-time">10 min ago</div>
                                    </div>
                                </div>
                            </a>
                            <a href="#" class="dropdown-item">
                                <div class="message-item">
                                    <img src="https://via.placeholder.com/40" alt="User" class="avatar-sm">
                                    <div class="message-content">
                                        <div class="message-title">Sarah Smith</div>
                                        <div class="message-text">My withdrawal is pending for 2 days</div>
                                        <div class="message-time">1 hour ago</div>
                                    </div>
                                </div>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item">View All Messages</a>
                        </div>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" id="profile-btn">
                            <img src="https://via.placeholder.com/32" alt="Admin" class="avatar-sm">
                            <span id="admin-name">Admin</span>
                        </a>
                        <div class="dropdown-menu" id="profile-dropdown">
                            <div class="dropdown-header">
                                <div class="profile-info">
                                    <img src="https://via.placeholder.com/80" alt="Admin" class="avatar">
                                    <div class="profile-details">
                                        <div class="profile-name" id="admin-fullname">Administrator</div>
                                        <div class="profile-email" id="admin-email">admin@bithash.com</div>
                                    </div>
                                </div>
                            </div>
                            <a href="#" class="dropdown-item"><i class="fas fa-user"></i> Profile</a>
                            <a href="#" class="dropdown-item"><i class="fas fa-cog"></i> Settings</a>
                            <a href="#" class="dropdown-item"><i class="fas fa-shield-alt"></i> Security</a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item" id="dropdown-logout"><i class="fas fa-sign-out-alt"></i> Logout</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Content -->
            <div class="admin-content" id="dashboard-section">
                <div class="content-header">
                    <div class="content-title">
                        <h1>Dashboard</h1>
                        <p>Welcome back, <span id="dashboard-admin-name">Admin</span>. Here's what's happening with your platform today.</p>
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-secondary"><i class="fas fa-download"></i> Export</button>
                        <button class="btn btn-primary"><i class="fas fa-sync-alt"></i> Refresh</button>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="stats-cards">
                    <div class="stats-card">
                        <div class="stats-icon" style="background-color: rgba(0, 211, 149, 0.1); color: var(--success);">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stats-info">
                            <div class="stats-title">Total Users</div>
                            <div class="stats-value" id="total-users">0</div>
                            <div class="stats-change up"><i class="fas fa-arrow-up"></i> 12% from yesterday</div>
                        </div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-icon" style="background-color: rgba(0, 51, 102, 0.1); color: var(--blue);">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stats-info">
                            <div class="stats-title">Active Investments</div>
                            <div class="stats-value" id="active-investments">0</div>
                            <div class="stats-change up"><i class="fas fa-arrow-up"></i> 5% from yesterday</div>
                        </div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-icon" style="background-color: rgba(255, 184, 0, 0.1); color: var(--warning);">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="stats-info">
                            <div class="stats-title">Daily Volume</div>
                            <div class="stats-value" id="daily-volume">$0</div>
                            <div class="stats-change down"><i class="fas fa-arrow-down"></i> 3% from yesterday</div>
                        </div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-icon" style="background-color: rgba(255, 61, 87, 0.1); color: var(--error);">
                            <i class="fas fa-exclamation-circle"></i>
                        </div>
                        <div class="stats-info">
                            <div class="stats-title">Pending Withdrawals</div>
                            <div class="stats-value" id="pending-withdrawals">0</div>
                            <div class="stats-change up"><i class="fas fa-arrow-up"></i> 8% from yesterday</div>
                        </div>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Platform Growth</div>
                                <div class="card-tools">
                                    <select class="form-control form-control-sm" id="growth-period">
                                        <option value="7">Last 7 Days</option>
                                        <option value="30">Last 30 Days</option>
                                        <option value="90">Last 90 Days</option>
                                        <option value="365">Last Year</option>
                                    </select>
                                </div>
                            </div>
                            <div class="card-body">
                                <canvas id="growth-chart" height="250"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Investment Distribution</div>
                            </div>
                            <div class="card-body">
                                <canvas id="investment-chart" height="250"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Recent Activity</div>
                        <div class="card-tools">
                            <button class="btn btn-sm btn-secondary">View All</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="activity-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Activity</th>
                                        <th>IP Address</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Activity data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Users Section -->
            <div class="admin-content" id="users-section" style="display: none;">
                <div class="content-header">
                    <div class="content-title">
                        <h1>User Management</h1>
                        <p>Manage all registered users, view details, edit balances, and suspend accounts.</p>
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-secondary"><i class="fas fa-download"></i> Export</button>
                        <button class="btn btn-primary" id="add-user-btn"><i class="fas fa-plus"></i> Add User</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">All Users</div>
                        <div class="card-tools">
                            <div class="input-group" style="width: 250px;">
                                <input type="text" id="user-search" class="form-control" placeholder="Search users...">
                                <button class="btn btn-secondary"><i class="fas fa-search"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="users-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Email</th>
                                        <th>Balance</th>
                                        <th>Status</th>
                                        <th>Joined</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Users data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="card-footer">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="dataTables_info" id="users-table_info">Showing 0 to 0 of 0 entries</div>
                            </div>
                            <div class="col-md-6">
                                <div class="dataTables_paginate paging_simple_numbers">
                                    <ul class="pagination">
                                        <li class="paginate_button previous disabled"><a href="#">Previous</a></li>
                                        <li class="paginate_button active"><a href="#">1</a></li>
                                        <li class="paginate_button next disabled"><a href="#">Next</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Investments Section -->
            <div class="admin-content" id="investments-section" style="display: none;">
                <div class="content-header">
                    <div class="content-title">
                        <h1>Investment Management</h1>
                        <p>View and manage all active investments on the platform.</p>
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-secondary"><i class="fas fa-download"></i> Export</button>
                        <button class="btn btn-primary"><i class="fas fa-filter"></i> Filter</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Active Investments</div>
                        <div class="card-tools">
                            <div class="input-group" style="width: 250px;">
                                <input type="text" id="investment-search" class="form-control" placeholder="Search investments...">
                                <button class="btn btn-secondary"><i class="fas fa-search"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="investments-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Plan</th>
                                        <th>Amount</th>
                                        <th>Daily Profit</th>
                                        <th>Start Date</th>
                                        <th>End Date</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Investments data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Transactions Section -->
            <div class="admin-content" id="transactions-section" style="display: none;">
                <div class="content-header">
                    <div class="content-title">
                        <h1>Transaction History</h1>
                        <p>View all deposit and withdrawal transactions on the platform.</p>
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-secondary"><i class="fas fa-download"></i> Export</button>
                        <button class="btn btn-primary"><i class="fas fa-filter"></i> Filter</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">All Transactions</div>
                        <div class="card-tools">
                            <ul class="nav nav-tabs">
                                <li class="nav-item"><a class="nav-link active" href="#" data-type="all">All</a></li>
                                <li class="nav-item"><a class="nav-link" href="#" data-type="deposits">Deposits</a></li>
                                <li class="nav-item"><a class="nav-link" href="#" data-type="withdrawals">Withdrawals</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="transactions-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Type</th>
                                        <th>Amount</th>
                                        <th>Method</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Transactions data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Withdrawals Section -->
            <div class="admin-content" id="withdrawals-section" style="display: none;">
                <div class="content-header">
                    <div class="content-title">
                        <h1>Withdrawal Requests</h1>
                        <p>Review and process pending withdrawal requests from users.</p>
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-secondary"><i class="fas fa-download"></i> Export</button>
                        <button class="btn btn-primary"><i class="fas fa-filter"></i> Filter</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Pending Withdrawals</div>
                        <div class="card-tools">
                            <ul class="nav nav-tabs">
                                <li class="nav-item"><a class="nav-link active" href="#" data-status="pending">Pending</a></li>
                                <li class="nav-item"><a class="nav-link" href="#" data-status="approved">Approved</a></li>
                                <li class="nav-item"><a class="nav-link" href="#" data-status="rejected">Rejected</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="withdrawals-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Amount</th>
                                        <th>Method</th>
                                        <th>Wallet/Account</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Withdrawals data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Plans Section -->
            <div class="admin-content" id="plans-section" style="display: none;">
                <div class="content-header">
                    <div class="content-title">
                        <h1>Investment Plans</h1>
                        <p>Create and manage investment plans available to users.</p>
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-primary" id="add-plan-btn"><i class="fas fa-plus"></i> Add Plan</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">All Plans</div>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <!-- Plans will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Promotions Section -->
            <div class="admin-content" id="promotions-section" style="display: none;">
                <div class="content-header">
                    <div class="content-title">
                        <h1>Promotions & Notifications</h1>
                        <p>Create and send promotional offers and notifications to users.</p>
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-primary" id="add-promotion-btn"><i class="fas fa-plus"></i> Create Promotion</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Active Promotions</div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="promotions-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Title</th>
                                        <th>Type</th>
                                        <th>Start Date</th>
                                        <th>End Date</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Promotions data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Support Section -->
            <div class="admin-content" id="support-section" style="display: none;">
                <div class="content-header">
                    <div class="content-title">
                        <h1>Support Tickets</h1>
                        <p>Manage and respond to user support tickets.</p>
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-secondary"><i class="fas fa-download"></i> Export</button>
                        <button class="btn btn-primary"><i class="fas fa-filter"></i> Filter</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Open Tickets</div>
                        <div class="card-tools">
                            <ul class="nav nav-tabs">
                                <li class="nav-item"><a class="nav-link active" href="#" data-status="open">Open</a></li>
                                <li class="nav-item"><a class="nav-link" href="#" data-status="pending">Pending</a></li>
                                <li class="nav-item"><a class="nav-link" href="#" data-status="resolved">Resolved</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="tickets-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Subject</th>
                                        <th>Category</th>
                                        <th>Priority</th>
                                        <th>Last Updated</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Tickets data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notifications Section -->
            <div class="admin-content" id="notifications-section" style="display: none;">
                <div class="content-header">
                    <div class="content-title">
                        <h1>System Notifications</h1>
                        <p>Send system-wide notifications to users.</p>
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-primary" id="send-notification-btn"><i class="fas fa-paper-plane"></i> Send Notification</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Recent Notifications</div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="notifications-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Title</th>
                                        <th>Message</th>
                                        <th>Sent To</th>
                                        <th>Date Sent</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Notifications data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div class="admin-content" id="settings-section" style="display: none;">
                <div class="content-header">
                    <div class="content-title">
                        <h1>System Settings</h1>
                        <p>Configure platform settings and preferences.</p>
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-primary" id="save-settings-btn"><i class="fas fa-save"></i> Save Changes</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">General Settings</div>
                    </div>
                    <div class="card-body">
                        <form id="settings-form">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="site-name" class="form-label">Site Name</label>
                                        <input type="text" id="site-name" class="form-control" value="BitHash LLC">
                                    </div>
                                    <div class="form-group">
                                        <label for="site-url" class="form-label">Site URL</label>
                                        <input type="url" id="site-url" class="form-control" value="https://bithash.com">
                                    </div>
                                    <div class="form-group">
                                        <label for="site-email" class="form-label">Contact Email</label>
                                        <input type="email" id="site-email" class="form-control" value="support@bithash.com">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="site-currency" class="form-label">Default Currency</label>
                                        <select id="site-currency" class="form-control">
                                            <option value="USD">US Dollar (USD)</option>
                                            <option value="EUR">Euro (EUR)</option>
                                            <option value="GBP">British Pound (GBP)</option>
                                            <option value="BTC">Bitcoin (BTC)</option>
                                            <option value="ETH">Ethereum (ETH)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="site-timezone" class="form-label">Timezone</label>
                                        <select id="site-timezone" class="form-control">
                                            <option value="UTC">UTC</option>
                                            <option value="America/New_York">Eastern Time (ET)</option>
                                            <option value="America/Chicago">Central Time (CT)</option>
                                            <option value="America/Los_Angeles">Pacific Time (PT)</option>
                                            <option value="Europe/London">London (GMT)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="site-logo" class="form-label">Site Logo</label>
                                        <div class="file-upload">
                                            <input type="file" id="site-logo" class="file-upload-input" accept="image/*">
                                            <label for="site-logo" class="file-upload-label">
                                                <i class="fas fa-cloud-upload-alt"></i>
                                                <p>Click to upload or drag and drop</p>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Payment Settings</div>
                    </div>
                    <div class="card-body">
                        <form id="payment-settings-form">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="form-label">Payment Methods</label>
                                        <div class="form-check">
                                            <input type="checkbox" id="pm-crypto" class="form-check-input" checked>
                                            <label for="pm-crypto" class="form-check-label">Cryptocurrency</label>
                                        </div>
                                        <div class="form-check">
                                            <input type="checkbox" id="pm-bank" class="form-check-input" checked>
                                            <label for="pm-bank" class="form-check-label">Bank Transfer</label>
                                        </div>
                                        <div class="form-check">
                                            <input type="checkbox" id="pm-card" class="form-check-input">
                                            <label for="pm-card" class="form-check-label">Credit/Debit Card</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="min-deposit" class="form-label">Minimum Deposit</label>
                                        <input type="number" id="min-deposit" class="form-control" value="10">
                                    </div>
                                    <div class="form-group">
                                        <label for="min-withdrawal" class="form-label">Minimum Withdrawal</label>
                                        <input type="number" id="min-withdrawal" class="form-control" value="20">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="withdrawal-fee" class="form-label">Withdrawal Fee (%)</label>
                                        <input type="number" id="withdrawal-fee" class="form-control" value="1.5">
                                    </div>
                                    <div class="form-group">
                                        <label for="btc-wallet" class="form-label">BTC Wallet Address</label>
                                        <input type="text" id="btc-wallet" class="form-control" value="3FZbgi29cpjq2GjdwV8eyHuJJnkLtktZc5">
                                    </div>
                                    <div class="form-group">
                                        <label for="eth-wallet" class="form-label">ETH Wallet Address</label>
                                        <input type="text" id="eth-wallet" class="form-control" value="0x71C7656EC7ab88b098defB751B7401B5f6d8976F">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Security Section -->
            <div class="admin-content" id="security-section" style="display: none;">
                <div class="content-header">
                    <div class="content-title">
                        <h1>Security Settings</h1>
                        <p>Configure platform security and authentication settings.</p>
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-primary" id="save-security-btn"><i class="fas fa-save"></i> Save Changes</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Authentication</div>
                    </div>
                    <div class="card-body">
                        <form id="security-form">
                            <div class="form-group">
                                <label class="form-label">Two-Factor Authentication</label>
                                <div class="form-check form-switch">
                                    <input type="checkbox" id="enable-2fa" class="form-check-input" checked>
                                    <label for="enable-2fa" class="form-check-label">Enable 2FA for admin accounts</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Login Security</label>
                                <div class="form-check">
                                    <input type="checkbox" id="enable-login-alerts" class="form-check-input" checked>
                                    <label for="enable-login-alerts" class="form-check-label">Enable login alerts</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" id="enable-ip-restriction" class="form-check-input">
                                    <label for="enable-ip-restriction" class="form-check-label">Restrict admin access by IP</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="session-timeout" class="form-label">Session Timeout (minutes)</label>
                                <input type="number" id="session-timeout" class="form-control" value="30">
                            </div>
                            <div class="form-group">
                                <label for="failed-login-attempts" class="form-label">Failed Login Attempts Before Lockout</label>
                                <input type="number" id="failed-login-attempts" class="form-control" value="5">
                            </div>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Admin Sessions</div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="sessions-table">
                                <thead>
                                    <tr>
                                        <th>IP Address</th>
                                        <th>Device</th>
                                        <th>Browser</th>
                                        <th>Location</th>
                                        <th>Last Activity</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>192.168.1.1</td>
                                        <td>Windows 10</td>
                                        <td>Chrome 98</td>
                                        <td>New York, US</td>
                                        <td>2 minutes ago</td>
                                        <td><button class="btn btn-sm btn-danger">Terminate</button></td>
                                    </tr>
                                    <tr>
                                        <td>172.56.23.45</td>
                                        <td>Mac OS X</td>
                                        <td>Safari 15</td>
                                        <td>London, UK</td>
                                        <td>1 hour ago</td>
                                        <td><button class="btn btn-sm btn-danger">Terminate</button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Logs Section -->
            <div class="admin-content" id="logs-section" style="display: none;">
                <div class="content-header">
                    <div class="content-title">
                        <h1>Activity Logs</h1>
                        <p>View all system and admin activity logs.</p>
                    </div>
                    <div class="content-actions">
                        <button class="btn btn-secondary"><i class="fas fa-download"></i> Export</button>
                        <button class="btn btn-primary"><i class="fas fa-filter"></i> Filter</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Recent Activity</div>
                        <div class="card-tools">
                            <ul class="nav nav-tabs">
                                <li class="nav-item"><a class="nav-link active" href="#" data-type="all">All</a></li>
                                <li class="nav-item"><a class="nav-link" href="#" data-type="admin">Admin</a></li>
                                <li class="nav-item"><a class="nav-link" href="#" data-type="system">System</a></li>
                                <li class="nav-item"><a class="nav-link" href="#" data-type="user">User</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="logs-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Type</th>
                                        <th>Action</th>
                                        <th>User</th>
                                        <th>IP Address</th>
                                        <th>Date</th>
                                        <th>Details</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Logs data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div id="add-user-modal" class="modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title">Add New User</h3>
                <button type="button" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-user-form">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="new-first-name" class="form-label">First Name</label>
                                <input type="text" id="new-first-name" class="form-control" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="new-last-name" class="form-label">Last Name</label>
                                <input type="text" id="new-last-name" class="form-control" required>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="new-email" class="form-label">Email Address</label>
                        <input type="email" id="new-email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="new-password" class="form-label">Password</label>
                        <input type="password" id="new-password" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="new-phone" class="form-label">Phone Number</label>
                        <input type="tel" id="new-phone" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="new-country" class="form-label">Country</label>
                        <select id="new-country" class="form-control">
                            <option value="">Select Country</option>
                            <option value="US">United States</option>
                            <option value="UK">United Kingdom</option>
                            <option value="CA">Canada</option>
                            <!-- More countries will be added -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="new-balance" class="form-label">Initial Balance (USD)</label>
                        <input type="number" id="new-balance" class="form-control" value="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <div class="form-check">
                            <input type="radio" id="new-status-active" name="new-status" class="form-check-input" value="active" checked>
                            <label for="new-status-active" class="form-check-label">Active</label>
                        </div>
                        <div class="form-check">
                            <input type="radio" id="new-status-suspended" name="new-status" class="form-check-input" value="suspended">
                            <label for="new-status-suspended" class="form-check-label">Suspended</label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="save-new-user">Save User</button>
            </div>
        </div>
    </div>

    <!-- Edit User Modal -->
    <div id="edit-user-modal" class="modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title">Edit User</h3>
                <button type="button" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-user-form">
                    <input type="hidden" id="edit-user-id">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="edit-first-name" class="form-label">First Name</label>
                                <input type="text" id="edit-first-name" class="form-control" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="edit-last-name" class="form-label">Last Name</label>
                                <input type="text" id="edit-last-name" class="form-control" required>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="edit-email" class="form-label">Email Address</label>
                        <input type="email" id="edit-email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-phone" class="form-label">Phone Number</label>
                        <input type="tel" id="edit-phone" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="edit-country" class="form-label">Country</label>
                        <select id="edit-country" class="form-control">
                            <option value="">Select Country</option>
                            <option value="US">United States</option>
                            <option value="UK">United Kingdom</option>
                            <option value="CA">Canada</option>
                            <!-- More countries will be added -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="edit-balance" class="form-label">Balance (USD)</label>
                        <input type="number" id="edit-balance" class="form-control" value="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <div class="form-check">
                            <input type="radio" id="edit-status-active" name="edit-status" class="form-check-input" value="active" checked>
                            <label for="edit-status-active" class="form-check-label">Active</label>
                        </div>
                        <div class="form-check">
                            <input type="radio" id="edit-status-suspended" name="edit-status" class="form-check-input" value="suspended">
                            <label for="edit-status-suspended" class="form-check-label">Suspended</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Two-Factor Authentication</label>
                        <div class="form-check">
                            <input type="radio" id="edit-2fa-enabled" name="edit-2fa" class="form-check-input" value="enabled">
                            <label for="edit-2fa-enabled" class="form-check-label">Enabled</label>
                        </div>
                        <div class="form-check">
                            <input type="radio" id="edit-2fa-disabled" name="edit-2fa" class="form-check-input" value="disabled" checked>
                            <label for="edit-2fa-disabled" class="form-check-label">Disabled</label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="save-user-changes">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Add Plan Modal -->
    <div id="add-plan-modal" class="modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title">Add New Investment Plan</h3>
                <button type="button" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-plan-form">
                    <div class="form-group">
                        <label for="plan-name" class="form-label">Plan Name</label>
                        <input type="text" id="plan-name" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="plan-description" class="form-label">Description</label>
                        <textarea id="plan-description" class="form-control" rows="3"></textarea>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="plan-min-amount" class="form-label">Minimum Amount (USD)</label>
                                <input type="number" id="plan-min-amount" class="form-control" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="plan-max-amount" class="form-label">Maximum Amount (USD)</label>
                                <input type="number" id="plan-max-amount" class="form-control">
                                <small class="form-text">Leave empty for no maximum</small>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="plan-duration" class="form-label">Duration (Days)</label>
                                <input type="number" id="plan-duration" class="form-control" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="plan-profit" class="form-label">Daily Profit (%)</label>
                                <input type="number" id="plan-profit" class="form-control" step="0.01" required>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Features</label>
                        <div class="form-check">
                            <input type="checkbox" id="plan-feature-1" class="form-check-input">
                            <label for="plan-feature-1" class="form-check-label">24/7 Support</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" id="plan-feature-2" class="form-check-input">
                            <label for="plan-feature-2" class="form-check-label">Capital Return</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" id="plan-feature-3" class="form-check-input">
                            <label for="plan-feature-3" class="form-check-label">Instant Withdrawal</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <div class="form-check">
                            <input type="radio" id="plan-status-active" name="plan-status" class="form-check-input" value="active" checked>
                            <label for="plan-status-active" class="form-check-label">Active</label>
                        </div>
                        <div class="form-check">
                            <input type="radio" id="plan-status-inactive" name="plan-status" class="form-check-input" value="inactive">
                            <label for="plan-status-inactive" class="form-check-label">Inactive</label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="save-new-plan">Save Plan</button>
            </div>
        </div>
    </div>

    <!-- Send Notification Modal -->
    <div id="notification-modal" class="modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title">Send Notification</h3>
                <button type="button" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="notification-form">
                    <div class="form-group">
                        <label for="notification-title" class="form-label">Title</label>
                        <input type="text" id="notification-title" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="notification-message" class="form-label">Message</label>
                        <textarea id="notification-message" class="form-control" rows="5" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="notification-type" class="form-label">Type</label>
                        <select id="notification-type" class="form-control">
                            <option value="info">Information</option>
                            <option value="warning">Warning</option>
                            <option value="success">Success</option>
                            <option value="error">Error</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="notification-target" class="form-label">Target</label>
                        <select id="notification-target" class="form-control">
                            <option value="all">All Users</option>
                            <option value="active">Active Users</option>
                            <option value="investors">Investors Only</option>
                            <option value="specific">Specific Users</option>
                        </select>
                    </div>
                    <div class="form-group" id="specific-users-group" style="display: none;">
                        <label for="notification-users" class="form-label">Select Users</label>
                        <select id="notification-users" class="form-control" multiple>
                            <!-- Users will be loaded here -->
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="send-notification">Send Notification</button>
            </div>
        </div>
    </div>

    <!-- Process Withdrawal Modal -->
    <div id="process-withdrawal-modal" class="modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title">Process Withdrawal</h3>
                <button type="button" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="process-withdrawal-form">
                    <input type="hidden" id="withdrawal-id">
                    <div class="form-group">
                        <label class="form-label">User</label>
                        <p id="withdrawal-user" class="form-control-static"></p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Amount</label>
                        <p id="withdrawal-amount" class="form-control-static"></p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Payment Method</label>
                        <p id="withdrawal-method" class="form-control-static"></p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Wallet/Account</label>
                        <p id="withdrawal-wallet" class="form-control-static"></p>
                    </div>
                    <div class="form-group">
                        <label for="withdrawal-action" class="form-label">Action</label>
                        <select id="withdrawal-action" class="form-control">
                            <option value="approve">Approve</option>
                            <option value="reject">Reject</option>
                        </select>
                    </div>
                    <div class="form-group" id="withdrawal-reason-group" style="display: none;">
                        <label for="withdrawal-reason" class="form-label">Reason for Rejection</label>
                        <textarea id="withdrawal-reason" class="form-control" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="withdrawal-notes" class="form-label">Admin Notes</label>
                        <textarea id="withdrawal-notes" class="form-control" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="process-withdrawal">Process</button>
            </div>
        </div>
    </div>

    <!-- View Ticket Modal -->
    <div id="ticket-modal" class="modal">
        <div class="modal-dialog modal-lg">
            <div class="modal-header">
                <h3 class="modal-title">Support Ticket #<span id="ticket-id"></span></h3>
                <button type="button" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">User</label>
                            <p id="ticket-user" class="form-control-static"></p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <p id="ticket-status" class="form-control-static"></p>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">Category</label>
                            <p id="ticket-category" class="form-control-static"></p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">Priority</label>
                            <p id="ticket-priority" class="form-control-static"></p>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Subject</label>
                    <p id="ticket-subject" class="form-control-static"></p>
                </div>
                <div class="form-group">
                    <label class="form-label">Message</label>
                    <div id="ticket-message" class="ticket-message"></div>
                </div>
                
                <div class="ticket-replies">
                    <h5>Replies</h5>
                    <div class="ticket-reply">
                        <div class="reply-header">
                            <div class="reply-user">Admin</div>
                            <div class="reply-date">2 hours ago</div>
                        </div>
                        <div class="reply-message">
                            <p>Thank you for contacting support. We're looking into your issue and will get back to you shortly.</p>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="ticket-reply" class="form-label">Add Reply</label>
                    <textarea id="ticket-reply" class="form-control" rows="5"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="ticket-status-change" class="form-label">Change Status</label>
                    <select id="ticket-status-change" class="form-control">
                        <option value="open">Open</option>
                        <option value="pending">Pending</option>
                        <option value="resolved">Resolved</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="save-ticket-reply">Send Reply</button>
            </div>
        </div>
    </div>

    <!-- Chat Widget -->
    <div class="chat-widget" id="chat-widget">
        <div class="chat-header">
            <h4>Live Chat Support</h4>
            <button class="btn" id="chat-close"><i class="fas fa-times"></i></button>
        </div>
        <div class="chat-body" id="chat-body">
            <div class="chat-message admin">
                <div class="chat-message-content">
                    <div class="chat-message-text">Hello! How can I help you today?</div>
                    <div class="chat-message-meta">
                        <span class="chat-message-time">10:30 AM</span>
                        <span class="chat-message-status">Seen</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="chat-footer">
            <div class="chat-input">
                <input type="text" id="chat-input" placeholder="Type your message...">
                <button id="chat-send"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <!-- Chat Button -->
    <div class="chat-button" id="chat-button">
        <button class="btn btn-primary"><i class="fas fa-comment-dots"></i></button>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" style="display: none;">
        <div class="spinner"></div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- DataTables -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
    
    <!-- Select2 -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    
    <!-- Toastr -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    
    <!-- AOS Animation -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- Moment.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    
    <script>
        // Initialize AOS animation
        AOS.init({
            duration: 800,
            easing: 'ease-in-out',
            once: true
        });

        // Global variables
        let authToken = null;
        let csrfToken = null;
        let currentAdmin = null;
        let socket = null;

        // Initialize toastr notifications
        toastr.options = {
            positionClass: 'toast-top-right',
            progressBar: true,
            timeOut: 5000,
            extendedTimeOut: 2000,
            closeButton: true,
            newestOnTop: true
        };

        // DOM Ready
        $(document).ready(function() {
            // Check if admin is already logged in
            checkAdminSession();

            // Initialize select2
            $('select').select2({
                theme: 'dark',
                width: '100%'
            });

            // Login form submission
            $('#login-form').on('submit', function(e) {
                e.preventDefault();
                const email = $('#email').val().trim();
                const password = $('#password').val();
                const remember = $('#remember').is(':checked');

                adminLogin(email, password, remember);
            });

            // Forgot password link
            $('#forgot-password').on('click', function(e) {
                e.preventDefault();
                const email = $('#email').val().trim();
                
                if (email) {
                    forgotPassword(email);
                } else {
                    toastr.warning('Please enter your email address first');
                }
            });

            // 2FA form submission
            $('#twofa-form').on('submit', function(e) {
                e.preventDefault();
                const code = $('#twofa-code').val().trim();
                const email = $('#email').val().trim();
                
                verify2FACode(email, code);
            });

            // Logout button
            $('#logout-btn, #dropdown-logout').on('click', function(e) {
                e.preventDefault();
                adminLogout();
            });

            // Sidebar toggle
            $('#sidebar-toggle').on('click', function() {
                $('body').toggleClass('sidebar-collapsed');
            });

            // Dropdown menus
            $('#notifications-btn').on('click', function(e) {
                e.preventDefault();
                $('#notifications-dropdown').toggleClass('show');
                $('#messages-dropdown, #profile-dropdown').removeClass('show');
            });

            $('#messages-btn').on('click', function(e) {
                e.preventDefault();
                $('#messages-dropdown').toggleClass('show');
                $('#notifications-dropdown, #profile-dropdown').removeClass('show');
            });

            $('#profile-btn').on('click', function(e) {
                e.preventDefault();
                $('#profile-dropdown').toggleClass('show');
                $('#notifications-dropdown, #messages-dropdown').removeClass('show');
            });

            // Close dropdowns when clicking outside
            $(document).on('click', function(e) {
                if (!$(e.target).closest('.nav-item').length) {
                    $('.dropdown-menu').removeClass('show');
                }
            });

            // Modal close buttons
            $('.modal-close, [data-dismiss="modal"]').on('click', function() {
                $(this).closest('.modal').removeClass('show');
            });

            // Section navigation
            $('.admin-menu a[data-section]').on('click', function(e) {
                e.preventDefault();
                const section = $(this).data('section');
                
                // Update active menu item
                $('.admin-menu a').removeClass('active');
                $(this).addClass('active');
                
                // Hide all sections
                $('.admin-content').hide();
                
                // Show selected section
                $(`#${section}-section`).show();
                
                // Load section data
                loadSectionData(section);
            });

            // Add User button
            $('#add-user-btn').on('click', function() {
                $('#add-user-modal').addClass('show');
            });

            // Add Plan button
            $('#add-plan-btn').on('click', function() {
                $('#add-plan-modal').addClass('show');
            });

            // Send Notification button
            $('#send-notification-btn').on('click', function() {
                $('#notification-modal').addClass('show');
            });

            // Notification target change
            $('#notification-target').on('change', function() {
                if ($(this).val() === 'specific') {
                    $('#specific-users-group').show();
                    loadUsersForNotification();
                } else {
                    $('#specific-users-group').hide();
                }
            });

            // Withdrawal action change
            $('#withdrawal-action').on('change', function() {
                if ($(this).val() === 'reject') {
                    $('#withdrawal-reason-group').show();
                } else {
                    $('#withdrawal-reason-group').hide();
                }
            });

            // Chat button
            $('#chat-button button').on('click', function() {
                $('#chat-widget').addClass('show');
            });

            // Chat close button
            $('#chat-close').on('click', function() {
                $('#chat-widget').removeClass('show');
            });

            // Chat send message
            $('#chat-send').on('click', function() {
                sendChatMessage();
            });

            // Chat input enter key
            $('#chat-input').on('keypress', function(e) {
                if (e.which === 13) {
                    sendChatMessage();
                }
            });

            // Initialize DataTables
            initDataTables();
        });

        // Check admin session
        function checkAdminSession() {
            showLoading();
            
            // Try to get token from localStorage or cookie
            const token = localStorage.getItem('admin_jwt') || getCookie('admin_jwt');
            
            if (token) {
                verifyAdminToken(token);
            } else {
                hideLoading();
                $('#login-page').show();
                $('#admin-dashboard').hide();
            }
        }

        // Admin login
        function adminLogin(email, password, remember) {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/login',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ email, password }),
                success: function(response) {
                    if (response.status === 'success') {
                        authToken = response.token;
                        csrfToken = response.csrfToken;
                        currentAdmin = response.data.admin;
                        
                        // Store token in localStorage if remember is true
                        if (remember) {
                            localStorage.setItem('admin_jwt', authToken);
                        }
                        
                        // Set cookie
                        document.cookie = `admin_jwt=${authToken}; path=/; secure; samesite=strict`;
                        
                        // Check if 2FA is required
                        if (response.twoFactorRequired) {
                            $('#twofa-modal').addClass('show');
                            hideLoading();
                        } else {
                            // Proceed to dashboard
                            switchToDashboard();
                        }
                    } else {
                        hideLoading();
                        toastr.error(response.message || 'Login failed');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred during login');
                }
            });
        }

        // Verify 2FA code
        function verify2FACode(email, code) {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/verify-2fa',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ email, token: code }),
                success: function(response) {
                    if (response.status === 'success') {
                        authToken = response.token;
                        currentAdmin = response.data.admin;
                        
                        // Store token in localStorage
                        localStorage.setItem('admin_jwt', authToken);
                        
                        // Set cookie
                        document.cookie = `admin_jwt=${authToken}; path=/; secure; samesite=strict`;
                        
                        // Close 2FA modal
                        $('#twofa-modal').removeClass('show');
                        
                        // Proceed to dashboard
                        switchToDashboard();
                    } else {
                        hideLoading();
                        toastr.error(response.message || '2FA verification failed');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred during 2FA verification');
                }
            });
        }

        // Verify admin token
        function verifyAdminToken(token) {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/verify',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${token}`);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        authToken = token;
                        currentAdmin = response.data.admin;
                        
                        // Get CSRF token
                        getCSRFToken();
                        
                        // Initialize WebSocket connection
                        initWebSocket();
                        
                        // Switch to dashboard
                        switchToDashboard();
                    } else {
                        // Invalid token, show login page
                        localStorage.removeItem('admin_jwt');
                        document.cookie = 'admin_jwt=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';
                        $('#login-page').show();
                        $('#admin-dashboard').hide();
                        hideLoading();
                    }
                },
                error: function() {
                    // Error verifying token, show login page
                    localStorage.removeItem('admin_jwt');
                    document.cookie = 'admin_jwt=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';
                    $('#login-page').show();
                    $('#admin-dashboard').hide();
                    hideLoading();
                }
            });
        }

        // Get CSRF token
        function getCSRFToken() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/csrf-token',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        csrfToken = response.csrfToken;
                    }
                },
                error: function() {
                    toastr.error('Failed to get CSRF token');
                }
            });
        }

        // Admin logout
        function adminLogout() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/logout',
                type: 'POST',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        // Clear tokens and user data
                        authToken = null;
                        csrfToken = null;
                        currentAdmin = null;
                        
                        // Remove token from storage
                        localStorage.removeItem('admin_jwt');
                        document.cookie = 'admin_jwt=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';
                        
                        // Close WebSocket connection
                        if (socket) {
                            socket.close();
                            socket = null;
                        }
                        
                        // Show login page
                        $('#login-page').show();
                        $('#admin-dashboard').hide();
                        hideLoading();
                        
                        toastr.success('Logged out successfully');
                    } else {
                        hideLoading();
                        toastr.error(response.message || 'Logout failed');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred during logout');
                }
            });
        }

        // Forgot password
        function forgotPassword(email) {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/forgot-password',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ email }),
                success: function(response) {
                    hideLoading();
                    if (response.status === 'success') {
                        toastr.success(response.message || 'Password reset link sent to your email');
                    } else {
                        toastr.error(response.message || 'Failed to send password reset link');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while processing your request');
                }
            });
        }

        // Switch to dashboard
        function switchToDashboard() {
            // Update admin info
            $('#admin-name, #dashboard-admin-name').text(currentAdmin.name);
            $('#admin-fullname').text(currentAdmin.name);
            $('#admin-email').text(currentAdmin.email);
            
            // Show dashboard
            $('#login-page').hide();
            $('#admin-dashboard').show();
            
            // Load dashboard data
            loadSectionData('dashboard');
            
            hideLoading();
        }

        // Initialize WebSocket connection
        function initWebSocket() {
            // Close existing connection if any
            if (socket) {
                socket.close();
            }
            
            // Create new WebSocket connection
            socket = new WebSocket(`wss://website-backendd-1.onrender.com/api/admin/ws?token=${authToken}`);
            
            socket.onopen = function() {
                console.log('WebSocket connection established');
                
                // Subscribe to notifications
                socket.send(JSON.stringify({
                    type: 'subscribe',
                    channel: 'notifications'
                }));
            };
            
            socket.onmessage = function(event) {
                const data = JSON.parse(event.data);
                
                switch (data.type) {
                    case 'notification':
                        handleNotification(data.data);
                        break;
                    case 'chat':
                        handleChatMessage(data.data);
                        break;
                    case 'activity':
                        handleActivityUpdate(data.data);
                        break;
                }
            };
            
            socket.onclose = function() {
                console.log('WebSocket connection closed');
                // Attempt to reconnect after 5 seconds
                setTimeout(initWebSocket, 5000);
            };
            
            socket.onerror = function(error) {
                console.error('WebSocket error:', error);
            };
        }

        // Handle incoming notifications
        function handleNotification(notification) {
            // Update notifications badge
            const badge = $('#notifications-btn .nav-badge');
            const count = parseInt(badge.text()) || 0;
            badge.text(count + 1);
            
            // Add notification to dropdown
            const notificationItem = `
                <a href="#" class="dropdown-item">
                    <div class="notification-item">
                        <div class="notification-icon">
                            <i class="fas fa-${notification.icon} text-${notification.type}"></i>
                        </div>
                        <div class="notification-content">
                            <div class="notification-title">${notification.title}</div>
                            <div class="notification-text">${notification.message}</div>
                            <div class="notification-time">just now</div>
                        </div>
                    </div>
                </a>
            `;
            
            $('#notifications-dropdown .dropdown-divider').before(notificationItem);
            
            // Show toast notification
            toastr[notification.type](notification.message, notification.title);
        }

        // Handle incoming chat messages
        function handleChatMessage(message) {
            // If chat widget is closed and this is a new conversation, show notification
            if (!$('#chat-widget').hasClass('show') && message.isNew) {
                toastr.info('New chat message from ' + message.userName, 'New Chat');
            }
            
            // Add message to chat
            addChatMessage(message.userName, message.message, message.timestamp, false);
        }

        // Handle activity updates
        function handleActivityUpdate(activity) {
            // Update relevant sections based on activity type
            switch (activity.type) {
                case 'user':
                    refreshUsersTable();
                    break;
                case 'investment':
                    refreshInvestmentsTable();
                    break;
                case 'transaction':
                    refreshTransactionsTable();
                    break;
                case 'withdrawal':
                    refreshWithdrawalsTable();
                    break;
                case 'ticket':
                    refreshTicketsTable();
                    break;
            }
        }

        // Send chat message
        function sendChatMessage() {
            const message = $('#chat-input').val().trim();
            
            if (message) {
                // Add message to chat (as admin)
                addChatMessage('Admin', message, new Date().toISOString(), true);
                
                // Clear input
                $('#chat-input').val('');
                
                // Send message to server
                if (socket && socket.readyState === WebSocket.OPEN) {
                    socket.send(JSON.stringify({
                        type: 'chat',
                        data: {
                            message: message,
                            isAdmin: true
                        }
                    }));
                } else {
                    toastr.warning('Connection lost. Reconnecting...');
                    initWebSocket();
                }
            }
        }

        // Add message to chat UI
        function addChatMessage(sender, message, timestamp, isAdmin) {
            const time = moment(timestamp).format('h:mm A');
            const messageClass = isAdmin ? 'user' : 'admin';
            
            const messageHtml = `
                <div class="chat-message ${messageClass}">
                    <div class="chat-message-content">
                        <div class="chat-message-text">${message}</div>
                        <div class="chat-message-meta">
                            <span class="chat-message-time">${time}</span>
                            <span class="chat-message-status">${isAdmin ? 'Sent' : 'Seen'}</span>
                        </div>
                    </div>
                </div>
            `;
            
            $('#chat-body').append(messageHtml);
            $('#chat-body').scrollTop($('#chat-body')[0].scrollHeight);
        }

        // Load section data
        function loadSectionData(section) {
            showLoading();
            
            switch (section) {
                case 'dashboard':
                    loadDashboardData();
                    break;
                case 'users':
                    loadUsersData();
                    break;
                case 'investments':
                    loadInvestmentsData();
                    break;
                case 'transactions':
                    loadTransactionsData();
                    break;
                case 'withdrawals':
                    loadWithdrawalsData();
                    break;
                case 'plans':
                    loadPlansData();
                    break;
                case 'promotions':
                    loadPromotionsData();
                    break;
                case 'support':
                    loadSupportData();
                    break;
                case 'notifications':
                    loadNotificationsData();
                    break;
                case 'settings':
                    loadSettingsData();
                    break;
                case 'security':
                    loadSecurityData();
                    break;
                case 'logs':
                    loadLogsData();
                    break;
                default:
                    hideLoading();
            }
        }

        // Load dashboard data
        function loadDashboardData() {
            // Make multiple API calls to get dashboard data
            $.when(
                getTotalUsers(),
                getActiveInvestments(),
                getDailyVolume(),
                getPendingWithdrawals(),
                getGrowthData(),
                getInvestmentDistribution(),
                getRecentActivity()
            ).then(function() {
                hideLoading();
                initDashboardCharts();
            }).fail(function() {
                hideLoading();
                toastr.error('Failed to load dashboard data');
            });
        }

        // Get total users count
        function getTotalUsers() {
            return $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/users/count',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        $('#total-users').text(response.data.count.toLocaleString());
                    }
                }
            });
        }

        // Get active investments count
        function getActiveInvestments() {
            return $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/investments/count',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        $('#active-investments').text(response.data.count.toLocaleString());
                    }
                }
            });
        }

        // Get daily volume
        function getDailyVolume() {
            return $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/transactions/volume',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        $('#daily-volume').text('$' + response.data.amount.toLocaleString());
                    }
                }
            });
        }

        // Get pending withdrawals count
        function getPendingWithdrawals() {
            return $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/withdrawals/count',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        $('#pending-withdrawals').text(response.data.count);
                    }
                }
            });
        }

        // Get growth data
        function getGrowthData() {
            return $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/stats/growth',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        window.growthData = response.data;
                    }
                }
            });
        }

        // Get investment distribution
        function getInvestmentDistribution() {
            return $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/investments/distribution',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        window.investmentDistribution = response.data;
                    }
                }
            });
        }

        // Get recent activity
        function getRecentActivity() {
            return $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/activity',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateActivityTable(response.data);
                    }
                }
            });
        }

        // Initialize dashboard charts
        function initDashboardCharts() {
            // Growth chart
            const growthCtx = document.getElementById('growth-chart').getContext('2d');
            window.growthChart = new Chart(growthCtx, {
                type: 'line',
                data: {
                    labels: window.growthData.labels,
                    datasets: [
                        {
                            label: 'New Users',
                            data: window.growthData.users,
                            borderColor: 'rgba(0, 211, 149, 1)',
                            backgroundColor: 'rgba(0, 211, 149, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Investments',
                            data: window.growthData.investments,
                            borderColor: 'rgba(0, 51, 102, 1)',
                            backgroundColor: 'rgba(0, 51, 102, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Transactions',
                            data: window.growthData.transactions,
                            borderColor: 'rgba(255, 184, 0, 1)',
                            backgroundColor: 'rgba(255, 184, 0, 0.1)',
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#E5E5E5'
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(142, 142, 142, 0.1)'
                            },
                            ticks: {
                                color: '#E5E5E5'
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(142, 142, 142, 0.1)'
                            },
                            ticks: {
                                color: '#E5E5E5'
                            }
                        }
                    }
                }
            });

            // Investment distribution chart
            const investmentCtx = document.getElementById('investment-chart').getContext('2d');
            window.investmentChart = new Chart(investmentCtx, {
                type: 'doughnut',
                data: {
                    labels: window.investmentDistribution.labels,
                    datasets: [{
                        data: window.investmentDistribution.data,
                        backgroundColor: [
                            'rgba(0, 211, 149, 0.7)',
                            'rgba(0, 51, 102, 0.7)',
                            'rgba(255, 184, 0, 0.7)',
                            'rgba(255, 61, 87, 0.7)',
                            'rgba(120, 79, 237, 0.7)'
                        ],
                        borderColor: [
                            'rgba(0, 211, 149, 1)',
                            'rgba(0, 51, 102, 1)',
                            'rgba(255, 184, 0, 1)',
                            'rgba(255, 61, 87, 1)',
                            'rgba(120, 79, 237, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: '#E5E5E5'
                            }
                        }
                    }
                }
            });
        }

        // Populate activity table
        function populateActivityTable(activities) {
            const tbody = $('#activity-table tbody');
            tbody.empty();
            
            activities.forEach(activity => {
                const row = `
                    <tr>
                        <td>${activity.id}</td>
                        <td>
                            <div class="d-flex align-items-center">
                                <img src="https://via.placeholder.com/40" alt="User" class="avatar-sm rounded-circle me-2">
                                <div>
                                    <div class="fw-bold">${activity.userName || 'System'}</div>
                                    <div class="text-muted small">${activity.userEmail || ''}</div>
                                </div>
                            </div>
                        </td>
                        <td>${activity.action}</td>
                        <td>${activity.ipAddress}</td>
                        <td>${moment(activity.timestamp).format('MMM D, YYYY h:mm A')}</td>
                        <td><span class="badge badge-success">Completed</span></td>
                    </tr>
                `;
                
                tbody.append(row);
            });
        }

        // Load users data
        function loadUsersData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/users',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateUsersTable(response.data);
                    } else {
                        toastr.error(response.message || 'Failed to load users');
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading users');
                }
            });
        }

        // Populate users table
        function populateUsersTable(users) {
            const tbody = $('#users-table tbody');
            tbody.empty();
            
            users.forEach(user => {
                const statusBadge = user.status === 'active' ? 
                    '<span class="badge badge-success">Active</span>' : 
                    '<span class="badge badge-danger">Suspended</span>';
                
                const row = `
                    <tr>
                        <td>${user.id}</td>
                        <td>
                            <div class="d-flex align-items-center">
                                <img src="${user.avatar || 'https://via.placeholder.com/40'}" alt="User" class="avatar-sm rounded-circle me-2">
                                <div>
                                    <div class="fw-bold">${user.name}</div>
                                    <div class="text-muted small">${user.country || ''}</div>
                                </div>
                            </div>
                        </td>
                        <td>${user.email}</td>
                        <td>$${user.balance.toLocaleString()}</td>
                        <td>${statusBadge}</td>
                        <td>${moment(user.createdAt).format('MMM D, YYYY')}</td>
                        <td class="actions">
                            <button class="btn btn-sm btn-primary edit-user" data-id="${user.id}"><i class="fas fa-edit"></i></button>
                            <button class="btn btn-sm btn-danger delete-user" data-id="${user.id}"><i class="fas fa-trash"></i></button>
                            <button class="btn btn-sm btn-secondary view-user" data-id="${user.id}"><i class="fas fa-eye"></i></button>
                        </td>
                    </tr>
                `;
                
                tbody.append(row);
            });
            
            // Initialize user actions
            $('.edit-user').on('click', function() {
                const userId = $(this).data('id');
                editUser(userId);
            });
            
            $('.delete-user').on('click', function() {
                const userId = $(this).data('id');
                deleteUser(userId);
            });
            
            $('.view-user').on('click', function() {
                const userId = $(this).data('id');
                viewUser(userId);
            });
        }

        // Refresh users table
        function refreshUsersTable() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/users',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateUsersTable(response.data);
                    }
                }
            });
        }

        // Edit user
        function editUser(userId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/users/${userId}`,
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        const user = response.data.user;
                        
                        // Populate edit form
                        $('#edit-user-id').val(user.id);
                        $('#edit-first-name').val(user.firstName);
                        $('#edit-last-name').val(user.lastName);
                        $('#edit-email').val(user.email);
                        $('#edit-phone').val(user.phone);
                        $('#edit-country').val(user.country).trigger('change');
                        $('#edit-balance').val(user.balance);
                        
                        if (user.status === 'active') {
                            $('#edit-status-active').prop('checked', true);
                        } else {
                            $('#edit-status-suspended').prop('checked', true);
                        }
                        
                        if (user.twoFactorEnabled) {
                            $('#edit-2fa-enabled').prop('checked', true);
                        } else {
                            $('#edit-2fa-disabled').prop('checked', true);
                        }
                        
                        // Show edit modal
                        $('#edit-user-modal').addClass('show');
                    } else {
                        toastr.error(response.message || 'Failed to load user data');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading user data');
                }
            });
        }

        // Save user changes
        $('#save-user-changes').on('click', function() {
            const userId = $('#edit-user-id').val();
            const userData = {
                firstName: $('#edit-first-name').val().trim(),
                lastName: $('#edit-last-name').val().trim(),
                email: $('#edit-email').val().trim(),
                phone: $('#edit-phone').val().trim(),
                country: $('#edit-country').val(),
                balance: parseFloat($('#edit-balance').val()),
                status: $('input[name="edit-status"]:checked').val(),
                twoFactorEnabled: $('input[name="edit-2fa"]:checked').val() === 'enabled'
            };
            
            if (!userData.firstName || !userData.lastName || !userData.email) {
                toastr.warning('Please fill in all required fields');
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/users/${userId}`,
                type: 'PUT',
                contentType: 'application/json',
                data: JSON.stringify(userData),
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success('User updated successfully');
                        $('#edit-user-modal').removeClass('show');
                        refreshUsersTable();
                    } else {
                        toastr.error(response.message || 'Failed to update user');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while updating user');
                }
            });
        });

        // Delete user
        function deleteUser(userId) {
            if (!confirm('Are you sure you want to delete this user? This action cannot be undone.')) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/users/${userId}`,
                type: 'DELETE',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success('User deleted successfully');
                        refreshUsersTable();
                    } else {
                        toastr.error(response.message || 'Failed to delete user');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while deleting user');
                }
            });
        }

        // View user details
        function viewUser(userId) {
            // In a real implementation, this would open a detailed view of the user
            toastr.info(`Viewing user details for ID: ${userId}`);
        }

        // Save new user
        $('#save-new-user').on('click', function() {
            const userData = {
                firstName: $('#new-first-name').val().trim(),
                lastName: $('#new-last-name').val().trim(),
                email: $('#new-email').val().trim(),
                password: $('#new-password').val(),
                phone: $('#new-phone').val().trim(),
                country: $('#new-country').val(),
                balance: parseFloat($('#new-balance').val()) || 0,
                status: $('input[name="new-status"]:checked').val()
            };
            
            if (!userData.firstName || !userData.lastName || !userData.email || !userData.password) {
                toastr.warning('Please fill in all required fields');
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/users',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(userData),
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success('User created successfully');
                        $('#add-user-modal').removeClass('show');
                        $('#add-user-form')[0].reset();
                        refreshUsersTable();
                    } else {
                        toastr.error(response.message || 'Failed to create user');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while creating user');
                }
            });
        });

        // Load investments data
        function loadInvestmentsData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/investments',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateInvestmentsTable(response.data);
                    } else {
                        toastr.error(response.message || 'Failed to load investments');
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading investments');
                }
            });
        }

        // Populate investments table
        function populateInvestmentsTable(investments) {
            const tbody = $('#investments-table tbody');
            tbody.empty();
            
            investments.forEach(investment => {
                const statusBadge = investment.status === 'active' ? 
                    '<span class="badge badge-success">Active</span>' : 
                    '<span class="badge badge-secondary">Completed</span>';
                
                const row = `
                    <tr>
                        <td>${investment.id}</td>
                        <td>
                            <div class="d-flex align-items-center">
                                <img src="${investment.user.avatar || 'https://via.placeholder.com/40'}" alt="User" class="avatar-sm rounded-circle me-2">
                                <div>
                                    <div class="fw-bold">${investment.user.name}</div>
                                    <div class="text-muted small">ID: ${investment.user.id}</div>
                                </div>
                            </div>
                        </td>
                        <td>${investment.plan.name}</td>
                        <td>$${investment.amount.toLocaleString()}</td>
                        <td>$${investment.dailyProfit.toLocaleString()}</td>
                        <td>${moment(investment.startDate).format('MMM D, YYYY')}</td>
                        <td>${moment(investment.endDate).format('MMM D, YYYY')}</td>
                        <td>${statusBadge}</td>
                        <td class="actions">
                            <button class="btn btn-sm btn-primary view-investment" data-id="${investment.id}"><i class="fas fa-eye"></i></button>
                            <button class="btn btn-sm btn-danger cancel-investment" data-id="${investment.id}" ${investment.status !== 'active' ? 'disabled' : ''}><i class="fas fa-times"></i></button>
                        </td>
                    </tr>
                `;
                
                tbody.append(row);
            });
            
            // Initialize investment actions
            $('.view-investment').on('click', function() {
                const investmentId = $(this).data('id');
                viewInvestment(investmentId);
            });
            
            $('.cancel-investment').on('click', function() {
                const investmentId = $(this).data('id');
                cancelInvestment(investmentId);
            });
        }

        // Refresh investments table
        function refreshInvestmentsTable() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/investments',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateInvestmentsTable(response.data);
                    }
                }
            });
        }

        // View investment details
        function viewInvestment(investmentId) {
            // In a real implementation, this would open a detailed view of the investment
            toastr.info(`Viewing investment details for ID: ${investmentId}`);
        }

        // Cancel investment
        function cancelInvestment(investmentId) {
            if (!confirm('Are you sure you want to cancel this investment? The user will be refunded.')) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/investments/${investmentId}/cancel`,
                type: 'POST',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success('Investment cancelled successfully');
                        refreshInvestmentsTable();
                    } else {
                        toastr.error(response.message || 'Failed to cancel investment');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while cancelling investment');
                }
            });
        }

        // Load transactions data
        function loadTransactionsData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/transactions',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateTransactionsTable(response.data);
                    } else {
                        toastr.error(response.message || 'Failed to load transactions');
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading transactions');
                }
            });
        }

        // Populate transactions table
        function populateTransactionsTable(transactions) {
            const tbody = $('#transactions-table tbody');
            tbody.empty();
            
            transactions.forEach(transaction => {
                const typeBadge = transaction.type === 'deposit' ? 
                    '<span class="badge badge-primary">Deposit</span>' : 
                    '<span class="badge badge-warning">Withdrawal</span>';
                
                const statusBadge = transaction.status === 'completed' ? 
                    '<span class="badge badge-success">Completed</span>' : 
                    transaction.status === 'pending' ? 
                    '<span class="badge badge-warning">Pending</span>' : 
                    '<span class="badge badge-danger">Failed</span>';
                
                const row = `
                    <tr>
                        <td>${transaction.id}</td>
                        <td>
                            <div class="d-flex align-items-center">
                                <img src="${transaction.user.avatar || 'https://via.placeholder.com/40'}" alt="User" class="avatar-sm rounded-circle me-2">
                                <div>
                                    <div class="fw-bold">${transaction.user.name}</div>
                                    <div class="text-muted small">ID: ${transaction.user.id}</div>
                                </div>
                            </div>
                        </td>
                        <td>${typeBadge}</td>
                        <td>$${transaction.amount.toLocaleString()}</td>
                        <td>${transaction.method}</td>
                        <td>${moment(transaction.createdAt).format('MMM D, YYYY h:mm A')}</td>
                        <td>${statusBadge}</td>
                        <td class="actions">
                            <button class="btn btn-sm btn-primary view-transaction" data-id="${transaction.id}"><i class="fas fa-eye"></i></button>
                        </td>
                    </tr>
                `;
                
                tbody.append(row);
            });
            
            // Initialize transaction actions
            $('.view-transaction').on('click', function() {
                const transactionId = $(this).data('id');
                viewTransaction(transactionId);
            });
        }

        // Refresh transactions table
        function refreshTransactionsTable() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/transactions',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateTransactionsTable(response.data);
                    }
                }
            });
        }

        // View transaction details
        function viewTransaction(transactionId) {
            // In a real implementation, this would open a detailed view of the transaction
            toastr.info(`Viewing transaction details for ID: ${transactionId}`);
        }

        // Load withdrawals data
        function loadWithdrawalsData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/withdrawals/pending',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateWithdrawalsTable(response.data);
                    } else {
                        toastr.error(response.message || 'Failed to load withdrawals');
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading withdrawals');
                }
            });
        }

        // Populate withdrawals table
        function populateWithdrawalsTable(withdrawals) {
            const tbody = $('#withdrawals-table tbody');
            tbody.empty();
            
            withdrawals.forEach(withdrawal => {
                const row = `
                    <tr>
                        <td>${withdrawal.id}</td>
                        <td>
                            <div class="d-flex align-items-center">
                                <img src="${withdrawal.user.avatar || 'https://via.placeholder.com/40'}" alt="User" class="avatar-sm rounded-circle me-2">
                                <div>
                                    <div class="fw-bold">${withdrawal.user.name}</div>
                                    <div class="text-muted small">ID: ${withdrawal.user.id}</div>
                                </div>
                            </div>
                        </td>
                        <td>$${withdrawal.amount.toLocaleString()}</td>
                        <td>${withdrawal.method}</td>
                        <td>${withdrawal.wallet || withdrawal.accountNumber}</td>
                        <td>${moment(withdrawal.createdAt).format('MMM D, YYYY h:mm A')}</td>
                        <td class="actions">
                            <button class="btn btn-sm btn-primary process-withdrawal" data-id="${withdrawal.id}"><i class="fas fa-cog"></i> Process</button>
                        </td>
                    </tr>
                `;
                
                tbody.append(row);
            });
            
            // Initialize withdrawal actions
            $('.process-withdrawal').on('click', function() {
                const withdrawalId = $(this).data('id');
                prepareProcessWithdrawal(withdrawalId);
            });
        }

        // Refresh withdrawals table
        function refreshWithdrawalsTable() {
            const status = $('#withdrawals-section .nav-tabs .nav-link.active').data('status');
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/withdrawals/${status}`,
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateWithdrawalsTable(response.data);
                    }
                }
            });
        }

        // Prepare process withdrawal
        function prepareProcessWithdrawal(withdrawalId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/withdrawals/${withdrawalId}`,
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        const withdrawal = response.data.withdrawal;
                        
                        // Populate process form
                        $('#withdrawal-id').val(withdrawal.id);
                        $('#withdrawal-user').text(`${withdrawal.user.name} (ID: ${withdrawal.user.id})`);
                        $('#withdrawal-amount').text(`$${withdrawal.amount.toLocaleString()}`);
                        $('#withdrawal-method').text(withdrawal.method);
                        $('#withdrawal-wallet').text(withdrawal.wallet || withdrawal.accountNumber);
                        
                        // Show process modal
                        $('#process-withdrawal-modal').addClass('show');
                    } else {
                        toastr.error(response.message || 'Failed to load withdrawal data');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading withdrawal data');
                }
            });
        }

        // Process withdrawal
        $('#process-withdrawal').on('click', function() {
            const withdrawalId = $('#withdrawal-id').val();
            const action = $('#withdrawal-action').val();
            const reason = $('#withdrawal-reason').val().trim();
            const notes = $('#withdrawal-notes').val().trim();
            
            if (action === 'reject' && !reason) {
                toastr.warning('Please provide a reason for rejection');
                return;
            }
            
            const data = {
                action: action,
                reason: action === 'reject' ? reason : null,
                adminNotes: notes
            };
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/withdrawals/${withdrawalId}/process`,
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(data),
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success('Withdrawal processed successfully');
                        $('#process-withdrawal-modal').removeClass('show');
                        refreshWithdrawalsTable();
                    } else {
                        toastr.error(response.message || 'Failed to process withdrawal');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while processing withdrawal');
                }
            });
        });

        // Withdrawal status tab change
        $('#withdrawals-section .nav-tabs .nav-link').on('click', function(e) {
            e.preventDefault();
            
            // Update active tab
            $('#withdrawals-section .nav-tabs .nav-link').removeClass('active');
            $(this).addClass('active');
            
            // Refresh table with new status
            refreshWithdrawalsTable();
        });

        // Load plans data
        function loadPlansData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/plans',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populatePlans(response.data);
                    } else {
                        toastr.error(response.message || 'Failed to load plans');
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading plans');
                }
            });
        }

        // Populate plans
        function populatePlans(plans) {
            const container = $('#plans-section .card-body .row');
            container.empty();
            
            plans.forEach(plan => {
                const statusBadge = plan.status === 'active' ? 
                    '<span class="badge badge-success">Active</span>' : 
                    '<span class="badge badge-secondary">Inactive</span>';
                
                const card = `
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-header">
                                <h5 class="card-title">${plan.name}</h5>
                                <div class="card-tools">
                                    ${statusBadge}
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-text">${plan.description}</p>
                                <ul class="list-group list-group-flush mb-3">
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        Minimum Amount
                                        <span class="badge bg-primary">$${plan.minAmount.toLocaleString()}</span>
                                    </li>
                                    ${plan.maxAmount ? `
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        Maximum Amount
                                        <span class="badge bg-primary">$${plan.maxAmount.toLocaleString()}</span>
                                    </li>
                                    ` : ''}
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        Duration
                                        <span class="badge bg-primary">${plan.duration} Days</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        Daily Profit
                                        <span class="badge bg-success">${plan.dailyProfit}%</span>
                                    </li>
                                </ul>
                            </div>
                            <div class="card-footer">
                                <button class="btn btn-sm btn-primary edit-plan" data-id="${plan.id}"><i class="fas fa-edit"></i> Edit</button>
                                <button class="btn btn-sm btn-danger delete-plan" data-id="${plan.id}"><i class="fas fa-trash"></i> Delete</button>
                                <button class="btn btn-sm btn-secondary toggle-plan" data-id="${plan.id}" data-status="${plan.status}">
                                    <i class="fas fa-power-off"></i> ${plan.status === 'active' ? 'Deactivate' : 'Activate'}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                container.append(card);
            });
            
            // Initialize plan actions
            $('.edit-plan').on('click', function() {
                const planId = $(this).data('id');
                editPlan(planId);
            });
            
            $('.delete-plan').on('click', function() {
                const planId = $(this).data('id');
                deletePlan(planId);
            });
            
            $('.toggle-plan').on('click', function() {
                const planId = $(this).data('id');
                const currentStatus = $(this).data('status');
                togglePlanStatus(planId, currentStatus);
            });
        }

        // Edit plan
        function editPlan(planId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/plans/${planId}`,
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        const plan = response.data.plan;
                        
                        // Populate add plan form (reusing the same modal)
                        $('#plan-name').val(plan.name);
                        $('#plan-description').val(plan.description);
                        $('#plan-min-amount').val(plan.minAmount);
                        $('#plan-max-amount').val(plan.maxAmount || '');
                        $('#plan-duration').val(plan.duration);
                        $('#plan-profit').val(plan.dailyProfit);
                        
                        if (plan.status === 'active') {
                            $('#plan-status-active').prop('checked', true);
                        } else {
                            $('#plan-status-inactive').prop('checked', true);
                        }
                        
                        // Change modal title
                        $('#add-plan-modal .modal-title').text('Edit Investment Plan');
                        
                        // Add hidden field for plan ID
                        $('#add-plan-form').append('<input type="hidden" id="edit-plan-id" value="' + plan.id + '">');
                        
                        // Show modal
                        $('#add-plan-modal').addClass('show');
                    } else {
                        toastr.error(response.message || 'Failed to load plan data');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading plan data');
                }
            });
        }

        // Delete plan
        function deletePlan(planId) {
            if (!confirm('Are you sure you want to delete this plan? This action cannot be undone.')) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/plans/${planId}`,
                type: 'DELETE',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success('Plan deleted successfully');
                        loadPlansData();
                    } else {
                        toastr.error(response.message || 'Failed to delete plan');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while deleting plan');
                }
            });
        }

        // Toggle plan status
        function togglePlanStatus(planId, currentStatus) {
            const newStatus = currentStatus === 'active' ? 'inactive' : 'active';
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/plans/${planId}/status`,
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ status: newStatus }),
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success(`Plan ${newStatus === 'active' ? 'activated' : 'deactivated'} successfully`);
                        loadPlansData();
                    } else {
                        toastr.error(response.message || `Failed to ${newStatus === 'active' ? 'activate' : 'deactivate'} plan`);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || `An error occurred while ${newStatus === 'active' ? 'activating' : 'deactivating'} plan`);
                }
            });
        }

        // Save new plan
        $('#save-new-plan').on('click', function() {
            const planData = {
                name: $('#plan-name').val().trim(),
                description: $('#plan-description').val().trim(),
                minAmount: parseFloat($('#plan-min-amount').val()),
                maxAmount: $('#plan-max-amount').val() ? parseFloat($('#plan-max-amount').val()) : null,
                duration: parseInt($('#plan-duration').val()),
                dailyProfit: parseFloat($('#plan-profit').val()),
                status: $('input[name="plan-status"]:checked').val()
            };
            
            if (!planData.name || !planData.minAmount || !planData.duration || !planData.dailyProfit) {
                toastr.warning('Please fill in all required fields');
                return;
            }
            
            const planId = $('#edit-plan-id').val();
            const isEdit = !!planId;
            
            showLoading();
            
            const request = isEdit ? 
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/plans/${planId}`,
                    type: 'PUT',
                    contentType: 'application/json',
                    data: JSON.stringify(planData),
                    beforeSend: function(xhr) {
                        xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                        xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                    }
                }) :
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/plans',
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(planData),
                    beforeSend: function(xhr) {
                        xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                        xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                    }
                });
            
            request.then(function(response) {
                hideLoading();
                
                if (response.status === 'success') {
                    toastr.success(`Plan ${isEdit ? 'updated' : 'created'} successfully`);
                    $('#add-plan-modal').removeClass('show');
                    $('#add-plan-form')[0].reset();
                    $('#edit-plan-id').remove();
                    $('#add-plan-modal .modal-title').text('Add New Investment Plan');
                    loadPlansData();
                } else {
                    toastr.error(response.message || `Failed to ${isEdit ? 'update' : 'create'} plan`);
                }
            }).fail(function(xhr) {
                hideLoading();
                const error = xhr.responseJSON || {};
                toastr.error(error.message || `An error occurred while ${isEdit ? 'updating' : 'creating'} plan`);
            });
        });

        // Load promotions data
        function loadPromotionsData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/promotions',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populatePromotionsTable(response.data);
                    } else {
                        toastr.error(response.message || 'Failed to load promotions');
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading promotions');
                }
            });
        }

        // Populate promotions table
        function populatePromotionsTable(promotions) {
            const tbody = $('#promotions-table tbody');
            tbody.empty();
            
            promotions.forEach(promotion => {
                const statusBadge = promotion.status === 'active' ? 
                    '<span class="badge badge-success">Active</span>' : 
                    '<span class="badge badge-secondary">Inactive</span>';
                
                const row = `
                    <tr>
                        <td>${promotion.id}</td>
                        <td>${promotion.title}</td>
                        <td>${promotion.type}</td>
                        <td>${moment(promotion.startDate).format('MMM D, YYYY')}</td>
                        <td>${moment(promotion.endDate).format('MMM D, YYYY')}</td>
                        <td>${statusBadge}</td>
                        <td class="actions">
                            <button class="btn btn-sm btn-primary edit-promotion" data-id="${promotion.id}"><i class="fas fa-edit"></i></button>
                            <button class="btn btn-sm btn-danger delete-promotion" data-id="${promotion.id}"><i class="fas fa-trash"></i></button>
                            <button class="btn btn-sm btn-secondary toggle-promotion" data-id="${promotion.id}" data-status="${promotion.status}">
                                <i class="fas fa-power-off"></i>
                            </button>
                        </td>
                    </tr>
                `;
                
                tbody.append(row);
            });
            
            // Initialize promotion actions
            $('.edit-promotion').on('click', function() {
                const promotionId = $(this).data('id');
                editPromotion(promotionId);
            });
            
            $('.delete-promotion').on('click', function() {
                const promotionId = $(this).data('id');
                deletePromotion(promotionId);
            });
            
            $('.toggle-promotion').on('click', function() {
                const promotionId = $(this).data('id');
                const currentStatus = $(this).data('status');
                togglePromotionStatus(promotionId, currentStatus);
            });
        }

        // Edit promotion
        function editPromotion(promotionId) {
            // In a real implementation, this would open an edit form for the promotion
            toastr.info(`Editing promotion with ID: ${promotionId}`);
        }

        // Delete promotion
        function deletePromotion(promotionId) {
            if (!confirm('Are you sure you want to delete this promotion? This action cannot be undone.')) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/promotions/${promotionId}`,
                type: 'DELETE',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success('Promotion deleted successfully');
                        loadPromotionsData();
                    } else {
                        toastr.error(response.message || 'Failed to delete promotion');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while deleting promotion');
                }
            });
        }

        // Toggle promotion status
        function togglePromotionStatus(promotionId, currentStatus) {
            const newStatus = currentStatus === 'active' ? 'inactive' : 'active';
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/promotions/${promotionId}/status`,
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ status: newStatus }),
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success(`Promotion ${newStatus === 'active' ? 'activated' : 'deactivated'} successfully`);
                        loadPromotionsData();
                    } else {
                        toastr.error(response.message || `Failed to ${newStatus === 'active' ? 'activate' : 'deactivate'} promotion`);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || `An error occurred while ${newStatus === 'active' ? 'activating' : 'deactivating'} promotion`);
                }
            });
        }

        // Load support data
        function loadSupportData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/support/tickets',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateTicketsTable(response.data);
                    } else {
                        toastr.error(response.message || 'Failed to load support tickets');
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading support tickets');
                }
            });
        }

        // Populate tickets table
        function populateTicketsTable(tickets) {
            const tbody = $('#tickets-table tbody');
            tbody.empty();
            
            tickets.forEach(ticket => {
                const priorityBadge = ticket.priority === 'high' ? 
                    '<span class="badge badge-danger">High</span>' : 
                    ticket.priority === 'medium' ? 
                    '<span class="badge badge-warning">Medium</span>' : 
                    '<span class="badge badge-success">Low</span>';
                
                const statusBadge = ticket.status === 'open' ? 
                    '<span class="badge badge-primary">Open</span>' : 
                    ticket.status === 'pending' ? 
                    '<span class="badge badge-warning">Pending</span>' : 
                    '<span class="badge badge-success">Resolved</span>';
                
                const row = `
                    <tr>
                        <td>${ticket.id}</td>
                        <td>
                            <div class="d-flex align-items-center">
                                <img src="${ticket.user.avatar || 'https://via.placeholder.com/40'}" alt="User" class="avatar-sm rounded-circle me-2">
                                <div>
                                    <div class="fw-bold">${ticket.user.name}</div>
                                    <div class="text-muted small">ID: ${ticket.user.id}</div>
                                </div>
                            </div>
                        </td>
                        <td>${ticket.subject}</td>
                        <td>${ticket.category}</td>
                        <td>${priorityBadge}</td>
                        <td>${moment(ticket.updatedAt).format('MMM D, YYYY h:mm A')}</td>
                        <td>${statusBadge}</td>
                        <td class="actions">
                            <button class="btn btn-sm btn-primary view-ticket" data-id="${ticket.id}"><i class="fas fa-eye"></i> View</button>
                        </td>
                    </tr>
                `;
                
                tbody.append(row);
            });
            
            // Initialize ticket actions
            $('.view-ticket').on('click', function() {
                const ticketId = $(this).data('id');
                viewTicket(ticketId);
            });
        }

        // Refresh tickets table
        function refreshTicketsTable() {
            const status = $('#support-section .nav-tabs .nav-link.active').data('status');
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/support/tickets/${status}`,
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateTicketsTable(response.data);
                    }
                }
            });
        }

        // View ticket
        function viewTicket(ticketId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/support/tickets/${ticketId}`,
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        const ticket = response.data.ticket;
                        
                        // Populate ticket modal
                        $('#ticket-id').text(ticket.id);
                        $('#ticket-user').text(`${ticket.user.name} (ID: ${ticket.user.id})`);
                        $('#ticket-status').text(ticket.status.charAt(0).toUpperCase() + ticket.status.slice(1));
                        $('#ticket-category').text(ticket.category);
                        $('#ticket-priority').text(ticket.priority.charAt(0).toUpperCase() + ticket.priority.slice(1));
                        $('#ticket-subject').text(ticket.subject);
                        $('#ticket-message').html(ticket.message.replace(/\n/g, '<br>'));
                        
                        // Set current status
                        $('#ticket-status-change').val(ticket.status);
                        
                        // Show ticket modal
                        $('#ticket-modal').addClass('show');
                    } else {
                        toastr.error(response.message || 'Failed to load ticket data');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading ticket data');
                }
            });
        }

        // Save ticket reply
        $('#save-ticket-reply').on('click', function() {
            const ticketId = $('#ticket-id').text();
            const reply = $('#ticket-reply').val().trim();
            const status = $('#ticket-status-change').val();
            
            if (!reply) {
                toastr.warning('Please enter a reply message');
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/support/tickets/${ticketId}/reply`,
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ 
                    message: reply,
                    status: status 
                }),
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success('Reply sent successfully');
                        $('#ticket-reply').val('');
                        refreshTicketsTable();
                    } else {
                        toastr.error(response.message || 'Failed to send reply');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while sending reply');
                }
            });
        });

        // Ticket status tab change
        $('#support-section .nav-tabs .nav-link').on('click', function(e) {
            e.preventDefault();
            
            // Update active tab
            $('#support-section .nav-tabs .nav-link').removeClass('active');
            $(this).addClass('active');
            
            // Refresh table with new status
            refreshTicketsTable();
        });

        // Load notifications data
        function loadNotificationsData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/notifications',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateNotificationsTable(response.data);
                    } else {
                        toastr.error(response.message || 'Failed to load notifications');
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading notifications');
                }
            });
        }

        // Populate notifications table
        function populateNotificationsTable(notifications) {
            const tbody = $('#notifications-table tbody');
            tbody.empty();
            
            notifications.forEach(notification => {
                const statusBadge = notification.status === 'sent' ? 
                    '<span class="badge badge-success">Sent</span>' : 
                    '<span class="badge badge-secondary">Draft</span>';
                
                const row = `
                    <tr>
                        <td>${notification.id}</td>
                        <td>${notification.title}</td>
                        <td>${notification.message.length > 50 ? notification.message.substring(0, 50) + '...' : notification.message}</td>
                        <td>${notification.target === 'all' ? 'All Users' : 
                            notification.target === 'active' ? 'Active Users' : 
                            notification.target === 'investors' ? 'Investors Only' : 'Specific Users'}</td>
                        <td>${moment(notification.createdAt).format('MMM D, YYYY h:mm A')}</td>
                        <td>${statusBadge}</td>
                        <td class="actions">
                            <button class="btn btn-sm btn-primary view-notification" data-id="${notification.id}"><i class="fas fa-eye"></i></button>
                            <button class="btn btn-sm btn-danger delete-notification" data-id="${notification.id}"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
                
                tbody.append(row);
            });
            
            // Initialize notification actions
            $('.view-notification').on('click', function() {
                const notificationId = $(this).data('id');
                viewNotification(notificationId);
            });
            
            $('.delete-notification').on('click', function() {
                const notificationId = $(this).data('id');
                deleteNotification(notificationId);
            });
        }

        // View notification
        function viewNotification(notificationId) {
            // In a real implementation, this would show the full notification details
            toastr.info(`Viewing notification with ID: ${notificationId}`);
        }

        // Delete notification
        function deleteNotification(notificationId) {
            if (!confirm('Are you sure you want to delete this notification? This action cannot be undone.')) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/notifications/${notificationId}`,
                type: 'DELETE',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success('Notification deleted successfully');
                        loadNotificationsData();
                    } else {
                        toastr.error(response.message || 'Failed to delete notification');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while deleting notification');
                }
            });
        }

        // Send notification
        $('#send-notification').on('click', function() {
            const notificationData = {
                title: $('#notification-title').val().trim(),
                message: $('#notification-message').val().trim(),
                type: $('#notification-type').val(),
                target: $('#notification-target').val(),
                users: $('#notification-target').val() === 'specific' ? $('#notification-users').val() : null
            };
            
            if (!notificationData.title || !notificationData.message) {
                toastr.warning('Please fill in all required fields');
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/notifications',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(notificationData),
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success('Notification sent successfully');
                        $('#notification-modal').removeClass('show');
                        $('#notification-form')[0].reset();
                        loadNotificationsData();
                    } else {
                        toastr.error(response.message || 'Failed to send notification');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while sending notification');
                }
            });
        });

        // Load users for notification targeting
        function loadUsersForNotification() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/users',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        const select = $('#notification-users');
                        select.empty();
                        
                        response.data.forEach(user => {
                            select.append(new Option(`${user.name} (${user.email})`, user.id));
                        });
                        
                        select.trigger('change');
                    }
                }
            });
        }

        // Load settings data
        function loadSettingsData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/settings',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateSettingsForm(response.data);
                    } else {
                        toastr.error(response.message || 'Failed to load settings');
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading settings');
                }
            });
        }

        // Populate settings form
        function populateSettingsForm(settings) {
            // General settings
            $('#site-name').val(settings.siteName);
            $('#site-url').val(settings.siteUrl);
            $('#site-email').val(settings.siteEmail);
            $('#site-currency').val(settings.siteCurrency).trigger('change');
            $('#site-timezone').val(settings.siteTimezone).trigger('change');
            
            // Payment settings
            $('#pm-crypto').prop('checked', settings.paymentMethods.includes('crypto'));
            $('#pm-bank').prop('checked', settings.paymentMethods.includes('bank'));
            $('#pm-card').prop('checked', settings.paymentMethods.includes('card'));
            $('#min-deposit').val(settings.minDeposit);
            $('#min-withdrawal').val(settings.minWithdrawal);
            $('#withdrawal-fee').val(settings.withdrawalFee);
            $('#btc-wallet').val(settings.btcWallet);
            $('#eth-wallet').val(settings.ethWallet);
        }

        // Save settings
        $('#save-settings-btn').on('click', function() {
            const settingsData = {
                siteName: $('#site-name').val().trim(),
                siteUrl: $('#site-url').val().trim(),
                siteEmail: $('#site-email').val().trim(),
                siteCurrency: $('#site-currency').val(),
                siteTimezone: $('#site-timezone').val(),
                paymentMethods: [
                    $('#pm-crypto').is(':checked') ? 'crypto' : null,
                    $('#pm-bank').is(':checked') ? 'bank' : null,
                    $('#pm-card').is(':checked') ? 'card' : null
                ].filter(Boolean),
                minDeposit: parseFloat($('#min-deposit').val()),
                minWithdrawal: parseFloat($('#min-withdrawal').val()),
                withdrawalFee: parseFloat($('#withdrawal-fee').val()),
                btcWallet: $('#btc-wallet').val().trim(),
                ethWallet: $('#eth-wallet').val().trim()
            };
            
            if (!settingsData.siteName || !settingsData.siteUrl || !settingsData.siteEmail) {
                toastr.warning('Please fill in all required fields');
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/settings',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(settingsData),
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success('Settings saved successfully');
                    } else {
                        toastr.error(response.message || 'Failed to save settings');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while saving settings');
                }
            });
        });

        // Load security data
        function loadSecurityData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/security',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateSecurityForm(response.data);
                    } else {
                        toastr.error(response.message || 'Failed to load security settings');
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading security settings');
                }
            });
        }

        // Populate security form
        function populateSecurityForm(security) {
            $('#enable-2fa').prop('checked', security.twoFactorEnabled);
            $('#enable-login-alerts').prop('checked', security.loginAlertsEnabled);
            $('#enable-ip-restriction').prop('checked', security.ipRestrictionEnabled);
            $('#session-timeout').val(security.sessionTimeout);
            $('#failed-login-attempts').val(security.failedLoginAttempts);
        }

        // Save security settings
        $('#save-security-btn').on('click', function() {
            const securityData = {
                twoFactorEnabled: $('#enable-2fa').is(':checked'),
                loginAlertsEnabled: $('#enable-login-alerts').is(':checked'),
                ipRestrictionEnabled: $('#enable-ip-restriction').is(':checked'),
                sessionTimeout: parseInt($('#session-timeout').val()),
                failedLoginAttempts: parseInt($('#failed-login-attempts').val())
            };
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/security',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(securityData),
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    hideLoading();
                    
                    if (response.status === 'success') {
                        toastr.success('Security settings saved successfully');
                    } else {
                        toastr.error(response.message || 'Failed to save security settings');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while saving security settings');
                }
            });
        });

        // Load logs data
        function loadLogsData() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/logs',
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateLogsTable(response.data);
                    } else {
                        toastr.error(response.message || 'Failed to load logs');
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading logs');
                }
            });
        }

        // Populate logs table
        function populateLogsTable(logs) {
            const tbody = $('#logs-table tbody');
            tbody.empty();
            
            logs.forEach(log => {
                const row = `
                    <tr>
                        <td>${log.id}</td>
                        <td>${log.type}</td>
                        <td>${log.action}</td>
                        <td>
                            ${log.user ? `
                            <div class="d-flex align-items-center">
                                <img src="${log.user.avatar || 'https://via.placeholder.com/40'}" alt="User" class="avatar-sm rounded-circle me-2">
                                <div>
                                    <div class="fw-bold">${log.user.name}</div>
                                    <div class="text-muted small">ID: ${log.user.id}</div>
                                </div>
                            </div>
                            ` : 'System'}
                        </td>
                        <td>${log.ipAddress}</td>
                        <td>${moment(log.timestamp).format('MMM D, YYYY h:mm A')}</td>
                        <td>${log.details.length > 50 ? log.details.substring(0, 50) + '...' : log.details}</td>
                    </tr>
                `;
                
                tbody.append(row);
            });
        }

        // Logs type tab change
        $('#logs-section .nav-tabs .nav-link').on('click', function(e) {
            e.preventDefault();
            
            // Update active tab
            $('#logs-section .nav-tabs .nav-link').removeClass('active');
            $(this).addClass('active');
            
            // Load logs with filter
            const type = $(this).data('type');
            loadFilteredLogs(type);
        });

        // Load filtered logs
        function loadFilteredLogs(type) {
            showLoading();
            
            const url = type === 'all' ? 
                'https://website-backendd-1.onrender.com/api/admin/logs' :
                `https://website-backendd-1.onrender.com/api/admin/logs/${type}`;
            
            $.ajax({
                url: url,
                type: 'GET',
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                success: function(response) {
                    if (response.status === 'success') {
                        populateLogsTable(response.data);
                    } else {
                        toastr.error(response.message || 'Failed to load logs');
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    const error = xhr.responseJSON || {};
                    toastr.error(error.message || 'An error occurred while loading logs');
                }
            });
        }

        // Initialize DataTables
        function initDataTables() {
            $('#users-table').DataTable({
                responsive: true,
                dom: '<"top"lf>rt<"bottom"ip>',
                language: {
                    search: '_INPUT_',
                    searchPlaceholder: 'Search users...'
                }
            });
            
            $('#investments-table').DataTable({
                responsive: true,
                dom: '<"top"lf>rt<"bottom"ip>',
                language: {
                    search: '_INPUT_',
                    searchPlaceholder: 'Search investments...'
                }
            });
            
            $('#transactions-table').DataTable({
                responsive: true,
                dom: '<"top"lf>rt<"bottom"ip>',
                language: {
                    search: '_INPUT_',
                    searchPlaceholder: 'Search transactions...'
                }
            });
            
            $('#withdrawals-table').DataTable({
                responsive: true,
                dom: '<"top"lf>rt<"bottom"ip>',
                language: {
                    search: '_INPUT_',
                    searchPlaceholder: 'Search withdrawals...'
                }
            });
            
            $('#promotions-table').DataTable({
                responsive: true,
                dom: '<"top"lf>rt<"bottom"ip>',
                language: {
                    search: '_INPUT_',
                    searchPlaceholder: 'Search promotions...'
                }
            });
            
            $('#tickets-table').DataTable({
                responsive: true,
                dom: '<"top"lf>rt<"bottom"ip>',
                language: {
                    search: '_INPUT_',
                    searchPlaceholder: 'Search tickets...'
                }
            });
            
            $('#notifications-table').DataTable({
                responsive: true,
                dom: '<"top"lf>rt<"bottom"ip>',
                language: {
                    search: '_INPUT_',
                    searchPlaceholder: 'Search notifications...'
                }
            });
            
            $('#logs-table').DataTable({
                responsive: true,
                dom: '<"top"lf>rt<"bottom"ip>',
                language: {
                    search: '_INPUT_',
                    searchPlaceholder: 'Search logs...'
                }
            });
            
            $('#sessions-table').DataTable({
                responsive: true,
                dom: '<"top"lf>rt<"bottom"ip>',
                language: {
                    search: '_INPUT_',
                    searchPlaceholder: 'Search sessions...'
                }
            });
        }

        // Get cookie by name
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
        }

        // Show loading overlay
        function showLoading() {
            $('#loading-overlay').show();
        }

        // Hide loading overlay
        function hideLoading() {
            $('#loading-overlay').hide();
        }
    </script>
</body>
</html>
