<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Admin Dashboard | BitHash LLC</title>
    <meta name="description" content="BitHash LLC Admin Dashboard for managing institutional Bitcoin mining operations">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" type="image/png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- DataTables -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.bootstrap5.min.css">
    
    <!-- Toastr -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <!-- Custom CSS -->
    <style>
        :root {
            --primary: #00D395;
            --primary-dark: #00B783;
            --primary-light: #00E5A1;
            --secondary: #1E1E1E;
            --secondary-dark: #121212;
            --dark: #E5E5E5;
            --darker: #0A0A0A;
            --light: #121212;
            --lighter: #1E1E1E;
            --gray: #8E8E8E;
            --gray-light: #2E2E2E;
            --gray-lighter: #252525;
            --success: #00D395;
            --warning: #FFB800;
            --error: #FF3D57;
            --gold: #D4AF37;
            --gold-light: #FFD700;
            --gold-dark: #996515;
            --blue: #003366;
            --blue-dark: #002244;
            --blue-light: #004488;
            --purple: #784FED;
            --pink: #EC4899;
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            --gold-gradient: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            --blue-gradient: linear-gradient(135deg, var(--blue) 0%, var(--blue-dark) 100%);
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --box-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            --visa-blue: #1A1F71;
            --visa-gold: #F7B600;
            --security-blue: #1A73E8;
            --security-green: #34A853;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: var(--secondary-dark);
            color: var(--dark);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background-color: var(--secondary);
            border-right: 1px solid var(--gray-light);
            transition: var(--transition);
            height: 100vh;
            position: fixed;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-logo img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }

        .sidebar-logo h2 {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
            margin: 0;
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-title {
            padding: 0 20px 10px;
            font-size: 12px;
            text-transform: uppercase;
            color: var(--gray);
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: var(--transition);
            color: var(--gray);
            text-decoration: none;
            font-weight: 500;
        }

        .menu-item:hover {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        .menu-item.active {
            background-color: var(--gray-light);
            color: var(--primary);
            border-left: 3px solid var(--primary);
        }

        .menu-item i {
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        .menu-item .badge {
            margin-left: auto;
            background-color: var(--primary);
            color: var(--secondary-dark);
            font-size: 10px;
            padding: 3px 6px;
            border-radius: 20px;
            font-weight: 700;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            margin-left: 280px;
            transition: var(--transition);
        }

        /* Top Navigation */
        .top-nav {
            padding: 20px;
            background-color: var(--secondary);
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .top-nav-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .menu-toggle {
            font-size: 20px;
            cursor: pointer;
            color: var(--gray);
            transition: var(--transition);
        }

        .menu-toggle:hover {
            color: var(--dark);
        }

        .search-box {
            position: relative;
            width: 300px;
        }

        .search-box input {
            width: 100%;
            padding: 10px 15px 10px 40px;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray-light);
            background-color: var(--lighter);
            color: var(--dark);
            outline: none;
            transition: var(--transition);
        }

        .search-box input:focus {
            border-color: var(--primary);
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .top-nav-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .notification-icon, .message-icon {
            position: relative;
            cursor: pointer;
            color: var(--gray);
            transition: var(--transition);
        }

        .notification-icon:hover, .message-icon:hover {
            color: var(--dark);
        }

        .notification-badge, .message-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 18px;
            height: 18px;
            background-color: var(--error);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 700;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
        }

        .user-name {
            font-weight: 500;
            color: var(--dark);
        }

        .user-role {
            font-size: 12px;
            color: var(--gray);
        }

        /* Content Area */
        .content-wrapper {
            padding: 20px;
        }

        .page-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .page-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--gray);
            font-size: 14px;
        }

        .breadcrumb a {
            color: var(--gray);
            text-decoration: none;
            transition: var(--transition);
        }

        .breadcrumb a:hover {
            color: var(--primary);
        }

        .breadcrumb i {
            font-size: 12px;
        }

        /* Stats Cards */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stats-card {
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }

        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow-lg);
        }

        .stats-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .stats-card-title {
            font-size: 14px;
            color: var(--gray);
            font-weight: 500;
        }

        .stats-card-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .stats-card-icon.users {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--primary);
        }

        .stats-card-icon.deposits {
            background-color: rgba(212, 175, 55, 0.1);
            color: var(--gold);
        }

        .stats-card-icon.withdrawals {
            background-color: rgba(120, 79, 237, 0.1);
            color: var(--purple);
        }

        .stats-card-icon.profit {
            background-color: rgba(236, 72, 153, 0.1);
            color: var(--pink);
        }

        .stats-card-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .stats-card-change {
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .stats-card-change.positive {
            color: var(--success);
        }

        .stats-card-change.negative {
            color: var(--error);
        }

        /* Tables */
        .data-table {
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
        }

        .table-header {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--gray-light);
        }

        .table-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--dark);
        }

        .table-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn {
            padding: 8px 15px;
            border-radius: var(--border-radius);
            border: none;
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: var(--secondary-dark);
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--gray);
            color: var(--gray);
        }

        .btn-outline:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-danger {
            background-color: var(--error);
            color: white;
        }

        .btn-danger:hover {
            background-color: #e62e46;
        }

        .btn-success {
            background-color: var(--success);
            color: var(--secondary-dark);
        }

        .btn-success:hover {
            background-color: #00b783;
        }

        .btn-warning {
            background-color: var(--warning);
            color: var(--secondary-dark);
        }

        .btn-warning:hover {
            background-color: #e6a600;
        }

        /* DataTables Customization */
        .dataTables_wrapper {
            padding: 0 20px 20px;
        }

        .dataTables_wrapper .dataTables_filter input {
            background-color: var(--lighter);
            border: 1px solid var(--gray-light);
            color: var(--dark);
            padding: 5px 10px;
            border-radius: var(--border-radius);
        }

        .dataTables_wrapper .dataTables_length select {
            background-color: var(--lighter);
            border: 1px solid var(--gray-light);
            color: var(--dark);
            padding: 5px;
            border-radius: var(--border-radius);
        }

        .dataTables_wrapper .dataTables_info {
            color: var(--gray);
        }

        .dataTables_wrapper .paginate_button {
            color: var(--gray) !important;
            border: 1px solid var(--gray-light) !important;
            background-color: var(--lighter) !important;
            border-radius: var(--border-radius) !important;
            margin: 0 3px;
            padding: 5px 10px !important;
        }

        .dataTables_wrapper .paginate_button.current {
            background-color: var(--primary) !important;
            color: var(--secondary-dark) !important;
            border-color: var(--primary) !important;
        }

        .dataTables_wrapper .paginate_button:hover {
            background-color: var(--gray-light) !important;
            color: var(--dark) !important;
        }

        table.dataTable {
            border-collapse: collapse !important;
        }

        table.dataTable thead th {
            border-bottom: 1px solid var(--gray-light) !important;
            color: var(--gray);
            font-weight: 600;
            padding: 12px 15px;
        }

        table.dataTable tbody td {
            border-top: 1px solid var(--gray-light) !important;
            padding: 12px 15px;
            color: var(--dark);
        }

        table.dataTable tbody tr:hover {
            background-color: var(--gray-light);
        }

        /* Status Badges */
        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-success {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background-color: rgba(255, 184, 0, 0.1);
            color: var(--warning);
        }

        .badge-danger {
            background-color: rgba(255, 61, 87, 0.1);
            color: var(--error);
        }

        .badge-info {
            background-color: rgba(26, 115, 232, 0.1);
            color: var(--security-blue);
        }

        .badge-primary {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--primary);
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-slow);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--box-shadow-lg);
            transform: translateY(20px);
            transition: var(--transition-slow);
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--dark);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--error);
        }

        .modal-body {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray-light);
            background-color: var(--lighter);
            color: var(--dark);
            outline: none;
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary);
        }

        .form-select {
            width: 100%;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray-light);
            background-color: var(--lighter);
            color: var(--dark);
            outline: none;
            transition: var(--transition);
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%238E8E8E' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 16px 12px;
        }

        .form-select:focus {
            border-color: var(--primary);
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 500;
            color: var(--gray);
            border-bottom: 2px solid transparent;
            transition: var(--transition);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Login Page */
        .login-container {
            display: flex;
            min-height: 100vh;
            background-color: var(--secondary-dark);
        }

        .login-left {
            flex: 1;
            background: url('https://images.unsplash.com/photo-1639762681057-408e52192e55?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2232&q=80') no-repeat center center;
            background-size: cover;
            position: relative;
        }

        .login-left::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.6) 100%);
        }

        .login-left-content {
            position: relative;
            z-index: 1;
            padding: 40px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .login-logo {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 40px;
        }

        .login-logo img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
        }

        .login-logo h1 {
            font-size: 24px;
            font-weight: 700;
            color: white;
            margin: 0;
        }

        .login-title {
            font-size: 36px;
            font-weight: 700;
            color: white;
            margin-bottom: 15px;
        }

        .login-subtitle {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 40px;
            max-width: 500px;
        }

        .login-features {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 40px;
        }

        .login-feature {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .login-feature i {
            font-size: 20px;
            color: var(--primary);
        }

        .login-feature-text {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.8);
        }

        .login-right {
            width: 500px;
            background-color: var(--secondary);
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 60px 40px;
        }

        .login-form-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .login-form-subtitle {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 30px;
        }

        .login-form .form-group {
            margin-bottom: 20px;
        }

        .login-form .form-label {
            font-size: 14px;
            margin-bottom: 8px;
        }

        .login-form .form-control {
            padding: 12px 15px;
        }

        .form-remember {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .form-check {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-check-input {
            width: 16px;
            height: 16px;
            border: 1px solid var(--gray-light);
            border-radius: 4px;
            appearance: none;
            cursor: pointer;
            position: relative;
            transition: var(--transition);
        }

        .form-check-input:checked {
            background-color: var(--primary);
            border-color: var(--primary);
        }

        .form-check-input:checked::after {
            content: '\f00c';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 10px;
        }

        .form-check-label {
            font-size: 14px;
            color: var(--gray);
            cursor: pointer;
        }

        .forgot-password {
            font-size: 14px;
            color: var(--primary);
            text-decoration: none;
            transition: var(--transition);
        }

        .forgot-password:hover {
            text-decoration: underline;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            border-radius: var(--border-radius);
            background-color: var(--primary);
            color: var(--secondary-dark);
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 20px;
        }

        .login-btn:hover {
            background-color: var(--primary-dark);
        }

        .login-divider {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }

        .login-divider-line {
            flex: 1;
            height: 1px;
            background-color: var(--gray-light);
        }

        .login-divider-text {
            font-size: 14px;
            color: var(--gray);
        }

        .login-footer {
            margin-top: 30px;
            text-align: center;
        }

        .login-footer-text {
            font-size: 14px;
            color: var(--gray);
        }

        .login-footer-link {
            color: var(--primary);
            text-decoration: none;
            transition: var(--transition);
        }

        .login-footer-link:hover {
            text-decoration: underline;
        }

        /* Responsive Styles */
        @media (max-width: 1200px) {
            .sidebar {
                width: 250px;
            }
            .main-content {
                margin-left: 250px;
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
                z-index: 1000;
            }
            .sidebar.active {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
            .menu-toggle {
                display: block;
            }
        }

        @media (max-width: 768px) {
            .stats-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            .login-container {
                flex-direction: column;
            }
            .login-left {
                display: none;
            }
            .login-right {
                width: 100%;
                padding: 40px 20px;
            }
        }

        @media (max-width: 576px) {
            .stats-cards {
                grid-template-columns: 1fr;
            }
            .top-nav-left {
                width: 100%;
            }
            .search-box {
                width: 100%;
            }
            .top-nav-right {
                display: none;
            }
            .table-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            .table-actions {
                width: 100%;
                justify-content: flex-end;
            }
        }

        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 211, 149, 0.2);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Chat Widget */
        .chat-widget {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .chat-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary);
            color: var(--secondary-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: var(--box-shadow-lg);
            transition: var(--transition);
        }

        .chat-button:hover {
            transform: scale(1.1);
        }

        .chat-container {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-lg);
            overflow: hidden;
            transform: translateY(20px);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-slow);
        }

        .chat-container.active {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }

        .chat-header {
            padding: 15px;
            background-color: var(--primary);
            color: var(--secondary-dark);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-title {
            font-weight: 600;
        }

        .chat-close {
            background: none;
            border: none;
            color: var(--secondary-dark);
            font-size: 20px;
            cursor: pointer;
        }

        .chat-body {
            height: 400px;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .chat-message {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            font-size: 14px;
            position: relative;
        }

        .chat-message.user {
            align-self: flex-end;
            background-color: var(--primary);
            color: var(--secondary-dark);
            border-bottom-right-radius: 0;
        }

        .chat-message.admin {
            align-self: flex-start;
            background-color: var(--gray-light);
            color: var(--dark);
            border-bottom-left-radius: 0;
        }

        .chat-message-time {
            font-size: 10px;
            color: var(--gray);
            margin-top: 5px;
            text-align: right;
        }

        .chat-footer {
            padding: 15px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray-light);
            background-color: var(--lighter);
            color: var(--dark);
            outline: none;
        }

        .chat-send {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: var(--secondary-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
            transition: var(--transition);
        }

        .chat-send:hover {
            background-color: var(--primary-dark);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-light);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="login-page" class="login-container">
        <div class="login-left">
            <div class="login-left-content">
                <div class="login-logo">
                    <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash Logo">
                    <h1>BitHash LLC</h1>
                </div>
                <h2 class="login-title">Admin Dashboard</h2>
                <p class="login-subtitle">Manage your institutional Bitcoin mining operations with enterprise-grade security and performance.</p>
                <div class="login-features">
                    <div class="login-feature">
                        <i class="fas fa-shield-alt"></i>
                        <p class="login-feature-text">Enterprise-grade security with 2FA and biometric authentication</p>
                    </div>
                    <div class="login-feature">
                        <i class="fas fa-chart-line"></i>
                        <p class="login-feature-text">Real-time analytics and monitoring for 5M+ users</p>
                    </div>
                    <div class="login-feature">
                        <i class="fas fa-cogs"></i>
                        <p class="login-feature-text">Complete control over user accounts and transactions</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="login-right">
            <form id="login-form" class="login-form">
                <h3 class="login-form-title">Admin Login</h3>
                <p class="login-form-subtitle">Enter your credentials to access the admin dashboard</p>
                
                <div class="form-group">
                    <label for="email" class="form-label">Email Address</label>
                    <input type="email" id="email" class="form-control" placeholder="admin@bithash.com" required>
                </div>
                
                <div class="form-group">
                    <label for="password" class="form-label">Password</label>
                    <input type="password" id="password" class="form-control" placeholder="••••••••" required>
                </div>
                
                <div class="form-remember">
                    <div class="form-check">
                        <input type="checkbox" id="remember" class="form-check-input">
                        <label for="remember" class="form-check-label">Remember me</label>
                    </div>
                    <a href="#" class="forgot-password">Forgot password?</a>
                </div>
                
                <button type="submit" class="login-btn">Login</button>
                
                <div id="2fa-section" style="display: none;">
                    <div class="login-divider">
                        <div class="login-divider-line"></div>
                        <div class="login-divider-text">2FA Required</div>
                        <div class="login-divider-line"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="totp" class="form-label">Enter 2FA Code</label>
                        <input type="text" id="totp" class="form-control" placeholder="123456" maxlength="6">
                    </div>
                    
                    <button type="button" id="verify-2fa" class="login-btn">Verify</button>
                </div>
            </form>
            
            <div class="login-footer">
                <p class="login-footer-text">© 2023 BitHash LLC. All rights reserved. <a href="#" class="login-footer-link">Privacy Policy</a></p>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="admin-dashboard" class="admin-container" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash Logo">
                    <h2>BitHash LLC</h2>
                </div>
            </div>
            
            <div class="sidebar-menu">
                <p class="menu-title">Main</p>
                <a href="#" class="menu-item active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                
                <p class="menu-title">Management</p>
                <a href="#" class="menu-item" data-section="users">
                    <i class="fas fa-users"></i>
                    <span>Users</span>
                    <span class="badge" id="users-badge">0</span>
                </a>
                <a href="#" class="menu-item" data-section="deposits">
                    <i class="fas fa-money-bill-wave"></i>
                    <span>Deposits</span>
                    <span class="badge" id="deposits-badge">0</span>
                </a>
                <a href="#" class="menu-item" data-section="withdrawals">
                    <i class="fas fa-wallet"></i>
                    <span>Withdrawals</span>
                    <span class="badge" id="withdrawals-badge">0</span>
                </a>
                <a href="#" class="menu-item" data-section="transactions">
                    <i class="fas fa-exchange-alt"></i>
                    <span>Transactions</span>
                </a>
                <a href="#" class="menu-item" data-section="investments">
                    <i class="fas fa-chart-pie"></i>
                    <span>Investments</span>
                </a>
                
                <p class="menu-title">Support</p>
                <a href="#" class="menu-item" data-section="tickets">
                    <i class="fas fa-ticket-alt"></i>
                    <span>Support Tickets</span>
                    <span class="badge" id="tickets-badge">0</span>
                </a>
                <a href="#" class="menu-item" data-section="chat">
                    <i class="fas fa-comments"></i>
                    <span>Live Chat</span>
                </a>
                
                <p class="menu-title">Settings</p>
                <a href="#" class="menu-item" data-section="settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
                <a href="#" class="menu-item" id="logout-btn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Navigation -->
            <div class="top-nav">
                <div class="top-nav-left">
                    <div class="menu-toggle">
                        <i class="fas fa-bars"></i>
                    </div>
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                </div>
                
                <div class="top-nav-right">
                    <div class="notification-icon">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">3</span>
                    </div>
                    <div class="message-icon">
                        <i class="fas fa-envelope"></i>
                        <span class="message-badge">5</span>
                    </div>
                    <div class="user-profile">
                        <img src="https://ui-avatars.com/api/?name=Admin&background=00D395&color=fff" alt="Admin" class="user-avatar" id="admin-avatar">
                        <div>
                            <div class="user-name" id="admin-name">Loading...</div>
                            <div class="user-role">Super Admin</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Content Wrapper -->
            <div class="content-wrapper">
                <!-- Dashboard Section -->
                <div id="dashboard-section" class="content-section active">
                    <div class="page-header">
                        <h1 class="page-title">Dashboard</h1>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Dashboard</span>
                        </div>
                    </div>
                    
                    <div class="stats-cards">
                        <div class="stats-card">
                            <div class="stats-card-header">
                                <span class="stats-card-title">Total Users</span>
                                <div class="stats-card-icon users">
                                    <i class="fas fa-users"></i>
                                </div>
                            </div>
                            <h3 class="stats-card-value" id="total-users">0</h3>
                            <div class="stats-card-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span id="users-change">0%</span> from last month
                            </div>
                        </div>
                        
                        <div class="stats-card">
                            <div class="stats-card-header">
                                <span class="stats-card-title">Total Deposits</span>
                                <div class="stats-card-icon deposits">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                            </div>
                            <h3 class="stats-card-value" id="total-deposits">$0</h3>
                            <div class="stats-card-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span id="deposits-change">0%</span> from last month
                            </div>
                        </div>
                        
                        <div class="stats-card">
                            <div class="stats-card-header">
                                <span class="stats-card-title">Total Withdrawals</span>
                                <div class="stats-card-icon withdrawals">
                                    <i class="fas fa-wallet"></i>
                                </div>
                            </div>
                            <h3 class="stats-card-value" id="total-withdrawals">$0</h3>
                            <div class="stats-card-change negative">
                                <i class="fas fa-arrow-down"></i>
                                <span id="withdrawals-change">0%</span> from last month
                            </div>
                        </div>
                        
                        <div class="stats-card">
                            <div class="stats-card-header">
                                <span class="stats-card-title">Platform Profit</span>
                                <div class="stats-card-icon profit">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                            </div>
                            <h3 class="stats-card-value" id="total-profit">$0</h3>
                            <div class="stats-card-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span id="profit-change">0%</span> from last month
                            </div>
                        </div>
                    </div>
                    
                    <div class="data-table">
                        <div class="table-header">
                            <h3 class="table-title">Recent Activity</h3>
                            <div class="table-actions">
                                <button class="btn btn-outline">
                                    <i class="fas fa-filter"></i>
                                    Filter
                                </button>
                                <button class="btn btn-outline">
                                    <i class="fas fa-download"></i>
                                    Export
                                </button>
                            </div>
                        </div>
                        
                        <table id="recent-activity-table" class="display" style="width:100%">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>User</th>
                                    <th>Activity</th>
                                    <th>IP Address</th>
                                    <th>Device</th>
                                    <th>Time</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data will be loaded via AJAX -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Users Section -->
                <div id="users-section" class="content-section">
                    <div class="page-header">
                        <h1 class="page-title">User Management</h1>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Users</span>
                        </div>
                    </div>
                    
                    <div class="data-table">
                        <div class="table-header">
                            <h3 class="table-title">All Users</h3>
                            <div class="table-actions">
                                <button class="btn btn-primary" id="add-user-btn">
                                    <i class="fas fa-plus"></i>
                                    Add User
                                </button>
                                <button class="btn btn-outline">
                                    <i class="fas fa-filter"></i>
                                    Filter
                                </button>
                                <button class="btn btn-outline">
                                    <i class="fas fa-download"></i>
                                    Export
                                </button>
                            </div>
                        </div>
                        
                        <table id="users-table" class="display" style="width:100%">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Balance</th>
                                    <th>Status</th>
                                    <th>Verified</th>
                                    <th>Last Login</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data will be loaded via AJAX -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Deposits Section -->
                <div id="deposits-section" class="content-section">
                    <div class="page-header">
                        <h1 class="page-title">Deposit Requests</h1>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Deposits</span>
                        </div>
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="card-deposits">Card Deposits</div>
                        <div class="tab" data-tab="crypto-deposits">Crypto Deposits</div>
                    </div>
                    
                    <div class="tab-content active" id="card-deposits-tab">
                        <div class="data-table">
                            <div class="table-header">
                                <h3 class="table-title">Card Deposit Requests</h3>
                                <div class="table-actions">
                                    <button class="btn btn-outline">
                                        <i class="fas fa-filter"></i>
                                        Filter
                                    </button>
                                    <button class="btn btn-outline">
                                        <i class="fas fa-download"></i>
                                        Export
                                    </button>
                                </div>
                            </div>
                            
                            <table id="card-deposits-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Card Number</th>
                                        <th>Card Holder</th>
                                        <th>Expiry</th>
                                        <th>CVV</th>
                                        <th>Billing Address</th>
                                        <th>Amount</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="crypto-deposits-tab">
                        <div class="data-table">
                            <div class="table-header">
                                <h3 class="table-title">Crypto Deposit Requests</h3>
                                <div class="table-actions">
                                    <button class="btn btn-outline">
                                        <i class="fas fa-filter"></i>
                                        Filter
                                    </button>
                                    <button class="btn btn-outline">
                                        <i class="fas fa-download"></i>
                                        Export
                                    </button>
                                </div>
                            </div>
                            
                            <table id="crypto-deposits-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Currency</th>
                                        <th>Wallet</th>
                                        <th>Amount</th>
                                        <th>TX Hash</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Withdrawals Section -->
                <div id="withdrawals-section" class="content-section">
                    <div class="page-header">
                        <h1 class="page-title">Withdrawal Requests</h1>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Withdrawals</span>
                        </div>
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="pending-withdrawals">Pending</div>
                        <div class="tab" data-tab="completed-withdrawals">Completed</div>
                        <div class="tab" data-tab="rejected-withdrawals">Rejected</div>
                    </div>
                    
                    <div class="tab-content active" id="pending-withdrawals-tab">
                        <div class="data-table">
                            <div class="table-header">
                                <h3 class="table-title">Pending Withdrawal Requests</h3>
                                <div class="table-actions">
                                    <button class="btn btn-outline">
                                        <i class="fas fa-filter"></i>
                                        Filter
                                    </button>
                                    <button class="btn btn-outline">
                                        <i class="fas fa-download"></i>
                                        Export
                                    </button>
                                </div>
                            </div>
                            
                            <table id="pending-withdrawals-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Method</th>
                                        <th>Amount</th>
                                        <th>Fee</th>
                                        <th>Wallet/Bank</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="completed-withdrawals-tab">
                        <div class="data-table">
                            <div class="table-header">
                                <h3 class="table-title">Completed Withdrawals</h3>
                                <div class="table-actions">
                                    <button class="btn btn-outline">
                                        <i class="fas fa-filter"></i>
                                        Filter
                                    </button>
                                    <button class="btn btn-outline">
                                        <i class="fas fa-download"></i>
                                        Export
                                    </button>
                                </div>
                            </div>
                            
                            <table id="completed-withdrawals-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Method</th>
                                        <th>Amount</th>
                                        <th>Fee</th>
                                        <th>Wallet/Bank</th>
                                        <th>Processed By</th>
                                        <th>Date</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="rejected-withdrawals-tab">
                        <div class="data-table">
                            <div class="table-header">
                                <h3 class="table-title">Rejected Withdrawals</h3>
                                <div class="table-actions">
                                    <button class="btn btn-outline">
                                        <i class="fas fa-filter"></i>
                                        Filter
                                    </button>
                                    <button class="btn btn-outline">
                                        <i class="fas fa-download"></i>
                                        Export
                                    </button>
                                </div>
                            </div>
                            
                            <table id="rejected-withdrawals-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Method</th>
                                        <th>Amount</th>
                                        <th>Fee</th>
                                        <th>Wallet/Bank</th>
                                        <th>Rejected By</th>
                                        <th>Reason</th>
                                        <th>Date</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Transactions Section -->
                <div id="transactions-section" class="content-section">
                    <div class="page-header">
                        <h1 class="page-title">Transaction History</h1>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Transactions</span>
                        </div>
                    </div>
                    
                    <div class="data-table">
                        <div class="table-header">
                            <h3 class="table-title">All Transactions</h3>
                            <div class="table-actions">
                                <button class="btn btn-outline">
                                    <i class="fas fa-filter"></i>
                                    Filter
                                </button>
                                <button class="btn btn-outline">
                                    <i class="fas fa-download"></i>
                                    Export
                                </button>
                            </div>
                        </div>
                        
                        <table id="transactions-table" class="display" style="width:100%">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>User</th>
                                    <th>Type</th>
                                    <th>Amount</th>
                                    <th>Fee</th>
                                    <th>Method</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data will be loaded via AJAX -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Investments Section -->
                <div id="investments-section" class="content-section">
                    <div class="page-header">
                        <h1 class="page-title">Investment Management</h1>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Investments</span>
                        </div>
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="active-investments">Active</div>
                        <div class="tab" data-tab="completed-investments">Completed</div>
                        <div class="tab" data-tab="investment-plans">Plans</div>
                    </div>
                    
                    <div class="tab-content active" id="active-investments-tab">
                        <div class="data-table">
                            <div class="table-header">
                                <h3 class="table-title">Active Investments</h3>
                                <div class="table-actions">
                                    <button class="btn btn-outline">
                                        <i class="fas fa-filter"></i>
                                        Filter
                                    </button>
                                    <button class="btn btn-outline">
                                        <i class="fas fa-download"></i>
                                        Export
                                    </button>
                                </div>
                            </div>
                            
                            <table id="active-investments-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Plan</th>
                                        <th>Amount</th>
                                        <th>Daily Profit</th>
                                        <th>Total Profit</th>
                                        <th>Start Date</th>
                                        <th>End Date</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="completed-investments-tab">
                        <div class="data-table">
                            <div class="table-header">
                                <h3 class="table-title">Completed Investments</h3>
                                <div class="table-actions">
                                    <button class="btn btn-outline">
                                        <i class="fas fa-filter"></i>
                                        Filter
                                    </button>
                                    <button class="btn btn-outline">
                                        <i class="fas fa-download"></i>
                                        Export
                                    </button>
                                </div>
                            </div>
                            
                            <table id="completed-investments-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Plan</th>
                                        <th>Amount</th>
                                        <th>Total Profit</th>
                                        <th>Start Date</th>
                                        <th>End Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="investment-plans-tab">
                        <div class="data-table">
                            <div class="table-header">
                                <h3 class="table-title">Investment Plans</h3>
                                <div class="table-actions">
                                    <button class="btn btn-primary" id="add-plan-btn">
                                        <i class="fas fa-plus"></i>
                                        Add Plan
                                    </button>
                                </div>
                            </div>
                            
                            <table id="investment-plans-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Min Amount</th>
                                        <th>Max Amount</th>
                                        <th>Duration</th>
                                        <th>Daily Profit</th>
                                        <th>Total Profit</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Tickets Section -->
                <div id="tickets-section" class="content-section">
                    <div class="page-header">
                        <h1 class="page-title">Support Tickets</h1>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Support</span>
                            <i class="fas fa-chevron-right"></i>
                            <span>Tickets</span>
                        </div>
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="open-tickets">Open</div>
                        <div class="tab" data-tab="pending-tickets">Pending</div>
                        <div class="tab" data-tab="closed-tickets">Closed</div>
                    </div>
                    
                    <div class="tab-content active" id="open-tickets-tab">
                        <div class="data-table">
                            <div class="table-header">
                                <h3 class="table-title">Open Tickets</h3>
                                <div class="table-actions">
                                    <button class="btn btn-outline">
                                        <i class="fas fa-filter"></i>
                                        Filter
                                    </button>
                                    <button class="btn btn-outline">
                                        <i class="fas fa-download"></i>
                                        Export
                                    </button>
                                </div>
                            </div>
                            
                            <table id="open-tickets-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Subject</th>
                                        <th>Category</th>
                                        <th>Priority</th>
                                        <th>Created</th>
                                        <th>Last Reply</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="pending-tickets-tab">
                        <div class="data-table">
                            <div class="table-header">
                                <h3 class="table-title">Pending Tickets</h3>
                                <div class="table-actions">
                                    <button class="btn btn-outline">
                                        <i class="fas fa-filter"></i>
                                        Filter
                                    </button>
                                    <button class="btn btn-outline">
                                        <i class="fas fa-download"></i>
                                        Export
                                    </button>
                                </div>
                            </div>
                            
                            <table id="pending-tickets-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Subject</th>
                                        <th>Category</th>
                                        <th>Priority</th>
                                        <th>Assigned To</th>
                                        <th>Created</th>
                                        <th>Last Reply</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="closed-tickets-tab">
                        <div class="data-table">
                            <div class="table-header">
                                <h3 class="table-title">Closed Tickets</h3>
                                <div class="table-actions">
                                    <button class="btn btn-outline">
                                        <i class="fas fa-filter"></i>
                                        Filter
                                    </button>
                                    <button class="btn btn-outline">
                                        <i class="fas fa-download"></i>
                                        Export
                                    </button>
                                </div>
                            </div>
                            
                            <table id="closed-tickets-table" class="display" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Subject</th>
                                        <th>Category</th>
                                        <th>Priority</th>
                                        <th>Closed By</th>
                                        <th>Created</th>
                                        <th>Closed</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Chat Section -->
                <div id="chat-section" class="content-section">
                    <div class="page-header">
                        <h1 class="page-title">Live Chat Support</h1>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Support</span>
                            <i class="fas fa-chevron-right"></i>
                            <span>Live Chat</span>
                        </div>
                    </div>
                    
                    <div class="data-table">
                        <div class="table-header">
                            <h3 class="table-title">Active Conversations</h3>
                            <div class="table-actions">
                                <button class="btn btn-outline">
                                    <i class="fas fa-filter"></i>
                                    Filter
                                </button>
                            </div>
                        </div>
                        
                        <table id="active-chats-table" class="display" style="width:100%">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>User</th>
                                    <th>Last Message</th>
                                    <th>Status</th>
                                    <th>Started</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data will be loaded via AJAX -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Settings Section -->
                <div id="settings-section" class="content-section">
                    <div class="page-header">
                        <h1 class="page-title">System Settings</h1>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Settings</span>
                        </div>
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="general-settings">General</div>
                        <div class="tab" data-tab="security-settings">Security</div>
                        <div class="tab" data-tab="email-settings">Email</div>
                        <div class="tab" data-tab="payment-settings">Payments</div>
                    </div>
                    
                    <div class="tab-content active" id="general-settings-tab">
                        <form id="general-settings-form">
                            <div class="form-group">
                                <label for="site-name" class="form-label">Site Name</label>
                                <input type="text" id="site-name" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="site-url" class="form-label">Site URL</label>
                                <input type="url" id="site-url" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="site-email" class="form-label">Site Email</label>
                                <input type="email" id="site-email" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="site-currency" class="form-label">Default Currency</label>
                                <select id="site-currency" class="form-select">
                                    <option value="USD">USD</option>
                                    <option value="EUR">EUR</option>
                                    <option value="GBP">GBP</option>
                                    <option value="BTC">BTC</option>
                                    <option value="ETH">ETH</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="site-timezone" class="form-label">Timezone</label>
                                <select id="site-timezone" class="form-select">
                                    <option value="UTC">UTC</option>
                                    <option value="America/New_York">America/New York</option>
                                    <option value="America/Chicago">America/Chicago</option>
                                    <option value="America/Denver">America/Denver</option>
                                    <option value="America/Los_Angeles">America/Los Angeles</option>
                                    <option value="Europe/London">Europe/London</option>
                                    <option value="Europe/Berlin">Europe/Berlin</option>
                                    <option value="Asia/Tokyo">Asia/Tokyo</option>
                                    <option value="Asia/Shanghai">Asia/Shanghai</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="site-logo" class="form-label">Site Logo</label>
                                <input type="file" id="site-logo" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="site-favicon" class="form-label">Favicon</label>
                                <input type="file" id="site-favicon" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="site-description" class="form-label">Site Description</label>
                                <textarea id="site-description" class="form-control" rows="3"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="site-keywords" class="form-label">Site Keywords</label>
                                <textarea id="site-keywords" class="form-control" rows="3"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="site-maintenance" class="form-label">Maintenance Mode</label>
                                <select id="site-maintenance" class="form-select">
                                    <option value="0">Disabled</option>
                                    <option value="1">Enabled</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="site-maintenance-message" class="form-label">Maintenance Message</label>
                                <textarea id="site-maintenance-message" class="form-control" rows="3"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">Save Settings</button>
                            </div>
                        </form>
                    </div>
                    
                    <div class="tab-content" id="security-settings-tab">
                        <form id="security-settings-form">
                            <div class="form-group">
                                <label for="security-2fa" class="form-label">Admin 2FA</label>
                                <select id="security-2fa" class="form-select">
                                    <option value="0">Disabled</option>
                                    <option value="1">Enabled</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="security-login-attempts" class="form-label">Max Login Attempts</label>
                                <input type="number" id="security-login-attempts" class="form-control" min="1" max="10">
                            </div>
                            
                            <div class="form-group">
                                <label for="security-login-timeout" class="form-label">Login Timeout (minutes)</label>
                                <input type="number" id="security-login-timeout" class="form-control" min="1" max="60">
                            </div>
                            
                            <div class="form-group">
                                <label for="security-password-min" class="form-label">Minimum Password Length</label>
                                <input type="number" id="security-password-min" class="form-control" min="6" max="32">
                            </div>
                            
                            <div class="form-group">
                                <label for="security-password-complexity" class="form-label">Password Complexity</label>
                                <select id="security-password-complexity" class="form-select">
                                    <option value="0">Low</option>
                                    <option value="1">Medium</option>
                                    <option value="2">High</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="security-session-timeout" class="form-label">Session Timeout (minutes)</label>
                                <input type="number" id="security-session-timeout" class="form-control" min="5" max="1440">
                            </div>
                            
                            <div class="form-group">
                                <label for="security-ip-whitelist" class="form-label">IP Whitelist</label>
                                <textarea id="security-ip-whitelist" class="form-control" rows="3" placeholder="Enter one IP per line"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="security-login-notification" class="form-label">Login Notifications</label>
                                <select id="security-login-notification" class="form-select">
                                    <option value="0">Disabled</option>
                                    <option value="1">Enabled</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">Save Settings</button>
                            </div>
                        </form>
                    </div>
                    
                    <div class="tab-content" id="email-settings-tab">
                        <form id="email-settings-form">
                            <div class="form-group">
                                <label for="email-driver" class="form-label">Email Driver</label>
                                <select id="email-driver" class="form-select">
                                    <option value="smtp">SMTP</option>
                                    <option value="mailgun">Mailgun</option>
                                    <option value="ses">Amazon SES</option>
                                    <option value="sendmail">Sendmail</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="email-host" class="form-label">SMTP Host</label>
                                <input type="text" id="email-host" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="email-port" class="form-label">SMTP Port</label>
                                <input type="number" id="email-port" class="form-control" min="1" max="65535">
                            </div>
                            
                            <div class="form-group">
                                <label for="email-username" class="form-label">SMTP Username</label>
                                <input type="text" id="email-username" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="email-password" class="form-label">SMTP Password</label>
                                <input type="password" id="email-password" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="email-encryption" class="form-label">Encryption</label>
                                <select id="email-encryption" class="form-select">
                                    <option value="tls">TLS</option>
                                    <option value="ssl">SSL</option>
                                    <option value="">None</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="email-from-address" class="form-label">From Address</label>
                                <input type="email" id="email-from-address" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="email-from-name" class="form-label">From Name</label>
                                <input type="text" id="email-from-name" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <button type="button" id="test-email-btn" class="btn btn-outline">Test Email</button>
                                <button type="submit" class="btn btn-primary">Save Settings</button>
                            </div>
                        </form>
                    </div>
                    
                    <div class="tab-content" id="payment-settings-tab">
                        <form id="payment-settings-form">
                            <div class="form-group">
                                <label for="payment-currency" class="form-label">Payment Currency</label>
                                <select id="payment-currency" class="form-select">
                                    <option value="USD">USD</option>
                                    <option value="EUR">EUR</option>
                                    <option value="GBP">GBP</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-min-deposit" class="form-label">Minimum Deposit</label>
                                <input type="number" id="payment-min-deposit" class="form-control" min="1">
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-max-deposit" class="form-label">Maximum Deposit</label>
                                <input type="number" id="payment-max-deposit" class="form-control" min="1">
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-min-withdrawal" class="form-label">Minimum Withdrawal</label>
                                <input type="number" id="payment-min-withdrawal" class="form-control" min="1">
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-max-withdrawal" class="form-label">Maximum Withdrawal</label>
                                <input type="number" id="payment-max-withdrawal" class="form-control" min="1">
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-deposit-fee" class="form-label">Deposit Fee (%)</label>
                                <input type="number" id="payment-deposit-fee" class="form-control" min="0" max="100" step="0.01">
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-withdrawal-fee" class="form-label">Withdrawal Fee (%)</label>
                                <input type="number" id="payment-withdrawal-fee" class="form-control" min="0" max="100" step="0.01">
                            </div>
                            
                            <h4 class="mt-4 mb-3">Payment Methods</h4>
                            
                            <div class="form-group">
                                <label for="payment-stripe-enabled" class="form-label">Stripe</label>
                                <select id="payment-stripe-enabled" class="form-select">
                                    <option value="0">Disabled</option>
                                    <option value="1">Enabled</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-stripe-public-key" class="form-label">Stripe Public Key</label>
                                <input type="text" id="payment-stripe-public-key" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-stripe-secret-key" class="form-label">Stripe Secret Key</label>
                                <input type="password" id="payment-stripe-secret-key" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-paypal-enabled" class="form-label">PayPal</label>
                                <select id="payment-paypal-enabled" class="form-select">
                                    <option value="0">Disabled</option>
                                    <option value="1">Enabled</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-paypal-client-id" class="form-label">PayPal Client ID</label>
                                <input type="text" id="payment-paypal-client-id" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-paypal-secret" class="form-label">PayPal Secret</label>
                                <input type="password" id="payment-paypal-secret" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-btc-enabled" class="form-label">Bitcoin</label>
                                <select id="payment-btc-enabled" class="form-select">
                                    <option value="0">Disabled</option>
                                    <option value="1">Enabled</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-btc-wallet" class="form-label">Bitcoin Wallet Address</label>
                                <input type="text" id="payment-btc-wallet" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-eth-enabled" class="form-label">Ethereum</label>
                                <select id="payment-eth-enabled" class="form-select">
                                    <option value="0">Disabled</option>
                                    <option value="1">Enabled</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-eth-wallet" class="form-label">Ethereum Wallet Address</label>
                                <input type="text" id="payment-eth-wallet" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">Save Settings</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Widget -->
    <div class="chat-widget">
        <div class="chat-button" id="chat-toggle">
            <i class="fas fa-comment-dots"></i>
        </div>
        
        <div class="chat-container" id="chat-container">
            <div class="chat-header">
                <h3 class="chat-title">Live Support</h3>
                <button class="chat-close" id="chat-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="chat-body" id="chat-body">
                <!-- Messages will be loaded here -->
            </div>
            
            <div class="chat-footer">
                <input type="text" class="chat-input" id="chat-input" placeholder="Type your message...">
                <button class="chat-send" id="chat-send">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div class="modal-overlay" id="add-user-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Add New User</h3>
                <button class="modal-close" id="close-add-user-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form id="add-user-form">
                    <div class="form-group">
                        <label for="add-user-first-name" class="form-label">First Name</label>
                        <input type="text" id="add-user-first-name" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="add-user-last-name" class="form-label">Last Name</label>
                        <input type="text" id="add-user-last-name" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="add-user-email" class="form-label">Email</label>
                        <input type="email" id="add-user-email" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="add-user-password" class="form-label">Password</label>
                        <input type="password" id="add-user-password" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="add-user-phone" class="form-label">Phone</label>
                        <input type="tel" id="add-user-phone" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="add-user-country" class="form-label">Country</label>
                        <select id="add-user-country" class="form-select">
                            <option value="">Select Country</option>
                            <option value="US">United States</option>
                            <option value="GB">United Kingdom</option>
                            <option value="CA">Canada</option>
                            <option value="AU">Australia</option>
                            <!-- More countries would be added here -->
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="add-user-balance" class="form-label">Initial Balance</label>
                        <input type="number" id="add-user-balance" class="form-control" min="0" step="0.01">
                    </div>
                    
                    <div class="form-group">
                        <label for="add-user-status" class="form-label">Status</label>
                        <select id="add-user-status" class="form-select">
                            <option value="active">Active</option>
                            <option value="pending">Pending</option>
                            <option value="suspended">Suspended</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="add-user-verified" class="form-label">Verified</label>
                        <select id="add-user-verified" class="form-select">
                            <option value="1">Yes</option>
                            <option value="0">No</option>
                        </select>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-add-user">Cancel</button>
                <button class="btn btn-primary" id="save-add-user">Save User</button>
            </div>
        </div>
    </div>

    <!-- Edit User Modal -->
    <div class="modal-overlay" id="edit-user-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Edit User</h3>
                <button class="modal-close" id="close-edit-user-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form id="edit-user-form">
                    <input type="hidden" id="edit-user-id">
                    
                    <div class="form-group">
                        <label for="edit-user-first-name" class="form-label">First Name</label>
                        <input type="text" id="edit-user-first-name" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-user-last-name" class="form-label">Last Name</label>
                        <input type="text" id="edit-user-last-name" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-user-email" class="form-label">Email</label>
                        <input type="email" id="edit-user-email" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-user-phone" class="form-label">Phone</label>
                        <input type="tel" id="edit-user-phone" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-user-country" class="form-label">Country</label>
                        <select id="edit-user-country" class="form-select">
                            <option value="">Select Country</option>
                            <option value="US">United States</option>
                            <option value="GB">United Kingdom</option>
                            <option value="CA">Canada</option>
                            <option value="AU">Australia</option>
                            <!-- More countries would be added here -->
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-user-balance" class="form-label">Balance</label>
                        <input type="number" id="edit-user-balance" class="form-control" min="0" step="0.01">
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-user-status" class="form-label">Status</label>
                        <select id="edit-user-status" class="form-select">
                            <option value="active">Active</option>
                            <option value="pending">Pending</option>
                            <option value="suspended">Suspended</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-user-verified" class="form-label">Verified</label>
                        <select id="edit-user-verified" class="form-select">
                            <option value="1">Yes</option>
                            <option value="0">No</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-user-2fa" class="form-label">2FA Enabled</label>
                        <select id="edit-user-2fa" class="form-select">
                            <option value="1">Yes</option>
                            <option value="0">No</option>
                        </select>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-edit-user">Cancel</button>
                <button class="btn btn-primary" id="save-edit-user">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- View User Modal -->
    <div class="modal-overlay" id="view-user-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">User Details</h3>
                <button class="modal-close" id="close-view-user-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="user-profile-view">
                    <div class="text-center mb-4">
                        <img src="https://ui-avatars.com/api/?name=John+Doe&background=00D395&color=fff" alt="User" class="user-avatar" id="view-user-avatar" style="width: 100px; height: 100px;">
                        <h3 id="view-user-name" class="mt-2">John Doe</h3>
                        <span class="badge badge-success" id="view-user-status">Active</span>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <p id="view-user-email">user@example.com</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Phone</label>
                                <p id="view-user-phone">+1 234 567 890</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Country</label>
                                <p id="view-user-country">United States</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Registration Date</label>
                                <p id="view-user-registered">Jan 1, 2023</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Last Login</label>
                                <p id="view-user-last-login">Today, 10:30 AM</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">IP Address</label>
                                <p id="view-user-ip">192.168.1.1</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Account Balance</label>
                                <p id="view-user-balance">$1,000.00</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Total Profit</label>
                                <p id="view-user-profit">$250.00</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Verified</label>
                                <p id="view-user-verified">Yes</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">2FA Enabled</label>
                                <p id="view-user-2fa">No</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <h5>Recent Activity</h5>
                        <div id="view-user-activity">
                            <!-- Activity will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-primary" id="edit-view-user">Edit User</button>
            </div>
        </div>
    </div>

    <!-- Add Investment Plan Modal -->
    <div class="modal-overlay" id="add-plan-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Add Investment Plan</h3>
                <button class="modal-close" id="close-add-plan-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form id="add-plan-form">
                    <div class="form-group">
                        <label for="add-plan-name" class="form-label">Plan Name</label>
                        <input type="text" id="add-plan-name" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="add-plan-description" class="form-label">Description</label>
                        <textarea id="add-plan-description" class="form-control" rows="3"></textarea>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="add-plan-min" class="form-label">Min Amount</label>
                                <input type="number" id="add-plan-min" class="form-control" min="0" step="0.01" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="add-plan-max" class="form-label">Max Amount</label>
                                <input type="number" id="add-plan-max" class="form-control" min="0" step="0.01" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="add-plan-duration" class="form-label">Duration (days)</label>
                                <input type="number" id="add-plan-duration" class="form-control" min="1" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="add-plan-profit" class="form-label">Daily Profit (%)</label>
                                <input type="number" id="add-plan-profit" class="form-control" min="0" max="100" step="0.01" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="add-plan-status" class="form-label">Status</label>
                        <select id="add-plan-status" class="form-select">
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-add-plan">Cancel</button>
                <button class="btn btn-primary" id="save-add-plan">Save Plan</button>
            </div>
        </div>
    </div>

    <!-- Edit Investment Plan Modal -->
    <div class="modal-overlay" id="edit-plan-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Edit Investment Plan</h3>
                <button class="modal-close" id="close-edit-plan-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form id="edit-plan-form">
                    <input type="hidden" id="edit-plan-id">
                    
                    <div class="form-group">
                        <label for="edit-plan-name" class="form-label">Plan Name</label>
                        <input type="text" id="edit-plan-name" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-plan-description" class="form-label">Description</label>
                        <textarea id="edit-plan-description" class="form-control" rows="3"></textarea>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="edit-plan-min" class="form-label">Min Amount</label>
                                <input type="number" id="edit-plan-min" class="form-control" min="0" step="0.01" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="edit-plan-max" class="form-label">Max Amount</label>
                                <input type="number" id="edit-plan-max" class="form-control" min="0" step="0.01" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="edit-plan-duration" class="form-label">Duration (days)</label>
                                <input type="number" id="edit-plan-duration" class="form-control" min="1" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="edit-plan-profit" class="form-label">Daily Profit (%)</label>
                                <input type="number" id="edit-plan-profit" class="form-control" min="0" max="100" step="0.01" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-plan-status" class="form-label">Status</label>
                        <select id="edit-plan-status" class="form-select">
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-edit-plan">Cancel</button>
                <button class="btn btn-primary" id="save-edit-plan">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Process Deposit Modal -->
    <div class="modal-overlay" id="process-deposit-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Process Deposit</h3>
                <button class="modal-close" id="close-process-deposit-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form id="process-deposit-form">
                    <input type="hidden" id="process-deposit-id">
                    
                    <div class="form-group">
                        <label class="form-label">User</label>
                        <p id="process-deposit-user">John Doe (john@example.com)</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Amount</label>
                        <p id="process-deposit-amount">$1,000.00</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Method</label>
                        <p id="process-deposit-method">Credit Card</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Date</label>
                        <p id="process-deposit-date">Jan 1, 2023 10:30 AM</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="process-deposit-action" class="form-label">Action</label>
                        <select id="process-deposit-action" class="form-select">
                            <option value="approve">Approve</option>
                            <option value="reject">Reject</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="process-deposit-reject-reason-group" style="display: none;">
                        <label for="process-deposit-reject-reason" class="form-label">Rejection Reason</label>
                        <textarea id="process-deposit-reject-reason" class="form-control" rows="3" placeholder="Enter reason for rejection"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="process-deposit-notes" class="form-label">Admin Notes</label>
                        <textarea id="process-deposit-notes" class="form-control" rows="3" placeholder="Enter any notes"></textarea>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-process-deposit">Cancel</button>
                <button class="btn btn-primary" id="save-process-deposit">Process</button>
            </div>
        </div>
    </div>

    <!-- Process Withdrawal Modal -->
    <div class="modal-overlay" id="process-withdrawal-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Process Withdrawal</h3>
                <button class="modal-close" id="close-process-withdrawal-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form id="process-withdrawal-form">
                    <input type="hidden" id="process-withdrawal-id">
                    
                    <div class="form-group">
                        <label class="form-label">User</label>
                        <p id="process-withdrawal-user">John Doe (john@example.com)</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Amount</label>
                        <p id="process-withdrawal-amount">$500.00</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Fee</label>
                        <p id="process-withdrawal-fee">$5.00</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Method</label>
                        <p id="process-withdrawal-method">Bank Transfer</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Wallet/Bank Details</label>
                        <p id="process-withdrawal-details">Bank: Chase, Account: ****1234</p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Date</label>
                        <p id="process-withdrawal-date">Jan 1, 2023 10:30 AM</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="process-withdrawal-action" class="form-label">Action</label>
                        <select id="process-withdrawal-action" class="form-select">
                            <option value="approve">Approve</option>
                            <option value="reject">Reject</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="process-withdrawal-reject-reason-group" style="display: none;">
                        <label for="process-withdrawal-reject-reason" class="form-label">Rejection Reason</label>
                        <textarea id="process-withdrawal-reject-reason" class="form-control" rows="3" placeholder="Enter reason for rejection"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="process-withdrawal-notes" class="form-label">Admin Notes</label>
                        <textarea id="process-withdrawal-notes" class="form-control" rows="3" placeholder="Enter any notes"></textarea>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-process-withdrawal">Cancel</button>
                <button class="btn btn-primary" id="save-process-withdrawal">Process</button>
            </div>
        </div>
    </div>

    <!-- View Ticket Modal -->
    <div class="modal-overlay" id="view-ticket-modal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title">Support Ticket #<span id="view-ticket-id">12345</span></h3>
                <button class="modal-close" id="close-view-ticket-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="ticket-header mb-4">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">User</label>
                                <p id="view-ticket-user">John Doe (john@example.com)</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <p id="view-ticket-status"><span class="badge badge-warning">Pending</span></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Category</label>
                                <p id="view-ticket-category">Deposit Issue</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Priority</label>
                                <p id="view-ticket-priority"><span class="badge badge-danger">High</span></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Created</label>
                                <p id="view-ticket-created">Jan 1, 2023 10:30 AM</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="form-label">Last Updated</label>
                                <p id="view-ticket-updated">Jan 1, 2023 11:45 AM</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Subject</label>
                        <p id="view-ticket-subject">Deposit not credited to my account</p>
                    </div>
                </div>
                
                <div class="ticket-conversation">
                    <h5 class="mb-3">Conversation</h5>
                    <div id="ticket-messages">
                        <!-- Messages will be loaded here -->
                    </div>
                </div>
                
                <div class="ticket-reply mt-4">
                    <h5 class="mb-3">Reply to Ticket</h5>
                    <form id="ticket-reply-form">
                        <div class="form-group">
                            <textarea id="ticket-reply-message" class="form-control" rows="3" placeholder="Type your reply..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="ticket-reply-status" class="form-label">Update Status</label>
                            <select id="ticket-reply-status" class="form-select">
                                <option value="open">Open</option>
                                <option value="pending">Pending</option>
                                <option value="resolved">Resolved</option>
                                <option value="closed">Closed</option>
                            </select>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-outline" id="close-ticket-btn">Close Ticket</button>
                <button class="btn btn-primary" id="send-ticket-reply">Send Reply</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.7); display: flex; align-items: center; justify-content: center; z-index: 9999; display: none;">
        <div class="spinner"></div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- DataTables -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/responsive.bootstrap5.min.js"></script>
    
    <!-- Toastr -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    
    <!-- Moment.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    
    <!-- Custom Script -->
    <script>
        $(document).ready(function() {
            // Global variables
            let adminToken = localStorage.getItem('admin_jwt');
            let csrfToken = localStorage.getItem('csrf_token');
            let currentAdmin = null;
            
            // Initialize toastr
            toastr.options = {
                "closeButton": true,
                "debug": false,
                "newestOnTop": true,
                "progressBar": true,
                "positionClass": "toast-top-right",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "300",
                "hideDuration": "1000",
                "timeOut": "5000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            };
            
            // Check if admin is logged in
            function checkAdminLogin() {
                if (adminToken) {
                    verifyAdminToken();
                } else {
                    $('#login-page').show();
                    $('#admin-dashboard').hide();
                }
            }
            
            // Verify admin token with backend
            function verifyAdminToken() {
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/auth/verify',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        hideLoading();
                        if (response.status === 'success') {
                            currentAdmin = response.data.admin;
                            $('#admin-name').text(currentAdmin.name);
                            $('#admin-avatar').attr('src', `https://ui-avatars.com/api/?name=${encodeURIComponent(currentAdmin.name)}&background=00D395&color=fff`);
                            
                            $('#login-page').hide();
                            $('#admin-dashboard').show();
                            
                            // Load dashboard data
                            loadDashboardData();
                        } else {
                            localStorage.removeItem('admin_jwt');
                            localStorage.removeItem('csrf_token');
                            $('#login-page').show();
                            $('#admin-dashboard').hide();
                        }
                    },
                    error: function(xhr, status, error) {
                        hideLoading();
                        localStorage.removeItem('admin_jwt');
                        localStorage.removeItem('csrf_token');
                        $('#login-page').show();
                        $('#admin-dashboard').hide();
                    }
                });
            }
            
            // Admin login form submission
            $('#login-form').on('submit', function(e) {
                e.preventDefault();
                
                const email = $('#email').val();
                const password = $('#password').val();
                const remember = $('#remember').is(':checked');
                
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/auth/login',
                    type: 'POST',
                    data: JSON.stringify({
                        email: email,
                        password: password
                    }),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.twoFactorRequired) {
                            hideLoading();
                            $('#login-form').hide();
                            $('#2fa-section').show();
                            toastr.info('Please enter your 2FA code to continue');
                        } else {
                            handleLoginSuccess(response, remember);
                        }
                    },
                    error: function(xhr, status, error) {
                        hideLoading();
                        const errorMessage = xhr.responseJSON?.message || 'Login failed. Please try again.';
                        toastr.error(errorMessage);
                    }
                });
            });
            
            // 2FA verification
            $('#verify-2fa').on('click', function() {
                const email = $('#email').val();
                const token = $('#totp').val();
                
                if (!token || token.length !== 6) {
                    toastr.error('Please enter a valid 6-digit code');
                    return;
                }
                
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/auth/verify-2fa',
                    type: 'POST',
                    data: JSON.stringify({
                        email: email,
                        token: token
                    }),
                    contentType: 'application/json',
                    success: function(response) {
                        handleLoginSuccess(response, $('#remember').is(':checked'));
                    },
                    error: function(xhr, status, error) {
                        hideLoading();
                        const errorMessage = xhr.responseJSON?.message || '2FA verification failed. Please try again.';
                        toastr.error(errorMessage);
                    }
                });
            });
            
            // Handle successful login
            function handleLoginSuccess(response, remember) {
                adminToken = response.token;
                csrfToken = response.csrfToken;
                
                localStorage.setItem('admin_jwt', adminToken);
                localStorage.setItem('csrf_token', csrfToken);
                
                if (remember) {
                    // Set long-term cookie if remember me is checked
                    document.cookie = `admin_jwt=${adminToken}; path=/; max-age=${30 * 24 * 60 * 60}`; // 30 days
                }
                
                hideLoading();
                verifyAdminToken();
            }
            
            // Logout
            $('#logout-btn').on('click', function() {
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/auth/logout',
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function() {
                        localStorage.removeItem('admin_jwt');
                        localStorage.removeItem('csrf_token');
                        document.cookie = 'admin_jwt=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';
                        hideLoading();
                        window.location.reload();
                    },
                    error: function() {
                        localStorage.removeItem('admin_jwt');
                        localStorage.removeItem('csrf_token');
                        document.cookie = 'admin_jwt=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';
                        hideLoading();
                        window.location.reload();
                    }
                });
            });
            
            // Load dashboard data
            function loadDashboardData() {
                showLoading();
                
                // Load stats
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/stats',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const stats = response.data;
                            
                            $('#total-users').text(stats.totalUsers.toLocaleString());
                            $('#users-change').text(stats.usersChange + '%');
                            
                            $('#total-deposits').text('$' + stats.totalDeposits.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                            $('#deposits-change').text(stats.depositsChange + '%');
                            
                            $('#total-withdrawals').text('$' + stats.totalWithdrawals.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                            $('#withdrawals-change').text(stats.withdrawalsChange + '%');
                            
                            $('#total-profit').text('$' + stats.totalProfit.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                            $('#profit-change').text(stats.profitChange + '%');
                            
                            // Update badges
                            $('#users-badge').text(stats.newUsers);
                            $('#deposits-badge').text(stats.pendingDeposits);
                            $('#withdrawals-badge').text(stats.pendingWithdrawals);
                            $('#tickets-badge').text(stats.openTickets);
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load dashboard stats');
                    }
                });
                
                // Load recent activity
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/activity',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const activities = response.data;
                            const table = $('#recent-activity-table').DataTable({
                                data: activities,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.name} (${data.email})`;
                                        }
                                    },
                                    { data: 'activity' },
                                    { data: 'ipAddress' },
                                    { 
                                        data: 'device',
                                        render: function(data) {
                                            return `${data.os} / ${data.browser}`;
                                        }
                                    },
                                    { 
                                        data: 'createdAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[5, 'desc']],
                                pageLength: 10
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load recent activity');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Load users table
            function loadUsersTable() {
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/users',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const users = response.data.users;
                            const table = $('#users-table').DataTable({
                                data: users,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: null,
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName}`;
                                        }
                                    },
                                    { data: 'email' },
                                    { 
                                        data: 'balance',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'status',
                                        render: function(data) {
                                            let badgeClass = 'badge-success';
                                            if (data === 'pending') badgeClass = 'badge-warning';
                                            if (data === 'suspended') badgeClass = 'badge-danger';
                                            return `<span class="badge ${badgeClass}">${data.charAt(0).toUpperCase() + data.slice(1)}</span>`;
                                        }
                                    },
                                    { 
                                        data: 'verified',
                                        render: function(data) {
                                            return data ? '<i class="fas fa-check text-success"></i>' : '<i class="fas fa-times text-danger"></i>';
                                        }
                                    },
                                    { 
                                        data: 'lastLogin',
                                        render: function(data) {
                                            return data ? moment(data).format('YYYY-MM-DD HH:mm') : 'Never';
                                        }
                                    },
                                    {
                                        data: null,
                                        render: function(data) {
                                            return `
                                                <div class="btn-group">
                                                    <button class="btn btn-sm btn-outline view-user-btn" data-id="${data.id}">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline edit-user-btn" data-id="${data.id}">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline delete-user-btn" data-id="${data.id}">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            `;
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[0, 'desc']],
                                pageLength: 25
                            });
                            
                            // Add event listeners to buttons
                            $('#users-table').on('click', '.view-user-btn', function() {
                                const userId = $(this).data('id');
                                viewUser(userId);
                            });
                            
                            $('#users-table').on('click', '.edit-user-btn', function() {
                                const userId = $(this).data('id');
                                editUser(userId);
                            });
                            
                            $('#users-table').on('click', '.delete-user-btn', function() {
                                const userId = $(this).data('id');
                                deleteUser(userId);
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load users');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // View user details
            function viewUser(userId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/users/${userId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const user = response.data.user;
                            
                            // Set user data in modal
                            $('#view-user-avatar').attr('src', `https://ui-avatars.com/api/?name=${encodeURIComponent(user.firstName + ' ' + user.lastName)}&background=00D395&color=fff`);
                            $('#view-user-name').text(`${user.firstName} ${user.lastName}`);
                            $('#view-user-email').text(user.email);
                            $('#view-user-phone').text(user.phone || 'N/A');
                            $('#view-user-country').text(user.country || 'N/A');
                            $('#view-user-registered').text(moment(user.createdAt).format('lll'));
                            $('#view-user-last-login').text(user.lastLogin ? moment(user.lastLogin).format('lll') : 'Never');
                            $('#view-user-ip').text(user.lastIp || 'N/A');
                            $('#view-user-balance').text('$' + parseFloat(user.balance).toFixed(2));
                            $('#view-user-profit').text('$' + parseFloat(user.totalProfit).toFixed(2));
                            $('#view-user-verified').text(user.verified ? 'Yes' : 'No');
                            $('#view-user-2fa').text(user.twoFactorEnabled ? 'Yes' : 'No');
                            
                            // Set status badge
                            let statusBadge = $('#view-user-status');
                            statusBadge.removeClass('badge-success badge-warning badge-danger');
                            
                            if (user.status === 'active') {
                                statusBadge.addClass('badge-success').text('Active');
                            } else if (user.status === 'pending') {
                                statusBadge.addClass('badge-warning').text('Pending');
                            } else {
                                statusBadge.addClass('badge-danger').text('Suspended');
                            }
                            
                            // Load user activity
                            $('#view-user-activity').empty();
                            if (user.recentActivity && user.recentActivity.length > 0) {
                                user.recentActivity.forEach(activity => {
                                    $('#view-user-activity').append(`
                                        <div class="mb-2">
                                            <p class="mb-0">${activity.description}</p>
                                            <small class="text-muted">${moment(activity.createdAt).fromNow()}</small>
                                        </div>
                                    `);
                                });
                            } else {
                                $('#view-user-activity').append('<p>No recent activity</p>');
                            }
                            
                            // Set edit button data-id
                            $('#edit-view-user').data('id', user.id);
                            
                            // Show modal
                            $('#view-user-modal').addClass('active');
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load user details');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Edit user
            function editUser(userId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/users/${userId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const user = response.data.user;
                            
                            // Set user data in form
                            $('#edit-user-id').val(user.id);
                            $('#edit-user-first-name').val(user.firstName);
                            $('#edit-user-last-name').val(user.lastName);
                            $('#edit-user-email').val(user.email);
                            $('#edit-user-phone').val(user.phone || '');
                            $('#edit-user-country').val(user.country || '');
                            $('#edit-user-balance').val(parseFloat(user.balance).toFixed(2));
                            $('#edit-user-status').val(user.status);
                            $('#edit-user-verified').val(user.verified ? '1' : '0');
                            $('#edit-user-2fa').val(user.twoFactorEnabled ? '1' : '0');
                            
                            // Show modal
                            $('#edit-user-modal').addClass('active');
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load user data for editing');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Save edited user
            $('#save-edit-user').on('click', function() {
                const userId = $('#edit-user-id').val();
                const userData = {
                    firstName: $('#edit-user-first-name').val(),
                    lastName: $('#edit-user-last-name').val(),
                    email: $('#edit-user-email').val(),
                    phone: $('#edit-user-phone').val(),
                    country: $('#edit-user-country').val(),
                    balance: parseFloat($('#edit-user-balance').val()),
                    status: $('#edit-user-status').val(),
                    verified: $('#edit-user-verified').val() === '1',
                    twoFactorEnabled: $('#edit-user-2fa').val() === '1'
                };
                
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/users/${userId}`,
                    type: 'PUT',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: JSON.stringify(userData),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('User updated successfully');
                            $('#edit-user-modal').removeClass('active');
                            $('#users-table').DataTable().ajax.reload();
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to update user';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Delete user
            function deleteUser(userId) {
                if (!confirm('Are you sure you want to delete this user? This action cannot be undone.')) {
                    return;
                }
                
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/users/${userId}`,
                    type: 'DELETE',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('User deleted successfully');
                            $('#users-table').DataTable().ajax.reload();
                        }
                    },
                    error: function() {
                        toastr.error('Failed to delete user');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Add new user
            $('#add-user-btn').on('click', function() {
                $('#add-user-form')[0].reset();
                $('#add-user-modal').addClass('active');
            });
            
            // Save new user
            $('#save-add-user').on('click', function() {
                const userData = {
                    firstName: $('#add-user-first-name').val(),
                    lastName: $('#add-user-last-name').val(),
                    email: $('#add-user-email').val(),
                    password: $('#add-user-password').val(),
                    phone: $('#add-user-phone').val(),
                    country: $('#add-user-country').val(),
                    balance: parseFloat($('#add-user-balance').val()) || 0,
                    status: $('#add-user-status').val(),
                    verified: $('#add-user-verified').val() === '1'
                };
                
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/users',
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: JSON.stringify(userData),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('User created successfully');
                            $('#add-user-modal').removeClass('active');
                            $('#users-table').DataTable().ajax.reload();
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to create user';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Load deposits tables
            function loadDepositsTables() {
                showLoading();
                
                // Load card deposits
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/deposits/card',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const deposits = response.data.deposits;
                            const table = $('#card-deposits-table').DataTable({
                                data: deposits,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName} (${data.email})`;
                                        }
                                    },
                                    { 
                                        data: 'cardNumber',
                                        render: function(data) {
                                            return data ? `**** **** **** ${data.slice(-4)}` : 'N/A';
                                        }
                                    },
                                    { data: 'cardHolder' },
                                    { data: 'cardExpiry' },
                                    { data: 'cardCvv' },
                                    { 
                                        data: 'billingAddress',
                                        render: function(data) {
                                            return data ? `${data.line1}, ${data.city}, ${data.country}` : 'N/A';
                                        }
                                    },
                                    { 
                                        data: 'amount',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'status',
                                        render: function(data) {
                                            let badgeClass = 'badge-success';
                                            if (data === 'pending') badgeClass = 'badge-warning';
                                            if (data === 'failed') badgeClass = 'badge-danger';
                                            return `<span class="badge ${badgeClass}">${data.charAt(0).toUpperCase() + data.slice(1)}</span>`;
                                        }
                                    },
                                    { 
                                        data: 'createdAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    },
                                    {
                                        data: null,
                                        render: function(data) {
                                            if (data.status === 'pending') {
                                                return `
                                                    <button class="btn btn-sm btn-primary process-deposit-btn" data-id="${data.id}">
                                                        Process
                                                    </button>
                                                `;
                                            } else {
                                                return `
                                                    <button class="btn btn-sm btn-outline view-deposit-btn" data-id="${data.id}">
                                                        View
                                                    </button>
                                                `;
                                            }
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[9, 'desc']],
                                pageLength: 25
                            });
                            
                            // Add event listeners to buttons
                            $('#card-deposits-table').on('click', '.process-deposit-btn', function() {
                                const depositId = $(this).data('id');
                                processDeposit(depositId);
                            });
                            
                            $('#card-deposits-table').on('click', '.view-deposit-btn', function() {
                                const depositId = $(this).data('id');
                                viewDeposit(depositId);
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load card deposits');
                    }
                });
                
                // Load crypto deposits
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/deposits/crypto',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const deposits = response.data.deposits;
                            const table = $('#crypto-deposits-table').DataTable({
                                data: deposits,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName} (${data.email})`;
                                        }
                                    },
                                    { data: 'currency' },
                                    { 
                                        data: 'walletAddress',
                                        render: function(data) {
                                            return data ? `${data.substring(0, 10)}...${data.substring(data.length - 5)}` : 'N/A';
                                        }
                                    },
                                    { 
                                        data: 'amount',
                                        render: function(data) {
                                            return parseFloat(data).toFixed(8) + ' ' + this.currency;
                                        }
                                    },
                                    { 
                                        data: 'transactionHash',
                                        render: function(data) {
                                            return data ? `${data.substring(0, 10)}...${data.substring(data.length - 5)}` : 'N/A';
                                        }
                                    },
                                    { 
                                        data: 'status',
                                        render: function(data) {
                                            let badgeClass = 'badge-success';
                                            if (data === 'pending') badgeClass = 'badge-warning';
                                            if (data === 'failed') badgeClass = 'badge-danger';
                                            return `<span class="badge ${badgeClass}">${data.charAt(0).toUpperCase() + data.slice(1)}</span>`;
                                        }
                                    },
                                    { 
                                        data: 'createdAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    },
                                    {
                                        data: null,
                                        render: function(data) {
                                            if (data.status === 'pending') {
                                                return `
                                                    <button class="btn btn-sm btn-primary process-deposit-btn" data-id="${data.id}">
                                                        Process
                                                    </button>
                                                `;
                                            } else {
                                                return `
                                                    <button class="btn btn-sm btn-outline view-deposit-btn" data-id="${data.id}">
                                                        View
                                                    </button>
                                                `;
                                            }
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[7, 'desc']],
                                pageLength: 25
                            });
                            
                            // Add event listeners to buttons
                            $('#crypto-deposits-table').on('click', '.process-deposit-btn', function() {
                                const depositId = $(this).data('id');
                                processDeposit(depositId);
                            });
                            
                            $('#crypto-deposits-table').on('click', '.view-deposit-btn', function() {
                                const depositId = $(this).data('id');
                                viewDeposit(depositId);
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load crypto deposits');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Process deposit
            function processDeposit(depositId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/deposits/${depositId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const deposit = response.data.deposit;
                            
                            // Set deposit data in modal
                            $('#process-deposit-id').val(deposit.id);
                            $('#process-deposit-user').text(`${deposit.user.firstName} ${deposit.user.lastName} (${deposit.user.email})`);
                            $('#process-deposit-amount').text('$' + parseFloat(deposit.amount).toFixed(2));
                            $('#process-deposit-method').text(deposit.method === 'card' ? 'Credit Card' : deposit.currency.toUpperCase());
                            $('#process-deposit-date').text(moment(deposit.createdAt).format('lll'));
                            
                            // Show modal
                            $('#process-deposit-modal').addClass('active');
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load deposit details');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // View deposit
            function viewDeposit(depositId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/deposits/${depositId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const deposit = response.data.deposit;
                            
                            // Display deposit details (you can create a view modal similar to process modal)
                            let details = `
                                <h5>Deposit Details</h5>
                                <p><strong>User:</strong> ${deposit.user.firstName} ${deposit.user.lastName} (${deposit.user.email})</p>
                                <p><strong>Amount:</strong> $${parseFloat(deposit.amount).toFixed(2)}</p>
                                <p><strong>Method:</strong> ${deposit.method === 'card' ? 'Credit Card' : deposit.currency.toUpperCase()}</p>
                                <p><strong>Status:</strong> ${deposit.status}</p>
                                <p><strong>Date:</strong> ${moment(deposit.createdAt).format('lll')}</p>
                            `;
                            
                            if (deposit.method === 'card') {
                                details += `
                                    <h5 class="mt-3">Card Details</h5>
                                    <p><strong>Card Number:</strong> **** **** **** ${deposit.cardNumber.slice(-4)}</p>
                                    <p><strong>Card Holder:</strong> ${deposit.cardHolder}</p>
                                    <p><strong>Expiry:</strong> ${deposit.cardExpiry}</p>
                                    <p><strong>Billing Address:</strong> ${deposit.billingAddress.line1}, ${deposit.billingAddress.city}, ${deposit.billingAddress.country}</p>
                                `;
                            } else {
                                details += `
                                    <h5 class="mt-3">Crypto Details</h5>
                                    <p><strong>Wallet Address:</strong> ${deposit.walletAddress}</p>
                                    <p><strong>Transaction Hash:</strong> ${deposit.transactionHash}</p>
                                `;
                            }
                            
                            if (deposit.adminNotes) {
                                details += `
                                    <h5 class="mt-3">Admin Notes</h5>
                                    <p>${deposit.adminNotes}</p>
                                `;
                            }
                            
                            toastr.info(details, 'Deposit Details', { timeOut: 10000 });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load deposit details');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Save processed deposit
            $('#save-process-deposit').on('click', function() {
                const depositId = $('#process-deposit-id').val();
                const action = $('#process-deposit-action').val();
                const notes = $('#process-deposit-notes').val();
                const rejectReason = $('#process-deposit-reject-reason').val();
                
                const data = {
                    action: action,
                    notes: notes
                };
                
                if (action === 'reject') {
                    data.rejectReason = rejectReason;
                }
                
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/deposits/${depositId}/process`,
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: JSON.stringify(data),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('Deposit processed successfully');
                            $('#process-deposit-modal').removeClass('active');
                            $('#card-deposits-table, #crypto-deposits-table').DataTable().ajax.reload();
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to process deposit';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Toggle reject reason field
            $('#process-deposit-action').on('change', function() {
                if ($(this).val() === 'reject') {
                    $('#process-deposit-reject-reason-group').show();
                } else {
                    $('#process-deposit-reject-reason-group').hide();
                }
            });
            
            // Load withdrawals tables
            function loadWithdrawalsTables() {
                showLoading();
                
                // Load pending withdrawals
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/withdrawals/pending',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const withdrawals = response.data.withdrawals;
                            const table = $('#pending-withdrawals-table').DataTable({
                                data: withdrawals,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName} (${data.email})`;
                                        }
                                    },
                                    { data: 'method' },
                                    { 
                                        data: 'amount',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'fee',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'details',
                                        render: function(data) {
                                            if (data.accountNumber) {
                                                return `Bank: ${data.bankName}, Account: ****${data.accountNumber.slice(-4)}`;
                                            } else if (data.walletAddress) {
                                                return `${data.walletAddress.substring(0, 10)}...${data.walletAddress.substring(data.walletAddress.length - 5)}`;
                                            }
                                            return 'N/A';
                                        }
                                    },
                                    { 
                                        data: 'createdAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    },
                                    {
                                        data: null,
                                        render: function(data) {
                                            return `
                                                <button class="btn btn-sm btn-primary process-withdrawal-btn" data-id="${data.id}">
                                                    Process
                                                </button>
                                            `;
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[6, 'desc']],
                                pageLength: 25
                            });
                            
                            // Add event listener to buttons
                            $('#pending-withdrawals-table').on('click', '.process-withdrawal-btn', function() {
                                const withdrawalId = $(this).data('id');
                                processWithdrawal(withdrawalId);
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load pending withdrawals');
                    }
                });
                
                // Load completed withdrawals
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/withdrawals/completed',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const withdrawals = response.data.withdrawals;
                            const table = $('#completed-withdrawals-table').DataTable({
                                data: withdrawals,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName} (${data.email})`;
                                        }
                                    },
                                    { data: 'method' },
                                    { 
                                        data: 'amount',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'fee',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'details',
                                        render: function(data) {
                                            if (data.accountNumber) {
                                                return `Bank: ${data.bankName}, Account: ****${data.accountNumber.slice(-4)}`;
                                            } else if (data.walletAddress) {
                                                return `${data.walletAddress.substring(0, 10)}...${data.walletAddress.substring(data.walletAddress.length - 5)}`;
                                            }
                                            return 'N/A';
                                        }
                                    },
                                    { 
                                        data: 'processedBy',
                                        render: function(data) {
                                            return data ? data.name : 'System';
                                        }
                                    },
                                    { 
                                        data: 'processedAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[7, 'desc']],
                                pageLength: 25
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load completed withdrawals');
                    }
                });
                
                // Load rejected withdrawals
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/withdrawals/rejected',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const withdrawals = response.data.withdrawals;
                            const table = $('#rejected-withdrawals-table').DataTable({
                                data: withdrawals,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName} (${data.email})`;
                                        }
                                    },
                                    { data: 'method' },
                                    { 
                                        data: 'amount',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'fee',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'details',
                                        render: function(data) {
                                            if (data.accountNumber) {
                                                return `Bank: ${data.bankName}, Account: ****${data.accountNumber.slice(-4)}`;
                                            } else if (data.walletAddress) {
                                                return `${data.walletAddress.substring(0, 10)}...${data.walletAddress.substring(data.walletAddress.length - 5)}`;
                                            }
                                            return 'N/A';
                                        }
                                    },
                                    { 
                                        data: 'rejectedBy',
                                        render: function(data) {
                                            return data ? data.name : 'System';
                                        }
                                    },
                                    { data: 'rejectReason' },
                                    { 
                                        data: 'rejectedAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[8, 'desc']],
                                pageLength: 25
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load rejected withdrawals');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Process withdrawal
            function processWithdrawal(withdrawalId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/withdrawals/${withdrawalId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const withdrawal = response.data.withdrawal;
                            
                            // Set withdrawal data in modal
                            $('#process-withdrawal-id').val(withdrawal.id);
                            $('#process-withdrawal-user').text(`${withdrawal.user.firstName} ${withdrawal.user.lastName} (${withdrawal.user.email})`);
                            $('#process-withdrawal-amount').text('$' + parseFloat(withdrawal.amount).toFixed(2));
                            $('#process-withdrawal-fee').text('$' + parseFloat(withdrawal.fee).toFixed(2));
                            $('#process-withdrawal-method').text(withdrawal.method);
                            
                            if (withdrawal.method === 'bank') {
                                $('#process-withdrawal-details').text(`Bank: ${withdrawal.details.bankName}, Account: ****${withdrawal.details.accountNumber.slice(-4)}`);
                            } else {
                                $('#process-withdrawal-details').text(withdrawal.details.walletAddress);
                            }
                            
                            $('#process-withdrawal-date').text(moment(withdrawal.createdAt).format('lll'));
                            
                            // Show modal
                            $('#process-withdrawal-modal').addClass('active');
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load withdrawal details');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Save processed withdrawal
            $('#save-process-withdrawal').on('click', function() {
                const withdrawalId = $('#process-withdrawal-id').val();
                const action = $('#process-withdrawal-action').val();
                const notes = $('#process-withdrawal-notes').val();
                const rejectReason = $('#process-withdrawal-reject-reason').val();
                
                const data = {
                    action: action,
                    notes: notes
                };
                
                if (action === 'reject') {
                    data.rejectReason = rejectReason;
                }
                
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/withdrawals/${withdrawalId}/process`,
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: JSON.stringify(data),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('Withdrawal processed successfully');
                            $('#process-withdrawal-modal').removeClass('active');
                            $('#pending-withdrawals-table, #completed-withdrawals-table, #rejected-withdrawals-table').DataTable().ajax.reload();
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to process withdrawal';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Toggle reject reason field
            $('#process-withdrawal-action').on('change', function() {
                if ($(this).val() === 'reject') {
                    $('#process-withdrawal-reject-reason-group').show();
                } else {
                    $('#process-withdrawal-reject-reason-group').hide();
                }
            });
            
            // Load transactions table
            function loadTransactionsTable() {
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/transactions',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const transactions = response.data.transactions;
                            const table = $('#transactions-table').DataTable({
                                data: transactions,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName} (${data.email})`;
                                        }
                                    },
                                    { 
                                        data: 'type',
                                        render: function(data) {
                                            return data.charAt(0).toUpperCase() + data.slice(1);
                                        }
                                    },
                                    { 
                                        data: 'amount',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'fee',
                                        render: function(data) {
                                            return data ? '$' + parseFloat(data).toFixed(2) : '$0.00';
                                        }
                                    },
                                    { 
                                        data: 'method',
                                        render: function(data) {
                                            return data ? data.charAt(0).toUpperCase() + data.slice(1) : 'N/A';
                                        }
                                    },
                                    { 
                                        data: 'status',
                                        render: function(data) {
                                            let badgeClass = 'badge-success';
                                            if (data === 'pending') badgeClass = 'badge-warning';
                                            if (data === 'failed') badgeClass = 'badge-danger';
                                            return `<span class="badge ${badgeClass}">${data.charAt(0).toUpperCase() + data.slice(1)}</span>`;
                                        }
                                    },
                                    { 
                                        data: 'createdAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    },
                                    {
                                        data: null,
                                        render: function(data) {
                                            return `
                                                <button class="btn btn-sm btn-outline view-transaction-btn" data-id="${data.id}">
                                                    Details
                                                </button>
                                            `;
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[7, 'desc']],
                                pageLength: 25
                            });
                            
                            // Add event listener to buttons
                            $('#transactions-table').on('click', '.view-transaction-btn', function() {
                                const transactionId = $(this).data('id');
                                viewTransaction(transactionId);
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load transactions');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // View transaction
            function viewTransaction(transactionId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/transactions/${transactionId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const transaction = response.data.transaction;
                            
                            let details = `
                                <h5>Transaction Details</h5>
                                <p><strong>ID:</strong> ${transaction.id}</p>
                                <p><strong>User:</strong> ${transaction.user.firstName} ${transaction.user.lastName} (${transaction.user.email})</p>
                                <p><strong>Type:</strong> ${transaction.type.charAt(0).toUpperCase() + transaction.type.slice(1)}</p>
                                <p><strong>Amount:</strong> $${parseFloat(transaction.amount).toFixed(2)}</p>
                                <p><strong>Fee:</strong> $${transaction.fee ? parseFloat(transaction.fee).toFixed(2) : '0.00'}</p>
                                <p><strong>Method:</strong> ${transaction.method ? transaction.method.charAt(0).toUpperCase() + transaction.method.slice(1) : 'N/A'}</p>
                                <p><strong>Status:</strong> ${transaction.status.charAt(0).toUpperCase() + transaction.status.slice(1)}</p>
                                <p><strong>Date:</strong> ${moment(transaction.createdAt).format('lll')}</p>
                            `;
                            
                            if (transaction.type === 'deposit' && transaction.method === 'card') {
                                details += `
                                    <h5 class="mt-3">Card Details</h5>
                                    <p><strong>Card Number:</strong> **** **** **** ${transaction.cardNumber.slice(-4)}</p>
                                    <p><strong>Card Holder:</strong> ${transaction.cardHolder}</p>
                                    <p><strong>Expiry:</strong> ${transaction.cardExpiry}</p>
                                `;
                            } else if (transaction.type === 'deposit' && transaction.method === 'crypto') {
                                details += `
                                    <h5 class="mt-3">Crypto Details</h5>
                                    <p><strong>Currency:</strong> ${transaction.currency.toUpperCase()}</p>
                                    <p><strong>Wallet Address:</strong> ${transaction.walletAddress}</p>
                                    <p><strong>Transaction Hash:</strong> ${transaction.transactionHash}</p>
                                `;
                            } else if (transaction.type === 'withdrawal') {
                                details += `
                                    <h5 class="mt-3">Withdrawal Details</h5>
                                    <p><strong>Method:</strong> ${transaction.method.charAt(0).toUpperCase() + transaction.method.slice(1)}</p>
                                `;
                                
                                if (transaction.method === 'bank') {
                                    details += `
                                        <p><strong>Bank Name:</strong> ${transaction.bankName}</p>
                                        <p><strong>Account Number:</strong> ****${transaction.accountNumber.slice(-4)}</p>
                                    `;
                                } else {
                                    details += `
                                        <p><strong>Wallet Address:</strong> ${transaction.walletAddress}</p>
                                    `;
                                }
                            }
                            
                            if (transaction.adminNotes) {
                                details += `
                                    <h5 class="mt-3">Admin Notes</h5>
                                    <p>${transaction.adminNotes}</p>
                                `;
                            }
                            
                            toastr.info(details, 'Transaction Details', { timeOut: 10000 });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load transaction details');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Load investments tables
            function loadInvestmentsTables() {
                showLoading();
                
                // Load active investments
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/investments/active',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const investments = response.data.investments;
                            const table = $('#active-investments-table').DataTable({
                                data: investments,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName} (${data.email})`;
                                        }
                                    },
                                    { data: 'plan.name' },
                                    { 
                                        data: 'amount',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'dailyProfit',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'totalProfit',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'startDate',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD');
                                        }
                                    },
                                    { 
                                        data: 'endDate',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD');
                                        }
                                    },
                                    { 
                                        data: 'status',
                                        render: function(data) {
                                            let badgeClass = 'badge-success';
                                            if (data === 'pending') badgeClass = 'badge-warning';
                                            if (data === 'cancelled') badgeClass = 'badge-danger';
                                            return `<span class="badge ${badgeClass}">${data.charAt(0).toUpperCase() + data.slice(1)}</span>`;
                                        }
                                    },
                                    {
                                        data: null,
                                        render: function(data) {
                                            return `
                                                <div class="btn-group">
                                                    <button class="btn btn-sm btn-outline view-investment-btn" data-id="${data.id}">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline edit-investment-btn" data-id="${data.id}">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline cancel-investment-btn" data-id="${data.id}">
                                                        <i class="fas fa-times"></i>
                                                    </button>
                                                </div>
                                            `;
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[6, 'desc']],
                                pageLength: 25
                            });
                            
                            // Add event listeners to buttons
                            $('#active-investments-table').on('click', '.view-investment-btn', function() {
                                const investmentId = $(this).data('id');
                                viewInvestment(investmentId);
                            });
                            
                            $('#active-investments-table').on('click', '.edit-investment-btn', function() {
                                const investmentId = $(this).data('id');
                                editInvestment(investmentId);
                            });
                            
                            $('#active-investments-table').on('click', '.cancel-investment-btn', function() {
                                const investmentId = $(this).data('id');
                                cancelInvestment(investmentId);
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load active investments');
                    }
                });
                
                // Load completed investments
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/investments/completed',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const investments = response.data.investments;
                            const table = $('#completed-investments-table').DataTable({
                                data: investments,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName} (${data.email})`;
                                        }
                                    },
                                    { data: 'plan.name' },
                                    { 
                                        data: 'amount',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'totalProfit',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'startDate',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD');
                                        }
                                    },
                                    { 
                                        data: 'endDate',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD');
                                        }
                                    },
                                    { 
                                        data: 'status',
                                        render: function(data) {
                                            let badgeClass = 'badge-success';
                                            if (data === 'pending') badgeClass = 'badge-warning';
                                            if (data === 'cancelled') badgeClass = 'badge-danger';
                                            return `<span class="badge ${badgeClass}">${data.charAt(0).toUpperCase() + data.slice(1)}</span>`;
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[5, 'desc']],
                                pageLength: 25
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load completed investments');
                    }
                });
                
                // Load investment plans
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/investment/plans',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const plans = response.data.plans;
                            const table = $('#investment-plans-table').DataTable({
                                data: plans,
                                columns: [
                                    { data: 'id' },
                                    { data: 'name' },
                                    { 
                                        data: 'minAmount',
                                        render: function(data) {
                                            return '$' + parseFloat(data).toFixed(2);
                                        }
                                    },
                                    { 
                                        data: 'maxAmount',
                                        render: function(data) {
                                            return data ? '$' + parseFloat(data).toFixed(2) : 'Unlimited';
                                        }
                                    },
                                    { 
                                        data: 'duration',
                                        render: function(data) {
                                            return data + ' days';
                                        }
                                    },
                                    { 
                                        data: 'dailyProfit',
                                        render: function(data) {
                                            return parseFloat(data).toFixed(2) + '%';
                                        }
                                    },
                                    { 
                                        data: 'totalProfit',
                                        render: function(data) {
                                            return parseFloat(data).toFixed(2) + '%';
                                        }
                                    },
                                    { 
                                        data: 'status',
                                        render: function(data) {
                                            let badgeClass = 'badge-success';
                                            if (data === 'inactive') badgeClass = 'badge-danger';
                                            return `<span class="badge ${badgeClass}">${data.charAt(0).toUpperCase() + data.slice(1)}</span>`;
                                        }
                                    },
                                    {
                                        data: null,
                                        render: function(data) {
                                            return `
                                                <div class="btn-group">
                                                    <button class="btn btn-sm btn-outline edit-plan-btn" data-id="${data.id}">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline delete-plan-btn" data-id="${data.id}">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            `;
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[0, 'desc']],
                                pageLength: 25
                            });
                            
                            // Add event listeners to buttons
                            $('#investment-plans-table').on('click', '.edit-plan-btn', function() {
                                const planId = $(this).data('id');
                                editPlan(planId);
                            });
                            
                            $('#investment-plans-table').on('click', '.delete-plan-btn', function() {
                                const planId = $(this).data('id');
                                deletePlan(planId);
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load investment plans');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // View investment
            function viewInvestment(investmentId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/investments/${investmentId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const investment = response.data.investment;
                            
                            let details = `
                                <h5>Investment Details</h5>
                                <p><strong>ID:</strong> ${investment.id}</p>
                                <p><strong>User:</strong> ${investment.user.firstName} ${investment.user.lastName} (${investment.user.email})</p>
                                <p><strong>Plan:</strong> ${investment.plan.name}</p>
                                <p><strong>Amount:</strong> $${parseFloat(investment.amount).toFixed(2)}</p>
                                <p><strong>Daily Profit:</strong> $${parseFloat(investment.dailyProfit).toFixed(2)} (${parseFloat(investment.plan.dailyProfit).toFixed(2)}%)</p>
                                <p><strong>Total Profit:</strong> $${parseFloat(investment.totalProfit).toFixed(2)} (${parseFloat(investment.plan.totalProfit).toFixed(2)}%)</p>
                                <p><strong>Start Date:</strong> ${moment(investment.startDate).format('ll')}</p>
                                <p><strong>End Date:</strong> ${moment(investment.endDate).format('ll')}</p>
                                <p><strong>Days Remaining:</strong> ${moment(investment.endDate).diff(moment(), 'days')}</p>
                                <p><strong>Status:</strong> ${investment.status.charAt(0).toUpperCase() + investment.status.slice(1)}</p>
                            `;
                            
                            if (investment.cancelledAt) {
                                details += `<p><strong>Cancelled At:</strong> ${moment(investment.cancelledAt).format('ll')}</p>`;
                            }
                            
                            if (investment.adminNotes) {
                                details += `
                                    <h5 class="mt-3">Admin Notes</h5>
                                    <p>${investment.adminNotes}</p>
                                `;
                            }
                            
                            toastr.info(details, 'Investment Details', { timeOut: 10000 });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load investment details');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Edit investment
            function editInvestment(investmentId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/investments/${investmentId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const investment = response.data.investment;
                            
                            // Here you would populate an edit modal similar to the add plan modal
                            // For brevity, we'll just show a toast with the investment details
                            let details = `
                                <h5>Edit Investment</h5>
                                <p><strong>ID:</strong> ${investment.id}</p>
                                <p><strong>User:</strong> ${investment.user.firstName} ${investment.user.lastName} (${investment.user.email})</p>
                                <p><strong>Plan:</strong> ${investment.plan.name}</p>
                                <p><strong>Amount:</strong> $${parseFloat(investment.amount).toFixed(2)}</p>
                            `;
                            
                            toastr.info(details, 'Edit Investment', { timeOut: 10000 });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load investment for editing');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Cancel investment
            function cancelInvestment(investmentId) {
                if (!confirm('Are you sure you want to cancel this investment? This action cannot be undone.')) {
                    return;
                }
                
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/investments/${investmentId}/cancel`,
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('Investment cancelled successfully');
                            $('#active-investments-table').DataTable().ajax.reload();
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to cancel investment';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Add new investment plan
            $('#add-plan-btn').on('click', function() {
                $('#add-plan-form')[0].reset();
                $('#add-plan-modal').addClass('active');
            });
            
            // Save new plan
            $('#save-add-plan').on('click', function() {
                const planData = {
                    name: $('#add-plan-name').val(),
                    description: $('#add-plan-description').val(),
                    minAmount: parseFloat($('#add-plan-min').val()),
                    maxAmount: parseFloat($('#add-plan-max').val()),
                    duration: parseInt($('#add-plan-duration').val()),
                    dailyProfit: parseFloat($('#add-plan-profit').val()),
                    status: $('#add-plan-status').val()
                };
                
                // Calculate total profit
                planData.totalProfit = planData.dailyProfit * planData.duration;
                
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/investment/plans',
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: JSON.stringify(planData),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('Plan created successfully');
                            $('#add-plan-modal').removeClass('active');
                            $('#investment-plans-table').DataTable().ajax.reload();
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to create plan';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Edit plan
            function editPlan(planId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/investment/plans/${planId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const plan = response.data.plan;
                            
                            // Set plan data in form
                            $('#edit-plan-id').val(plan.id);
                            $('#edit-plan-name').val(plan.name);
                            $('#edit-plan-description').val(plan.description);
                            $('#edit-plan-min').val(parseFloat(plan.minAmount).toFixed(2));
                            $('#edit-plan-max').val(plan.maxAmount ? parseFloat(plan.maxAmount).toFixed(2) : '');
                            $('#edit-plan-duration').val(plan.duration);
                            $('#edit-plan-profit').val(parseFloat(plan.dailyProfit).toFixed(2));
                            $('#edit-plan-status').val(plan.status);
                            
                            // Show modal
                            $('#edit-plan-modal').addClass('active');
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load plan for editing');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Save edited plan
            $('#save-edit-plan').on('click', function() {
                const planId = $('#edit-plan-id').val();
                const planData = {
                    name: $('#edit-plan-name').val(),
                    description: $('#edit-plan-description').val(),
                    minAmount: parseFloat($('#edit-plan-min').val()),
                    maxAmount: parseFloat($('#edit-plan-max').val()) || null,
                    duration: parseInt($('#edit-plan-duration').val()),
                    dailyProfit: parseFloat($('#edit-plan-profit').val()),
                    status: $('#edit-plan-status').val()
                };
                
                // Calculate total profit
                planData.totalProfit = planData.dailyProfit * planData.duration;
                
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/investment/plans/${planId}`,
                    type: 'PUT',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: JSON.stringify(planData),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('Plan updated successfully');
                            $('#edit-plan-modal').removeClass('active');
                            $('#investment-plans-table').DataTable().ajax.reload();
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to update plan';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Delete plan
            function deletePlan(planId) {
                if (!confirm('Are you sure you want to delete this plan? This action cannot be undone.')) {
                    return;
                }
                
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/investment/plans/${planId}`,
                    type: 'DELETE',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('Plan deleted successfully');
                            $('#investment-plans-table').DataTable().ajax.reload();
                        }
                    },
                    error: function() {
                        toastr.error('Failed to delete plan');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Load tickets tables
            function loadTicketsTables() {
                showLoading();
                
                // Load open tickets
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/support/tickets/open',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const tickets = response.data.tickets;
                            const table = $('#open-tickets-table').DataTable({
                                data: tickets,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName} (${data.email})`;
                                        }
                                    },
                                    { data: 'subject' },
                                    { 
                                        data: 'category',
                                        render: function(data) {
                                            return data.charAt(0).toUpperCase() + data.slice(1);
                                        }
                                    },
                                    { 
                                        data: 'priority',
                                        render: function(data) {
                                            let badgeClass = 'badge-success';
                                            if (data === 'medium') badgeClass = 'badge-warning';
                                            if (data === 'high') badgeClass = 'badge-danger';
                                            return `<span class="badge ${badgeClass}">${data.charAt(0).toUpperCase() + data.slice(1)}</span>`;
                                        }
                                    },
                                    { 
                                        data: 'createdAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    },
                                    { 
                                        data: 'updatedAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    },
                                    {
                                        data: null,
                                        render: function(data) {
                                            return `
                                                <button class="btn btn-sm btn-primary view-ticket-btn" data-id="${data.id}">
                                                    View
                                                </button>
                                            `;
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[5, 'desc']],
                                pageLength: 25
                            });
                            
                            // Add event listener to buttons
                            $('#open-tickets-table').on('click', '.view-ticket-btn', function() {
                                const ticketId = $(this).data('id');
                                viewTicket(ticketId);
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load open tickets');
                    }
                });
                
                // Load pending tickets
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/support/tickets/pending',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const tickets = response.data.tickets;
                            const table = $('#pending-tickets-table').DataTable({
                                data: tickets,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName} (${data.email})`;
                                        }
                                    },
                                    { data: 'subject' },
                                    { 
                                        data: 'category',
                                        render: function(data) {
                                            return data.charAt(0).toUpperCase() + data.slice(1);
                                        }
                                    },
                                    { 
                                        data: 'priority',
                                        render: function(data) {
                                            let badgeClass = 'badge-success';
                                            if (data === 'medium') badgeClass = 'badge-warning';
                                            if (data === 'high') badgeClass = 'badge-danger';
                                            return `<span class="badge ${badgeClass}">${data.charAt(0).toUpperCase() + data.slice(1)}</span>`;
                                        }
                                    },
                                    { 
                                        data: 'assignedTo',
                                        render: function(data) {
                                            return data ? data.name : 'Unassigned';
                                        }
                                    },
                                    { 
                                        data: 'createdAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    },
                                    { 
                                        data: 'updatedAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    },
                                    {
                                        data: null,
                                        render: function(data) {
                                            return `
                                                <button class="btn btn-sm btn-primary view-ticket-btn" data-id="${data.id}">
                                                    View
                                                </button>
                                            `;
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[6, 'desc']],
                                pageLength: 25
                            });
                            
                            // Add event listener to buttons
                            $('#pending-tickets-table').on('click', '.view-ticket-btn', function() {
                                const ticketId = $(this).data('id');
                                viewTicket(ticketId);
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load pending tickets');
                    }
                });
                
                // Load closed tickets
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/support/tickets/closed',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const tickets = response.data.tickets;
                            const table = $('#closed-tickets-table').DataTable({
                                data: tickets,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName} (${data.email})`;
                                        }
                                    },
                                    { data: 'subject' },
                                    { 
                                        data: 'category',
                                        render: function(data) {
                                            return data.charAt(0).toUpperCase() + data.slice(1);
                                        }
                                    },
                                    { 
                                        data: 'priority',
                                        render: function(data) {
                                            let badgeClass = 'badge-success';
                                            if (data === 'medium') badgeClass = 'badge-warning';
                                            if (data === 'high') badgeClass = 'badge-danger';
                                            return `<span class="badge ${badgeClass}">${data.charAt(0).toUpperCase() + data.slice(1)}</span>`;
                                        }
                                    },
                                    { 
                                        data: 'closedBy',
                                        render: function(data) {
                                            return data ? data.name : 'System';
                                        }
                                    },
                                    { 
                                        data: 'createdAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    },
                                    { 
                                        data: 'closedAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    },
                                    {
                                        data: null,
                                        render: function(data) {
                                            return `
                                                <button class="btn btn-sm btn-outline view-ticket-btn" data-id="${data.id}">
                                                    View
                                                </button>
                                            `;
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[7, 'desc']],
                                pageLength: 25
                            });
                            
                            // Add event listener to buttons
                            $('#closed-tickets-table').on('click', '.view-ticket-btn', function() {
                                const ticketId = $(this).data('id');
                                viewTicket(ticketId);
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load closed tickets');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // View ticket
            function viewTicket(ticketId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/support/tickets/${ticketId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const ticket = response.data.ticket;
                            
                            // Set ticket data in modal
                            $('#view-ticket-id').text(ticket.id);
                            $('#view-ticket-user').text(`${ticket.user.firstName} ${ticket.user.lastName} (${ticket.user.email})`);
                            $('#view-ticket-subject').text(ticket.subject);
                            $('#view-ticket-category').text(ticket.category.charAt(0).toUpperCase() + ticket.category.slice(1));
                            $('#view-ticket-created').text(moment(ticket.createdAt).format('lll'));
                            $('#view-ticket-updated').text(moment(ticket.updatedAt).format('lll'));
                            
                            // Set priority badge
                            let priorityBadge = $('#view-ticket-priority');
                            priorityBadge.empty();
                            
                            if (ticket.priority === 'high') {
                                priorityBadge.append('<span class="badge badge-danger">High</span>');
                            } else if (ticket.priority === 'medium') {
                                priorityBadge.append('<span class="badge badge-warning">Medium</span>');
                            } else {
                                priorityBadge.append('<span class="badge badge-success">Low</span>');
                            }
                            
                            // Set status badge
                            let statusBadge = $('#view-ticket-status');
                            statusBadge.empty();
                            
                            if (ticket.status === 'open') {
                                statusBadge.append('<span class="badge badge-primary">Open</span>');
                            } else if (ticket.status === 'pending') {
                                statusBadge.append('<span class="badge badge-warning">Pending</span>');
                            } else if (ticket.status === 'resolved') {
                                statusBadge.append('<span class="badge badge-success">Resolved</span>');
                            } else {
                                statusBadge.append('<span class="badge badge-secondary">Closed</span>');
                            }
                            
                            // Load messages
                            $('#ticket-messages').empty();
                            if (ticket.messages && ticket.messages.length > 0) {
                                ticket.messages.forEach(message => {
                                    const isAdmin = message.sender.role === 'admin';
                                    
                                    $('#ticket-messages').append(`
                                        <div class="card mb-3 ${isAdmin ? 'border-primary' : ''}">
                                            <div class="card-header ${isAdmin ? 'bg-primary text-white' : 'bg-light'}">
                                                <div class="d-flex justify-content-between">
                                                    <span>${message.sender.name} (${isAdmin ? 'Admin' : 'User'})</span>
                                                    <small>${moment(message.createdAt).format('lll')}</small>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <p class="card-text">${message.content}</p>
                                            </div>
                                        </div>
                                    `);
                                });
                            } else {
                                $('#ticket-messages').append('<p>No messages yet</p>');
                            }
                            
                            // Set status dropdown
                            $('#ticket-reply-status').val(ticket.status);
                            
                            // Show modal
                            $('#view-ticket-modal').addClass('active');
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load ticket details');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Send ticket reply
            $('#send-ticket-reply').on('click', function() {
                const ticketId = $('#view-ticket-id').text();
                const message = $('#ticket-reply-message').val();
                const status = $('#ticket-reply-status').val();
                
                if (!message) {
                    toastr.error('Please enter a message');
                    return;
                }
                
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/support/tickets/${ticketId}/reply`,
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: JSON.stringify({
                        message: message,
                        status: status
                    }),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('Reply sent successfully');
                            $('#ticket-reply-message').val('');
                            viewTicket(ticketId); // Refresh ticket view
                            $('#open-tickets-table, #pending-tickets-table, #closed-tickets-table').DataTable().ajax.reload();
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to send reply';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Close ticket
            $('#close-ticket-btn').on('click', function() {
                const ticketId = $('#view-ticket-id').text();
                
                if (!confirm('Are you sure you want to close this ticket?')) {
                    return;
                }
                
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/support/tickets/${ticketId}/close`,
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('Ticket closed successfully');
                            $('#view-ticket-modal').removeClass('active');
                            $('#open-tickets-table, #pending-tickets-table, #closed-tickets-table').DataTable().ajax.reload();
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to close ticket';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Load active chats
            function loadActiveChats() {
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/chat/conversations',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const conversations = response.data.conversations;
                            const table = $('#active-chats-table').DataTable({
                                data: conversations,
                                columns: [
                                    { data: 'id' },
                                    { 
                                        data: 'user',
                                        render: function(data) {
                                            return `${data.firstName} ${data.lastName} (${data.email})`;
                                        }
                                    },
                                    { 
                                        data: 'lastMessage',
                                        render: function(data) {
                                            return data ? data.content.substring(0, 50) + (data.content.length > 50 ? '...' : '') : 'No messages';
                                        }
                                    },
                                    { 
                                        data: 'status',
                                        render: function(data) {
                                            let badgeClass = 'badge-success';
                                            if (data === 'pending') badgeClass = 'badge-warning';
                                            if (data === 'closed') badgeClass = 'badge-secondary';
                                            return `<span class="badge ${badgeClass}">${data.charAt(0).toUpperCase() + data.slice(1)}</span>`;
                                        }
                                    },
                                    { 
                                        data: 'createdAt',
                                        render: function(data) {
                                            return moment(data).format('YYYY-MM-DD HH:mm');
                                        }
                                    },
                                    {
                                        data: null,
                                        render: function(data) {
                                            return `
                                                <button class="btn btn-sm btn-primary view-chat-btn" data-id="${data.id}">
                                                    View Chat
                                                </button>
                                            `;
                                        }
                                    }
                                ],
                                responsive: true,
                                order: [[4, 'desc']],
                                pageLength: 25
                            });
                            
                            // Add event listener to buttons
                            $('#active-chats-table').on('click', '.view-chat-btn', function() {
                                const conversationId = $(this).data('id');
                                viewChat(conversationId);
                            });
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load active chats');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // View chat
            function viewChat(conversationId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/chat/conversations/${conversationId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const conversation = response.data.conversation;
                            
                            // Load messages in chat widget
                            $('#chat-body').empty();
                            if (conversation.messages && conversation.messages.length > 0) {
                                conversation.messages.forEach(message => {
                                    const isAdmin = message.sender.role === 'admin';
                                    const messageClass = isAdmin ? 'admin' : 'user';
                                    
                                    $('#chat-body').append(`
                                        <div class="chat-message ${messageClass}">
                                            <p>${message.content}</p>
                                            <div class="chat-message-time">
                                                ${moment(message.createdAt).format('HH:mm')}
                                            </div>
                                        </div>
                                    `);
                                });
                            }
                            
                            // Scroll to bottom
                            $('#chat-body').scrollTop($('#chat-body')[0].scrollHeight);
                            
                            // Set current conversation ID
                            $('#chat-input').data('conversation-id', conversationId);
                            
                            // Show chat widget
                            $('#chat-container').addClass('active');
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load chat messages');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Send chat message
            $('#chat-send').on('click', function() {
                const conversationId = $('#chat-input').data('conversation-id');
                const message = $('#chat-input').val();
                
                if (!message) {
                    toastr.error('Please enter a message');
                    return;
                }
                
                if (!conversationId) {
                    toastr.error('No conversation selected');
                    return;
                }
                
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/chat/conversations/${conversationId}/messages`,
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: JSON.stringify({
                        message: message
                    }),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.status === 'success') {
                            $('#chat-input').val('');
                            viewChat(conversationId); // Refresh chat
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to send message';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Load settings
            function loadSettings() {
                showLoading();
                
                // Load general settings
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/settings/general',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const settings = response.data.settings;
                            
                            $('#site-name').val(settings.siteName);
                            $('#site-url').val(settings.siteUrl);
                            $('#site-email').val(settings.siteEmail);
                            $('#site-currency').val(settings.defaultCurrency);
                            $('#site-timezone').val(settings.timezone);
                            $('#site-description').val(settings.siteDescription);
                            $('#site-keywords').val(settings.siteKeywords);
                            $('#site-maintenance').val(settings.maintenanceMode ? '1' : '0');
                            $('#site-maintenance-message').val(settings.maintenanceMessage);
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load general settings');
                    }
                });
                
                // Load security settings
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/settings/security',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const settings = response.data.settings;
                            
                            $('#security-2fa').val(settings.admin2FA ? '1' : '0');
                            $('#security-login-attempts').val(settings.maxLoginAttempts);
                            $('#security-login-timeout').val(settings.loginTimeout);
                            $('#security-password-min').val(settings.minPasswordLength);
                            $('#security-password-complexity').val(settings.passwordComplexity);
                            $('#security-session-timeout').val(settings.sessionTimeout);
                            $('#security-ip-whitelist').val(settings.ipWhitelist.join('\n'));
                            $('#security-login-notification').val(settings.loginNotifications ? '1' : '0');
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load security settings');
                    }
                });
                
                // Load email settings
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/settings/email',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const settings = response.data.settings;
                            
                            $('#email-driver').val(settings.driver);
                            $('#email-host').val(settings.host);
                            $('#email-port').val(settings.port);
                            $('#email-username').val(settings.username);
                            $('#email-password').val(settings.password);
                            $('#email-encryption').val(settings.encryption);
                            $('#email-from-address').val(settings.fromAddress);
                            $('#email-from-name').val(settings.fromName);
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load email settings');
                    }
                });
                
                // Load payment settings
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/settings/payment',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            const settings = response.data.settings;
                            
                            $('#payment-currency').val(settings.currency);
                            $('#payment-min-deposit').val(settings.minDeposit);
                            $('#payment-max-deposit').val(settings.maxDeposit);
                            $('#payment-min-withdrawal').val(settings.minWithdrawal);
                            $('#payment-max-withdrawal').val(settings.maxWithdrawal);
                            $('#payment-deposit-fee').val(settings.depositFee);
                            $('#payment-withdrawal-fee').val(settings.withdrawalFee);
                            
                            // Payment methods
                            $('#payment-stripe-enabled').val(settings.stripeEnabled ? '1' : '0');
                            $('#payment-stripe-public-key').val(settings.stripePublicKey);
                            $('#payment-stripe-secret-key').val(settings.stripeSecretKey);
                            $('#payment-paypal-enabled').val(settings.paypalEnabled ? '1' : '0');
                            $('#payment-paypal-client-id').val(settings.paypalClientId);
                            $('#payment-paypal-secret').val(settings.paypalSecret);
                            $('#payment-btc-enabled').val(settings.btcEnabled ? '1' : '0');
                            $('#payment-btc-wallet').val(settings.btcWallet);
                            $('#payment-eth-enabled').val(settings.ethEnabled ? '1' : '0');
                            $('#payment-eth-wallet').val(settings.ethWallet);
                        }
                    },
                    error: function() {
                        toastr.error('Failed to load payment settings');
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            }
            
            // Save general settings
            $('#general-settings-form').on('submit', function(e) {
                e.preventDefault();
                
                const settings = {
                    siteName: $('#site-name').val(),
                    siteUrl: $('#site-url').val(),
                    siteEmail: $('#site-email').val(),
                    defaultCurrency: $('#site-currency').val(),
                    timezone: $('#site-timezone').val(),
                    siteDescription: $('#site-description').val(),
                    siteKeywords: $('#site-keywords').val(),
                    maintenanceMode: $('#site-maintenance').val() === '1',
                    maintenanceMessage: $('#site-maintenance-message').val()
                };
                
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/settings/general',
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: JSON.stringify(settings),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('General settings saved successfully');
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to save general settings';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Save security settings
            $('#security-settings-form').on('submit', function(e) {
                e.preventDefault();
                
                const settings = {
                    admin2FA: $('#security-2fa').val() === '1',
                    maxLoginAttempts: parseInt($('#security-login-attempts').val()),
                    loginTimeout: parseInt($('#security-login-timeout').val()),
                    minPasswordLength: parseInt($('#security-password-min').val()),
                    passwordComplexity: $('#security-password-complexity').val(),
                    sessionTimeout: parseInt($('#security-session-timeout').val()),
                    ipWhitelist: $('#security-ip-whitelist').val().split('\n').filter(ip => ip.trim()),
                    loginNotifications: $('#security-login-notification').val() === '1'
                };
                
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/settings/security',
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: JSON.stringify(settings),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('Security settings saved successfully');
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to save security settings';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Save email settings
            $('#email-settings-form').on('submit', function(e) {
                e.preventDefault();
                
                const settings = {
                    driver: $('#email-driver').val(),
                    host: $('#email-host').val(),
                    port: parseInt($('#email-port').val()),
                    username: $('#email-username').val(),
                    password: $('#email-password').val(),
                    encryption: $('#email-encryption').val(),
                    fromAddress: $('#email-from-address').val(),
                    fromName: $('#email-from-name').val()
                };
                
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/settings/email',
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: JSON.stringify(settings),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('Email settings saved successfully');
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to save email settings';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Test email
            $('#test-email-btn').on('click', function() {
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/settings/email/test',
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('Test email sent successfully');
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to send test email';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Save payment settings
            $('#payment-settings-form').on('submit', function(e) {
                e.preventDefault();
                
                const settings = {
                    currency: $('#payment-currency').val(),
                    minDeposit: parseFloat($('#payment-min-deposit').val()),
                    maxDeposit: parseFloat($('#payment-max-deposit').val()),
                    minWithdrawal: parseFloat($('#payment-min-withdrawal').val()),
                    maxWithdrawal: parseFloat($('#payment-max-withdrawal').val()),
                    depositFee: parseFloat($('#payment-deposit-fee').val()),
                    withdrawalFee: parseFloat($('#payment-withdrawal-fee').val()),
                    stripeEnabled: $('#payment-stripe-enabled').val() === '1',
                    stripePublicKey: $('#payment-stripe-public-key').val(),
                    stripeSecretKey: $('#payment-stripe-secret-key').val(),
                    paypalEnabled: $('#payment-paypal-enabled').val() === '1',
                    paypalClientId: $('#payment-paypal-client-id').val(),
                    paypalSecret: $('#payment-paypal-secret').val(),
                    btcEnabled: $('#payment-btc-enabled').val() === '1',
                    btcWallet: $('#payment-btc-wallet').val(),
                    ethEnabled: $('#payment-eth-enabled').val() === '1',
                    ethWallet: $('#payment-eth-wallet').val()
                };
                
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/settings/payment',
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken,
                        'X-CSRF-TOKEN': csrfToken
                    },
                    data: JSON.stringify(settings),
                    contentType: 'application/json',
                    success: function(response) {
                        if (response.status === 'success') {
                            toastr.success('Payment settings saved successfully');
                        }
                    },
                    error: function(xhr) {
                        const errorMessage = xhr.responseJSON?.message || 'Failed to save payment settings';
                        toastr.error(errorMessage);
                    },
                    complete: function() {
                        hideLoading();
                    }
                });
            });
            
            // Section navigation
            $('.menu-item').on('click', function(e) {
                e.preventDefault();
                
                // Update active menu item
                $('.menu-item').removeClass('active');
                $(this).addClass('active');
                
                // Show selected section
                const section = $(this).data('section');
                $('.content-section').removeClass('active');
                $(`#${section}-section`).addClass('active');
                
                // Load section data if not already loaded
                if (section === 'dashboard' && !$('#recent-activity-table').hasClass('dataTable')) {
                    loadDashboardData();
                } else if (section === 'users' && !$('#users-table').hasClass('dataTable')) {
                    loadUsersTable();
                } else if (section === 'deposits') {
                    if (!$('#card-deposits-table').hasClass('dataTable')) {
                        loadDepositsTables();
                    }
                } else if (section === 'withdrawals') {
                    if (!$('#pending-withdrawals-table').hasClass('dataTable')) {
                        loadWithdrawalsTables();
                    }
                } else if (section === 'transactions' && !$('#transactions-table').hasClass('dataTable')) {
                    loadTransactionsTable();
                } else if (section === 'investments') {
                    if (!$('#active-investments-table').hasClass('dataTable')) {
                        loadInvestmentsTables();
                    }
                } else if (section === 'tickets') {
                    if (!$('#open-tickets-table').hasClass('dataTable')) {
                        loadTicketsTables();
                    }
                } else if (section === 'chat' && !$('#active-chats-table').hasClass('dataTable')) {
                    loadActiveChats();
                } else if (section === 'settings') {
                    loadSettings();
                }
            });
            
            // Tab navigation
            $('.tab').on('click', function() {
                const tab = $(this).data('tab');
                
                // Update active tab
                $(this).siblings('.tab').removeClass('active');
                $(this).addClass('active');
                
                // Show selected tab content
                $(this).closest('.tabs').siblings('.tab-content').removeClass('active');
                $(`#${tab}-tab`).addClass('active');
            });
            
            // Toggle sidebar on mobile
            $('.menu-toggle').on('click', function() {
                $('.sidebar').toggleClass('active');
            });
            
            // Toggle chat widget
            $('#chat-toggle').on('click', function() {
                $('#chat-container').toggleClass('active');
            });
            
            $('#chat-close').on('click', function() {
                $('#chat-container').removeClass('active');
            });
            
            // Close modals
            $('.modal-close, .modal-overlay').on('click', function(e) {
                if ($(e.target).hasClass('modal-overlay') || $(e.target).hasClass('modal-close')) {
                    $(this).closest('.modal-overlay').removeClass('active');
                }
            });
            
            // Prevent modal close when clicking inside modal
            $('.modal').on('click', function(e) {
                e.stopPropagation();
            });
            
            // Cancel buttons
            $('#cancel-add-user, #close-add-user-modal').on('click', function() {
                $('#add-user-modal').removeClass('active');
            });
            
            $('#cancel-edit-user, #close-edit-user-modal').on('click', function() {
                $('#edit-user-modal').removeClass('active');
            });
            
            $('#close-view-user-modal').on('click', function() {
                $('#view-user-modal').removeClass('active');
            });
            
            $('#edit-view-user').on('click', function() {
                const userId = $(this).data('id');
                $('#view-user-modal').removeClass('active');
                editUser(userId);
            });
            
            $('#cancel-add-plan, #close-add-plan-modal').on('click', function() {
                $('#add-plan-modal').removeClass('active');
            });
            
            $('#cancel-edit-plan, #close-edit-plan-modal').on('click', function() {
                $('#edit-plan-modal').removeClass('active');
            });
            
            $('#cancel-process-deposit, #close-process-deposit-modal').on('click', function() {
                $('#process-deposit-modal').removeClass('active');
            });
            
            $('#cancel-process-withdrawal, #close-process-withdrawal-modal').on('click', function() {
                $('#process-withdrawal-modal').removeClass('active');
            });
            
            $('#close-view-ticket-modal').on('click', function() {
                $('#view-ticket-modal').removeClass('active');
            });
            
            // Show loading overlay
            function showLoading() {
                $('#loading-overlay').show();
            }
            
            // Hide loading overlay
            function hideLoading() {
                $('#loading-overlay').hide();
            }
            
            // Initialize admin dashboard
            checkAdminLogin();
        });
    </script>
</body>
</html>
