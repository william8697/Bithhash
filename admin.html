<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Admin Dashboard | BitHash LLC - Institutional Bitcoin Mining</title>
    <meta name="description" content="BitHash LLC Admin Dashboard for managing institutional-grade Bitcoin mining operations.">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rowdies:wght@300;400;700&family=Inter:wght@300;400;500;600;700&family=Manrope:wght@500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" type="image/png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- DataTables -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.bootstrap5.min.css">
    
    <!-- Select2 -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- Toastr -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    
    <style>
        :root {
            --primary: #00D395;
            --primary-dark: #00B783;
            --primary-light: #00E5A1;
            --secondary: #1E1E1E;
            --secondary-dark: #121212;
            --dark: #E5E5E5;
            --darker: #0A0A0A;
            --light: #121212;
            --lighter: #1E1E1E;
            --gray: #8E8E8E;
            --gray-light: #2E2E2E;
            --gray-lighter: #252525;
            --success: #00D395;
            --warning: #FFB800;
            --error: #FF3D57;
            --gold: #D4AF37;
            --gold-light: #FFD700;
            --gold-dark: #996515;
            --blue: #003366;
            --blue-dark: #002244;
            --blue-light: #004488;
            --purple: #784FED;
            --pink: #EC4899;
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            --gold-gradient: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            --blue-gradient: linear-gradient(135deg, var(--blue) 0%, var(--blue-dark) 100%);
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --box-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            --security-blue: #1A73E8;
            --security-green: #34A853;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--secondary-dark);
            color: var(--dark);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background-color: var(--secondary);
            color: var(--dark);
            transition: var(--transition);
            position: fixed;
            height: 100vh;
            z-index: 1000;
            box-shadow: var(--box-shadow-lg);
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-logo img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }

        .sidebar-logo h3 {
            margin: 0;
            font-weight: 700;
            font-family: 'Manrope', sans-serif;
            color: var(--primary);
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-title {
            padding: 0 20px 10px;
            font-size: 12px;
            text-transform: uppercase;
            color: var(--gray);
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
            border-left: 3px solid transparent;
        }

        .menu-item:hover, .menu-item.active {
            background-color: var(--gray-lighter);
            color: var(--primary);
            border-left: 3px solid var(--primary);
        }

        .menu-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .menu-item .badge {
            margin-left: auto;
            background-color: var(--error);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }

        .submenu {
            padding-left: 40px;
            display: none;
        }

        .submenu.show {
            display: block;
        }

        .submenu-item {
            padding: 8px 0;
            color: var(--gray);
            text-decoration: none;
            display: block;
            transition: var(--transition);
        }

        .submenu-item:hover, .submenu-item.active {
            color: var(--primary);
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            margin-left: 280px;
            transition: var(--transition);
        }

        .topbar {
            background-color: var(--secondary);
            padding: 15px 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--box-shadow);
            position: sticky;
            top: 0;
            z-index: 999;
        }

        .topbar-left {
            display: flex;
            align-items: center;
        }

        .sidebar-toggle {
            background: none;
            border: none;
            color: var(--dark);
            font-size: 20px;
            margin-right: 15px;
            cursor: pointer;
        }

        .search-bar {
            position: relative;
            width: 300px;
        }

        .search-bar input {
            width: 100%;
            padding: 8px 15px 8px 40px;
            background-color: var(--gray-lighter);
            border: none;
            border-radius: var(--border-radius);
            color: var(--dark);
            outline: none;
        }

        .search-bar i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .topbar-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .notification-icon, .message-icon {
            position: relative;
            color: var(--dark);
            cursor: pointer;
        }

        .notification-badge, .message-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--error);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            object-fit: cover;
        }

        .user-name {
            font-weight: 500;
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-lg);
            padding: 10px 0;
            min-width: 200px;
            display: none;
            z-index: 1000;
        }

        .dropdown-menu.show {
            display: block;
        }

        .dropdown-item {
            padding: 8px 20px;
            color: var(--dark);
            text-decoration: none;
            display: block;
            transition: var(--transition);
        }

        .dropdown-item:hover {
            background-color: var(--gray-lighter);
            color: var(--primary);
        }

        .dropdown-divider {
            border-top: 1px solid var(--gray-light);
            margin: 5px 0;
        }

        /* Content Styles */
        .content-wrapper {
            padding: 25px;
        }

        .page-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
        }

        .page-title h1 {
            margin: 0;
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
        }

        .breadcrumb {
            display: flex;
            list-style: none;
            padding: 0;
            margin: 5px 0 0;
        }

        .breadcrumb-item {
            color: var(--gray);
            font-size: 13px;
        }

        .breadcrumb-item.active {
            color: var(--primary);
        }

        .breadcrumb-item + .breadcrumb-item::before {
            content: "/";
            padding: 0 8px;
            color: var(--gray);
        }

        .page-actions .btn {
            margin-left: 10px;
        }

        /* Card Styles */
        .card {
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow);
            margin-bottom: 25px;
            border: none;
        }

        .card-header {
            padding: 15px 20px;
            background-color: transparent;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .card-title {
            margin: 0;
            font-weight: 600;
            color: var(--dark);
        }

        .card-actions {
            display: flex;
            gap: 10px;
        }

        .card-body {
            padding: 20px;
        }

        .card-footer {
            padding: 15px 20px;
            background-color: var(--gray-lighter);
            border-top: 1px solid var(--gray-light);
            border-bottom-left-radius: var(--border-radius-lg);
            border-bottom-right-radius: var(--border-radius-lg);
        }

        /* Stats Card */
        .stats-card {
            text-align: center;
            padding: 20px;
        }

        .stats-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 20px;
        }

        .stats-icon.primary {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--primary);
        }

        .stats-icon.warning {
            background-color: rgba(255, 184, 0, 0.1);
            color: var(--warning);
        }

        .stats-icon.danger {
            background-color: rgba(255, 61, 87, 0.1);
            color: var(--error);
        }

        .stats-icon.info {
            background-color: rgba(26, 115, 232, 0.1);
            color: var(--security-blue);
        }

        .stats-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stats-label {
            color: var(--gray);
            font-size: 14px;
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 8px 16px;
            border-radius: var(--border-radius);
            font-weight: 500;
            font-size: 14px;
            line-height: 1.5;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            cursor: pointer;
            user-select: none;
            border: 1px solid transparent;
            transition: var(--transition);
        }

        .btn i {
            margin-right: 8px;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 12px;
        }

        .btn-lg {
            padding: 10px 20px;
            font-size: 16px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-outline-primary {
            background-color: transparent;
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-outline-primary:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-success:hover {
            background-color: #00b783;
        }

        .btn-warning {
            background-color: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background-color: #e6a600;
        }

        .btn-danger {
            background-color: var(--error);
            color: white;
        }

        .btn-danger:hover {
            background-color: #e63750;
        }

        .btn-secondary {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        .btn-secondary:hover {
            background-color: var(--gray);
        }

        .btn-group {
            display: inline-flex;
            vertical-align: middle;
        }

        .btn-group .btn {
            position: relative;
            flex: 1 1 auto;
        }

        .btn-group .btn:not(:first-child) {
            margin-left: -1px;
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
        }

        .btn-group .btn:not(:last-child) {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }

        /* Table Styles */
        .table {
            width: 100%;
            color: var(--dark);
            border-collapse: collapse;
        }

        .table th, .table td {
            padding: 12px 15px;
            vertical-align: middle;
            border-top: 1px solid var(--gray-light);
        }

        .table thead th {
            vertical-align: bottom;
            border-bottom: 2px solid var(--gray-light);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: 0.5px;
            color: var(--gray);
        }

        .table tbody + tbody {
            border-top: 2px solid var(--gray-light);
        }

        .table-striped tbody tr:nth-of-type(odd) {
            background-color: var(--gray-lighter);
        }

        .table-hover tbody tr:hover {
            background-color: rgba(0, 211, 149, 0.05);
        }

        .table-responsive {
            display: block;
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        /* Badge Styles */
        .badge {
            display: inline-block;
            padding: 4px 8px;
            font-size: 12px;
            font-weight: 600;
            line-height: 1;
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: 10px;
        }

        .badge-primary {
            background-color: var(--primary);
            color: white;
        }

        .badge-success {
            background-color: var(--success);
            color: white;
        }

        .badge-warning {
            background-color: var(--warning);
            color: white;
        }

        .badge-danger {
            background-color: var(--error);
            color: white;
        }

        .badge-info {
            background-color: var(--security-blue);
            color: white;
        }

        .badge-secondary {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            display: block;
            width: 100%;
            padding: 10px 15px;
            font-size: 14px;
            line-height: 1.5;
            color: var(--dark);
            background-color: var(--gray-lighter);
            background-clip: padding-box;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: 0;
            box-shadow: 0 0 0 0.2rem rgba(0, 211, 149, 0.25);
        }

        .form-control::placeholder {
            color: var(--gray);
            opacity: 1;
        }

        .form-text {
            display: block;
            margin-top: 5px;
            font-size: 12px;
            color: var(--gray);
        }

        .input-group {
            position: relative;
            display: flex;
            flex-wrap: wrap;
            align-items: stretch;
            width: 100%;
        }

        .input-group-prepend {
            margin-right: -1px;
            display: flex;
        }

        .input-group-text {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            margin-bottom: 0;
            font-size: 14px;
            font-weight: 400;
            line-height: 1.5;
            color: var(--dark);
            text-align: center;
            white-space: nowrap;
            background-color: var(--gray-light);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius) 0 0 var(--border-radius);
        }

        .input-group .form-control:not(:first-child) {
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
        }

        .custom-select {
            display: inline-block;
            width: 100%;
            height: calc(2.25rem + 2px);
            padding: 10px 15px;
            font-size: 14px;
            line-height: 1.5;
            color: var(--dark);
            vertical-align: middle;
            background: var(--gray-lighter) url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5' viewBox='0 0 4 5'%3e%3cpath fill='%238e8e8e' d='M2 0L0 2h4zm0 5L0 3h4z'/%3e%3c/svg%3e") no-repeat right 0.75rem center/8px 10px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            appearance: none;
        }

        .custom-select:focus {
            border-color: var(--primary);
            outline: 0;
            box-shadow: 0 0 0 0.2rem rgba(0, 211, 149, 0.25);
        }

        .custom-checkbox, .custom-radio {
            position: relative;
            display: block;
            min-height: 1.5rem;
            padding-left: 1.5rem;
        }

        .custom-checkbox .custom-control-input, .custom-radio .custom-control-input {
            position: absolute;
            z-index: -1;
            opacity: 0;
        }

        .custom-checkbox .custom-control-label::before, .custom-radio .custom-control-label::before {
            position: absolute;
            top: 0.25rem;
            left: 0;
            display: block;
            width: 1rem;
            height: 1rem;
            pointer-events: none;
            content: "";
            background-color: var(--gray-lighter);
            border: 1px solid var(--gray-light);
        }

        .custom-checkbox .custom-control-label::before {
            border-radius: var(--border-radius);
        }

        .custom-radio .custom-control-label::before {
            border-radius: 50%;
        }

        .custom-checkbox .custom-control-input:checked ~ .custom-control-label::before, .custom-radio .custom-control-input:checked ~ .custom-control-label::before {
            color: #fff;
            border-color: var(--primary);
            background-color: var(--primary);
        }

        .custom-checkbox .custom-control-input:checked ~ .custom-control-label::after {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 8 8'%3e%3cpath fill='%23fff' d='M6.564.75l-3.59 3.612-1.538-1.55L0 4.26l2.974 2.99L8 2.193z'/%3e%3c/svg%3e");
        }

        .custom-radio .custom-control-input:checked ~ .custom-control-label::after {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%23fff'/%3e%3c/svg%3e");
        }

        .custom-control-label::after {
            position: absolute;
            top: 0.25rem;
            left: 0;
            display: block;
            width: 1rem;
            height: 1rem;
            content: "";
            background: no-repeat 50%/50% 50%;
        }

        /* Alert Styles */
        .alert {
            position: relative;
            padding: 15px 20px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            border-radius: var(--border-radius);
        }

        .alert-primary {
            color: #004085;
            background-color: #cce5ff;
            border-color: #b8daff;
        }

        .alert-success {
            color: #155724;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }

        .alert-danger {
            color: #721c24;
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }

        .alert-warning {
            color: #856404;
            background-color: #fff3cd;
            border-color: #ffeeba;
        }

        .alert-info {
            color: #0c5460;
            background-color: #d1ecf1;
            border-color: #bee5eb;
        }

        .alert-dismissible {
            padding-right: 40px;
        }

        .alert-dismissible .close {
            position: absolute;
            top: 0;
            right: 0;
            padding: 15px 20px;
            color: inherit;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1050;
            display: none;
            width: 100%;
            height: 100%;
            overflow: hidden;
            outline: 0;
        }

        .modal-open .modal {
            overflow-x: hidden;
            overflow-y: auto;
        }

        .modal-dialog {
            position: relative;
            width: auto;
            margin: 10px;
            pointer-events: none;
            transition: transform 0.3s ease-out;
        }

        .modal.fade .modal-dialog {
            transition: transform 0.3s ease-out;
            transform: translate(0, -50px);
        }

        .modal.show .modal-dialog {
            transform: none;
        }

        .modal-content {
            position: relative;
            display: flex;
            flex-direction: column;
            width: 100%;
            pointer-events: auto;
            background-color: var(--secondary);
            background-clip: padding-box;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius-lg);
            outline: 0;
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        }

        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1040;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-backdrop.fade {
            opacity: 0;
        }

        .modal-backdrop.show {
            opacity: 1;
        }

        .modal-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            border-top-left-radius: var(--border-radius-lg);
            border-top-right-radius: var(--border-radius-lg);
        }

        .modal-title {
            margin-bottom: 0;
            line-height: 1.5;
        }

        .modal-body {
            position: relative;
            flex: 1 1 auto;
            padding: 20px;
        }

        .modal-footer {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 20px;
            border-top: 1px solid var(--gray-light);
            border-bottom-right-radius: var(--border-radius-lg);
            border-bottom-left-radius: var(--border-radius-lg);
        }

        .modal-footer > :not(:first-child) {
            margin-left: 10px;
        }

        .modal-footer > :not(:last-child) {
            margin-right: 10px;
        }

        .modal-scrollbar-measure {
            position: absolute;
            top: -9999px;
            width: 50px;
            height: 50px;
            overflow: scroll;
        }

        /* Tabs */
        .nav-tabs {
            border-bottom: 1px solid var(--gray-light);
        }

        .nav-tabs .nav-item {
            margin-bottom: -1px;
        }

        .nav-tabs .nav-link {
            border: 1px solid transparent;
            border-top-left-radius: var(--border-radius);
            border-top-right-radius: var(--border-radius);
            padding: 10px 20px;
            color: var(--gray);
            font-weight: 500;
        }

        .nav-tabs .nav-link:hover {
            border-color: var(--gray-light) var(--gray-light) var(--gray-light);
            color: var(--dark);
        }

        .nav-tabs .nav-link.active {
            color: var(--primary);
            background-color: var(--secondary);
            border-color: var(--gray-light) var(--gray-light) var(--secondary);
        }

        .tab-content {
            padding: 20px 0;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        /* Pagination */
        .pagination {
            display: flex;
            padding-left: 0;
            list-style: none;
            border-radius: var(--border-radius);
        }

        .page-link {
            position: relative;
            display: block;
            padding: 8px 15px;
            margin-left: -1px;
            line-height: 1.25;
            color: var(--primary);
            background-color: var(--secondary);
            border: 1px solid var(--gray-light);
            text-decoration: none;
        }

        .page-link:hover {
            z-index: 2;
            color: var(--primary-dark);
            background-color: var(--gray-lighter);
            border-color: var(--gray-light);
        }

        .page-link:focus {
            z-index: 3;
            outline: 0;
            box-shadow: 0 0 0 0.2rem rgba(0, 211, 149, 0.25);
        }

        .page-item:first-child .page-link {
            margin-left: 0;
            border-top-left-radius: var(--border-radius);
            border-bottom-left-radius: var(--border-radius);
        }

        .page-item:last-child .page-link {
            border-top-right-radius: var(--border-radius);
            border-bottom-right-radius: var(--border-radius);
        }

        .page-item.active .page-link {
            z-index: 3;
            color: white;
            background-color: var(--primary);
            border-color: var(--primary);
        }

        .page-item.disabled .page-link {
            color: var(--gray);
            pointer-events: none;
            cursor: auto;
            background-color: var(--secondary);
            border-color: var(--gray-light);
        }

        /* Progress Bars */
        .progress {
            display: flex;
            height: 10px;
            overflow: hidden;
            font-size: 10px;
            background-color: var(--gray-lighter);
            border-radius: 5px;
        }

        .progress-bar {
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow: hidden;
            color: white;
            text-align: center;
            white-space: nowrap;
            background-color: var(--primary);
            transition: width 0.6s ease;
        }

        .progress-bar-striped {
            background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
            background-size: 1rem 1rem;
        }

        .progress-bar-animated {
            animation: progress-bar-stripes 1s linear infinite;
        }

        @keyframes progress-bar-stripes {
            from {
                background-position: 1rem 0;
            }
            to {
                background-position: 0 0;
            }
        }

        /* Charts */
        .chart-container {
            position: relative;
            height: 300px;
        }

        /* Responsive Utilities */
        @media (min-width: 576px) {
            .modal-dialog {
                max-width: 500px;
                margin: 30px auto;
            }
        }

        @media (min-width: 768px) {
            .modal-dialog {
                max-width: 700px;
            }
        }

        @media (min-width: 992px) {
            .modal-dialog {
                max-width: 900px;
            }
        }

        @media (min-width: 1200px) {
            .modal-dialog {
                max-width: 1100px;
            }
        }

        @media (max-width: 991.98px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.show {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-lighter);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            vertical-align: text-bottom;
            border: 0.25em solid currentColor;
            border-right-color: transparent;
            border-radius: 50%;
            animation: spinner-border 0.75s linear infinite;
        }

        @keyframes spinner-border {
            to {
                transform: rotate(360deg);
            }
        }

        /* Custom Utilities */
        .text-primary {
            color: var(--primary) !important;
        }

        .text-success {
            color: var(--success) !important;
        }

        .text-warning {
            color: var(--warning) !important;
        }

        .text-danger {
            color: var(--error) !important;
        }

        .text-info {
            color: var(--security-blue) !important;
        }

        .text-muted {
            color: var(--gray) !important;
        }

        .bg-primary {
            background-color: var(--primary) !important;
        }

        .bg-success {
            background-color: var(--success) !important;
        }

        .bg-warning {
            background-color: var(--warning) !important;
        }

        .bg-danger {
            background-color: var(--error) !important;
        }

        .bg-info {
            background-color: var(--security-blue) !important;
        }

        .rounded {
            border-radius: var(--border-radius) !important;
        }

        .rounded-lg {
            border-radius: var(--border-radius-lg) !important;
        }

        .shadow {
            box-shadow: var(--box-shadow) !important;
        }

        .shadow-lg {
            box-shadow: var(--box-shadow-lg) !important;
        }

        .w-100 {
            width: 100% !important;
        }

        .h-100 {
            height: 100% !important;
        }

        .mw-100 {
            max-width: 100% !important;
        }

        .mh-100 {
            max-height: 100% !important;
        }

        .d-none {
            display: none !important;
        }

        .d-block {
            display: block !important;
        }

        .d-flex {
            display: flex !important;
        }

        .align-items-center {
            align-items: center !important;
        }

        .justify-content-center {
            justify-content: center !important;
        }

        .justify-content-between {
            justify-content: space-between !important;
        }

        .text-center {
            text-align: center !important;
        }

        .text-right {
            text-align: right !important;
        }

        .text-left {
            text-align: left !important;
        }

        .font-weight-bold {
            font-weight: 700 !important;
        }

        .position-relative {
            position: relative !important;
        }

        .position-absolute {
            position: absolute !important;
        }

        .position-fixed {
            position: fixed !important;
        }

        .overflow-hidden {
            overflow: hidden !important;
        }

        .cursor-pointer {
            cursor: pointer !important;
        }

        /* Custom Admin Styles */
        .user-avatar-sm {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            object-fit: cover;
        }

        .user-avatar-md {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            object-fit: cover;
        }

        .user-avatar-lg {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
        }

        .status-badge {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .status-badge.active {
            background-color: var(--success);
        }

        .status-badge.inactive {
            background-color: var(--error);
        }

        .status-badge.pending {
            background-color: var(--warning);
        }

        .status-badge.suspended {
            background-color: var(--gray);
        }

        .activity-item {
            padding: 10px 0;
            border-bottom: 1px solid var(--gray-light);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-time {
            font-size: 12px;
            color: var(--gray);
        }

        .chat-container {
            display: flex;
            flex-direction: column;
            height: 500px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        .chat-header {
            padding: 15px;
            background-color: var(--gray-lighter);
            border-bottom: 1px solid var(--gray-light);
        }

        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
        }

        .message {
            margin-bottom: 15px;
            max-width: 80%;
        }

        .message-in {
            margin-right: auto;
        }

        .message-out {
            margin-left: auto;
            text-align: right;
        }

        .message-content {
            display: inline-block;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            background-color: var(--gray-lighter);
        }

        .message-out .message-content {
            background-color: var(--primary);
            color: white;
        }

        .message-time {
            font-size: 11px;
            color: var(--gray);
            margin-top: 5px;
        }

        .chat-input {
            display: flex;
            padding: 15px;
            background-color: var(--gray-lighter);
            border-top: 1px solid var(--gray-light);
        }

        .chat-input input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius) 0 0 var(--border-radius);
            outline: none;
        }

        .chat-input button {
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }

        /* Dark Mode Toggle */
        .dark-mode-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--secondary);
            color: var(--dark);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--box-shadow-lg);
            border: none;
            outline: none;
        }

        /* Login Page */
        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: var(--secondary-dark);
            padding: 20px;
        }

        .login-card {
            width: 100%;
            max-width: 450px;
            background-color: var(--secondary);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-lg);
            overflow: hidden;
        }

        .login-header {
            padding: 30px;
            text-align: center;
            background-color: var(--secondary);
            border-bottom: 1px solid var(--gray-light);
        }

        .login-logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--primary);
            color: white;
            font-size: 30px;
        }

        .login-title {
            margin: 0;
            font-weight: 700;
            color: var(--dark);
        }

        .login-subtitle {
            margin: 10px 0 0;
            color: var(--gray);
            font-size: 14px;
        }

        .login-body {
            padding: 30px;
        }

        .login-footer {
            padding: 20px;
            text-align: center;
            background-color: var(--gray-lighter);
            color: var(--gray);
            font-size: 13px;
        }

        .form-floating {
            position: relative;
            margin-bottom: 20px;
        }

        .form-floating label {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            padding: 16px;
            pointer-events: none;
            border: 1px solid transparent;
            transform-origin: 0 0;
            transition: opacity 0.1s ease-in-out, transform 0.1s ease-in-out;
            color: var(--gray);
        }

        .form-floating input:not(:placeholder-shown) ~ label,
        .form-floating input:focus ~ label {
            transform: scale(0.85) translateY(-0.5rem) translateX(0.15rem);
            opacity: 0.65;
        }

        .form-floating .form-control {
            height: calc(3.5rem + 2px);
            padding: 16px;
        }

        .form-floating .form-control::placeholder {
            color: transparent;
        }

        .login-actions {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .login-remember {
            display: flex;
            align-items: center;
        }

        .login-remember input {
            margin-right: 8px;
        }

        .login-forgot {
            color: var(--primary);
            text-decoration: none;
            font-size: 14px;
        }

        .login-forgot:hover {
            text-decoration: underline;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            font-weight: 600;
        }

        .login-divider {
            display: flex;
            align-items: center;
            margin: 20px 0;
            color: var(--gray);
            font-size: 12px;
        }

        .login-divider::before,
        .login-divider::after {
            content: "";
            flex: 1;
            height: 1px;
            background-color: var(--gray-light);
        }

        .login-divider::before {
            margin-right: 15px;
        }

        .login-divider::after {
            margin-left: 15px;
        }

        .login-social {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .social-btn {
            flex: 1;
            padding: 10px;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            font-weight: 500;
        }

        .social-btn i {
            margin-right: 8px;
        }

        .social-btn.google {
            background-color: #DB4437;
        }

        .social-btn.facebook {
            background-color: #4267B2;
        }

        .social-btn.twitter {
            background-color: #1DA1F2;
        }

        .login-register {
            text-align: center;
            margin-top: 20px;
            color: var(--gray);
            font-size: 14px;
        }

        .login-register a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
        }

        .login-register a:hover {
            text-decoration: underline;
        }

        /* 2FA Modal */
        .twofa-container {
            text-align: center;
            padding: 20px;
        }

        .twofa-qrcode {
            margin: 20px auto;
            padding: 10px;
            background-color: white;
            display: inline-block;
            border-radius: var(--border-radius);
        }

        .twofa-code {
            font-family: monospace;
            font-size: 18px;
            letter-spacing: 2px;
            color: var(--primary);
            margin: 15px 0;
            padding: 10px;
            background-color: var(--gray-lighter);
            border-radius: var(--border-radius);
            display: inline-block;
        }

        /* Responsive Adjustments */
        @media (max-width: 767.98px) {
            .content-wrapper {
                padding: 15px;
            }
            
            .page-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .page-actions {
                margin-top: 15px;
                width: 100%;
            }
            
            .page-actions .btn {
                width: 100%;
                margin: 5px 0;
            }
            
            .stats-card {
                margin-bottom: 15px;
            }
            
            .card-body {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Login Page (Initially Visible) -->
    <div id="loginPage" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="login-logo">
                    <i class="fas fa-bitcoin"></i>
                </div>
                <h2 class="login-title">BitHash LLC</h2>
                <p class="login-subtitle">Admin Dashboard</p>
            </div>
            <div class="login-body">
                <form id="loginForm">
                    <div class="form-floating">
                        <input type="email" class="form-control" id="loginEmail" placeholder="Email Address" required>
                        <label for="loginEmail">Email Address</label>
                    </div>
                    <div class="form-floating">
                        <input type="password" class="form-control" id="loginPassword" placeholder="Password" required>
                        <label for="loginPassword">Password</label>
                    </div>
                    <div class="login-actions">
                        <div class="login-remember">
                            <input type="checkbox" id="rememberMe">
                            <label for="rememberMe">Remember me</label>
                        </div>
                        <a href="#" id="forgotPassword" class="login-forgot">Forgot password?</a>
                    </div>
                    <button type="submit" class="btn btn-primary login-btn">
                        <span id="loginBtnText">Sign In</span>
                        <span id="loginSpinner" class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                    </button>
                </form>
                <div class="login-divider">OR</div>
                <div class="login-social">
                    <a href="#" class="social-btn google">
                        <i class="fab fa-google"></i> Google
                    </a>
                    <a href="#" class="social-btn facebook">
                        <i class="fab fa-facebook-f"></i> Facebook
                    </a>
                </div>
                <div class="alert alert-danger d-none" id="loginError"></div>
            </div>
            <div class="login-footer">
                <p>Â© 2023 BitHash LLC. All rights reserved.</p>
            </div>
        </div>
    </div>

    <!-- 2FA Verification Modal -->
    <div class="modal fade" id="twofaModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Two-Factor Authentication</h5>
                    <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="twofa-container">
                        <p>Please enter the 6-digit code from your authenticator app</p>
                        <div class="form-group">
                            <input type="text" class="form-control text-center" id="twofaCode" placeholder="123456" maxlength="6" pattern="\d{6}">
                        </div>
                        <button type="button" id="verifyTwofa" class="btn btn-primary">Verify</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard (Initially Hidden) -->
    <div id="adminDashboard" class="admin-container d-none">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="Logo">
                    <h3>BitHash</h3>
                </div>
            </div>
            <div class="sidebar-menu">
                <div class="menu-title">Main</div>
                <a href="#" class="menu-item active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                
                <div class="menu-title">Management</div>
                <a href="#" class="menu-item" data-section="users">
                    <i class="fas fa-users"></i>
                    <span>Users</span>
                    <span class="badge" id="pendingUsersBadge">0</span>
                </a>
                <a href="#" class="menu-item" data-section="investments">
                    <i class="fas fa-chart-line"></i>
                    <span>Investments</span>
                </a>
                <a href="#" class="menu-item" data-section="transactions">
                    <i class="fas fa-exchange-alt"></i>
                    <span>Transactions</span>
                </a>
                <a href="#" class="menu-item" data-section="withdrawals">
                    <i class="fas fa-money-bill-wave"></i>
                    <span>Withdrawals</span>
                    <span class="badge" id="pendingWithdrawalsBadge">0</span>
                </a>
                
                <div class="menu-title">Support</div>
                <a href="#" class="menu-item" data-section="tickets">
                    <i class="fas fa-ticket-alt"></i>
                    <span>Support Tickets</span>
                    <span class="badge" id="openTicketsBadge">0</span>
                </a>
                <a href="#" class="menu-item" data-section="chat">
                    <i class="fas fa-comments"></i>
                    <span>Live Chat</span>
                </a>
                
                <div class="menu-title">Marketing</div>
                <a href="#" class="menu-item" data-section="notifications">
                    <i class="fas fa-bell"></i>
                    <span>Notifications</span>
                </a>
                <a href="#" class="menu-item" data-section="promotions">
                    <i class="fas fa-bullhorn"></i>
                    <span>Promotions</span>
                </a>
                
                <div class="menu-title">Settings</div>
                <a href="#" class="menu-item" data-section="settings">
                    <i class="fas fa-cog"></i>
                    <span>Platform Settings</span>
                </a>
                <a href="#" class="menu-item" data-section="security">
                    <i class="fas fa-shield-alt"></i>
                    <span>Security</span>
                </a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Topbar -->
            <div class="topbar">
                <div class="topbar-left">
                    <button class="sidebar-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                </div>
                <div class="topbar-right">
                    <div class="notification-icon">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">3</span>
                    </div>
                    <div class="message-icon">
                        <i class="fas fa-envelope"></i>
                        <span class="message-badge">5</span>
                    </div>
                    <div class="user-profile" id="userProfileDropdown">
                        <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="User" class="user-avatar">
                        <span class="user-name">Admin</span>
                        <div class="dropdown-menu" id="profileDropdown">
                            <a href="#" class="dropdown-item" data-section="profile">
                                <i class="fas fa-user-circle mr-2"></i> Profile
                            </a>
                            <a href="#" class="dropdown-item" data-section="settings">
                                <i class="fas fa-cog mr-2"></i> Settings
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item" id="logoutBtn">
                                <i class="fas fa-sign-out-alt mr-2"></i> Logout
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content Wrapper -->
            <div class="content-wrapper">
                <!-- Dashboard Section (Default Visible) -->
                <div id="dashboardSection" class="section-content">
                    <div class="page-header">
                        <div class="page-title">
                            <h1>Dashboard</h1>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item active">Dashboard</li>
                            </ul>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-primary">
                                <i class="fas fa-plus"></i> Generate Report
                            </button>
                        </div>
                    </div>

                    <!-- Stats Cards -->
                    <div class="row">
                        <div class="col-md-3">
                            <div class="card stats-card">
                                <div class="stats-icon primary">
                                    <i class="fas fa-users"></i>
                                </div>
                                <h3 class="stats-value" id="totalUsers">0</h3>
                                <p class="stats-label">Total Users</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card stats-card">
                                <div class="stats-icon warning">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <h3 class="stats-value" id="activeInvestments">0</h3>
                                <p class="stats-label">Active Investments</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card stats-card">
                                <div class="stats-icon danger">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <h3 class="stats-value" id="totalWithdrawals">0</h3>
                                <p class="stats-label">Total Withdrawals</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card stats-card">
                                <div class="stats-icon info">
                                    <i class="fas fa-wallet"></i>
                                </div>
                                <h3 class="stats-value" id="platformBalance">0</h3>
                                <p class="stats-label">Platform Balance</p>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row -->
                    <div class="row">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title">User Growth</h5>
                                    <div class="card-actions">
                                        <select class="custom-select" id="userGrowthPeriod">
                                            <option value="7">Last 7 Days</option>
                                            <option value="30" selected>Last 30 Days</option>
                                            <option value="90">Last 90 Days</option>
                                            <option value="365">Last Year</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="userGrowthChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title">User Distribution</h5>
                                </div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="userDistributionChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title">Recent Transactions</h5>
                                    <div class="card-actions">
                                        <a href="#" data-section="transactions" class="btn btn-sm btn-outline-primary">View All</a>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover" id="recentTransactionsTable">
                                            <thead>
                                                <tr>
                                                    <th>User</th>
                                                    <th>Amount</th>
                                                    <th>Type</th>
                                                    <th>Status</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Filled by JavaScript -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title">Recent Users</h5>
                                    <div class="card-actions">
                                        <a href="#" data-section="users" class="btn btn-sm btn-outline-primary">View All</a>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover" id="recentUsersTable">
                                            <thead>
                                                <tr>
                                                    <th>User</th>
                                                    <th>Joined</th>
                                                    <th>Status</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Filled by JavaScript -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Users Section (Hidden by Default) -->
                <div id="usersSection" class="section-content d-none">
                    <div class="page-header">
                        <div class="page-title">
                            <h1>User Management</h1>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#" data-section="dashboard">Dashboard</a></li>
                                <li class="breadcrumb-item active">Users</li>
                            </ul>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-primary" id="addUserBtn">
                                <i class="fas fa-plus"></i> Add User
                            </button>
                            <button class="btn btn-outline-primary">
                                <i class="fas fa-download"></i> Export
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title">All Users</h5>
                            <div class="card-actions">
                                <div class="input-group" style="width: 250px;">
                                    <input type="text" class="form-control" id="userSearchInput" placeholder="Search users...">
                                    <div class="input-group-append">
                                        <button class="btn btn-secondary" type="button">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped" id="usersTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>User</th>
                                            <th>Email</th>
                                            <th>Balance</th>
                                            <th>Status</th>
                                            <th>Joined</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Filled by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="d-flex justify-content-between">
                                <div class="dataTables_info" id="usersTableInfo">Showing 0 to 0 of 0 entries</div>
                                <div class="dataTables_paginate">
                                    <ul class="pagination" id="usersTablePagination">
                                        <!-- Filled by JavaScript -->
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add/Edit User Modal -->
                <div class="modal fade" id="userModal" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="userModalTitle">Add New User</h5>
                                <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form id="userForm">
                                    <input type="hidden" id="userId">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="firstName">First Name</label>
                                                <input type="text" class="form-control" id="firstName" required>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="lastName">Last Name</label>
                                                <input type="text" class="form-control" id="lastName" required>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="userEmail">Email Address</label>
                                        <input type="email" class="form-control" id="userEmail" required>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="userPassword">Password</label>
                                                <input type="password" class="form-control" id="userPassword">
                                                <small class="form-text text-muted">Leave blank to keep current password</small>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="confirmPassword">Confirm Password</label>
                                                <input type="password" class="form-control" id="confirmPassword">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="userBalance">Account Balance</label>
                                                <input type="number" step="0.01" class="form-control" id="userBalance" required>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="userStatus">Account Status</label>
                                                <select class="custom-select" id="userStatus" required>
                                                    <option value="active">Active</option>
                                                    <option value="pending">Pending</option>
                                                    <option value="suspended">Suspended</option>
                                                    <option value="banned">Banned</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="userRole">User Role</label>
                                        <select class="custom-select" id="userRole" required>
                                            <option value="user">User</option>
                                            <option value="admin">Admin</option>
                                            <option value="moderator">Moderator</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="userNotes">Admin Notes</label>
                                        <textarea class="form-control" id="userNotes" rows="3"></textarea>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                <button type="button" class="btn btn-primary" id="saveUserBtn">Save User</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Investments Section (Hidden by Default) -->
                <div id="investmentsSection" class="section-content d-none">
                    <div class="page-header">
                        <div class="page-title">
                            <h1>Investment Management</h1>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#" data-section="dashboard">Dashboard</a></li>
                                <li class="breadcrumb-item active">Investments</li>
                            </ul>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add Investment
                            </button>
                            <button class="btn btn-outline-primary">
                                <i class="fas fa-download"></i> Export
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title">All Investments</h5>
                            <div class="card-actions">
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-primary active">All</button>
                                    <button class="btn btn-sm btn-outline-primary">Active</button>
                                    <button class="btn btn-sm btn-outline-primary">Completed</button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped" id="investmentsTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>User</th>
                                            <th>Plan</th>
                                            <th>Amount</th>
                                            <th>Profit</th>
                                            <th>Start Date</th>
                                            <th>End Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Filled by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="d-flex justify-content-between">
                                <div class="dataTables_info" id="investmentsTableInfo">Showing 0 to 0 of 0 entries</div>
                                <div class="dataTables_paginate">
                                    <ul class="pagination" id="investmentsTablePagination">
                                        <!-- Filled by JavaScript -->
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Transactions Section (Hidden by Default) -->
                <div id="transactionsSection" class="section-content d-none">
                    <div class="page-header">
                        <div class="page-title">
                            <h1>Transaction Management</h1>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#" data-section="dashboard">Dashboard</a></li>
                                <li class="breadcrumb-item active">Transactions</li>
                            </ul>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-outline-primary">
                                <i class="fas fa-download"></i> Export
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title">All Transactions</h5>
                            <div class="card-actions">
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-primary active">All</button>
                                    <button class="btn btn-sm btn-outline-primary">Deposits</button>
                                    <button class="btn btn-sm btn-outline-primary">Withdrawals</button>
                                    <button class="btn btn-sm btn-outline-primary">Transfers</button>
                                </div>
                                <div class="input-group ml-3" style="width: 250px;">
                                    <input type="text" class="form-control" placeholder="Search transactions...">
                                    <div class="input-group-append">
                                        <button class="btn btn-secondary" type="button">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped" id="transactionsTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>User</th>
                                            <th>Type</th>
                                            <th>Amount</th>
                                            <th>Fee</th>
                                            <th>Method</th>
                                            <th>Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Filled by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="d-flex justify-content-between">
                                <div class="dataTables_info" id="transactionsTableInfo">Showing 0 to 0 of 0 entries</div>
                                <div class="dataTables_paginate">
                                    <ul class="pagination" id="transactionsTablePagination">
                                        <!-- Filled by JavaScript -->
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Withdrawals Section (Hidden by Default) -->
                <div id="withdrawalsSection" class="section-content d-none">
                    <div class="page-header">
                        <div class="page-title">
                            <h1>Withdrawal Management</h1>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#" data-section="dashboard">Dashboard</a></li>
                                <li class="breadcrumb-item active">Withdrawals</li>
                            </ul>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-outline-primary">
                                <i class="fas fa-download"></i> Export
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title">Pending Withdrawals</h5>
                            <div class="card-actions">
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-primary active">Pending</button>
                                    <button class="btn btn-sm btn-outline-primary">Completed</button>
                                    <button class="btn btn-sm btn-outline-primary">Rejected</button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped" id="withdrawalsTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>User</th>
                                            <th>Amount</th>
                                            <th>Fee</th>
                                            <th>Method</th>
                                            <th>Wallet</th>
                                            <th>Date</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Filled by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="d-flex justify-content-between">
                                <div class="dataTables_info" id="withdrawalsTableInfo">Showing 0 to 0 of 0 entries</div>
                                <div class="dataTables_paginate">
                                    <ul class="pagination" id="withdrawalsTablePagination">
                                        <!-- Filled by JavaScript -->
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tickets Section (Hidden by Default) -->
                <div id="ticketsSection" class="section-content d-none">
                    <div class="page-header">
                        <div class="page-title">
                            <h1>Support Tickets</h1>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#" data-section="dashboard">Dashboard</a></li>
                                <li class="breadcrumb-item active">Tickets</li>
                            </ul>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-primary">
                                <i class="fas fa-plus"></i> New Ticket
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title">Open Tickets</h5>
                            <div class="card-actions">
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-primary active">Open</button>
                                    <button class="btn btn-sm btn-outline-primary">Answered</button>
                                    <button class="btn btn-sm btn-outline-primary">Closed</button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped" id="ticketsTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>User</th>
                                            <th>Subject</th>
                                            <th>Department</th>
                                            <th>Priority</th>
                                            <th>Last Reply</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Filled by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="d-flex justify-content-between">
                                <div class="dataTables_info" id="ticketsTableInfo">Showing 0 to 0 of 0 entries</div>
                                <div class="dataTables_paginate">
                                    <ul class="pagination" id="ticketsTablePagination">
                                        <!-- Filled by JavaScript -->
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chat Section (Hidden by Default) -->
                <div id="chatSection" class="section-content d-none">
                    <div class="page-header">
                        <div class="page-title">
                            <h1>Live Chat Support</h1>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#" data-section="dashboard">Dashboard</a></li>
                                <li class="breadcrumb-item active">Live Chat</li>
                            </ul>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-primary">
                                <i class="fas fa-plus"></i> New Chat
                            </button>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title">Active Conversations</h5>
                                    <div class="card-actions">
                                        <button class="btn btn-sm btn-outline-primary">
                                            <i class="fas fa-sync-alt"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body p-0">
                                    <div class="list-group list-group-flush" id="chatList">
                                        <!-- Filled by JavaScript -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title">Chat</h5>
                                    <div class="card-actions">
                                        <button class="btn btn-sm btn-outline-danger" id="endChatBtn">
                                            <i class="fas fa-times"></i> End Chat
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body p-0">
                                    <div class="chat-container">
                                        <div class="chat-header">
                                            <div class="d-flex align-items-center">
                                                <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="User" class="user-avatar-sm mr-2">
                                                <div>
                                                    <h6 class="mb-0">Select a conversation</h6>
                                                    <small class="text-muted">No chat selected</small>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chat-messages" id="chatMessages">
                                            <div class="text-center py-5">
                                                <i class="fas fa-comments fa-3x text-muted mb-3"></i>
                                                <p class="text-muted">Select a conversation to start chatting</p>
                                            </div>
                                        </div>
                                        <div class="chat-input">
                                            <input type="text" placeholder="Type a message..." disabled>
                                            <button class="btn btn-primary" disabled>
                                                <i class="fas fa-paper-plane"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Notifications Section (Hidden by Default) -->
                <div id="notificationsSection" class="section-content d-none">
                    <div class="page-header">
                        <div class="page-title">
                            <h1>Notification Center</h1>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#" data-section="dashboard">Dashboard</a></li>
                                <li class="breadcrumb-item active">Notifications</li>
                            </ul>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-primary" id="sendNotificationBtn">
                                <i class="fas fa-paper-plane"></i> Send Notification
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title">Recent Notifications</h5>
                            <div class="card-actions">
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-primary active">All</button>
                                    <button class="btn btn-sm btn-outline-primary">System</button>
                                    <button class="btn btn-sm btn-outline-primary">Promotional</button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped" id="notificationsTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Title</th>
                                            <th>Type</th>
                                            <th>Recipients</th>
                                            <th>Date Sent</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Filled by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="d-flex justify-content-between">
                                <div class="dataTables_info" id="notificationsTableInfo">Showing 0 to 0 of 0 entries</div>
                                <div class="dataTables_paginate">
                                    <ul class="pagination" id="notificationsTablePagination">
                                        <!-- Filled by JavaScript -->
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Send Notification Modal -->
                <div class="modal fade" id="notificationModal" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Send Notification</h5>
                                <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form id="notificationForm">
                                    <div class="form-group">
                                        <label for="notificationTitle">Title</label>
                                        <input type="text" class="form-control" id="notificationTitle" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="notificationMessage">Message</label>
                                        <textarea class="form-control" id="notificationMessage" rows="5" required></textarea>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="notificationType">Type</label>
                                                <select class="custom-select" id="notificationType" required>
                                                    <option value="system">System Notification</option>
                                                    <option value="promotional">Promotional</option>
                                                    <option value="alert">Alert</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="notificationAudience">Audience</label>
                                                <select class="custom-select" id="notificationAudience" required>
                                                    <option value="all">All Users</option>
                                                    <option value="active">Active Users</option>
                                                    <option value="investors">Investors Only</option>
                                                    <option value="custom">Custom Selection</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group" id="customUsersGroup" style="display: none;">
                                        <label for="notificationUsers">Select Users</label>
                                        <select class="form-control select2" id="notificationUsers" multiple="multiple" style="width: 100%;">
                                            <!-- Filled by JavaScript -->
                                        </select>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                <button type="button" class="btn btn-primary" id="sendNotificationNowBtn">Send Notification</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Promotions Section (Hidden by Default) -->
                <div id="promotionsSection" class="section-content d-none">
                    <div class="page-header">
                        <div class="page-title">
                            <h1>Promotion Management</h1>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#" data-section="dashboard">Dashboard</a></li>
                                <li class="breadcrumb-item active">Promotions</li>
                            </ul>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-primary" id="createPromotionBtn">
                                <i class="fas fa-plus"></i> Create Promotion
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title">Active Promotions</h5>
                            <div class="card-actions">
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-primary active">Active</button>
                                    <button class="btn btn-sm btn-outline-primary">Upcoming</button>
                                    <button class="btn btn-sm btn-outline-primary">Expired</button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped" id="promotionsTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Title</th>
                                            <th>Type</th>
                                            <th>Discount/Bonus</th>
                                            <th>Start Date</th>
                                            <th>End Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Filled by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="d-flex justify-content-between">
                                <div class="dataTables_info" id="promotionsTableInfo">Showing 0 to 0 of 0 entries</div>
                                <div class="dataTables_paginate">
                                    <ul class="pagination" id="promotionsTablePagination">
                                        <!-- Filled by JavaScript -->
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Create Promotion Modal -->
                <div class="modal fade" id="promotionModal" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Create New Promotion</h5>
                                <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form id="promotionForm">
                                    <div class="form-group">
                                        <label for="promotionTitle">Promotion Title</label>
                                        <input type="text" class="form-control" id="promotionTitle" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="promotionDescription">Description</label>
                                        <textarea class="form-control" id="promotionDescription" rows="3" required></textarea>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="promotionType">Promotion Type</label>
                                                <select class="custom-select" id="promotionType" required>
                                                    <option value="deposit_bonus">Deposit Bonus</option>
                                                    <option value="investment_discount">Investment Discount</option>
                                                    <option value="referral_bonus">Referral Bonus</option>
                                                    <option value="holiday_special">Holiday Special</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="promotionValue">Bonus/Discount Value</label>
                                                <div class="input-group">
                                                    <input type="number" class="form-control" id="promotionValue" required>
                                                    <div class="input-group-append">
                                                        <span class="input-group-text" id="promotionValueUnit">%</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="promotionStartDate">Start Date</label>
                                                <input type="datetime-local" class="form-control" id="promotionStartDate" required>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="promotionEndDate">End Date</label>
                                                <input type="datetime-local" class="form-control" id="promotionEndDate" required>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="promotionImage">Promotion Image</label>
                                        <div class="custom-file">
                                            <input type="file" class="custom-file-input" id="promotionImage">
                                            <label class="custom-file-label" for="promotionImage">Choose file</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="custom-control custom-switch">
                                            <input type="checkbox" class="custom-control-input" id="promotionIsActive">
                                            <label class="custom-control-label" for="promotionIsActive">Activate immediately</label>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                <button type="button" class="btn btn-primary" id="savePromotionBtn">Create Promotion</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Section (Hidden by Default) -->
                <div id="settingsSection" class="section-content d-none">
                    <div class="page-header">
                        <div class="page-title">
                            <h1>Platform Settings</h1>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#" data-section="dashboard">Dashboard</a></li>
                                <li class="breadcrumb-item active">Settings</li>
                            </ul>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-primary" id="saveSettingsBtn">
                                <i class="fas fa-save"></i> Save Settings
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <ul class="nav nav-tabs" id="settingsTabs" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="general-tab" data-toggle="tab" href="#general" role="tab">General</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="payment-tab" data-toggle="tab" href="#payment" role="tab">Payment</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="email-tab" data-toggle="tab" href="#email" role="tab">Email</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="investment-tab" data-toggle="tab" href="#investment" role="tab">Investment</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="maintenance-tab" data-toggle="tab" href="#maintenance" role="tab">Maintenance</a>
                                </li>
                            </ul>
                        </div>
                        <div class="card-body">
                            <div class="tab-content" id="settingsTabContent">
                                <div class="tab-pane fade show active" id="general" role="tabpanel">
                                    <form id="generalSettingsForm">
                                        <div class="form-group">
                                            <label for="siteName">Site Name</label>
                                            <input type="text" class="form-control" id="siteName" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="siteUrl">Site URL</label>
                                            <input type="url" class="form-control" id="siteUrl" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="siteLogo">Site Logo</label>
                                            <div class="custom-file">
                                                <input type="file" class="custom-file-input" id="siteLogo">
                                                <label class="custom-file-label" for="siteLogo">Choose file</label>
                                            </div>
                                            <small class="form-text text-muted">Recommended size: 200x50 pixels</small>
                                        </div>
                                        <div class="form-group">
                                            <label for="siteFavicon">Favicon</label>
                                            <div class="custom-file">
                                                <input type="file" class="custom-file-input" id="siteFavicon">
                                                <label class="custom-file-label" for="siteFavicon">Choose file</label>
                                            </div>
                                            <small class="form-text text-muted">Recommended size: 32x32 pixels</small>
                                        </div>
                                        <div class="form-group">
                                            <label for="siteTimezone">Timezone</label>
                                            <select class="custom-select" id="siteTimezone" required>
                                                <!-- Filled by JavaScript -->
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="siteCurrency">Default Currency</label>
                                            <select class="custom-select" id="siteCurrency" required>
                                                <option value="USD">US Dollar (USD)</option>
                                                <option value="EUR">Euro (EUR)</option>
                                                <option value="GBP">British Pound (GBP)</option>
                                                <option value="BTC">Bitcoin (BTC)</option>
                                                <option value="ETH">Ethereum (ETH)</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="siteRegistration">
                                                <label class="custom-control-label" for="siteRegistration">Allow new user registration</label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="siteVerification">
                                                <label class="custom-control-label" for="siteVerification">Require email verification</label>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="tab-pane fade" id="payment" role="tabpanel">
                                    <form id="paymentSettingsForm">
                                        <div class="form-group">
                                            <label for="paymentMinDeposit">Minimum Deposit Amount</label>
                                            <input type="number" step="0.01" class="form-control" id="paymentMinDeposit" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="paymentMinWithdrawal">Minimum Withdrawal Amount</label>
                                            <input type="number" step="0.01" class="form-control" id="paymentMinWithdrawal" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="paymentWithdrawalFee">Withdrawal Fee (%)</label>
                                            <input type="number" step="0.01" class="form-control" id="paymentWithdrawalFee" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="paymentDepositMethods">Enabled Deposit Methods</label>
                                            <select class="custom-select" id="paymentDepositMethods" multiple>
                                                <option value="bank">Bank Transfer</option>
                                                <option value="credit_card">Credit Card</option>
                                                <option value="paypal">PayPal</option>
                                                <option value="crypto">Cryptocurrency</option>
                                                <option value="skrill">Skrill</option>
                                                <option value="neteller">Neteller</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="paymentWithdrawalMethods">Enabled Withdrawal Methods</label>
                                            <select class="custom-select" id="paymentWithdrawalMethods" multiple>
                                                <option value="bank">Bank Transfer</option>
                                                <option value="paypal">PayPal</option>
                                                <option value="crypto">Cryptocurrency</option>
                                                <option value="skrill">Skrill</option>
                                                <option value="neteller">Neteller</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="paymentAutoWithdrawal">
                                                <label class="custom-control-label" for="paymentAutoWithdrawal">Enable automatic withdrawals</label>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="tab-pane fade" id="email" role="tabpanel">
                                    <form id="emailSettingsForm">
                                        <div class="form-group">
                                            <label for="emailFromName">From Name</label>
                                            <input type="text" class="form-control" id="emailFromName" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="emailFromAddress">From Email</label>
                                            <input type="email" class="form-control" id="emailFromAddress" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="emailDriver">Mail Driver</label>
                                            <select class="custom-select" id="emailDriver" required>
                                                <option value="smtp">SMTP</option>
                                                <option value="sendmail">Sendmail</option>
                                                <option value="mailgun">Mailgun</option>
                                                <option value="ses">Amazon SES</option>
                                            </select>
                                        </div>
                                        <div id="smtpSettings">
                                            <div class="form-group">
                                                <label for="emailHost">SMTP Host</label>
                                                <input type="text" class="form-control" id="emailHost">
                                            </div>
                                            <div class="form-group">
                                                <label for="emailPort">SMTP Port</label>
                                                <input type="number" class="form-control" id="emailPort">
                                            </div>
                                            <div class="form-group">
                                                <label for="emailUsername">SMTP Username</label>
                                                <input type="text" class="form-control" id="emailUsername">
                                            </div>
                                            <div class="form-group">
                                                <label for="emailPassword">SMTP Password</label>
                                                <input type="password" class="form-control" id="emailPassword">
                                            </div>
                                            <div class="form-group">
                                                <label for="emailEncryption">Encryption</label>
                                                <select class="custom-select" id="emailEncryption">
                                                    <option value="tls">TLS</option>
                                                    <option value="ssl">SSL</option>
                                                    <option value="">None</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="emailVerification">
                                                <label class="custom-control-label" for="emailVerification">Send email verification</label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="emailNotifications">
                                                <label class="custom-control-label" for="emailNotifications">Send email notifications</label>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="tab-pane fade" id="investment" role="tabpanel">
                                    <form id="investmentSettingsForm">
                                        <div class="form-group">
                                            <label for="investmentMinAmount">Minimum Investment Amount</label>
                                            <input type="number" step="0.01" class="form-control" id="investmentMinAmount" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="investmentMaxAmount">Maximum Investment Amount</label>
                                            <input type="number" step="0.01" class="form-control" id="investmentMaxAmount" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="investmentDefaultTerm">Default Investment Term (days)</label>
                                            <input type="number" class="form-control" id="investmentDefaultTerm" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="investmentWithdrawalLock">Withdrawal Lock Period (days)</label>
                                            <input type="number" class="form-control" id="investmentWithdrawalLock" required>
                                        </div>
                                        <div class="form-group">
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="investmentAutoRenewal">
                                                <label class="custom-control-label" for="investmentAutoRenewal">Enable automatic renewal</label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="investmentCompounding">
                                                <label class="custom-control-label" for="investmentCompounding">Enable compounding</label>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="tab-pane fade" id="maintenance" role="tabpanel">
                                    <form id="maintenanceSettingsForm">
                                        <div class="form-group">
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="maintenanceMode">
                                                <label class="custom-control-label" for="maintenanceMode">Enable Maintenance Mode</label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="maintenanceMessage">Maintenance Message</label>
                                            <textarea class="form-control" id="maintenanceMessage" rows="5"></textarea>
                                        </div>
                                        <div class="form-group">
                                            <label for="maintenanceAllowedIps">Allowed IP Addresses</label>
                                            <textarea class="form-control" id="maintenanceAllowedIps" rows="3" placeholder="Enter one IP per line"></textarea>
                                            <small class="form-text text-muted">These IPs will have access during maintenance</small>
                                        </div>
                                        <div class="alert alert-warning">
                                            <i class="fas fa-exclamation-triangle mr-2"></i> Maintenance mode will restrict access to the platform for all users except administrators and specified IP addresses.
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Security Section (Hidden by Default) -->
                <div id="securitySection" class="section-content d-none">
                    <div class="page-header">
                        <div class="page-title">
                            <h1>Security Settings</h1>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#" data-section="dashboard">Dashboard</a></li>
                                <li class="breadcrumb-item active">Security</li>
                            </ul>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-primary" id="saveSecurityBtn">
                                <i class="fas fa-save"></i> Save Settings
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title">Security Configuration</h5>
                        </div>
                        <div class="card-body">
                            <form id="securityForm">
                                <div class="form-group">
                                    <label for="security2fa">Two-Factor Authentication</label>
                                    <select class="custom-select" id="security2fa" required>
                                        <option value="disabled">Disabled</option>
                                        <option value="optional">Optional</option>
                                        <option value="required">Required for all users</option>
                                        <option value="admin">Required for admins only</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="securityLoginAttempts">Max Login Attempts</label>
                                    <input type="number" class="form-control" id="securityLoginAttempts" required>
                                    <small class="form-text text-muted">Number of failed login attempts before account is locked</small>
                                </div>
                                <div class="form-group">
                                    <label for="securityLockoutTime">Account Lockout Time (minutes)</label>
                                    <input type="number" class="form-control" id="securityLockoutTime" required>
                                </div>
                                <div class="form-group">
                                    <label for="securityPasswordAge">Password Age (days)</label>
                                    <input type="number" class="form-control" id="securityPasswordAge" required>
                                    <small class="form-text text-muted">Number of days before users are required to change their password</small>
                                </div>
                                <div class="form-group">
                                    <label for="securityPasswordHistory">Password History</label>
                                    <input type="number" class="form-control" id="securityPasswordHistory" required>
                                    <small class="form-text text-muted">Number of previous passwords to remember (prevent reuse)</small>
                                </div>
                                <div class="form-group">
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="securityHttps">
                                        <label class="custom-control-label" for="securityHttps">Force HTTPS connections</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="securityActivityLog">
                                        <label class="custom-control-label" for="securityActivityLog">Enable activity logging</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="securityIpWhitelist">
                                        <label class="custom-control-label" for="securityIpWhitelist">Enable IP Whitelist</label>
                                    </div>
                                </div>
                                <div class="form-group" id="ipWhitelistGroup" style="display: none;">
                                    <label for="securityAllowedIps">Allowed IP Addresses</label>
                                    <textarea class="form-control" id="securityAllowedIps" rows="3" placeholder="Enter one IP per line"></textarea>
                                    <small class="form-text text-muted">Only these IPs will have access to admin panel</small>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="card mt-4">
                        <div class="card-header">
                            <h5 class="card-title">Admin Sessions</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped" id="sessionsTable">
                                    <thead>
                                        <tr>
                                            <th>IP Address</th>
                                            <th>Device</th>
                                            <th>Location</th>
                                            <th>Last Activity</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Filled by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="card mt-4">
                        <div class="card-header">
                            <h5 class="card-title">Security Logs</h5>
                            <div class="card-actions">
                                <button class="btn btn-sm btn-outline-danger" id="clearSecurityLogsBtn">
                                    <i class="fas fa-trash"></i> Clear Logs
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped" id="securityLogsTable">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Event</th>
                                            <th>IP Address</th>
                                            <th>User</th>
                                            <th>Details</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Filled by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="d-flex justify-content-between">
                                <div class="dataTables_info" id="securityLogsTableInfo">Showing 0 to 0 of 0 entries</div>
                                <div class="dataTables_paginate">
                                    <ul class="pagination" id="securityLogsTablePagination">
                                        <!-- Filled by JavaScript -->
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Profile Section (Hidden by Default) -->
                <div id="profileSection" class="section-content d-none">
                    <div class="page-header">
                        <div class="page-title">
                            <h1>My Profile</h1>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#" data-section="dashboard">Dashboard</a></li>
                                <li class="breadcrumb-item active">Profile</li>
                            </ul>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-primary" id="saveProfileBtn">
                                <i class="fas fa-save"></i> Save Changes
                            </button>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title">Profile Picture</h5>
                                </div>
                                <div class="card-body text-center">
                                    <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="Admin" class="user-avatar-lg rounded-circle mb-3">
                                    <div class="custom-file">
                                        <input type="file" class="custom-file-input" id="profileImage">
                                        <label class="custom-file-label" for="profileImage">Choose file</label>
                                    </div>
                                    <small class="form-text text-muted">Recommended size: 200x200 pixels</small>
                                </div>
                            </div>

                            <div class="card mt-4">
                                <div class="card-header">
                                    <h5 class="card-title">Change Password</h5>
                                </div>
                                <div class="card-body">
                                    <form id="passwordForm">
                                        <div class="form-group">
                                            <label for="currentPassword">Current Password</label>
                                            <input type="password" class="form-control" id="currentPassword" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="newPassword">New Password</label>
                                            <input type="password" class="form-control" id="newPassword" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="confirmNewPassword">Confirm New Password</label>
                                            <input type="password" class="form-control" id="confirmNewPassword" required>
                                        </div>
                                        <button type="submit" class="btn btn-primary w-100">Change Password</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title">Personal Information</h5>
                                </div>
                                <div class="card-body">
                                    <form id="profileForm">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="profileFirstName">First Name</label>
                                                    <input type="text" class="form-control" id="profileFirstName" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="profileLastName">Last Name</label>
                                                    <input type="text" class="form-control" id="profileLastName" required>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="profileEmail">Email Address</label>
                                            <input type="email" class="form-control" id="profileEmail" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="profilePhone">Phone Number</label>
                                            <input type="tel" class="form-control" id="profilePhone">
                                        </div>
                                        <div class="form-group">
                                            <label for="profileTimezone">Timezone</label>
                                            <select class="custom-select" id="profileTimezone" required>
                                                <!-- Filled by JavaScript -->
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="profileBio">Bio</label>
                                            <textarea class="form-control" id="profileBio" rows="3"></textarea>
                                        </div>
                                    </form>
                                </div>
                            </div>

                            <div class="card mt-4">
                                <div class="card-header">
                                    <h5 class="card-title">Two-Factor Authentication</h5>
                                </div>
                                <div class="card-body">
                                    <div class="alert alert-info">
                                        <i class="fas fa-info-circle mr-2"></i> Two-factor authentication adds an extra layer of security to your account.
                                    </div>
                                    <div class="text-center">
                                        <div id="twofaStatus">
                                            <p class="text-danger"><i class="fas fa-times-circle mr-2"></i> Two-factor authentication is currently disabled</p>
                                            <button class="btn btn-primary" id="enableTwofaBtn">Enable 2FA</button>
                                        </div>
                                        <div id="twofaSetup" class="d-none">
                                            <div class="twofa-qrcode" id="twofaQrCode"></div>
                                            <div class="twofa-code" id="twofaSecret"></div>
                                            <p>Scan this QR code with your authenticator app or enter the code manually</p>
                                            <div class="form-group">
                                                <input type="text" class="form-control text-center" id="twofaVerifyCode" placeholder="Enter 6-digit code" maxlength="6">
                                            </div>
                                            <button class="btn btn-success" id="verifyTwofaBtn">Verify & Enable</button>
                                            <button class="btn btn-secondary" id="cancelTwofaBtn">Cancel</button>
                                        </div>
                                        <div id="twofaEnabled" class="d-none">
                                            <p class="text-success"><i class="fas fa-check-circle mr-2"></i> Two-factor authentication is enabled</p>
                                            <button class="btn btn-danger" id="disableTwofaBtn">Disable 2FA</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); z-index: 9999; display: flex; align-items: center; justify-content: center; display: none;">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- Bootstrap Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- DataTables -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/responsive.bootstrap5.min.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Select2 -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    
    <!-- AOS Animation -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- Toastr -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    
    <!-- QR Code Generator -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    
    <!-- Moment.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    
    <!-- Timezone Data -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.34/moment-timezone-with-data.min.js"></script>
    
    <script>
        // Global variables
        let authToken = null;
        let currentUser = null;
        let userGrowthChart = null;
        let userDistributionChart = null;
        
        // Initialize the admin dashboard
        $(document).ready(function() {
            // Check for existing session
            checkAdminSession();
            
            // Initialize plugins
            $('.select2').select2();
            AOS.init();
            toastr.options = {
                positionClass: 'toast-top-right',
                progressBar: true,
                timeOut: 5000,
                closeButton: true
            };
            
            // Event listeners
            $('#loginForm').on('submit', handleLogin);
            $('#forgotPassword').on('click', handleForgotPassword);
            $('#logoutBtn').on('click', handleLogout);
            $('#verifyTwofa').on('click', verifyTwoFactorAuth);
            $('.sidebar-toggle').on('click', toggleSidebar);
            $('#userProfileDropdown').on('click', toggleProfileDropdown);
            $('[data-section]').on('click', navigateToSection);
            $('#addUserBtn').on('click', showAddUserModal);
            $('#saveUserBtn').on('click', saveUser);
            $('#sendNotificationBtn').on('click', showNotificationModal);
            $('#notificationAudience').on('change', toggleCustomUsers);
            $('#sendNotificationNowBtn').on('click', sendNotification);
            $('#createPromotionBtn').on('click', showPromotionModal);
            $('#savePromotionBtn').on('click', savePromotion);
            $('#saveSettingsBtn').on('click', saveSettings);
            $('#saveSecurityBtn').on('click', saveSecuritySettings);
            $('#securityIpWhitelist').on('change', toggleIpWhitelist);
            $('#clearSecurityLogsBtn').on('click', clearSecurityLogs);
            $('#saveProfileBtn').on('click', saveProfile);
            $('#passwordForm').on('submit', changePassword);
            $('#enableTwofaBtn').on('click', setupTwoFactorAuth);
            $('#verifyTwofaBtn').on('click', verifyAndEnableTwofa);
            $('#cancelTwofaBtn').on('click', cancelTwofaSetup);
            $('#disableTwofaBtn').on('click', disableTwoFactorAuth);
            
            // Initialize DataTables
            initDataTables();
            
            // Load timezone data
            loadTimezoneData();
        });
        
        // Check if admin is already logged in
        function checkAdminSession() {
            const token = localStorage.getItem('adminToken');
            if (token) {
                authToken = token;
                verifyToken();
            } else {
                $('#loginPage').removeClass('d-none');
            }
        }
        
        // Verify token with backend
        function verifyToken() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/verify',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        currentUser = response.data.user;
                        $('#adminDashboard').removeClass('d-none');
                        $('#loginPage').addClass('d-none');
                        loadDashboardData();
                        updateUserProfile();
                    } else {
                        localStorage.removeItem('adminToken');
                        $('#loginError').text(response.message).removeClass('d-none');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    localStorage.removeItem('adminToken');
                    showError('Session verification failed. Please login again.');
                }
            });
        }
        
        // Handle admin login
        function handleLogin(e) {
            e.preventDefault();
            
            const email = $('#loginEmail').val().trim();
            const password = $('#loginPassword').val();
            const rememberMe = $('#rememberMe').is(':checked');
            
            if (!email || !password) {
                $('#loginError').text('Please enter both email and password').removeClass('d-none');
                return;
            }
            
            $('#loginBtnText').addClass('d-none');
            $('#loginSpinner').removeClass('d-none');
            $('#loginError').addClass('d-none');
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/login',
                type: 'POST',
                data: JSON.stringify({
                    email: email,
                    password: password
                }),
                contentType: 'application/json',
                success: function(response) {
                    if (response.success) {
                        if (response.data.requires2fa) {
                            // Show 2FA modal
                            $('#twofaModal').modal('show');
                            $('#loginBtnText').removeClass('d-none');
                            $('#loginSpinner').addClass('d-none');
                        } else {
                            // No 2FA required, proceed with login
                            completeLogin(response.data.token, rememberMe);
                        }
                    } else {
                        $('#loginBtnText').removeClass('d-none');
                        $('#loginSpinner').addClass('d-none');
                        $('#loginError').text(response.message).removeClass('d-none');
                    }
                },
                error: function(xhr) {
                    $('#loginBtnText').removeClass('d-none');
                    $('#loginSpinner').addClass('d-none');
                    $('#loginError').text(xhr.responseJSON?.message || 'Login failed. Please try again.').removeClass('d-none');
                }
            });
        }
        
        // Verify 2FA code
        function verifyTwoFactorAuth() {
            const code = $('#twofaCode').val().trim();
            
            if (!code || code.length !== 6) {
                toastr.error('Please enter a valid 6-digit code');
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/verify-2fa',
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                data: JSON.stringify({
                    code: code
                }),
                contentType: 'application/json',
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        $('#twofaModal').modal('hide');
                        completeLogin(response.data.token, $('#rememberMe').is(':checked'));
                    } else {
                        toastr.error(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    toastr.error(xhr.responseJSON?.message || '2FA verification failed');
                }
            });
        }
        
        // Complete login process
        function completeLogin(token, rememberMe) {
            authToken = token;
            if (rememberMe) {
                localStorage.setItem('adminToken', token);
            }
            
            $('#adminDashboard').removeClass('d-none');
            $('#loginPage').addClass('d-none');
            $('#loginBtnText').removeClass('d-none');
            $('#loginSpinner').addClass('d-none');
            
            verifyToken();
        }
        
        // Handle forgot password
        function handleForgotPassword(e) {
            e.preventDefault();
            const email = prompt('Please enter your email address:');
            
            if (email) {
                showLoading();
                
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/auth/forgot-password',
                    type: 'POST',
                    data: JSON.stringify({
                        email: email
                    }),
                    contentType: 'application/json',
                    success: function(response) {
                        hideLoading();
                        if (response.success) {
                            toastr.success('Password reset link has been sent to your email');
                        } else {
                            toastr.error(response.message);
                        }
                    },
                    error: function(xhr) {
                        hideLoading();
                        toastr.error(xhr.responseJSON?.message || 'Failed to send password reset link');
                    }
                });
            }
        }
        
        // Handle logout
        function handleLogout() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/logout',
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    localStorage.removeItem('adminToken');
                    authToken = null;
                    currentUser = null;
                    $('#adminDashboard').addClass('d-none');
                    $('#loginPage').removeClass('d-none');
                    $('#loginEmail').val('');
                    $('#loginPassword').val('');
                },
                error: function(xhr) {
                    hideLoading();
                    localStorage.removeItem('adminToken');
                    authToken = null;
                    currentUser = null;
                    $('#adminDashboard').addClass('d-none');
                    $('#loginPage').removeClass('d-none');
                    $('#loginEmail').val('');
                    $('#loginPassword').val('');
                }
            });
        }
        
        // Toggle sidebar on mobile
        function toggleSidebar() {
            $('.sidebar').toggleClass('show');
        }
        
        // Toggle profile dropdown
        function toggleProfileDropdown(e) {
            e.stopPropagation();
            $('#profileDropdown').toggleClass('show');
            
            // Close dropdown when clicking outside
            $(document).on('click', function(e) {
                if (!$(e.target).closest('#userProfileDropdown').length) {
                    $('#profileDropdown').removeClass('show');
                }
            });
        }
        
        // Navigate between sections
        function navigateToSection(e) {
            e.preventDefault();
            const section = $(this).data('section');
            
            // Update active menu item
            $('.menu-item').removeClass('active');
            $(this).addClass('active');
            
            // Hide all sections
            $('.section-content').addClass('d-none');
            
            // Show selected section
            $(`#${section}Section`).removeClass('d-none');
            
            // Update breadcrumb
            if (section !== 'dashboard') {
                $('.breadcrumb').html(`
                    <li class="breadcrumb-item"><a href="#" data-section="dashboard">Dashboard</a></li>
                    <li class="breadcrumb-item active">${section.charAt(0).toUpperCase() + section.slice(1)}</li>
                `);
            } else {
                $('.breadcrumb').html('<li class="breadcrumb-item active">Dashboard</li>');
            }
            
            // Load section data if needed
            switch(section) {
                case 'dashboard':
                    loadDashboardData();
                    break;
                case 'users':
                    loadUsersTable();
                    break;
                case 'investments':
                    loadInvestmentsTable();
                    break;
                case 'transactions':
                    loadTransactionsTable();
                    break;
                case 'withdrawals':
                    loadWithdrawalsTable();
                    break;
                case 'tickets':
                    loadTicketsTable();
                    break;
                case 'chat':
                    loadChatList();
                    break;
                case 'notifications':
                    loadNotificationsTable();
                    break;
                case 'promotions':
                    loadPromotionsTable();
                    break;
                case 'settings':
                    loadSettings();
                    break;
                case 'security':
                    loadSecuritySettings();
                    loadAdminSessions();
                    loadSecurityLogs();
                    break;
                case 'profile':
                    loadProfile();
                    break;
            }
        }
        
        // Load dashboard data
        function loadDashboardData() {
            showLoading();
            
            // Fetch dashboard stats
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/dashboard/stats',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    if (response.success) {
                        const stats = response.data;
                        
                        // Update stat cards
                        $('#totalUsers').text(stats.totalUsers.toLocaleString());
                        $('#activeInvestments').text(stats.activeInvestments.toLocaleString());
                        $('#totalWithdrawals').text('$' + stats.totalWithdrawals.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                        $('#platformBalance').text('$' + stats.platformBalance.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                        
                        // Update badges
                        $('#pendingUsersBadge').text(stats.pendingUsers);
                        $('#pendingWithdrawalsBadge').text(stats.pendingWithdrawals);
                        $('#openTicketsBadge').text(stats.openTickets);
                        
                        // Load charts
                        loadUserGrowthChart(stats.userGrowth);
                        loadUserDistributionChart(stats.userDistribution);
                        
                        // Load recent transactions
                        loadRecentTransactions(stats.recentTransactions);
                        
                        // Load recent users
                        loadRecentUsers(stats.recentUsers);
                    } else {
                        showError(response.message);
                    }
                    hideLoading();
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load dashboard data');
                }
            });
        }
        
        // Load user growth chart
        function loadUserGrowthChart(data) {
            const ctx = document.getElementById('userGrowthChart').getContext('2d');
            
            if (userGrowthChart) {
                userGrowthChart.destroy();
            }
            
            const labels = data.map(item => moment(item.date).format('MMM D'));
            const values = data.map(item => item.count);
            
            userGrowthChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'New Users',
                        data: values,
                        backgroundColor: 'rgba(0, 211, 149, 0.1)',
                        borderColor: 'rgba(0, 211, 149, 1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(142, 142, 142, 0.1)'
                            },
                            ticks: {
                                color: '#8E8E8E'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#8E8E8E'
                            }
                        }
                    }
                }
            });
        }
        
        // Load user distribution chart
        function loadUserDistributionChart(data) {
            const ctx = document.getElementById('userDistributionChart').getContext('2d');
            
            if (userDistributionChart) {
                userDistributionChart.destroy();
            }
            
            userDistributionChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Active', 'Pending', 'Suspended', 'Inactive'],
                    datasets: [{
                        data: [data.active, data.pending, data.suspended, data.inactive],
                        backgroundColor: [
                            'rgba(0, 211, 149, 0.8)',
                            'rgba(255, 184, 0, 0.8)',
                            'rgba(255, 61, 87, 0.8)',
                            'rgba(142, 142, 142, 0.8)'
                        ],
                        borderColor: [
                            'rgba(0, 211, 149, 1)',
                            'rgba(255, 184, 0, 1)',
                            'rgba(255, 61, 87, 1)',
                            'rgba(142, 142, 142, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#E5E5E5'
                            }
                        }
                    },
                    cutout: '70%'
                }
            });
        }
        
        // Load recent transactions
        function loadRecentTransactions(transactions) {
            const tbody = $('#recentTransactionsTable tbody');
            tbody.empty();
            
            transactions.forEach(tx => {
                let statusClass = '';
                switch(tx.status) {
                    case 'completed':
                        statusClass = 'badge-success';
                        break;
                    case 'pending':
                        statusClass = 'badge-warning';
                        break;
                    case 'failed':
                        statusClass = 'badge-danger';
                        break;
                    default:
                        statusClass = 'badge-secondary';
                }
                
                tbody.append(`
                    <tr>
                        <td>
                            <div class="d-flex align-items-center">
                                <img src="${tx.user.avatar || 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'}" class="user-avatar-sm rounded-circle mr-2">
                                <span>${tx.user.name}</span>
                            </div>
                        </td>
                        <td>$${tx.amount.toFixed(2)}</td>
                        <td>${tx.type.charAt(0).toUpperCase() + tx.type.slice(1)}</td>
                        <td><span class="badge ${statusClass}">${tx.status.charAt(0).toUpperCase() + tx.status.slice(1)}</span></td>
                    </tr>
                `);
            });
        }
        
        // Load recent users
        function loadRecentUsers(users) {
            const tbody = $('#recentUsersTable tbody');
            tbody.empty();
            
            users.forEach(user => {
                let statusClass = '';
                switch(user.status) {
                    case 'active':
                        statusClass = 'badge-success';
                        break;
                    case 'pending':
                        statusClass = 'badge-warning';
                        break;
                    case 'suspended':
                        statusClass = 'badge-danger';
                        break;
                    default:
                        statusClass = 'badge-secondary';
                }
                
                tbody.append(`
                    <tr>
                        <td>
                            <div class="d-flex align-items-center">
                                <img src="${user.avatar || 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'}" class="user-avatar-sm rounded-circle mr-2">
                                <span>${user.name}</span>
                            </div>
                        </td>
                        <td>${moment(user.joinedAt).format('MMM D, YYYY')}</td>
                        <td><span class="badge ${statusClass}">${user.status.charAt(0).toUpperCase() + user.status.slice(1)}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary">View</button>
                        </td>
                    </tr>
                `);
            });
        }
        
        // Initialize DataTables
        function initDataTables() {
            $('#usersTable').DataTable({
                responsive: true,
                dom: '<"top"f>rt<"bottom"lip><"clear">',
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Search users..."
                }
            });
            
            $('#investmentsTable').DataTable({
                responsive: true,
                dom: '<"top"f>rt<"bottom"lip><"clear">',
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Search investments..."
                }
            });
            
            $('#transactionsTable').DataTable({
                responsive: true,
                dom: '<"top"f>rt<"bottom"lip><"clear">',
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Search transactions..."
                }
            });
            
            $('#withdrawalsTable').DataTable({
                responsive: true,
                dom: '<"top"f>rt<"bottom"lip><"clear">',
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Search withdrawals..."
                }
            });
            
            $('#ticketsTable').DataTable({
                responsive: true,
                dom: '<"top"f>rt<"bottom"lip><"clear">',
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Search tickets..."
                }
            });
            
            $('#notificationsTable').DataTable({
                responsive: true,
                dom: '<"top"f>rt<"bottom"lip><"clear">',
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Search notifications..."
                }
            });
            
            $('#promotionsTable').DataTable({
                responsive: true,
                dom: '<"top"f>rt<"bottom"lip><"clear">',
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Search promotions..."
                }
            });
            
            $('#securityLogsTable').DataTable({
                responsive: true,
                dom: '<"top"f>rt<"bottom"lip><"clear">',
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Search logs..."
                }
            });
        }
        
        // Load users table data
        function loadUsersTable() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/users',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const users = response.data.users;
                        const tbody = $('#usersTable tbody');
                        tbody.empty();
                        
                        users.forEach(user => {
                            let statusClass = '';
                            switch(user.status) {
                                case 'active':
                                    statusClass = 'badge-success';
                                    break;
                                case 'pending':
                                    statusClass = 'badge-warning';
                                    break;
                                case 'suspended':
                                    statusClass = 'badge-danger';
                                    break;
                                default:
                                    statusClass = 'badge-secondary';
                            }
                            
                            tbody.append(`
                                <tr>
                                    <td>${user.id}</td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <img src="${user.avatar || 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'}" class="user-avatar-sm rounded-circle mr-2">
                                            <span>${user.name}</span>
                                        </div>
                                    </td>
                                    <td>${user.email}</td>
                                    <td>$${user.balance.toFixed(2)}</td>
                                    <td><span class="badge ${statusClass}">${user.status.charAt(0).toUpperCase() + user.status.slice(1)}</span></td>
                                    <td>${moment(user.createdAt).format('MMM D, YYYY')}</td>
                                    <td>
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline-primary" data-user-id="${user.id}" onclick="editUser(${user.id})">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger" data-user-id="${user.id}" onclick="deleteUser(${user.id})">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `);
                        });
                        
                        // Update table info
                        $('#usersTableInfo').text(`Showing 1 to ${users.length} of ${users.length} entries`);
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load users');
                }
            });
        }
        
        // Show add user modal
        function showAddUserModal() {
            $('#userModalTitle').text('Add New User');
            $('#userId').val('');
            $('#userForm')[0].reset();
            $('#userModal').modal('show');
        }
        
        // Edit user
        function editUser(userId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/users/${userId}`,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const user = response.data.user;
                        
                        $('#userModalTitle').text('Edit User');
                        $('#userId').val(user.id);
                        $('#firstName').val(user.firstName);
                        $('#lastName').val(user.lastName);
                        $('#userEmail').val(user.email);
                        $('#userBalance').val(user.balance);
                        $('#userStatus').val(user.status);
                        $('#userRole').val(user.role);
                        $('#userNotes').val(user.adminNotes || '');
                        
                        $('#userModal').modal('show');
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load user data');
                }
            });
        }
        
        // Save user (add/edit)
        function saveUser() {
            const userId = $('#userId').val();
            const firstName = $('#firstName').val().trim();
            const lastName = $('#lastName').val().trim();
            const email = $('#userEmail').val().trim();
            const password = $('#userPassword').val();
            const confirmPassword = $('#confirmPassword').val();
            const balance = $('#userBalance').val();
            const status = $('#userStatus').val();
            const role = $('#userRole').val();
            const notes = $('#userNotes').val().trim();
            
            // Basic validation
            if (!firstName || !lastName || !email || !balance || isNaN(balance)) {
                toastr.error('Please fill all required fields with valid data');
                return;
            }
            
            if (password && password !== confirmPassword) {
                toastr.error('Passwords do not match');
                return;
            }
            
            const userData = {
                firstName: firstName,
                lastName: lastName,
                email: email,
                balance: parseFloat(balance),
                status: status,
                role: role,
                adminNotes: notes
            };
            
            if (password) {
                userData.password = password;
            }
            
            showLoading();
            
            const url = userId ? `https://website-backendd-1.onrender.com/api/admin/users/${userId}` : 'https://website-backendd-1.onrender.com/api/admin/users';
            const method = userId ? 'PUT' : 'POST';
            
            $.ajax({
                url: url,
                type: method,
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                data: JSON.stringify(userData),
                contentType: 'application/json',
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success(userId ? 'User updated successfully' : 'User created successfully');
                        $('#userModal').modal('hide');
                        loadUsersTable();
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || (userId ? 'Failed to update user' : 'Failed to create user'));
                }
            });
        }
        
        // Delete user
        function deleteUser(userId) {
            if (!confirm('Are you sure you want to delete this user? This action cannot be undone.')) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/users/${userId}`,
                type: 'DELETE',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('User deleted successfully');
                        loadUsersTable();
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to delete user');
                }
            });
        }
        
        // Load investments table data
        function loadInvestmentsTable() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/investments',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const investments = response.data.investments;
                        const tbody = $('#investmentsTable tbody');
                        tbody.empty();
                        
                        investments.forEach(investment => {
                            let statusClass = '';
                            switch(investment.status) {
                                case 'active':
                                    statusClass = 'badge-success';
                                    break;
                                case 'completed':
                                    statusClass = 'badge-primary';
                                    break;
                                case 'cancelled':
                                    statusClass = 'badge-danger';
                                    break;
                                default:
                                    statusClass = 'badge-secondary';
                            }
                            
                            tbody.append(`
                                <tr>
                                    <td>${investment.id}</td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <img src="${investment.user.avatar || 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'}" class="user-avatar-sm rounded-circle mr-2">
                                            <span>${investment.user.name}</span>
                                        </div>
                                    </td>
                                    <td>${investment.plan.name}</td>
                                    <td>$${investment.amount.toFixed(2)}</td>
                                    <td>$${investment.profit.toFixed(2)}</td>
                                    <td>${moment(investment.startDate).format('MMM D, YYYY')}</td>
                                    <td>${moment(investment.endDate).format('MMM D, YYYY')}</td>
                                    <td><span class="badge ${statusClass}">${investment.status.charAt(0).toUpperCase() + investment.status.slice(1)}</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-primary" data-investment-id="${investment.id}">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </td>
                                </tr>
                            `);
                        });
                        
                        // Update table info
                        $('#investmentsTableInfo').text(`Showing 1 to ${investments.length} of ${investments.length} entries`);
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load investments');
                }
            });
        }
        
        // Load transactions table data
        function loadTransactionsTable() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/transactions',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const transactions = response.data.transactions;
                        const tbody = $('#transactionsTable tbody');
                        tbody.empty();
                        
                        transactions.forEach(tx => {
                            let statusClass = '';
                            switch(tx.status) {
                                case 'completed':
                                    statusClass = 'badge-success';
                                    break;
                                case 'pending':
                                    statusClass = 'badge-warning';
                                    break;
                                case 'failed':
                                    statusClass = 'badge-danger';
                                    break;
                                default:
                                    statusClass = 'badge-secondary';
                            }
                            
                            let typeClass = '';
                            switch(tx.type) {
                                case 'deposit':
                                    typeClass = 'text-success';
                                    break;
                                case 'withdrawal':
                                    typeClass = 'text-danger';
                                    break;
                                case 'transfer':
                                    typeClass = 'text-primary';
                                    break;
                                default:
                                    typeClass = 'text-muted';
                            }
                            
                            tbody.append(`
                                <tr>
                                    <td>${tx.id}</td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <img src="${tx.user.avatar || 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'}" class="user-avatar-sm rounded-circle mr-2">
                                            <span>${tx.user.name}</span>
                                        </div>
                                    </td>
                                    <td class="${typeClass}">${tx.type.charAt(0).toUpperCase() + tx.type.slice(1)}</td>
                                    <td>$${tx.amount.toFixed(2)}</td>
                                    <td>$${tx.fee?.toFixed(2) || '0.00'}</td>
                                    <td>${tx.method?.charAt(0).toUpperCase() + tx.method?.slice(1) || 'N/A'}</td>
                                    <td>${moment(tx.createdAt).format('MMM D, YYYY')}</td>
                                    <td><span class="badge ${statusClass}">${tx.status.charAt(0).toUpperCase() + tx.status.slice(1)}</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-primary" data-tx-id="${tx.id}">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </td>
                                </tr>
                            `);
                        });
                        
                        // Update table info
                        $('#transactionsTableInfo').text(`Showing 1 to ${transactions.length} of ${transactions.length} entries`);
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load transactions');
                }
            });
        }
        
        // Load withdrawals table data
        function loadWithdrawalsTable() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/withdrawals/pending',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const withdrawals = response.data.withdrawals;
                        const tbody = $('#withdrawalsTable tbody');
                        tbody.empty();
                        
                        withdrawals.forEach(withdrawal => {
                            tbody.append(`
                                <tr>
                                    <td>${withdrawal.id}</td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <img src="${withdrawal.user.avatar || 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'}" class="user-avatar-sm rounded-circle mr-2">
                                            <span>${withdrawal.user.name}</span>
                                        </div>
                                    </td>
                                    <td>$${withdrawal.amount.toFixed(2)}</td>
                                    <td>$${withdrawal.fee.toFixed(2)}</td>
                                    <td>${withdrawal.method.charAt(0).toUpperCase() + withdrawal.method.slice(1)}</td>
                                    <td>${withdrawal.walletAddress}</td>
                                    <td>${moment(withdrawal.createdAt).format('MMM D, YYYY')}</td>
                                    <td>
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-success" onclick="processWithdrawal(${withdrawal.id}, 'approved')">
                                                <i class="fas fa-check"></i> Approve
                                            </button>
                                            <button class="btn btn-sm btn-danger" onclick="processWithdrawal(${withdrawal.id}, 'rejected')">
                                                <i class="fas fa-times"></i> Reject
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `);
                        });
                        
                        // Update table info
                        $('#withdrawalsTableInfo').text(`Showing 1 to ${withdrawals.length} of ${withdrawals.length} entries`);
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load withdrawals');
                }
            });
        }
        
        // Process withdrawal (approve/reject)
        function processWithdrawal(withdrawalId, action) {
            const actionText = action === 'approved' ? 'approve' : 'reject';
            
            if (!confirm(`Are you sure you want to ${actionText} this withdrawal?`)) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/withdrawals/${withdrawalId}/process`,
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                data: JSON.stringify({
                    action: action
                }),
                contentType: 'application/json',
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success(`Withdrawal ${actionText}d successfully`);
                        loadWithdrawalsTable();
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || `Failed to ${actionText} withdrawal`);
                }
            });
        }
        
        // Load tickets table data
        function loadTicketsTable() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/support/tickets',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const tickets = response.data.tickets;
                        const tbody = $('#ticketsTable tbody');
                        tbody.empty();
                        
                        tickets.forEach(ticket => {
                            let priorityClass = '';
                            switch(ticket.priority) {
                                case 'high':
                                    priorityClass = 'badge-danger';
                                    break;
                                case 'medium':
                                    priorityClass = 'badge-warning';
                                    break;
                                case 'low':
                                    priorityClass = 'badge-primary';
                                    break;
                                default:
                                    priorityClass = 'badge-secondary';
                            }
                            
                            let statusClass = '';
                            switch(ticket.status) {
                                case 'open':
                                    statusClass = 'badge-warning';
                                    break;
                                case 'answered':
                                    statusClass = 'badge-info';
                                    break;
                                case 'closed':
                                    statusClass = 'badge-success';
                                    break;
                                default:
                                    statusClass = 'badge-secondary';
                            }
                            
                            tbody.append(`
                                <tr>
                                    <td>${ticket.id}</td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <img src="${ticket.user.avatar || 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'}" class="user-avatar-sm rounded-circle mr-2">
                                            <span>${ticket.user.name}</span>
                                        </div>
                                    </td>
                                    <td>${ticket.subject}</td>
                                    <td>${ticket.department.charAt(0).toUpperCase() + ticket.department.slice(1)}</td>
                                    <td><span class="badge ${priorityClass}">${ticket.priority.charAt(0).toUpperCase() + ticket.priority.slice(1)}</span></td>
                                    <td>${moment(ticket.updatedAt).format('MMM D, YYYY')}</td>
                                    <td><span class="badge ${statusClass}">${ticket.status.charAt(0).toUpperCase() + ticket.status.slice(1)}</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-primary" onclick="viewTicket(${ticket.id})">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                    </td>
                                </tr>
                            `);
                        });
                        
                        // Update table info
                        $('#ticketsTableInfo').text(`Showing 1 to ${tickets.length} of ${tickets.length} entries`);
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load tickets');
                }
            });
        }
        
        // View ticket details
        function viewTicket(ticketId) {
            // In a real implementation, this would open a modal with ticket details and conversation
            alert(`Viewing ticket #${ticketId} - This would open a detailed view in a real implementation`);
        }
        
        // Load chat list
        function loadChatList() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/chat/conversations',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const conversations = response.data.conversations;
                        const chatList = $('#chatList');
                        chatList.empty();
                        
                        if (conversations.length === 0) {
                            chatList.append(`
                                <div class="text-center py-3 text-muted">
                                    <i class="fas fa-comments fa-2x mb-2"></i>
                                    <p>No active conversations</p>
                                </div>
                            `);
                        } else {
                            conversations.forEach(conversation => {
                                const unreadClass = conversation.unreadCount > 0 ? 'font-weight-bold' : '';
                                const unreadBadge = conversation.unreadCount > 0 ? `<span class="badge badge-primary float-right">${conversation.unreadCount}</span>` : '';
                                
                                chatList.append(`
                                    <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center ${unreadClass}" data-conversation-id="${conversation.id}" onclick="loadConversation('${conversation.id}')">
                                        <div>
                                            <div class="d-flex align-items-center">
                                                <img src="${conversation.user.avatar || 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'}" class="user-avatar-sm rounded-circle mr-2">
                                                <span>${conversation.user.name}</span>
                                            </div>
                                            <small class="text-muted">${conversation.lastMessage?.substring(0, 30) || 'No messages yet'}...</small>
                                        </div>
                                        ${unreadBadge}
                                    </a>
                                `);
                            });
                        }
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load conversations');
                }
            });
        }
        
        // Load conversation messages
        function loadConversation(conversationId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/chat/conversations/${conversationId}`,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const conversation = response.data.conversation;
                        const messages = response.data.messages;
                        
                        // Update chat header
                        const chatHeader = $('.chat-header');
                        chatHeader.html(`
                            <div class="d-flex align-items-center">
                                <img src="${conversation.user.avatar || 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'}" class="user-avatar-sm mr-2">
                                <div>
                                    <h6 class="mb-0">${conversation.user.name}</h6>
                                    <small class="text-muted">${conversation.user.email}</small>
                                </div>
                            </div>
                        `);
                        
                        // Display messages
                        const chatMessages = $('#chatMessages');
                        chatMessages.empty();
                        
                        if (messages.length === 0) {
                            chatMessages.append(`
                                <div class="text-center py-5">
                                    <i class="fas fa-comments fa-3x text-muted mb-3"></i>
                                    <p class="text-muted">No messages in this conversation yet</p>
                                </div>
                            `);
                        } else {
                            messages.forEach(message => {
                                const messageClass = message.sender === 'admin' ? 'message-out' : 'message-in';
                                const messageTime = moment(message.createdAt).format('h:mm A');
                                
                                chatMessages.append(`
                                    <div class="message ${messageClass}">
                                        <div class="message-content">${message.content}</div>
                                        <div class="message-time">${messageTime}</div>
                                    </div>
                                `);
                            });
                            
                            // Scroll to bottom
                            chatMessages.scrollTop(chatMessages[0].scrollHeight);
                        }
                        
                        // Enable chat input
                        $('.chat-input input').attr('disabled', false);
                        $('.chat-input button').attr('disabled', false);
                        $('.chat-input button').off('click').on('click', function() {
                            sendChatMessage(conversationId);
                        });
                        
                        // Mark as read
                        markConversationAsRead(conversationId);
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load conversation');
                }
            });
        }
        
        // Send chat message
        function sendChatMessage(conversationId) {
            const input = $('.chat-input input');
            const message = input.val().trim();
            
            if (!message) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/chat/conversations/${conversationId}/messages`,
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                data: JSON.stringify({
                    content: message
                }),
                contentType: 'application/json',
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        input.val('');
                        loadConversation(conversationId);
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to send message');
                }
            });
        }
        
        // Mark conversation as read
        function markConversationAsRead(conversationId) {
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/chat/conversations/${conversationId}/read`,
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    if (response.success) {
                        // Update unread count in UI
                        $(`[data-conversation-id="${conversationId}"] .badge`).remove();
                    }
                },
                error: function() {
                    // Silently fail
                }
            });
        }
        
        // End chat
        function endChat(conversationId) {
            if (!confirm('Are you sure you want to end this chat?')) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/chat/conversations/${conversationId}/end`,
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('Chat ended successfully');
                        loadChatList();
                        
                        // Reset chat UI
                        $('.chat-header h6').text('Select a conversation');
                        $('.chat-header small').text('No chat selected');
                        $('#chatMessages').html(`
                            <div class="text-center py-5">
                                <i class="fas fa-comments fa-3x text-muted mb-3"></i>
                                <p class="text-muted">Select a conversation to start chatting</p>
                            </div>
                        `);
                        $('.chat-input input').attr('disabled', true);
                        $('.chat-input button').attr('disabled', true);
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to end chat');
                }
            });
        }
        
        // Load notifications table data
        function loadNotificationsTable() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/notifications',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const notifications = response.data.notifications;
                        const tbody = $('#notificationsTable tbody');
                        tbody.empty();
                        
                        notifications.forEach(notification => {
                            let typeClass = '';
                            switch(notification.type) {
                                case 'system':
                                    typeClass = 'badge-primary';
                                    break;
                                case 'promotional':
                                    typeClass = 'badge-success';
                                    break;
                                case 'alert':
                                    typeClass = 'badge-danger';
                                    break;
                                default:
                                    typeClass = 'badge-secondary';
                            }
                            
                            tbody.append(`
                                <tr>
                                    <td>${notification.id}</td>
                                    <td>${notification.title}</td>
                                    <td><span class="badge ${typeClass}">${notification.type.charAt(0).toUpperCase() + notification.type.slice(1)}</span></td>
                                    <td>${notification.recipientCount.toLocaleString()}</td>
                                    <td>${moment(notification.createdAt).format('MMM D, YYYY h:mm A')}</td>
                                    <td><span class="badge ${notification.status === 'sent' ? 'badge-success' : 'badge-warning'}">${notification.status.charAt(0).toUpperCase() + notification.status.slice(1)}</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-primary" onclick="viewNotification(${notification.id})">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                    </td>
                                </tr>
                            `);
                        });
                        
                        // Update table info
                        $('#notificationsTableInfo').text(`Showing 1 to ${notifications.length} of ${notifications.length} entries`);
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load notifications');
                }
            });
        }
        
        // Show notification modal
        function showNotificationModal() {
            $('#notificationForm')[0].reset();
            $('#customUsersGroup').hide();
            $('#notificationModal').modal('show');
            
            // Load users for custom selection
            loadNotificationUsers();
        }
        
        // Load users for notification custom selection
        function loadNotificationUsers() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/users/select',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    if (response.success) {
                        const users = response.data.users;
                        const select = $('#notificationUsers');
                        select.empty();
                        
                        users.forEach(user => {
                            select.append(new Option(user.name + ' (' + user.email + ')', user.id));
                        });
                        
                        select.trigger('change');
                    }
                },
                error: function() {
                    // Silently fail
                }
            });
        }
        
        // Toggle custom users selection
        function toggleCustomUsers() {
            if ($(this).val() === 'custom') {
                $('#customUsersGroup').show();
            } else {
                $('#customUsersGroup').hide();
            }
        }
        
        // Send notification
        function sendNotification() {
            const title = $('#notificationTitle').val().trim();
            const message = $('#notificationMessage').val().trim();
            const type = $('#notificationType').val();
            const audience = $('#notificationAudience').val();
            const userIds = audience === 'custom' ? $('#notificationUsers').val() : [];
            
            if (!title || !message) {
                toastr.error('Please fill all required fields');
                return;
            }
            
            const notificationData = {
                title: title,
                message: message,
                type: type,
                audience: audience
            };
            
            if (userIds && userIds.length > 0) {
                notificationData.userIds = userIds;
            }
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/notifications',
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                data: JSON.stringify(notificationData),
                contentType: 'application/json',
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('Notification sent successfully');
                        $('#notificationModal').modal('hide');
                        loadNotificationsTable();
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to send notification');
                }
            });
        }
        
        // View notification details
        function viewNotification(notificationId) {
            // In a real implementation, this would open a modal with notification details
            alert(`Viewing notification #${notificationId} - This would open a detailed view in a real implementation`);
        }
        
        // Load promotions table data
        function loadPromotionsTable() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/promotions',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const promotions = response.data.promotions;
                        const tbody = $('#promotionsTable tbody');
                        tbody.empty();
                        
                        promotions.forEach(promotion => {
                            let statusClass = '';
                            if (moment().isBefore(moment(promotion.startDate))) {
                                statusClass = 'badge-info';
                            } else if (moment().isAfter(moment(promotion.endDate))) {
                                statusClass = 'badge-secondary';
                            } else {
                                statusClass = 'badge-success';
                            }
                            
                            const statusText = moment().isBefore(moment(promotion.startDate)) ? 
                                'Upcoming' : 
                                (moment().isAfter(moment(promotion.endDate)) ? 'Expired' : 'Active';
                            
                            tbody.append(`
                                <tr>
                                    <td>${promotion.id}</td>
                                    <td>${promotion.title}</td>
                                    <td>${promotion.type.replace('_', ' ').split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')}</td>
                                    <td>${promotion.value}${promotion.type === 'deposit_bonus' || promotion.type === 'investment_discount' ? '%' : ''}</td>
                                    <td>${moment(promotion.startDate).format('MMM D, YYYY')}</td>
                                    <td>${moment(promotion.endDate).format('MMM D, YYYY')}</td>
                                    <td><span class="badge ${statusClass}">${statusText}</span></td>
                                    <td>
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline-primary" onclick="editPromotion(${promotion.id})">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger" onclick="deletePromotion(${promotion.id})">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `);
                        });
                        
                        // Update table info
                        $('#promotionsTableInfo').text(`Showing 1 to ${promotions.length} of ${promotions.length} entries`);
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load promotions');
                }
            });
        }
        
        // Show promotion modal
        function showPromotionModal() {
            $('#promotionForm')[0].reset();
            $('#promotionValueUnit').text('%');
            $('#promotionModal').modal('show');
        }
        
        // Save promotion
        function savePromotion() {
            const title = $('#promotionTitle').val().trim();
            const description = $('#promotionDescription').val().trim();
            const type = $('#promotionType').val();
            const value = $('#promotionValue').val();
            const startDate = $('#promotionStartDate').val();
            const endDate = $('#promotionEndDate').val();
            const isActive = $('#promotionIsActive').is(':checked');
            
            if (!title || !description || !value || !startDate || !endDate) {
                toastr.error('Please fill all required fields');
                return;
            }
            
            if (moment(endDate).isBefore(moment(startDate))) {
                toastr.error('End date must be after start date');
                return;
            }
            
            const promotionData = {
                title: title,
                description: description,
                type: type,
                value: parseFloat(value),
                startDate: startDate,
                endDate: endDate,
                isActive: isActive
            };
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/promotions',
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                data: JSON.stringify(promotionData),
                contentType: 'application/json',
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('Promotion created successfully');
                        $('#promotionModal').modal('hide');
                        loadPromotionsTable();
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to create promotion');
                }
            });
        }
        
        // Edit promotion
        function editPromotion(promotionId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/promotions/${promotionId}`,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const promotion = response.data.promotion;
                        
                        $('#promotionTitle').val(promotion.title);
                        $('#promotionDescription').val(promotion.description);
                        $('#promotionType').val(promotion.type);
                        $('#promotionValue').val(promotion.value);
                        $('#promotionStartDate').val(moment(promotion.startDate).format('YYYY-MM-DDTHH:mm'));
                        $('#promotionEndDate').val(moment(promotion.endDate).format('YYYY-MM-DDTHH:mm'));
                        $('#promotionIsActive').prop('checked', promotion.isActive);
                        
                        // Update value unit based on type
                        $('#promotionValueUnit').text(
                            promotion.type === 'deposit_bonus' || promotion.type === 'investment_discount' ? '%' : ''
                        );
                        
                        $('#promotionModal').modal('show');
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load promotion');
                }
            });
        }
        
        // Delete promotion
        function deletePromotion(promotionId) {
            if (!confirm('Are you sure you want to delete this promotion? This action cannot be undone.')) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/promotions/${promotionId}`,
                type: 'DELETE',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('Promotion deleted successfully');
                        loadPromotionsTable();
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to delete promotion');
                }
            });
        }
        
        // Load settings
        function loadSettings() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/settings',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const settings = response.data.settings;
                        
                        // General settings
                        $('#siteName').val(settings.general.siteName);
                        $('#siteUrl').val(settings.general.siteUrl);
                        $('#siteTimezone').val(settings.general.timezone);
                        $('#siteCurrency').val(settings.general.currency);
                        $('#siteRegistration').prop('checked', settings.general.allowRegistration);
                        $('#siteVerification').prop('checked', settings.general.requireEmailVerification);
                        
                        // Payment settings
                        $('#paymentMinDeposit').val(settings.payment.minDeposit);
                        $('#paymentMinWithdrawal').val(settings.payment.minWithdrawal);
                        $('#paymentWithdrawalFee').val(settings.payment.withdrawalFee);
                        $('#paymentDepositMethods').val(settings.payment.depositMethods).trigger('change');
                        $('#paymentWithdrawalMethods').val(settings.payment.withdrawalMethods).trigger('change');
                        $('#paymentAutoWithdrawal').prop('checked', settings.payment.autoWithdrawal);
                        
                        // Email settings
                        $('#emailFromName').val(settings.email.fromName);
                        $('#emailFromAddress').val(settings.email.fromAddress);
                        $('#emailDriver').val(settings.email.driver);
                        $('#emailHost').val(settings.email.smtpHost);
                        $('#emailPort').val(settings.email.smtpPort);
                        $('#emailUsername').val(settings.email.smtpUsername);
                        $('#emailPassword').val(settings.email.smtpPassword);
                        $('#emailEncryption').val(settings.email.smtpEncryption);
                        $('#emailVerification').prop('checked', settings.email.sendVerification);
                        $('#emailNotifications').prop('checked', settings.email.sendNotifications);
                        
                        // Investment settings
                        $('#investmentMinAmount').val(settings.investment.minAmount);
                        $('#investmentMaxAmount').val(settings.investment.maxAmount);
                        $('#investmentDefaultTerm').val(settings.investment.defaultTerm);
                        $('#investmentWithdrawalLock').val(settings.investment.withdrawalLockPeriod);
                        $('#investmentAutoRenewal').prop('checked', settings.investment.autoRenewal);
                        $('#investmentCompounding').prop('checked', settings.investment.compounding);
                        
                        // Maintenance settings
                        $('#maintenanceMode').prop('checked', settings.maintenance.enabled);
                        $('#maintenanceMessage').val(settings.maintenance.message);
                        $('#maintenanceAllowedIps').val(settings.maintenance.allowedIps.join('\n'));
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load settings');
                }
            });
        }
        
        // Save settings
        function saveSettings() {
            const settings = {
                general: {
                    siteName: $('#siteName').val().trim(),
                    siteUrl: $('#siteUrl').val().trim(),
                    timezone: $('#siteTimezone').val(),
                    currency: $('#siteCurrency').val(),
                    allowRegistration: $('#siteRegistration').is(':checked'),
                    requireEmailVerification: $('#siteVerification').is(':checked')
                },
                payment: {
                    minDeposit: parseFloat($('#paymentMinDeposit').val()),
                    minWithdrawal: parseFloat($('#paymentMinWithdrawal').val()),
                    withdrawalFee: parseFloat($('#paymentWithdrawalFee').val()),
                    depositMethods: $('#paymentDepositMethods').val(),
                    withdrawalMethods: $('#paymentWithdrawalMethods').val(),
                    autoWithdrawal: $('#paymentAutoWithdrawal').is(':checked')
                },
                email: {
                    fromName: $('#emailFromName').val().trim(),
                    fromAddress: $('#emailFromAddress').val().trim(),
                    driver: $('#emailDriver').val(),
                    smtpHost: $('#emailHost').val().trim(),
                    smtpPort: $('#emailPort').val(),
                    smtpUsername: $('#emailUsername').val().trim(),
                    smtpPassword: $('#emailPassword').val(),
                    smtpEncryption: $('#emailEncryption').val(),
                    sendVerification: $('#emailVerification').is(':checked'),
                    sendNotifications: $('#emailNotifications').is(':checked')
                },
                investment: {
                    minAmount: parseFloat($('#investmentMinAmount').val()),
                    maxAmount: parseFloat($('#investmentMaxAmount').val()),
                    defaultTerm: parseInt($('#investmentDefaultTerm').val()),
                    withdrawalLockPeriod: parseInt($('#investmentWithdrawalLock').val()),
                    autoRenewal: $('#investmentAutoRenewal').is(':checked'),
                    compounding: $('#investmentCompounding').is(':checked')
                },
                maintenance: {
                    enabled: $('#maintenanceMode').is(':checked'),
                    message: $('#maintenanceMessage').val().trim(),
                    allowedIps: $('#maintenanceAllowedIps').val().split('\n').map(ip => ip.trim()).filter(ip => ip)
                }
            };
            
            // Basic validation
            if (!settings.general.siteName || !settings.general.siteUrl || !settings.general.timezone || !settings.general.currency) {
                toastr.error('Please fill all required fields in General Settings');
                $('#general-tab').click();
                return;
            }
            
            if (isNaN(settings.payment.minDeposit) || isNaN(settings.payment.minWithdrawal) || isNaN(settings.payment.withdrawalFee)) {
                toastr.error('Please enter valid numbers in Payment Settings');
                $('#payment-tab').click();
                return;
            }
            
            if (!settings.email.fromName || !settings.email.fromAddress || !settings.email.driver) {
                toastr.error('Please fill all required fields in Email Settings');
                $('#email-tab').click();
                return;
            }
            
            if (settings.email.driver === 'smtp' && (!settings.email.smtpHost || !settings.email.smtpPort)) {
                toastr.error('Please fill all required SMTP settings');
                $('#email-tab').click();
                return;
            }
            
            if (isNaN(settings.investment.minAmount) || isNaN(settings.investment.maxAmount) || isNaN(settings.investment.defaultTerm) || isNaN(settings.investment.withdrawalLockPeriod)) {
                toastr.error('Please enter valid numbers in Investment Settings');
                $('#investment-tab').click();
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/settings',
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                data: JSON.stringify(settings),
                contentType: 'application/json',
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('Settings saved successfully');
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to save settings');
                }
            });
        }
        
        // Load security settings
        function loadSecuritySettings() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/security/settings',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const settings = response.data.settings;
                        
                        $('#security2fa').val(settings.twoFactorAuth);
                        $('#securityLoginAttempts').val(settings.maxLoginAttempts);
                        $('#securityLockoutTime').val(settings.lockoutTime);
                        $('#securityPasswordAge').val(settings.passwordAge);
                        $('#securityPasswordHistory').val(settings.passwordHistory);
                        $('#securityHttps').prop('checked', settings.forceHttps);
                        $('#securityActivityLog').prop('checked', settings.activityLogging);
                        $('#securityIpWhitelist').prop('checked', settings.ipWhitelist);
                        $('#securityAllowedIps').val(settings.allowedIps.join('\n'));
                        
                        // Toggle IP whitelist group based on current setting
                        toggleIpWhitelist();
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load security settings');
                }
            });
        }
        
        // Toggle IP whitelist visibility
        function toggleIpWhitelist() {
            if ($(this).is(':checked')) {
                $('#ipWhitelistGroup').show();
            } else {
                $('#ipWhitelistGroup').hide();
            }
        }
        
        // Save security settings
        function saveSecuritySettings() {
            const settings = {
                twoFactorAuth: $('#security2fa').val(),
                maxLoginAttempts: parseInt($('#securityLoginAttempts').val()),
                lockoutTime: parseInt($('#securityLockoutTime').val()),
                passwordAge: parseInt($('#securityPasswordAge').val()),
                passwordHistory: parseInt($('#securityPasswordHistory').val()),
                forceHttps: $('#securityHttps').is(':checked'),
                activityLogging: $('#securityActivityLog').is(':checked'),
                ipWhitelist: $('#securityIpWhitelist').is(':checked'),
                allowedIps: $('#securityAllowedIps').val().split('\n').map(ip => ip.trim()).filter(ip => ip)
            };
            
            // Basic validation
            if (isNaN(settings.maxLoginAttempts) || isNaN(settings.lockoutTime) || isNaN(settings.passwordAge) || isNaN(settings.passwordHistory)) {
                toastr.error('Please enter valid numbers in security settings');
                return;
            }
            
            if (settings.ipWhitelist && settings.allowedIps.length === 0) {
                toastr.error('Please enter at least one allowed IP address');
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/security/settings',
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                data: JSON.stringify(settings),
                contentType: 'application/json',
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('Security settings saved successfully');
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to save security settings');
                }
            });
        }
        
        // Load admin sessions
        function loadAdminSessions() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/security/sessions',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const sessions = response.data.sessions;
                        const tbody = $('#sessionsTable tbody');
                        tbody.empty();
                        
                        sessions.forEach(session => {
                            tbody.append(`
                                <tr>
                                    <td>${session.ip}</td>
                                    <td>${session.device}</td>
                                    <td>${session.location}</td>
                                    <td>${moment(session.lastActivity).fromNow()}</td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-danger" onclick="terminateSession('${session.id}')">
                                            <i class="fas fa-times"></i> Terminate
                                        </button>
                                    </td>
                                </tr>
                            `);
                        });
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load sessions');
                }
            });
        }
        
        // Terminate admin session
        function terminateSession(sessionId) {
            if (!confirm('Are you sure you want to terminate this session?')) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/security/sessions/${sessionId}`,
                type: 'DELETE',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('Session terminated successfully');
                        loadAdminSessions();
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to terminate session');
                }
            });
        }
        
        // Load security logs
        function loadSecurityLogs() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/security/logs',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const logs = response.data.logs;
                        const tbody = $('#securityLogsTable tbody');
                        tbody.empty();
                        
                        logs.forEach(log => {
                            let eventClass = '';
                            switch(log.eventType) {
                                case 'login_success':
                                    eventClass = 'text-success';
                                    break;
                                case 'login_failed':
                                    eventClass = 'text-danger';
                                    break;
                                case 'password_change':
                                    eventClass = 'text-primary';
                                    break;
                                default:
                                    eventClass = 'text-muted';
                            }
                            
                            tbody.append(`
                                <tr>
                                    <td>${moment(log.timestamp).format('MMM D, YYYY h:mm A')}</td>
                                    <td class="${eventClass}">${log.eventType.replace('_', ' ').split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')}</td>
                                    <td>${log.ipAddress}</td>
                                    <td>${log.user?.name || 'System'}</td>
                                    <td>${log.details || 'N/A'}</td>
                                </tr>
                            `);
                        });
                        
                        // Update table info
                        $('#securityLogsTableInfo').text(`Showing 1 to ${logs.length} of ${logs.length} entries`);
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load security logs');
                }
            });
        }
        
        // Clear security logs
        function clearSecurityLogs() {
            if (!confirm('Are you sure you want to clear all security logs? This action cannot be undone.')) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/security/logs',
                type: 'DELETE',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('Security logs cleared successfully');
                        loadSecurityLogs();
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to clear security logs');
                }
            });
        }
        
        // Load profile data
        function loadProfile() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/profile',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const profile = response.data.profile;
                        
                        // Update profile form
                        $('#profileFirstName').val(profile.firstName);
                        $('#profileLastName').val(profile.lastName);
                        $('#profileEmail').val(profile.email);
                        $('#profilePhone').val(profile.phone || '');
                        $('#profileTimezone').val(profile.timezone || 'UTC');
                        $('#profileBio').val(profile.bio || '');
                        
                        // Update 2FA status
                        if (profile.twoFactorEnabled) {
                            $('#twofaStatus').addClass('d-none');
                            $('#twofaSetup').addClass('d-none');
                            $('#twofaEnabled').removeClass('d-none');
                        } else {
                            $('#twofaStatus').removeClass('d-none');
                            $('#twofaSetup').addClass('d-none');
                            $('#twofaEnabled').addClass('d-none');
                        }
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to load profile');
                }
            });
        }
        
        // Save profile
        function saveProfile() {
            const profileData = {
                firstName: $('#profileFirstName').val().trim(),
                lastName: $('#profileLastName').val().trim(),
                email: $('#profileEmail').val().trim(),
                phone: $('#profilePhone').val().trim(),
                timezone: $('#profileTimezone').val(),
                bio: $('#profileBio').val().trim()
            };
            
            // Basic validation
            if (!profileData.firstName || !profileData.lastName || !profileData.email) {
                toastr.error('Please fill all required fields');
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/profile',
                type: 'PUT',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                data: JSON.stringify(profileData),
                contentType: 'application/json',
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('Profile updated successfully');
                        currentUser = response.data.user;
                        updateUserProfile();
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to update profile');
                }
            });
        }
        
        // Change password
        function changePassword(e) {
            e.preventDefault();
            
            const currentPassword = $('#currentPassword').val();
            const newPassword = $('#newPassword').val();
            const confirmPassword = $('#confirmNewPassword').val();
            
            if (!currentPassword || !newPassword || !confirmPassword) {
                toastr.error('Please fill all password fields');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                toastr.error('New passwords do not match');
                return;
            }
            
            if (newPassword.length < 8) {
                toastr.error('Password must be at least 8 characters long');
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/profile/password',
                type: 'PUT',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                data: JSON.stringify({
                    currentPassword: currentPassword,
                    newPassword: newPassword
                }),
                contentType: 'application/json',
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('Password changed successfully');
                        $('#passwordForm')[0].reset();
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to change password');
                }
            });
        }
        
        // Setup 2FA
        function setupTwoFactorAuth() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/profile/2fa/setup',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        const data = response.data;
                        
                        // Generate QR code
                        $('#twofaQrCode').empty();
                        QRCode.toCanvas($('#twofaQrCode')[0], data.qrCodeUrl, function(error) {
                            if (error) {
                                console.error('QR code generation failed:', error);
                            }
                        });
                        
                        // Show secret code
                        $('#twofaSecret').text(data.secret);
                        
                        // Show setup UI
                        $('#twofaStatus').addClass('d-none');
                        $('#twofaSetup').removeClass('d-none');
                        $('#twofaEnabled').addClass('d-none');
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to setup 2FA');
                }
            });
        }
        
        // Verify and enable 2FA
        function verifyAndEnableTwofa() {
            const code = $('#twofaVerifyCode').val().trim();
            
            if (!code || code.length !== 6) {
                toastr.error('Please enter a valid 6-digit code');
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/profile/2fa/verify',
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                data: JSON.stringify({
                    code: code
                }),
                contentType: 'application/json',
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('Two-factor authentication enabled successfully');
                        
                        // Show enabled UI
                        $('#twofaStatus').addClass('d-none');
                        $('#twofaSetup').addClass('d-none');
                        $('#twofaEnabled').removeClass('d-none');
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to verify 2FA code');
                }
            });
        }
        
        // Cancel 2FA setup
        function cancelTwofaSetup() {
            $('#twofaStatus').removeClass('d-none');
            $('#twofaSetup').addClass('d-none');
            $('#twofaEnabled').addClass('d-none');
            $('#twofaVerifyCode').val('');
        }
        
        // Disable 2FA
        function disableTwoFactorAuth() {
            if (!confirm('Are you sure you want to disable two-factor authentication? This reduces your account security.')) {
                return;
            }
            
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/profile/2fa/disable',
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + authToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.success) {
                        toastr.success('Two-factor authentication disabled successfully');
                        
                        // Show disabled UI
                        $('#twofaStatus').removeClass('d-none');
                        $('#twofaSetup').addClass('d-none');
                        $('#twofaEnabled').addClass('d-none');
                    } else {
                        showError(response.message);
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    showError(xhr.responseJSON?.message || 'Failed to disable 2FA');
                }
            });
        }
        
        // Update user profile in topbar
        function updateUserProfile() {
            if (currentUser) {
                $('.user-name').text(currentUser.name);
                $('.user-avatar').attr('src', currentUser.avatar || 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1');
            }
        }
        
        // Load timezone data
        function loadTimezoneData() {
            const timezones = moment.tz.names();
            const profileTimezone = $('#profileTimezone');
            const siteTimezone = $('#siteTimezone');
            
            profileTimezone.empty();
            siteTimezone.empty();
            
            timezones.forEach(tz => {
                profileTimezone.append(new Option(tz, tz));
                siteTimezone.append(new Option(tz, tz));
            });
            
            // Set default timezone
            profileTimezone.val(moment.tz.guess());
            siteTimezone.val('UTC');
        }
        
        // Show loading overlay
        function showLoading() {
            $('.loading-overlay').show();
        }
        
        // Hide loading overlay
        function hideLoading() {
            $('.loading-overlay').hide();
        }
        
        // Show error message
        function showError(message) {
            toastr.error(message);
        }
    </script>
</body>
</html>
