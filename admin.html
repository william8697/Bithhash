<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Admin Dashboard | BitHash LLC - Institutional Bitcoin Mining</title>
    <meta name="description" content="BitHash LLC Admin Dashboard for managing institutional-grade Bitcoin mining operations with enterprise security standards.">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" type="image/png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- DataTables -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css">
    
    <!-- Chart.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.css">
    
    <!-- Select2 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css">
    
    <!-- Toastr -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    
    <style>
        :root {
            --primary: #00D395;
            --primary-dark: #00B783;
            --primary-light: #00E5A1;
            --secondary: #1E1E1E;
            --secondary-dark: #121212;
            --dark: #E5E5E5;
            --darker: #0A0A0A;
            --light: #121212;
            --lighter: #1E1E1E;
            --gray: #8E8E8E;
            --gray-light: #2E2E2E;
            --gray-lighter: #252525;
            --success: #00D395;
            --warning: #FFB800;
            --error: #FF3D57;
            --gold: #D4AF37;
            --security-blue: #1A73E8;
            --security-green: #34A853;
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --box-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: var(--secondary-dark);
            color: var(--dark);
            overflow-x: hidden;
        }

        #admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        #admin-sidebar {
            width: 280px;
            background-color: var(--secondary);
            border-right: 1px solid var(--gray-light);
            transition: var(--transition);
            position: fixed;
            height: 100vh;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sidebar-brand {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-brand img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }

        .sidebar-brand h2 {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark);
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .sidebar-menu ul {
            list-style: none;
        }

        .sidebar-menu li {
            position: relative;
        }

        .sidebar-menu li a {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: var(--gray);
            text-decoration: none;
            transition: var(--transition);
            font-size: 14px;
            font-weight: 500;
        }

        .sidebar-menu li a i {
            margin-right: 10px;
            font-size: 16px;
            width: 20px;
            text-align: center;
        }

        .sidebar-menu li a:hover {
            color: var(--dark);
            background-color: var(--gray-light);
        }

        .sidebar-menu li.active a {
            color: var(--primary);
            background-color: var(--gray-light);
        }

        .sidebar-menu li.active a::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background-color: var(--primary);
        }

        .sidebar-footer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 20px;
            border-top: 1px solid var(--gray-light);
        }

        .admin-profile {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-profile img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .admin-profile-info h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 2px;
        }

        .admin-profile-info p {
            font-size: 12px;
            color: var(--gray);
        }

        /* Main Content Styles */
        #admin-main {
            flex: 1;
            margin-left: 280px;
            transition: var(--transition);
        }

        .admin-header {
            padding: 20px;
            background-color: var(--secondary);
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-left h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .search-box {
            position: relative;
        }

        .search-box input {
            padding: 10px 15px 10px 40px;
            background-color: var(--gray-light);
            border: none;
            border-radius: var(--border-radius);
            color: var(--dark);
            width: 250px;
            font-size: 14px;
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .notification-bell {
            position: relative;
            cursor: pointer;
        }

        .notification-bell i {
            font-size: 20px;
            color: var(--gray);
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--error);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 600;
        }

        .admin-content {
            padding: 20px;
        }

        .content-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .content-header h2 {
            font-size: 20px;
            font-weight: 600;
            color: var(--dark);
        }

        .content-header .breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: var(--gray);
        }

        .content-header .breadcrumb a {
            color: var(--gray);
            text-decoration: none;
            transition: var(--transition);
        }

        .content-header .breadcrumb a:hover {
            color: var(--primary);
        }

        .content-header .breadcrumb i {
            font-size: 12px;
        }

        /* Dashboard Cards */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow-lg);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .card-icon.users {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--primary);
        }

        .card-icon.kyc {
            background-color: rgba(26, 115, 232, 0.1);
            color: var(--security-blue);
        }

        .card-icon.transactions {
            background-color: rgba(212, 175, 55, 0.1);
            color: var(--gold);
        }

        .card-icon.revenue {
            background-color: rgba(52, 168, 83, 0.1);
            color: var(--security-green);
        }

        .card-title {
            font-size: 14px;
            color: var(--gray);
            font-weight: 500;
        }

        .card-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
            margin: 5px 0;
        }

        .card-change {
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .card-change.positive {
            color: var(--success);
        }

        .card-change.negative {
            color: var(--error);
        }

        /* Data Tables */
        .data-table-container {
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
        }

        .table-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .table-header h3 {
            font-size: 18px;
            font-weight: 600;
            color: var(--dark);
        }

        .table-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border-radius: var(--border-radius);
            border: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        .btn-secondary:hover {
            background-color: var(--gray);
        }

        .btn-danger {
            background-color: var(--error);
            color: white;
        }

        .btn-danger:hover {
            background-color: #e2334d;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 12px;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            overflow-y: auto;
        }

        .modal-content {
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 800px;
            margin: 50px auto;
            box-shadow: var(--box-shadow-lg);
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-header h3 {
            font-size: 20px;
            font-weight: 600;
            color: var(--dark);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--error);
        }

        .modal-body {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 10px 15px;
            background-color: var(--gray-light);
            border: 1px solid var(--gray-lighter);
            border-radius: var(--border-radius);
            color: var(--dark);
            font-size: 14px;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 211, 149, 0.2);
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%238E8E8E' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 16px 12px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: var(--gray);
            border-bottom: 2px solid transparent;
            transition: var(--transition);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Live Support Widget */
        .support-widget {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .support-toggle {
            width: 60px;
            height: 60px;
            background-color: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: var(--box-shadow-lg);
            transition: var(--transition);
        }

        .support-toggle:hover {
            background-color: var(--primary-dark);
            transform: scale(1.1);
        }

        .support-container {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-lg);
            overflow: hidden;
            display: none;
        }

        .support-header {
            padding: 15px;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .support-header h4 {
            font-size: 16px;
            font-weight: 600;
        }

        .support-close {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }

        .support-body {
            padding: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        .support-message {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
        }

        .message-user {
            font-size: 12px;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .message-content {
            padding: 10px 15px;
            border-radius: var(--border-radius);
            max-width: 80%;
            font-size: 14px;
        }

        .message-incoming {
            align-items: flex-start;
        }

        .message-incoming .message-content {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        .message-outgoing {
            align-items: flex-end;
        }

        .message-outgoing .message-content {
            background-color: var(--primary);
            color: white;
        }

        .support-footer {
            padding: 15px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            gap: 10px;
        }

        .support-input {
            flex: 1;
            padding: 10px 15px;
            background-color: var(--gray-light);
            border: 1px solid var(--gray-lighter);
            border-radius: var(--border-radius);
            color: var(--dark);
            font-size: 14px;
        }

        .support-send {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 0 15px;
            cursor: pointer;
            transition: var(--transition);
        }

        .support-send:hover {
            background-color: var(--primary-dark);
        }

        /* Responsive Styles */
        @media (max-width: 992px) {
            #admin-sidebar {
                transform: translateX(-100%);
                position: fixed;
                z-index: 1100;
            }

            #admin-sidebar.active {
                transform: translateX(0);
            }

            #admin-main {
                margin-left: 0;
            }

            .sidebar-toggle {
                display: block;
            }
        }

        @media (max-width: 768px) {
            .dashboard-cards {
                grid-template-columns: 1fr 1fr;
            }

            .header-right {
                gap: 10px;
            }

            .search-box input {
                width: 180px;
            }
        }

        @media (max-width: 576px) {
            .dashboard-cards {
                grid-template-columns: 1fr;
            }

            .search-box {
                display: none;
            }

            .support-container {
                width: 300px;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-light);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gray);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* Login Page Styles */
        .login-container {
            display: flex;
            min-height: 100vh;
            background-color: var(--secondary-dark);
        }

        .login-left {
            flex: 1;
            background: linear-gradient(135deg, rgba(0, 211, 149, 0.8), rgba(0, 183, 131, 0.9)), url('https://images.unsplash.com/photo-1639762681057-408e52192e55?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2232&q=80');
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 50px;
            color: white;
            display: none;
        }

        .login-left-content {
            max-width: 500px;
        }

        .login-left h1 {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .login-left p {
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .login-right {
            width: 100%;
            max-width: 500px;
            padding: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            margin: 0 auto;
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .login-header img {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
        }

        .login-header h2 {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .login-header p {
            font-size: 14px;
            color: var(--gray);
        }

        .login-form .form-group {
            margin-bottom: 25px;
        }

        .login-form label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
            color: var(--dark);
        }

        .login-form .form-control {
            width: 100%;
            padding: 12px 15px;
            background-color: var(--secondary);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            color: var(--dark);
            font-size: 14px;
        }

        .form-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
        }

        .remember-me {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .remember-me input {
            width: 16px;
            height: 16px;
            accent-color: var(--primary);
        }

        .remember-me label {
            font-size: 14px;
            color: var(--gray);
            margin: 0;
            cursor: pointer;
        }

        .forgot-password {
            font-size: 14px;
            color: var(--primary);
            text-decoration: none;
            transition: var(--transition);
        }

        .forgot-password:hover {
            text-decoration: underline;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            background-color: var(--primary);
            border: none;
            border-radius: var(--border-radius);
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .login-btn:hover {
            background-color: var(--primary-dark);
        }

        .login-divider {
            display: flex;
            align-items: center;
            margin: 25px 0;
            color: var(--gray);
            font-size: 14px;
        }

        .login-divider::before,
        .login-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background-color: var(--gray-light);
            margin: 0 10px;
        }

        .login-footer {
            text-align: center;
            margin-top: 30px;
            font-size: 14px;
            color: var(--gray);
        }

        .login-footer a {
            color: var(--primary);
            text-decoration: none;
            transition: var(--transition);
        }

        .login-footer a:hover {
            text-decoration: underline;
        }

        /* 2FA Modal */
        .two-factor-modal {
            text-align: center;
        }

        .two-factor-modal img {
            width: 180px;
            height: 180px;
            margin: 20px auto;
            display: block;
        }

        .two-factor-modal p {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 20px;
        }

        .two-factor-input {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
        }

        .two-factor-input input {
            width: 40px;
            height: 50px;
            text-align: center;
            font-size: 20px;
            font-weight: 600;
            background-color: var(--gray-light);
            border: 1px solid var(--gray-lighter);
            border-radius: var(--border-radius);
            color: var(--dark);
        }

        .two-factor-input input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 211, 149, 0.2);
        }

        /* Status Badges */
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-badge.active {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--success);
        }

        .status-badge.suspended {
            background-color: rgba(255, 61, 87, 0.1);
            color: var(--error);
        }

        .status-badge.pending {
            background-color: rgba(255, 184, 0, 0.1);
            color: var(--warning);
        }

        .status-badge.verified {
            background-color: rgba(52, 168, 83, 0.1);
            color: var(--security-green);
        }

        /* Action Buttons */
        .action-btn {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
            font-size: 16px;
            padding: 5px;
        }

        .action-btn:hover {
            color: var(--primary);
        }

        .action-btn.delete:hover {
            color: var(--error);
        }

        /* Loading Spinner */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* DataTables Customization */
        .dataTables_wrapper .dataTables_length,
        .dataTables_wrapper .dataTables_filter,
        .dataTables_wrapper .dataTables_info,
        .dataTables_wrapper .dataTables_paginate {
            color: var(--gray);
        }

        .dataTables_wrapper .dataTables_filter input {
            background-color: var(--gray-light);
            border: 1px solid var(--gray-lighter);
            color: var(--dark);
            padding: 5px 10px;
            border-radius: var(--border-radius);
        }

        .dataTables_wrapper .dataTables_paginate .paginate_button {
            color: var(--gray) !important;
            border: 1px solid var(--gray-light) !important;
            background-color: var(--secondary) !important;
        }

        .dataTables_wrapper .dataTables_paginate .paginate_button.current,
        .dataTables_wrapper .dataTables_paginate .paginate_button.current:hover {
            background-color: var(--primary) !important;
            color: white !important;
            border-color: var(--primary) !important;
        }

        .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
            background-color: var(--gray-light) !important;
            color: var(--dark) !important;
        }

        /* Responsive Tables */
        table.dataTable.dtr-inline.collapsed>tbody>tr>td.dtr-control:before,
        table.dataTable.dtr-inline.collapsed>tbody>tr>th.dtr-control:before {
            background-color: var(--primary);
        }

        /* Chart Container */
        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 30px;
        }

        /* Custom Select2 Styles */
        .select2-container--default .select2-selection--single {
            background-color: var(--gray-light);
            border: 1px solid var(--gray-lighter);
            border-radius: var(--border-radius);
            height: 40px;
        }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            color: var(--dark);
            line-height: 40px;
        }

        .select2-container--default .select2-selection--single .select2-selection__arrow {
            height: 38px;
        }

        .select2-container--default .select2-results__option--selected {
            background-color: var(--gray-light);
        }

        .select2-container--default .select2-results__option--highlighted.select2-results__option--selectable {
            background-color: var(--primary);
            color: white;
        }

        .select2-dropdown {
            background-color: var(--secondary);
            border: 1px solid var(--gray-light);
        }

        /* Toastr Customization */
        .toast {
            background-color: var(--secondary) !important;
            border: 1px solid var(--gray-light) !important;
            color: var(--dark) !important;
            box-shadow: var(--box-shadow-lg) !important;
        }

        .toast-success {
            border-left: 4px solid var(--success) !important;
        }

        .toast-error {
            border-left: 4px solid var(--error) !important;
        }

        .toast-warning {
            border-left: 4px solid var(--warning) !important;
        }

        .toast-info {
            border-left: 4px solid var(--security-blue) !important;
        }

        /* Custom Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--gray-light);
            transition: var(--transition);
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: '';
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: var(--transition);
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        /* Custom Checkbox */
        .custom-checkbox {
            display: flex;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .custom-checkbox input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .checkmark {
            height: 18px;
            width: 18px;
            background-color: var(--gray-light);
            border: 1px solid var(--gray-lighter);
            border-radius: 4px;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .custom-checkbox:hover .checkmark {
            background-color: var(--gray-lighter);
        }

        .custom-checkbox input:checked ~ .checkmark {
            background-color: var(--primary);
            border-color: var(--primary);
        }

        .checkmark:after {
            content: '';
            display: none;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
            margin-top: -2px;
        }

        .custom-checkbox input:checked ~ .checkmark:after {
            display: block;
        }

        /* Custom Radio */
        .custom-radio {
            display: flex;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .custom-radio input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .radiomark {
            height: 18px;
            width: 18px;
            background-color: var(--gray-light);
            border: 1px solid var(--gray-lighter);
            border-radius: 50%;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .custom-radio:hover .radiomark {
            background-color: var(--gray-lighter);
        }

        .custom-radio input:checked ~ .radiomark {
            background-color: var(--primary);
            border-color: var(--primary);
        }

        .radiomark:after {
            content: '';
            display: none;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: white;
        }

        .custom-radio input:checked ~ .radiomark:after {
            display: block;
        }

        /* File Input */
        .file-input-container {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-button {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px 15px;
            background-color: var(--gray-light);
            color: var(--dark);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }

        .file-input-button:hover {
            background-color: var(--gray-lighter);
        }

        .file-input-button i {
            margin-right: 8px;
        }

        .file-input {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-name {
            margin-top: 8px;
            font-size: 12px;
            color: var(--gray);
        }

        /* KYC Verification Section */
        .kyc-verification {
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 30px;
        }

        .kyc-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .kyc-header h3 {
            font-size: 18px;
            font-weight: 600;
            color: var(--dark);
        }

        .kyc-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .kyc-docs {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .kyc-doc {
            background-color: var(--gray-light);
            border-radius: var(--border-radius);
            padding: 15px;
            text-align: center;
        }

        .kyc-doc img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: var(--border-radius);
            margin-bottom: 10px;
        }

        .kyc-doc h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .kyc-doc p {
            font-size: 12px;
            color: var(--gray);
        }

        .kyc-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* User Activity Timeline */
        .activity-timeline {
            position: relative;
            padding-left: 30px;
        }

        .activity-timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: var(--gray-light);
        }

        .activity-item {
            position: relative;
            padding-bottom: 20px;
        }

        .activity-item:last-child {
            padding-bottom: 0;
        }

        .activity-dot {
            position: absolute;
            left: -30px;
            top: 0;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .activity-dot i {
            font-size: 10px;
            color: white;
        }

        .activity-content {
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            padding: 15px;
            box-shadow: var(--box-shadow);
        }

        .activity-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .activity-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark);
        }

        .activity-time {
            font-size: 12px;
            color: var(--gray);
        }

        .activity-description {
            font-size: 13px;
            color: var(--gray);
            line-height: 1.5;
        }

        /* Investment Plan Cards */
        .plan-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .plan-card {
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            border: 1px solid var(--gray-light);
        }

        .plan-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow-lg);
        }

        .plan-card.featured {
            border: 1px solid var(--primary);
            position: relative;
            overflow: hidden;
        }

        .plan-card.featured::after {
            content: 'Featured';
            position: absolute;
            top: 10px;
            right: -30px;
            background-color: var(--primary);
            color: white;
            padding: 3px 30px;
            font-size: 12px;
            font-weight: 600;
            transform: rotate(45deg);
        }

        .plan-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .plan-name {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .plan-price {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .plan-price span {
            font-size: 14px;
            font-weight: 400;
            color: var(--gray);
        }

        .plan-duration {
            font-size: 14px;
            color: var(--gray);
        }

        .plan-features {
            margin-bottom: 25px;
        }

        .plan-feature {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 14px;
            color: var(--dark);
        }

        .plan-feature i {
            margin-right: 10px;
            color: var(--primary);
        }

        .plan-button {
            width: 100%;
            padding: 10px;
            background-color: var(--primary);
            border: none;
            border-radius: var(--border-radius);
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .plan-button:hover {
            background-color: var(--primary-dark);
        }

        /* Transaction History */
        .transaction-history {
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 30px;
        }

        .transaction-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid var(--gray-light);
        }

        .transaction-item:last-child {
            border-bottom: none;
        }

        .transaction-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .transaction-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .transaction-icon.deposit {
            color: var(--success);
        }

        .transaction-icon.withdrawal {
            color: var(--error);
        }

        .transaction-icon.transfer {
            color: var(--security-blue);
        }

        .transaction-icon.investment {
            color: var(--gold);
        }

        .transaction-details h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 3px;
        }

        .transaction-details p {
            font-size: 12px;
            color: var(--gray);
        }

        .transaction-amount {
            text-align: right;
        }

        .transaction-amount h4 {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 3px;
        }

        .transaction-amount p {
            font-size: 12px;
            color: var(--gray);
        }

        /* Loan Calculator */
        .loan-calculator {
            background-color: var(--secondary);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 30px;
        }

        .calculator-result {
            background-color: var(--gray-light);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .calculator-result h3 {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .calculator-result h2 {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .calculator-result p {
            font-size: 12px;
            color: var(--gray);
        }

        .calculator-slider {
            margin-bottom: 20px;
        }

        .calculator-slider label {
            display: block;
            margin-bottom: 10px;
            font-size: 14px;
            font-weight: 500;
            color: var(--dark);
        }

        .calculator-slider .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .calculator-slider input[type="range"] {
            flex: 1;
            height: 8px;
            -webkit-appearance: none;
            background-color: var(--gray-light);
            border-radius: 4px;
            outline: none;
        }

        .calculator-slider input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background-color: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }

        .calculator-slider .slider-value {
            width: 60px;
            padding: 5px;
            background-color: var(--gray-light);
            border: 1px solid var(--gray-lighter);
            border-radius: var(--border-radius);
            text-align: center;
            font-size: 14px;
            color: var(--dark);
        }

        .calculator-button {
            width: 100%;
            padding: 12px;
            background-color: var(--primary);
            border: none;
            border-radius: var(--border-radius);
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .calculator-button:hover {
            background-color: var(--primary-dark);
        }

        /* Responsive Helpers */
        .d-flex {
            display: flex;
        }

        .align-items-center {
            align-items: center;
        }

        .justify-content-between {
            justify-content: space-between;
        }

        .gap-10 {
            gap: 10px;
        }

        .gap-20 {
            gap: 20px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .text-center {
            text-align: center;
        }

        .text-right {
            text-align: right;
        }

        .text-primary {
            color: var(--primary);
        }

        .text-success {
            color: var(--success);
        }

        .text-error {
            color: var(--error);
        }

        .text-warning {
            color: var(--warning);
        }

        .text-gray {
            color: var(--gray);
        }

        .bg-primary {
            background-color: var(--primary);
        }

        .bg-secondary {
            background-color: var(--secondary);
        }

        .bg-gray-light {
            background-color: var(--gray-light);
        }

        .w-100 {
            width: 100%;
        }

        /* Print Styles */
        @media print {
            #admin-sidebar, .admin-header, .support-widget {
                display: none !important;
            }

            #admin-main {
                margin-left: 0 !important;
            }

            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Admin Login Page (Shown when not authenticated) -->
    <div id="login-page" class="login-container">
        <div class="login-left">
            <div class="login-left-content">
                <h1>BitHash LLC Institutional Mining</h1>
                <p>Enterprise-grade Bitcoin mining solutions with institutional security, compliance, and performance.</p>
                <div class="security-badges">
                    <div class="security-badge">
                        <i class="fas fa-shield-alt"></i>
                        <span>256-bit Encryption</span>
                    </div>
                    <div class="security-badge">
                        <i class="fas fa-lock"></i>
                        <span>2FA Protection</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="login-right">
            <div class="login-header">
                <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash Logo">
                <h2>Admin Portal</h2>
                <p>Secure access to institutional controls</p>
            </div>
            <form id="login-form" class="login-form">
                <div class="form-group">
                    <label for="email">Institutional Email</label>
                    <input type="email" id="email" class="form-control" placeholder="admin@bithash.com" required>
                </div>
                <div class="form-group">
                    <label for="password">Security Passphrase</label>
                    <input type="password" id="password" class="form-control" placeholder="••••••••" required>
                    <div class="form-footer">
                        <div class="remember-me">
                            <input type="checkbox" id="remember">
                            <label for="remember">Remember Device</label>
                        </div>
                        <a href="#" class="forgot-password">Forgot Passphrase?</a>
                    </div>
                </div>
                <button type="submit" class="login-btn" id="login-button">
                    <span id="login-text">Authenticate</span>
                    <span id="login-spinner" class="loading-spinner" style="display: none;"></span>
                </button>
                <div class="login-divider">or</div>
                <button type="button" class="login-btn bg-gray-light text-dark" id="google-signin">
                    <i class="fab fa-google"></i> Sign in with Google
                </button>
                <div class="login-footer">
                    <p>Ensure this is a trusted device before authenticating. <a href="#">Security Guidelines</a></p>
                </div>
            </form>
        </div>
    </div>

    <!-- 2FA Verification Modal -->
    <div id="two-factor-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Two-Factor Authentication</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body two-factor-modal">
                <p>Enter the 6-digit code from your authenticator app</p>
                <div class="two-factor-input">
                    <input type="text" maxlength="1" pattern="[0-9]">
                    <input type="text" maxlength="1" pattern="[0-9]">
                    <input type="text" maxlength="1" pattern="[0-9]">
                    <input type="text" maxlength="1" pattern="[0-9]">
                    <input type="text" maxlength="1" pattern="[0-9]">
                    <input type="text" maxlength="1" pattern="[0-9]">
                </div>
                <p>Didn't receive a code? <a href="#" id="resend-code">Resend Code</a></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-2fa">Cancel</button>
                <button class="btn btn-primary" id="verify-2fa">Verify</button>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard (Shown after authentication) -->
    <div id="admin-container" style="display: none;">
        <!-- Sidebar Navigation -->
        <div id="admin-sidebar">
            <div class="sidebar-header">
                <div class="sidebar-brand">
                    <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash Logo">
                    <h2>BitHash Admin</h2>
                </div>
                <button class="sidebar-toggle" id="sidebar-toggle" style="display: none;">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            <div class="sidebar-menu">
                <ul>
                    <li class="active">
                        <a href="#dashboard">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="#users">
                            <i class="fas fa-users"></i>
                            <span>User Management</span>
                        </a>
                    </li>
                    <li>
                        <a href="#kyc">
                            <i class="fas fa-id-card"></i>
                            <span>KYC Verification</span>
                        </a>
                    </li>
                    <li>
                        <a href="#transactions">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Transactions</span>
                        </a>
                    </li>
                    <li>
                        <a href="#investments">
                            <i class="fas fa-chart-line"></i>
                            <span>Investments</span>
                        </a>
                    </li>
                    <li>
                        <a href="#mining">
                            <i class="fas fa-server"></i>
                            <span>Mining Operations</span>
                        </a>
                    </li>
                    <li>
                        <a href="#withdrawals">
                            <i class="fas fa-money-bill-wave"></i>
                            <span>Withdrawals</span>
                        </a>
                    </li>
                    <li>
                        <a href="#loans">
                            <i class="fas fa-hand-holding-usd"></i>
                            <span>Loans</span>
                        </a>
                    </li>
                    <li>
                        <a href="#support">
                            <i class="fas fa-headset"></i>
                            <span>Support Tickets</span>
                        </a>
                    </li>
                    <li>
                        <a href="#reports">
                            <i class="fas fa-file-alt"></i>
                            <span>Reports</span>
                        </a>
                    </li>
                    <li>
                        <a href="#settings">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="sidebar-footer">
                <div class="admin-profile">
                    <img id="admin-avatar" src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="Admin Avatar">
                    <div class="admin-profile-info">
                        <h4 id="admin-name">Loading...</h4>
                        <p id="admin-role">Administrator</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div id="admin-main">
            <div class="admin-header">
                <div class="header-left">
                    <h1 id="page-title">Dashboard</h1>
                </div>
                <div class="header-right">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search users, transactions...">
                    </div>
                    <div class="notification-bell">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">3</span>
                    </div>
                    <button class="btn btn-sm btn-secondary" id="logout-button">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>

            <div class="admin-content">
                <!-- Dashboard Content -->
                <div id="dashboard-content" class="tab-content active">
                    <div class="content-header">
                        <h2>Institutional Overview</h2>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Dashboard</span>
                        </div>
                    </div>

                    <!-- Dashboard Cards -->
                    <div class="dashboard-cards">
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div>
                                    <p class="card-title">Total Users</p>
                                    <h3 class="card-value" id="total-users">5,241,893</h3>
                                    <p class="card-change positive">
                                        <i class="fas fa-arrow-up"></i> 12.5% (30d)
                                    </p>
                                </div>
                                <div class="card-icon users">
                                    <i class="fas fa-users"></i>
                                </div>
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div>
                                    <p class="card-title">Pending KYC</p>
                                    <h3 class="card-value" id="pending-kyc">12,458</h3>
                                    <p class="card-change negative">
                                        <i class="fas fa-arrow-down"></i> 3.2% (30d)
                                    </p>
                                </div>
                                <div class="card-icon kyc">
                                    <i class="fas fa-id-card"></i>
                                </div>
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div>
                                    <p class="card-title">Daily Transactions</p>
                                    <h3 class="card-value" id="daily-transactions">$4.2M</h3>
                                    <p class="card-change positive">
                                        <i class="fas fa-arrow-up"></i> 8.7% (30d)
                                    </p>
                                </div>
                                <div class="card-icon transactions">
                                    <i class="fas fa-exchange-alt"></i>
                                </div>
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div>
                                    <p class="card-title">Mining Revenue</p>
                                    <h3 class="card-value" id="mining-revenue">124.8 BTC</h3>
                                    <p class="card-change positive">
                                        <i class="fas fa-arrow-up"></i> 15.3% (30d)
                                    </p>
                                </div>
                                <div class="card-icon revenue">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row -->
                    <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                        <div class="data-table-container" style="flex: 2; min-width: 300px;">
                            <div class="table-header">
                                <h3>Recent User Activity</h3>
                                <div class="table-actions">
                                    <button class="btn btn-sm btn-secondary">View All</button>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="userActivityChart"></canvas>
                            </div>
                        </div>
                        <div class="data-table-container" style="flex: 1; min-width: 300px;">
                            <div class="table-header">
                                <h3>User Distribution</h3>
                            </div>
                            <div class="chart-container">
                                <canvas id="userDistributionChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Users and Transactions -->
                    <div class="d-flex gap-20" style="flex-wrap: wrap;">
                        <div class="data-table-container" style="flex: 1; min-width: 300px;">
                            <div class="table-header">
                                <h3>Recent Signups</h3>
                                <div class="table-actions">
                                    <button class="btn btn-sm btn-secondary">Export</button>
                                </div>
                            </div>
                            <table id="recent-users-table" class="display nowrap" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Country</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                        <div class="data-table-container" style="flex: 1; min-width: 300px;">
                            <div class="table-header">
                                <h3>Recent Transactions</h3>
                                <div class="table-actions">
                                    <button class="btn btn-sm btn-secondary">Export</button>
                                </div>
                            </div>
                            <table id="recent-transactions-table" class="display nowrap" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Type</th>
                                        <th>Amount</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- User Management Content -->
                <div id="users-content" class="tab-content">
                    <div class="content-header">
                        <h2>User Management</h2>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Users</span>
                        </div>
                    </div>

                    <div class="data-table-container">
                        <div class="table-header">
                            <h3>All Users</h3>
                            <div class="table-actions">
                                <button class="btn btn-sm btn-secondary" id="export-users">
                                    <i class="fas fa-download"></i> Export
                                </button>
                                <button class="btn btn-sm btn-primary" id="add-user">
                                    <i class="fas fa-plus"></i> Add User
                                </button>
                            </div>
                        </div>
                        <table id="users-table" class="display nowrap" style="width:100%">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Country</th>
                                    <th>Balance</th>
                                    <th>Status</th>
                                    <th>KYC</th>
                                    <th>Last Active</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data will be loaded via AJAX -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- KYC Verification Content -->
                <div id="kyc-content" class="tab-content">
                    <div class="content-header">
                        <h2>KYC Verification</h2>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>KYC</span>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="pending">Pending (1,245)</div>
                        <div class="tab" data-tab="approved">Approved (4,856,231)</div>
                        <div class="tab" data-tab="rejected">Rejected (12,458)</div>
                    </div>

                    <div class="tab-content active" id="pending-tab">
                        <div class="data-table-container">
                            <div class="table-header">
                                <h3>Pending Verifications</h3>
                                <div class="table-actions">
                                    <button class="btn btn-sm btn-secondary">
                                        <i class="fas fa-download"></i> Export
                                    </button>
                                </div>
                            </div>
                            <table id="pending-kyc-table" class="display nowrap" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Document Type</th>
                                        <th>Submitted</th>
                                        <th>Country</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="approved-tab">
                        <div class="data-table-container">
                            <div class="table-header">
                                <h3>Approved Verifications</h3>
                                <div class="table-actions">
                                    <button class="btn btn-sm btn-secondary">
                                        <i class="fas fa-download"></i> Export
                                    </button>
                                    <button class="btn btn-sm btn-primary">
                                        <i class="fas fa-filter"></i> Filter
                                    </button>
                                </div>
                            </div>
                            <table id="approved-kyc-table" class="display nowrap" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Document Type</th>
                                        <th>Approved</th>
                                        <th>Country</th>
                                        <th>Verified By</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="rejected-tab">
                        <div class="data-table-container">
                            <div class="table-header">
                                <h3>Rejected Verifications</h3>
                                <div class="table-actions">
                                    <button class="btn btn-sm btn-secondary">
                                        <i class="fas fa-download"></i> Export
                                    </button>
                                    <button class="btn btn-sm btn-primary">
                                        <i class="fas fa-filter"></i> Filter
                                    </button>
                                </div>
                            </div>
                            <table id="rejected-kyc-table" class="display nowrap" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Document Type</th>
                                        <th>Rejected</th>
                                        <th>Country</th>
                                        <th>Reason</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Transactions Content -->
                <div id="transactions-content" class="tab-content">
                    <div class="content-header">
                        <h2>Transaction Management</h2>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Transactions</span>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="all">All Transactions</div>
                        <div class="tab" data-tab="deposits">Deposits</div>
                        <div class="tab" data-tab="withdrawals">Withdrawals</div>
                        <div class="tab" data-tab="transfers">Transfers</div>
                    </div>

                    <div class="tab-content active" id="all-transactions-tab">
                        <div class="data-table-container">
                            <div class="table-header">
                                <h3>All Transactions</h3>
                                <div class="table-actions">
                                    <div class="d-flex gap-10 align-items-center">
                                        <select id="transaction-filter" class="form-control">
                                            <option value="">All Status</option>
                                            <option value="completed">Completed</option>
                                            <option value="pending">Pending</option>
                                            <option value="failed">Failed</option>
                                        </select>
                                        <input type="date" id="transaction-date" class="form-control">
                                        <button class="btn btn-sm btn-secondary">
                                            <i class="fas fa-download"></i> Export
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <table id="all-transactions-table" class="display nowrap" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Type</th>
                                        <th>Amount</th>
                                        <th>Fee</th>
                                        <th>Method</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Other transaction tabs would follow the same pattern -->
                </div>

                <!-- Investments Content -->
                <div id="investments-content" class="tab-content">
                    <div class="content-header">
                        <h2>Investment Management</h2>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Investments</span>
                        </div>
                    </div>

                    <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                        <div class="data-table-container" style="flex: 1; min-width: 300px;">
                            <div class="table-header">
                                <h3>Investment Plans</h3>
                                <div class="table-actions">
                                    <button class="btn btn-sm btn-primary" id="add-investment-plan">
                                        <i class="fas fa-plus"></i> Add Plan
                                    </button>
                                </div>
                            </div>
                            <table id="investment-plans-table" class="display nowrap" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Plan Name</th>
                                        <th>Min Amount</th>
                                        <th>Max Amount</th>
                                        <th>Duration</th>
                                        <th>Daily Profit</th>
                                        <th>Total ROI</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="data-table-container">
                        <div class="table-header">
                            <h3>Active Investments</h3>
                            <div class="table-actions">
                                <button class="btn btn-sm btn-secondary">
                                    <i class="fas fa-download"></i> Export
                                </button>
                                <button class="btn btn-sm btn-primary">
                                    <i class="fas fa-filter"></i> Filter
                                </button>
                            </div>
                        </div>
                        <table id="active-investments-table" class="display nowrap" style="width:100%">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>User</th>
                                    <th>Plan</th>
                                    <th>Amount</th>
                                    <th>Start Date</th>
                                    <th>End Date</th>
                                    <th>Daily Profit</th>
                                    <th>Total Earned</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data will be loaded via AJAX -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Mining Operations Content -->
                <div id="mining-content" class="tab-content">
                    <div class="content-header">
                        <h2>Mining Operations</h2>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Mining</span>
                        </div>
                    </div>

                    <div class="dashboard-cards mb-20">
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div>
                                    <p class="card-title">Total Hashrate</p>
                                    <h3 class="card-value" id="total-hashrate">14.5 EH/s</h3>
                                    <p class="card-change positive">
                                        <i class="fas fa-arrow-up"></i> 5.2% (30d)
                                    </p>
                                </div>
                                <div class="card-icon">
                                    <i class="fas fa-microchip"></i>
                                </div>
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div>
                                    <p class="card-title">Active Miners</p>
                                    <h3 class="card-value" id="active-miners">8,742</h3>
                                    <p class="card-change positive">
                                        <i class="fas fa-arrow-up"></i> 2.1% (30d)
                                    </p>
                                </div>
                                <div class="card-icon">
                                    <i class="fas fa-server"></i>
                                </div>
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div>
                                    <p class="card-title">Daily Production</p>
                                    <h3 class="card-value" id="daily-production">4.2 BTC</h3>
                                    <p class="card-change negative">
                                        <i class="fas fa-arrow-down"></i> 1.5% (30d)
                                    </p>
                                </div>
                                <div class="card-icon">
                                    <i class="fas fa-coins"></i>
                                </div>
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div>
                                    <p class="card-title">Energy Consumption</p>
                                    <h3 class="card-value" id="energy-consumption">42.5 MW</h3>
                                    <p class="card-change positive">
                                        <i class="fas fa-arrow-up"></i> 3.7% (30d)
                                    </p>
                                </div>
                                <div class="card-icon">
                                    <i class="fas fa-bolt"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                        <div class="data-table-container" style="flex: 2; min-width: 300px;">
                            <div class="table-header">
                                <h3>Mining Revenue</h3>
                                <div class="table-actions">
                                    <select id="mining-timeframe" class="form-control">
                                        <option value="7d">Last 7 Days</option>
                                        <option value="30d">Last 30 Days</option>
                                        <option value="90d">Last 90 Days</option>
                                        <option value="1y">Last Year</option>
                                    </select>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="miningRevenueChart"></canvas>
                            </div>
                        </div>
                        <div class="data-table-container" style="flex: 1; min-width: 300px;">
                            <div class="table-header">
                                <h3>Mining Locations</h3>
                            </div>
                            <div class="chart-container">
                                <canvas id="miningLocationsChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="data-table-container">
                        <div class="table-header">
                            <h3>Mining Farms</h3>
                            <div class="table-actions">
                                <button class="btn btn-sm btn-primary" id="add-mining-farm">
                                    <i class="fas fa-plus"></i> Add Farm
                                </button>
                            </div>
                        </div>
                        <table id="mining-farms-table" class="display nowrap" style="width:100%">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Location</th>
                                    <th>Hashrate</th>
                                    <th>Miners</th>
                                    <th>Energy</th>
                                    <th>Temperature</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data will be loaded via AJAX -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Withdrawals Content -->
                <div id="withdrawals-content" class="tab-content">
                    <div class="content-header">
                        <h2>Withdrawal Management</h2>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Withdrawals</span>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="pending">Pending (1,245)</div>
                        <div class="tab" data-tab="completed">Completed (42,856)</div>
                        <div class="tab" data-tab="rejected">Rejected (2,458)</div>
                    </div>

                    <div class="tab-content active" id="pending-withdrawals-tab">
                        <div class="data-table-container">
                            <div class="table-header">
                                <h3>Pending Withdrawals</h3>
                                <div class="table-actions">
                                    <button class="btn btn-sm btn-secondary">
                                        <i class="fas fa-download"></i> Export
                                    </button>
                                </div>
                            </div>
                            <table id="pending-withdrawals-table" class="display nowrap" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Amount</th>
                                        <th>Fee</th>
                                        <th>Method</th>
                                        <th>Wallet/Account</th>
                                        <th>Requested</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Other withdrawal tabs would follow the same pattern -->
                </div>

                <!-- Loans Content -->
                <div id="loans-content" class="tab-content">
                    <div class="content-header">
                        <h2>Loan Management</h2>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Loans</span>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="active">Active Loans (5,241)</div>
                        <div class="tab" data-tab="pending">Pending (842)</div>
                        <div class="tab" data-tab="completed">Completed (12,458)</div>
                        <div class="tab" data-tab="defaulted">Defaulted (458)</div>
                    </div>

                    <div class="tab-content active" id="active-loans-tab">
                        <div class="data-table-container">
                            <div class="table-header">
                                <h3>Active Loans</h3>
                                <div class="table-actions">
                                    <button class="btn btn-sm btn-secondary">
                                        <i class="fas fa-download"></i> Export
                                    </button>
                                    <button class="btn btn-sm btn-primary">
                                        <i class="fas fa-filter"></i> Filter
                                    </button>
                                </div>
                            </div>
                            <table id="active-loans-table" class="display nowrap" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Amount</th>
                                        <th>Collateral</th>
                                        <th>Interest Rate</th>
                                        <th>Duration</th>
                                        <th>Start Date</th>
                                        <th>Due Date</th>
                                        <th>Paid</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Other loan tabs would follow the same pattern -->
                </div>

                <!-- Support Tickets Content -->
                <div id="support-content" class="tab-content">
                    <div class="content-header">
                        <h2>Support Ticket Management</h2>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Support</span>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="open">Open (142)</div>
                        <div class="tab" data-tab="pending">Pending (45)</div>
                        <div class="tab" data-tab="resolved">Resolved (8,542)</div>
                    </div>

                    <div class="tab-content active" id="open-tickets-tab">
                        <div class="data-table-container">
                            <div class="table-header">
                                <h3>Open Tickets</h3>
                                <div class="table-actions">
                                    <button class="btn btn-sm btn-secondary">
                                        <i class="fas fa-download"></i> Export
                                    </button>
                                    <button class="btn btn-sm btn-primary">
                                        <i class="fas fa-filter"></i> Filter
                                    </button>
                                </div>
                            </div>
                            <table id="open-tickets-table" class="display nowrap" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Subject</th>
                                        <th>Category</th>
                                        <th>Priority</th>
                                        <th>Created</th>
                                        <th>Last Reply</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data will be loaded via AJAX -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Other support tabs would follow the same pattern -->
                </div>

                <!-- Reports Content -->
                <div id="reports-content" class="tab-content">
                    <div class="content-header">
                        <h2>Reports & Analytics</h2>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Reports</span>
                        </div>
                    </div>

                    <div class="data-table-container mb-20">
                        <div class="table-header">
                            <h3>Generate Report</h3>
                        </div>
                        <div class="form-group">
                            <label>Report Type</label>
                            <select id="report-type" class="form-control">
                                <option value="">Select Report Type</option>
                                <option value="users">User Growth</option>
                                <option value="transactions">Transaction Volume</option>
                                <option value="revenue">Revenue</option>
                                <option value="mining">Mining Performance</option>
                                <option value="investments">Investment Analysis</option>
                                <option value="withdrawals">Withdrawal Patterns</option>
                                <option value="loans">Loan Portfolio</option>
                                <option value="support">Support Metrics</option>
                            </select>
                        </div>
                        <div class="d-flex gap-20" style="flex-wrap: wrap;">
                            <div class="form-group" style="flex: 1; min-width: 200px;">
                                <label>Start Date</label>
                                <input type="date" id="report-start-date" class="form-control">
                            </div>
                            <div class="form-group" style="flex: 1; min-width: 200px;">
                                <label>End Date</label>
                                <input type="date" id="report-end-date" class="form-control">
                            </div>
                            <div class="form-group" style="flex: 1; min-width: 200px;">
                                <label>Format</label>
                                <select id="report-format" class="form-control">
                                    <option value="pdf">PDF</option>
                                    <option value="csv">CSV</option>
                                    <option value="excel">Excel</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary" id="generate-report">
                                <i class="fas fa-file-export"></i> Generate Report
                            </button>
                        </div>
                    </div>

                    <div class="data-table-container">
                        <div class="table-header">
                            <h3>Report History</h3>
                            <div class="table-actions">
                                <button class="btn btn-sm btn-secondary">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                        </div>
                        <table id="report-history-table" class="display nowrap" style="width:100%">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Report Name</th>
                                    <th>Type</th>
                                    <th>Date Range</th>
                                    <th>Generated</th>
                                    <th>Size</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data will be loaded via AJAX -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Settings Content -->
                <div id="settings-content" class="tab-content">
                    <div class="content-header">
                        <h2>System Settings</h2>
                        <div class="breadcrumb">
                            <a href="#">Home</a>
                            <i class="fas fa-chevron-right"></i>
                            <span>Settings</span>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="general">General</div>
                        <div class="tab" data-tab="security">Security</div>
                        <div class="tab" data-tab="email">Email</div>
                        <div class="tab" data-tab="payment">Payment</div>
                        <div class="tab" data-tab="api">API</div>
                    </div>

                    <div class="tab-content active" id="general-settings-tab">
                        <div class="data-table-container">
                            <form id="general-settings-form">
                                <div class="form-group">
                                    <label>Platform Name</label>
                                    <input type="text" class="form-control" name="platform_name" value="BitHash LLC">
                                </div>
                                <div class="form-group">
                                    <label>Platform URL</label>
                                    <input type="url" class="form-control" name="platform_url" value="https://bithash.com">
                                </div>
                                <div class="form-group">
                                    <label>Platform Email</label>
                                    <input type="email" class="form-control" name="platform_email" value="support@bithash.com">
                                </div>
                                <div class="form-group">
                                    <label>Platform Currency</label>
                                    <select class="form-control" name="platform_currency">
                                        <option value="USD">US Dollar (USD)</option>
                                        <option value="EUR">Euro (EUR)</option>
                                        <option value="GBP">British Pound (GBP)</option>
                                        <option value="BTC">Bitcoin (BTC)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Timezone</label>
                                    <select class="form-control" name="timezone">
                                        <option value="UTC">UTC</option>
                                        <option value="EST">Eastern Time (EST)</option>
                                        <option value="PST">Pacific Time (PST)</option>
                                        <option value="GMT">London (GMT)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Maintenance Mode</label>
                                    <div class="d-flex align-items-center gap-10">
                                        <label class="toggle-switch">
                                            <input type="checkbox" name="maintenance_mode">
                                            <span class="toggle-slider"></span>
                                        </label>
                                        <span>Enable maintenance mode</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Logo</label>
                                    <div class="file-input-container">
                                        <label class="file-input-button">
                                            <i class="fas fa-upload"></i> Upload Logo
                                            <input type="file" class="file-input" accept="image/*">
                                        </label>
                                        <p class="file-name">No file selected</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Favicon</label>
                                    <div class="file-input-container">
                                        <label class="file-input-button">
                                            <i class="fas fa-upload"></i> Upload Favicon
                                            <input type="file" class="file-input" accept="image/*">
                                        </label>
                                        <p class="file-name">No file selected</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save"></i> Save Changes
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Other settings tabs would follow the same pattern -->
                </div>
            </div>
        </div>
    </div>

    <!-- Live Support Widget -->
    <div class="support-widget">
        <div class="support-toggle" id="support-toggle">
            <i class="fas fa-headset"></i>
        </div>
        <div class="support-container" id="support-container">
            <div class="support-header">
                <h4>Live Support</h4>
                <button class="support-close" id="support-close">&times;</button>
            </div>
            <div class="support-body" id="support-messages">
                <div class="support-message message-incoming">
                    <div class="message-user">Support Agent (10:32 AM)</div>
                    <div class="message-content">Hello! How can I help you today?</div>
                </div>
                <div class="support-message message-outgoing">
                    <div class="message-user">You (10:33 AM)</div>
                    <div class="message-content">I need help with a user's withdrawal</div>
                </div>
            </div>
            <div class="support-footer">
                <input type="text" class="support-input" id="support-input" placeholder="Type your message...">
                <button class="support-send" id="support-send">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- User Management Modal -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="user-modal-title">Add New User</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="user-form">
                    <input type="hidden" id="user-id">
                    <div class="d-flex gap-20" style="flex-wrap: wrap;">
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label>First Name</label>
                            <input type="text" id="first-name" class="form-control" required>
                        </div>
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label>Last Name</label>
                            <input type="text" id="last-name" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="user-email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label>Phone</label>
                        <input type="tel" id="user-phone" class="form-control">
                    </div>
                    <div class="form-group">
                        <label>Country</label>
                        <select id="user-country" class="form-control">
                            <option value="">Select Country</option>
                            <option value="US">United States</option>
                            <option value="GB">United Kingdom</option>
                            <!-- More countries would be added here -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="user-status" class="form-control">
                            <option value="active">Active</option>
                            <option value="suspended">Suspended</option>
                            <option value="pending">Pending</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>KYC Status</label>
                        <select id="user-kyc" class="form-control">
                            <option value="verified">Verified</option>
                            <option value="pending">Pending</option>
                            <option value="unverified">Unverified</option>
                            <option value="rejected">Rejected</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Balance (USD)</label>
                        <input type="number" id="user-balance" class="form-control" step="0.01">
                    </div>
                    <div class="form-group">
                        <label>BTC Balance</label>
                        <input type="number" id="user-btc" class="form-control" step="0.00000001">
                    </div>
                    <div class="form-group">
                        <label>Password (leave blank to keep current)</label>
                        <input type="password" id="user-password" class="form-control">
                    </div>
                    <div class="form-group">
                        <label>2FA Enabled</label>
                        <div class="d-flex align-items-center gap-10">
                            <label class="toggle-switch">
                                <input type="checkbox" id="user-2fa">
                                <span class="toggle-slider"></span>
                            </label>
                            <span id="2fa-status">Disabled</span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-user">Cancel</button>
                <button class="btn btn-primary" id="save-user">Save User</button>
            </div>
        </div>
    </div>

    <!-- KYC Verification Modal -->
    <div id="kyc-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>KYC Verification</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="kyc-verification">
                    <div class="kyc-header">
                        <h3>User: <span id="kyc-user-name">John Doe</span></h3>
                        <div class="kyc-status">
                            <span class="status-badge pending">Pending</span>
                        </div>
                    </div>
                    <div class="kyc-docs">
                        <div class="kyc-doc">
                            <img src="https://via.placeholder.com/300x200?text=ID+Front" alt="ID Front" id="kyc-id-front">
                            <h4>ID Front</h4>
                            <p>Submitted: 2023-05-15</p>
                        </div>
                        <div class="kyc-doc">
                            <img src="https://via.placeholder.com/300x200?text=ID+Back" alt="ID Back" id="kyc-id-back">
                            <h4>ID Back</h4>
                            <p>Submitted: 2023-05-15</p>
                        </div>
                        <div class="kyc-doc">
                            <img src="https://via.placeholder.com/300x200?text=Selfie" alt="Selfie" id="kyc-selfie">
                            <h4>Selfie</h4>
                            <p>Submitted: 2023-05-15</p>
                        </div>
                        <div class="kyc-doc">
                            <img src="https://via.placeholder.com/300x200?text=Proof+of+Address" alt="Proof of Address" id="kyc-poa">
                            <h4>Proof of Address</h4>
                            <p>Submitted: 2023-05-15</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Verification Status</label>
                        <select id="kyc-verification-status" class="form-control">
                            <option value="pending">Pending</option>
                            <option value="verified">Verified</option>
                            <option value="rejected">Rejected</option>
                        </select>
                    </div>
                    <div class="form-group" id="rejection-reason-container" style="display: none;">
                        <label>Rejection Reason</label>
                        <select id="kyc-rejection-reason" class="form-control">
                            <option value="">Select Reason</option>
                            <option value="blurry">Blurry/Unreadable</option>
                            <option value="expired">Expired Document</option>
                            <option value="mismatch">Information Mismatch</option>
                            <option value="fake">Suspected Fake</option>
                            <option value="other">Other</option>
                        </select>
                        <textarea id="kyc-rejection-notes" class="form-control mt-10" placeholder="Additional notes..." style="display: none;"></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-kyc">Cancel</button>
                <button class="btn btn-primary" id="save-kyc">Save Verification</button>
            </div>
        </div>
    </div>

    <!-- Transaction Details Modal -->
    <div id="transaction-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Transaction Details</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Transaction ID</h4>
                        <p id="transaction-id">TX-123456789</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>User</h4>
                        <p id="transaction-user">John Doe (ID: 12345)</p>
                    </div>
                </div>
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Type</h4>
                        <p id="transaction-type">Deposit</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Amount</h4>
                        <p id="transaction-amount">$1,000.00</p>
                    </div>
                </div>
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Fee</h4>
                        <p id="transaction-fee">$10.00</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Method</h4>
                        <p id="transaction-method">Bank Transfer</p>
                    </div>
                </div>
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Status</h4>
                        <p id="transaction-status"><span class="status-badge pending">Pending</span></p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Date</h4>
                        <p id="transaction-date">2023-05-15 14:30:22</p>
                    </div>
                </div>
                <div class="form-group">
                    <label>Transaction Notes</label>
                    <textarea id="transaction-notes" class="form-control" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Change Status</label>
                    <select id="transaction-status-change" class="form-control">
                        <option value="pending">Pending</option>
                        <option value="completed">Completed</option>
                        <option value="failed">Failed</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-transaction">Cancel</button>
                <button class="btn btn-primary" id="save-transaction">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Investment Plan Modal -->
    <div id="investment-plan-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="investment-plan-modal-title">Add Investment Plan</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="investment-plan-form">
                    <input type="hidden" id="plan-id">
                    <div class="form-group">
                        <label>Plan Name</label>
                        <input type="text" id="plan-name" class="form-control" required>
                    </div>
                    <div class="d-flex gap-20" style="flex-wrap: wrap;">
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label>Min Amount (USD)</label>
                            <input type="number" id="plan-min-amount" class="form-control" required>
                        </div>
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label>Max Amount (USD)</label>
                            <input type="number" id="plan-max-amount" class="form-control">
                        </div>
                    </div>
                    <div class="d-flex gap-20" style="flex-wrap: wrap;">
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label>Duration (Days)</label>
                            <input type="number" id="plan-duration" class="form-control" required>
                        </div>
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label>Daily Profit (%)</label>
                            <input type="number" id="plan-daily-profit" class="form-control" step="0.01" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Total ROI (%)</label>
                        <input type="number" id="plan-total-roi" class="form-control" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>Plan Features (One per line)</label>
                        <textarea id="plan-features" class="form-control" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="plan-status" class="form-control">
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-plan">Cancel</button>
                <button class="btn btn-primary" id="save-plan">Save Plan</button>
            </div>
        </div>
    </div>

    <!-- Mining Farm Modal -->
    <div id="mining-farm-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="mining-farm-modal-title">Add Mining Farm</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="mining-farm-form">
                    <input type="hidden" id="farm-id">
                    <div class="form-group">
                        <label>Farm Name</label>
                        <input type="text" id="farm-name" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" id="farm-location" class="form-control" required>
                    </div>
                    <div class="d-flex gap-20" style="flex-wrap: wrap;">
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label>Hashrate (TH/s)</label>
                            <input type="number" id="farm-hashrate" class="form-control" required>
                        </div>
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label>Number of Miners</label>
                            <input type="number" id="farm-miners" class="form-control" required>
                        </div>
                    </div>
                    <div class="d-flex gap-20" style="flex-wrap: wrap;">
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label>Energy Consumption (MW)</label>
                            <input type="number" id="farm-energy" class="form-control" step="0.1" required>
                        </div>
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label>Temperature (°C)</label>
                            <input type="number" id="farm-temperature" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Miner Model</label>
                        <input type="text" id="farm-model" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="farm-status" class="form-control">
                            <option value="active">Active</option>
                            <option value="maintenance">Maintenance</option>
                            <option value="offline">Offline</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Farm Image</label>
                        <div class="file-input-container">
                            <label class="file-input-button">
                                <i class="fas fa-upload"></i> Upload Image
                                <input type="file" class="file-input" accept="image/*">
                            </label>
                            <p class="file-name">No file selected</p>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-farm">Cancel</button>
                <button class="btn btn-primary" id="save-farm">Save Farm</button>
            </div>
        </div>
    </div>

    <!-- Withdrawal Approval Modal -->
    <div id="withdrawal-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Withdrawal Approval</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Withdrawal ID</h4>
                        <p id="withdrawal-id">WD-123456789</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>User</h4>
                        <p id="withdrawal-user">John Doe (ID: 12345)</p>
                    </div>
                </div>
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Amount</h4>
                        <p id="withdrawal-amount">$1,000.00</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Fee</h4>
                        <p id="withdrawal-fee">$10.00</p>
                    </div>
                </div>
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Method</h4>
                        <p id="withdrawal-method">Bank Transfer</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Wallet/Account</h4>
                        <p id="withdrawal-wallet">XXXX-XXXX-XXXX-1234</p>
                    </div>
                </div>
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Status</h4>
                        <p id="withdrawal-status"><span class="status-badge pending">Pending</span></p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Requested</h4>
                        <p id="withdrawal-date">2023-05-15 14:30:22</p>
                    </div>
                </div>
                <div class="form-group">
                    <label>Admin Notes</label>
                    <textarea id="withdrawal-notes" class="form-control" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Action</label>
                    <select id="withdrawal-action" class="form-control">
                        <option value="approve">Approve</option>
                        <option value="reject">Reject</option>
                    </select>
                </div>
                <div class="form-group" id="rejection-reason-withdrawal" style="display: none;">
                    <label>Rejection Reason</label>
                    <select id="withdrawal-rejection-reason" class="form-control">
                        <option value="">Select Reason</option>
                        <option value="insufficient_balance">Insufficient Balance</option>
                        <option value="suspicious_activity">Suspicious Activity</option>
                        <option value="kyc_required">KYC Required</option>
                        <option value="other">Other</option>
                    </select>
                    <textarea id="withdrawal-rejection-notes" class="form-control mt-10" placeholder="Additional notes..." style="display: none;"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-withdrawal">Cancel</button>
                <button class="btn btn-primary" id="process-withdrawal">Process Withdrawal</button>
            </div>
        </div>
    </div>

    <!-- Loan Management Modal -->
    <div id="loan-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="loan-modal-title">Loan Details</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Loan ID</h4>
                        <p id="loan-id">LN-123456789</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>User</h4>
                        <p id="loan-user">John Doe (ID: 12345)</p>
                    </div>
                </div>
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Loan Amount</h4>
                        <p id="loan-amount">$5,000.00</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Collateral</h4>
                        <p id="loan-collateral">1.25 BTC</p>
                    </div>
                </div>
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Interest Rate</h4>
                        <p id="loan-interest">8.5%</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Duration</h4>
                        <p id="loan-duration">90 days</p>
                    </div>
                </div>
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Start Date</h4>
                        <p id="loan-start">2023-05-01</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Due Date</h4>
                        <p id="loan-due">2023-07-30</p>
                    </div>
                </div>
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Amount Paid</h4>
                        <p id="loan-paid">$1,250.00</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Status</h4>
                        <p id="loan-status"><span class="status-badge active">Active</span></p>
                    </div>
                </div>
                <div class="form-group">
                    <label>Loan Notes</label>
                    <textarea id="loan-notes" class="form-control" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Change Status</label>
                    <select id="loan-status-change" class="form-control">
                        <option value="pending">Pending</option>
                        <option value="active">Active</option>
                        <option value="completed">Completed</option>
                        <option value="defaulted">Defaulted</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Actions</label>
                    <div class="d-flex gap-10">
                        <button class="btn btn-sm btn-primary" id="add-payment">
                            <i class="fas fa-plus"></i> Add Payment
                        </button>
                        <button class="btn btn-sm btn-secondary" id="view-schedule">
                            <i class="fas fa-calendar"></i> View Schedule
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-loan">Cancel</button>
                <button class="btn btn-primary" id="save-loan">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Support Ticket Modal -->
    <div id="ticket-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="ticket-modal-title">Support Ticket #12345</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>User</h4>
                        <p id="ticket-user">John Doe (ID: 12345)</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Category</h4>
                        <p id="ticket-category">Withdrawal Issue</p>
                    </div>
                </div>
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Priority</h4>
                        <p id="ticket-priority"><span class="status-badge">High</span></p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Status</h4>
                        <p id="ticket-status"><span class="status-badge pending">Open</span></p>
                    </div>
                </div>
                <div class="d-flex gap-20 mb-20" style="flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Created</h4>
                        <p id="ticket-created">2023-05-15 14:30:22</p>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h4>Last Updated</h4>
                        <p id="ticket-updated">2023-05-15 16:45:10</p>
                    </div>
                </div>
                <div class="form-group">
                    <h4>Subject</h4>
                    <p id="ticket-subject">Withdrawal not processed after 3 days</p>
                </div>
                <div class="form-group">
                    <h4>Message</h4>
                    <div class="ticket-message">
                        <p>I initiated a withdrawal 3 days ago but it's still showing as pending. The amount was deducted from my account but hasn't arrived in my bank. Can you please check what's going on?</p>
                    </div>
                </div>
                <div class="form-group">
                    <h4>Attachments</h4>
                    <div class="ticket-attachments">
                        <a href="#" class="btn btn-sm btn-secondary">
                            <i class="fas fa-paperclip"></i> withdrawal_proof.pdf
                        </a>
                    </div>
                </div>
                <div class="form-group">
                    <h4>Conversation</h4>
                    <div class="ticket-conversation">
                        <div class="message incoming">
                            <div class="message-header">
                                <strong>Support Agent</strong> - 2023-05-15 15:10:05
                            </div>
                            <div class="message-content">
                                <p>Hello John, we've checked your withdrawal and it's currently being processed by our finance team. It should be completed within the next 24 hours.</p>
                            </div>
                        </div>
                        <div class="message outgoing">
                            <div class="message-header">
                                <strong>You</strong> - 2023-05-15 16:45:10
                            </div>
                            <div class="message-content">
                                <p>Thanks for the update. I'll check again tomorrow.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Change Status</label>
                    <select id="ticket-status-change" class="form-control">
                        <option value="open">Open</option>
                        <option value="pending">Pending</option>
                        <option value="resolved">Resolved</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Priority</label>
                    <select id="ticket-priority-change" class="form-control">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="critical">Critical</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Reply</label>
                    <textarea id="ticket-reply" class="form-control" rows="3" placeholder="Type your reply here..."></textarea>
                </div>
                <div class="form-group">
                    <label>Attach File</label>
                    <div class="file-input-container">
                        <label class="file-input-button">
                            <i class="fas fa-upload"></i> Choose File
                            <input type="file" class="file-input">
                        </label>
                        <p class="file-name">No file selected</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-ticket">Cancel</button>
                <button class="btn btn-primary" id="save-ticket">Save & Send</button>
            </div>
        </div>
    </div>

    <!-- API Key Modal -->
    <div id="api-key-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="api-key-modal-title">Generate API Key</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="api-key-form">
                    <div class="form-group">
                        <label>Key Name</label>
                        <input type="text" id="api-key-name" class="form-control" placeholder="e.g., Trading Bot Integration" required>
                    </div>
                    <div class="form-group">
                        <label>Permissions</label>
                        <div class="d-flex flex-column gap-10">
                            <label class="custom-checkbox">
                                <input type="checkbox" name="api-permissions" value="read">
                                <span class="checkmark"></span>
                                Read Access
                            </label>
                            <label class="custom-checkbox">
                                <input type="checkbox" name="api-permissions" value="trade">
                                <span class="checkmark"></span>
                                Trade Access
                            </label>
                            <label class="custom-checkbox">
                                <input type="checkbox" name="api-permissions" value="withdraw">
                                <span class="checkmark"></span>
                                Withdrawal Access
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>IP Restrictions (Optional)</label>
                        <textarea id="api-ip-restrictions" class="form-control" rows="2" placeholder="Enter one IP per line"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Expiration (Optional)</label>
                        <input type="date" id="api-expiration" class="form-control">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-api-key">Cancel</button>
                <button class="btn btn-primary" id="generate-api-key">Generate Key</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 id="confirmation-title">Confirm Action</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmation-message">Are you sure you want to perform this action? This cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-confirmation">Cancel</button>
                <button class="btn btn-danger" id="confirm-action">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" style="display: none;">
        <div class="loading-spinner"></div>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Main Admin JavaScript -->
    <script>
        // Global variables
        let adminToken = localStorage.getItem('adminToken');
        let currentAdmin = JSON.parse(localStorage.getItem('currentAdmin'));
        let socket = null;

        // DOM Ready
        $(document).ready(function() {
            // Check authentication state
            checkAuthState();

            // Initialize DataTables
            initDataTables();

            // Initialize Charts
            initCharts();

            // Initialize Event Listeners
            initEventListeners();

            // Initialize Select2
            $('select').select2();

            // Initialize modals
            initModals();

            // Initialize tabs
            initTabs();

            // Initialize support widget
            initSupportWidget();
        });

        // Check authentication state
        function checkAuthState() {
            if (adminToken && currentAdmin) {
                // Verify token with backend
                verifyAdminToken();
            } else {
                // Show login page
                showLoginPage();
            }
        }

        // Verify admin token with backend
        function verifyAdminToken() {
            showLoading();
            
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/verify',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken
                },
                success: function(response) {
                    hideLoading();
                    if (response.valid) {
                        // Token is valid, show admin dashboard
                        showAdminDashboard();
                        // Load admin data
                        loadAdminData();
                        // Connect to WebSocket
                        connectWebSocket();
                    } else {
                        // Token is invalid, show login page
                        showLoginPage();
                    }
                },
                error: function(xhr, status, error) {
                    hideLoading();
                    showLoginPage();
                    showError('Session verification failed. Please login again.');
                }
            });
        }

        // Show login page
        function showLoginPage() {
            $('#login-page').show();
            $('#admin-container').hide();
            // Clear any existing tokens
            localStorage.removeItem('adminToken');
            localStorage.removeItem('currentAdmin');
        }

        // Show admin dashboard
        function showAdminDashboard() {
            $('#login-page').hide();
            $('#admin-container').show();
        }

        // Initialize DataTables
        function initDataTables() {
            // Users Table
            $('#users-table').DataTable({
                responsive: true,
                dom: 'Bfrtip',
                buttons: [
                    'copy', 'csv', 'excel', 'pdf', 'print'
                ],
                ajax: {
                    url: 'https://website-backendd-1.onrender.com/api/admin/users',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken
                    },
                    dataSrc: 'data'
                },
                columns: [
                    { data: 'id' },
                    { data: 'name' },
                    { data: 'email' },
                    { data: 'phone' },
                    { data: 'country' },
                    { data: 'balance', render: function(data) {
                        return '$' + parseFloat(data).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                    }},
                    { data: 'status', render: function(data) {
                        if (data === 'active') {
                            return '<span class="status-badge active">Active</span>';
                        } else if (data === 'suspended') {
                            return '<span class="status-badge suspended">Suspended</span>';
                        } else {
                            return '<span class="status-badge pending">Pending</span>';
                        }
                    }},
                    { data: 'kyc_status', render: function(data) {
                        if (data === 'verified') {
                            return '<span class="status-badge verified">Verified</span>';
                        } else if (data === 'pending') {
                            return '<span class="status-badge pending">Pending</span>';
                        } else {
                            return '<span class="status-badge">Unverified</span>';
                        }
                    }},
                    { data: 'last_active' },
                    { data: null, render: function() {
                        return '<div class="d-flex gap-5">' +
                            '<button class="action-btn edit-user" title="Edit"><i class="fas fa-edit"></i></button>' +
                            '<button class="action-btn delete-user" title="Delete"><i class="fas fa-trash"></i></button>' +
                            '<button class="action-btn view-user" title="View"><i class="fas fa-eye"></i></button>' +
                            '</div>';
                    }}
                ]
            });

            // Recent Users Table
            $('#recent-users-table').DataTable({
                responsive: true,
                ajax: {
                    url: 'https://website-backendd-1.onrender.com/api/admin/users/recent',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken
                    },
                    dataSrc: 'data'
                },
                columns: [
                    { data: 'id' },
                    { data: 'name' },
                    { data: 'email' },
                    { data: 'country' },
                    { data: 'status', render: function(data) {
                        if (data === 'active') {
                            return '<span class="status-badge active">Active</span>';
                        } else {
                            return '<span class="status-badge pending">Pending</span>';
                        }
                    }},
                    { data: 'created_at' },
                    { data: null, render: function() {
                        return '<button class="btn btn-sm btn-primary">View</button>';
                    }}
                ],
                order: [[5, 'desc']]
            });

            // Recent Transactions Table
            $('#recent-transactions-table').DataTable({
                responsive: true,
                ajax: {
                    url: 'https://website-backendd-1.onrender.com/api/admin/transactions/recent',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken
                    },
                    dataSrc: 'data'
                },
                columns: [
                    { data: 'id' },
                    { data: 'user.name' },
                    { data: 'type' },
                    { data: 'amount', render: function(data) {
                        return '$' + parseFloat(data).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                    }},
                    { data: 'status', render: function(data) {
                        if (data === 'completed') {
                            return '<span class="status-badge verified">Completed</span>';
                        } else if (data === 'pending') {
                            return '<span class="status-badge pending">Pending</span>';
                        } else {
                            return '<span class="status-badge suspended">Failed</span>';
                        }
                    }},
                    { data: 'created_at' },
                    { data: null, render: function() {
                        return '<button class="btn btn-sm btn-primary">View</button>';
                    }}
                ],
                order: [[5, 'desc']]
            });

            // Initialize other tables similarly...
        }

        // Initialize Charts
        function initCharts() {
            // User Activity Chart
            const userActivityCtx = document.getElementById('userActivityChart').getContext('2d');
            const userActivityChart = new Chart(userActivityCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                    datasets: [{
                        label: 'New Users',
                        data: [12000, 19000, 3000, 5000, 2000, 3000, 45000],
                        backgroundColor: 'rgba(0, 211, 149, 0.2)',
                        borderColor: 'rgba(0, 211, 149, 1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Active Users',
                        data: [8000, 12000, 25000, 18000, 12000, 20000, 28000],
                        backgroundColor: 'rgba(26, 115, 232, 0.2)',
                        borderColor: 'rgba(26, 115, 232, 1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#E5E5E5'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(46, 46, 46, 1)'
                            },
                            ticks: {
                                color: '#8E8E8E'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(46, 46, 46, 1)'
                            },
                            ticks: {
                                color: '#8E8E8E'
                            }
                        }
                    }
                }
            });

            // User Distribution Chart
            const userDistributionCtx = document.getElementById('userDistributionChart').getContext('2d');
            const userDistributionChart = new Chart(userDistributionCtx, {
                type: 'doughnut',
                data: {
                    labels: ['North America', 'Europe', 'Asia', 'Africa', 'South America', 'Oceania'],
                    datasets: [{
                        data: [35, 30, 20, 5, 7, 3],
                        backgroundColor: [
                            'rgba(0, 211, 149, 0.8)',
                            'rgba(26, 115, 232, 0.8)',
                            'rgba(212, 175, 55, 0.8)',
                            'rgba(52, 168, 83, 0.8)',
                            'rgba(255, 61, 87, 0.8)',
                            'rgba(120, 79, 237, 0.8)'
                        ],
                        borderColor: 'rgba(30, 30, 30, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: '#E5E5E5'
                            }
                        }
                    }
                }
            });

            // Initialize other charts similarly...
        }

        // Initialize Event Listeners
        function initEventListeners() {
            // Login Form
            $('#login-form').on('submit', function(e) {
                e.preventDefault();
                adminLogin();
            });

            // Logout Button
            $('#logout-button').on('click', function() {
                adminLogout();
            });

            // Sidebar Navigation
            $('#admin-sidebar ul li a').on('click', function(e) {
                e.preventDefault();
                const tabId = $(this).attr('href').substring(1);
                showTab(tabId);
            });

            // Add User Button
            $('#add-user').on('click', function() {
                showUserModal('add');
            });

            // Edit User Button (delegated for dynamic content)
            $('#users-table').on('click', '.edit-user', function() {
                const row = $(this).closest('tr');
                const userId = $('#users-table').DataTable().row(row).data().id;
                showUserModal('edit', userId);
            });

            // View User Button (delegated for dynamic content)
            $('#users-table').on('click', '.view-user', function() {
                const row = $(this).closest('tr');
                const userId = $('#users-table').DataTable().row(row).data().id;
                showUserModal('view', userId);
            });

            // Delete User Button (delegated for dynamic content)
            $('#users-table').on('click', '.delete-user', function() {
                const row = $(this).closest('tr');
                const userId = $('#users-table').DataTable().row(row).data().id;
                confirmAction('Delete User', 'Are you sure you want to delete this user? This action cannot be undone.', function() {
                    deleteUser(userId);
                });
            });

            // Save User Button
            $('#save-user').on('click', function() {
                saveUser();
            });

            // Cancel User Button
            $('#cancel-user').on('click', function() {
                $('#user-modal').hide();
            });

            // Initialize other event listeners similarly...
        }

        // Initialize Modals
        function initModals() {
            // User Modal
            $('#user-modal').hide();

            // KYC Modal
            $('#kyc-modal').hide();

            // Transaction Modal
            $('#transaction-modal').hide();

            // Investment Plan Modal
            $('#investment-plan-modal').hide();

            // Mining Farm Modal
            $('#mining-farm-modal').hide();

            // Withdrawal Modal
            $('#withdrawal-modal').hide();

            // Loan Modal
            $('#loan-modal').hide();

            // Ticket Modal
            $('#ticket-modal').hide();

            // API Key Modal
            $('#api-key-modal').hide();

            // Confirmation Modal
            $('#confirmation-modal').hide();

            // Loading Overlay
            $('#loading-overlay').hide();
        }

        // Initialize Tabs
        function initTabs() {
            // KYC Tabs
            $('.kyc-content .tab').on('click', function() {
                const tabId = $(this).data('tab');
                $('.kyc-content .tab').removeClass('active');
                $(this).addClass('active');
                $('.kyc-content .tab-content').removeClass('active');
                $(`#${tabId}-tab`).addClass('active');
            });

            // Transactions Tabs
            $('.transactions-content .tab').on('click', function() {
                const tabId = $(this).data('tab');
                $('.transactions-content .tab').removeClass('active');
                $(this).addClass('active');
                $('.transactions-content .tab-content').removeClass('active');
                $(`#${tabId}-transactions-tab`).addClass('active');
            });

            // Initialize other tabs similarly...
        }

        // Initialize Support Widget
        function initSupportWidget() {
            $('#support-toggle').on('click', function() {
                $('#support-container').toggle();
            });

            $('#support-close').on('click', function() {
                $('#support-container').hide();
            });

            $('#support-send').on('click', function() {
                sendSupportMessage();
            });

            $('#support-input').on('keypress', function(e) {
                if (e.which === 13) {
                    sendSupportMessage();
                }
            });
        }

        // Show Tab Content
        function showTab(tabId) {
            // Update active state in sidebar
            $('#admin-sidebar ul li').removeClass('active');
            $(`#admin-sidebar ul li a[href="#${tabId}"]`).parent().addClass('active');

            // Update page title
            $('#page-title').text($(`#admin-sidebar ul li a[href="#${tabId}"] span`).text());

            // Show the selected tab content
            $('.tab-content').removeClass('active');
            $(`#${tabId}-content`).addClass('active');

            // If this is the reports tab, refresh report data
            if (tabId === 'reports') {
                loadReportData();
            }

            // Scroll to top
            window.scrollTo(0, 0);
        }

        // Admin Login
        function adminLogin() {
            const email = $('#email').val();
            const password = $('#password').val();
            const remember = $('#remember').is(':checked');

            // Validate inputs
            if (!email || !password) {
                showError('Please enter both email and password');
                return;
            }

            // Show loading state
            $('#login-text').hide();
            $('#login-spinner').show();
            $('#login-button').prop('disabled', true);

            // Make API request
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/login',
                type: 'POST',
                data: JSON.stringify({
                    email: email,
                    password: password
                }),
                contentType: 'application/json',
                success: function(response) {
                    // Check if 2FA is required
                    if (response.two_factor_required) {
                        show2FAModal();
                    } else {
                        // Login successful
                        handleSuccessfulLogin(response, remember);
                    }
                },
                error: function(xhr, status, error) {
                    // Reset login button
                    $('#login-text').show();
                    $('#login-spinner').hide();
                    $('#login-button').prop('disabled', false);

                    // Show error message
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Login failed. Please try again.';
                    showError(errorMessage);
                }
            });
        }

        // Show 2FA Modal
        function show2FAModal() {
            // Reset login button
            $('#login-text').show();
            $('#login-spinner').hide();
            $('#login-button').prop('disabled', false);

            // Show 2FA modal
            $('#two-factor-modal').show();

            // Focus first input
            $('#two-factor-modal input').first().focus();

            // Handle input auto-tab
            $('#two-factor-modal input').on('input', function() {
                if ($(this).val().length === 1) {
                    $(this).next('input').focus();
                }
            });

            // Handle verify button
            $('#verify-2fa').on('click', function() {
                verify2FACode();
            });

            // Handle cancel button
            $('#cancel-2fa').on('click', function() {
                $('#two-factor-modal').hide();
            });

            // Handle resend code
            $('#resend-code').on('click', function(e) {
                e.preventDefault();
                resend2FACode();
            });
        }

        // Verify 2FA Code
        function verify2FACode() {
            // Collect all 6 digits
            let code = '';
            $('#two-factor-modal input').each(function() {
                code += $(this).val();
            });

            if (code.length !== 6) {
                showError('Please enter a complete 6-digit code');
                return;
            }

            // Show loading
            $('#verify-2fa').html('<span class="loading-spinner"></span> Verifying...');
            $('#verify-2fa').prop('disabled', true);

            // Verify code with backend
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/verify-2fa',
                type: 'POST',
                data: JSON.stringify({
                    email: $('#email').val(),
                    code: code
                }),
                contentType: 'application/json',
                success: function(response) {
                    // Login successful
                    handleSuccessfulLogin(response, $('#remember').is(':checked'));
                    // Hide 2FA modal
                    $('#two-factor-modal').hide();
                },
                error: function(xhr, status, error) {
                    // Reset verify button
                    $('#verify-2fa').html('Verify');
                    $('#verify-2fa').prop('disabled', false);

                    // Show error message
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Invalid verification code. Please try again.';
                    showError(errorMessage);

                    // Clear inputs and focus first
                    $('#two-factor-modal input').val('');
                    $('#two-factor-modal input').first().focus();
                }
            });
        }

        // Resend 2FA Code
        function resend2FACode() {
            // Show loading
            $('#resend-code').html('<span class="loading-spinner"></span> Sending...');

            // Resend code
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/auth/resend-2fa',
                type: 'POST',
                data: JSON.stringify({
                    email: $('#email').val()
                }),
                contentType: 'application/json',
                success: function() {
                    // Reset resend link
                    $('#resend-code').html('Resend Code');
                    showSuccess('Verification code resent successfully');
                },
                error: function(xhr, status, error) {
                    // Reset resend link
                    $('#resend-code').html('Resend Code');

                    // Show error message
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Failed to resend code. Please try again.';
                    showError(errorMessage);
                }
            });
        }

        // Handle Successful Login
        function handleSuccessfulLogin(response, remember) {
            // Store token and admin data
            adminToken = response.token;
            currentAdmin = response.admin;

            if (remember) {
                localStorage.setItem('adminToken', adminToken);
                localStorage.setItem('currentAdmin', JSON.stringify(currentAdmin));
            } else {
                sessionStorage.setItem('adminToken', adminToken);
                sessionStorage.setItem('currentAdmin', JSON.stringify(currentAdmin));
            }

            // Show admin dashboard
            showAdminDashboard();

            // Load admin data
            loadAdminData();

            // Connect to WebSocket
            connectWebSocket();

            // Reset login form
            $('#login-form')[0].reset();
            $('#login-text').show();
            $('#login-spinner').hide();
            $('#login-button').prop('disabled', false);
        }

        // Admin Logout
        function adminLogout() {
            confirmAction('Logout', 'Are you sure you want to logout?', function() {
                showLoading();
                
                // Make logout request to backend
                $.ajax({
                    url: 'https://website-backendd-1.onrender.com/api/admin/auth/logout',
                    type: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken
                    },
                    success: function() {
                        // Clear local storage
                        localStorage.removeItem('adminToken');
                        localStorage.removeItem('currentAdmin');
                        sessionStorage.removeItem('adminToken');
                        sessionStorage.removeItem('currentAdmin');
                        
                        // Disconnect WebSocket
                        if (socket) {
                            socket.disconnect();
                            socket = null;
                        }
                        
                        // Show login page
                        hideLoading();
                        showLoginPage();
                    },
                    error: function() {
                        // Still clear local storage and show login page even if logout fails
                        localStorage.removeItem('adminToken');
                        localStorage.removeItem('currentAdmin');
                        sessionStorage.removeItem('adminToken');
                        sessionStorage.removeItem('currentAdmin');
                        
                        if (socket) {
                            socket.disconnect();
                            socket = null;
                        }
                        
                        hideLoading();
                        showLoginPage();
                    }
                });
            });
        }

        // Load Admin Data
        function loadAdminData() {
            // Set admin name and avatar
            $('#admin-name').text(currentAdmin.name);
            if (currentAdmin.avatar) {
                $('#admin-avatar').attr('src', currentAdmin.avatar);
            }

            // Load dashboard stats
            loadDashboardStats();

            // Load notifications
            loadNotifications();
        }

        // Load Dashboard Stats
        function loadDashboardStats() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/stats',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken
                },
                success: function(response) {
                    // Update user count
                    $('#total-users').text(response.total_users.toLocaleString());
                    
                    // Update pending KYC
                    $('#pending-kyc').text(response.pending_kyc.toLocaleString());
                    
                    // Update daily transactions
                    $('#daily-transactions').text('$' + response.daily_transactions.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                    
                    // Update mining revenue
                    $('#mining-revenue').text(response.mining_revenue.toFixed(8) + ' BTC');
                    
                    // Update other stats as needed...
                },
                error: function() {
                    showError('Failed to load dashboard statistics');
                }
            });
        }

        // Load Notifications
        function loadNotifications() {
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/notifications',
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken
                },
                success: function(response) {
                    // Update notification badge
                    if (response.unread_count > 0) {
                        $('.notification-badge').text(response.unread_count).show();
                    } else {
                        $('.notification-badge').hide();
                    }
                    
                    // TODO: Implement notification dropdown
                },
                error: function() {
                    // Silently fail for notifications
                }
            });
        }

        // Connect to WebSocket
        function connectWebSocket() {
            // Disconnect existing connection if any
            if (socket) {
                socket.disconnect();
            }

            // Connect to WebSocket server
            socket = io('https://website-backendd-1.onrender.com', {
                transports: ['websocket'],
                query: {
                    token: adminToken
                }
            });

            // Handle connection events
            socket.on('connect', function() {
                console.log('WebSocket connected');
            });

            socket.on('disconnect', function() {
                console.log('WebSocket disconnected');
            });

            socket.on('error', function(error) {
                console.error('WebSocket error:', error);
            });

            // Handle real-time events
            socket.on('new_user', function(data) {
                // Show notification
                showNotification('New User', `${data.name} just signed up`);
                
                // Refresh users table if on users page
                if ($('#users-content').hasClass('active')) {
                    $('#users-table').DataTable().ajax.reload();
                }
                
                // Refresh dashboard stats
                loadDashboardStats();
            });

            socket.on('new_transaction', function(data) {
                // Show notification if transaction requires approval
                if (data.type === 'withdrawal' && data.status === 'pending') {
                    showNotification('New Withdrawal', `$${data.amount} withdrawal requested`);
                }
                
                // Refresh transactions table if on transactions page
                if ($('#transactions-content').hasClass('active')) {
                    $('#all-transactions-table').DataTable().ajax.reload();
                }
                
                // Refresh dashboard stats
                loadDashboardStats();
            });

            socket.on('new_ticket', function(data) {
                // Show notification
                showNotification('New Support Ticket', `Ticket #${data.id}: ${data.subject}`);
                
                // Refresh tickets table if on support page
                if ($('#support-content').hasClass('active')) {
                    $('#open-tickets-table').DataTable().ajax.reload();
                }
            });

            // Handle other real-time events as needed...
        }

        // Show User Modal
        function showUserModal(action, userId = null) {
            // Reset form
            $('#user-form')[0].reset();
            
            // Set modal title
            if (action === 'add') {
                $('#user-modal-title').text('Add New User');
                $('#save-user').text('Add User').show();
            } else if (action === 'edit') {
                $('#user-modal-title').text('Edit User');
                $('#save-user').text('Save Changes').show();
            } else {
                $('#user-modal-title').text('User Details');
                $('#save-user').hide();
            }
            
            // If editing or viewing, load user data
            if (action !== 'add' && userId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/users/${userId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken
                    },
                    success: function(response) {
                        hideLoading();
                        
                        // Populate form
                        $('#user-id').val(response.id);
                        $('#first-name').val(response.first_name);
                        $('#last-name').val(response.last_name);
                        $('#user-email').val(response.email);
                        $('#user-phone').val(response.phone);
                        $('#user-country').val(response.country).trigger('change');
                        $('#user-status').val(response.status).trigger('change');
                        $('#user-kyc').val(response.kyc_status).trigger('change');
                        $('#user-balance').val(response.balance);
                        $('#user-btc').val(response.btc_balance);
                        $('#user-2fa').prop('checked', response.two_factor_enabled);
                        $('#2fa-status').text(response.two_factor_enabled ? 'Enabled' : 'Disabled');
                        
                        // Disable fields if viewing
                        if (action === 'view') {
                            $('#user-form input, #user-form select').prop('disabled', true);
                        } else {
                            $('#user-form input, #user-form select').prop('disabled', false);
                        }
                        
                        // Show modal
                        $('#user-modal').show();
                    },
                    error: function() {
                        hideLoading();
                        showError('Failed to load user data');
                    }
                });
            } else {
                // Enable all fields for new user
                $('#user-form input, #user-form select').prop('disabled', false);
                
                // Show modal
                $('#user-modal').show();
            }
        }

        // Save User
        function saveUser() {
            // Validate form
            if (!$('#first-name').val() || !$('#last-name').val() || !$('#user-email').val()) {
                showError('Please fill in all required fields');
                return;
            }
            
            // Prepare data
            const userData = {
                first_name: $('#first-name').val(),
                last_name: $('#last-name').val(),
                email: $('#user-email').val(),
                phone: $('#user-phone').val(),
                country: $('#user-country').val(),
                status: $('#user-status').val(),
                kyc_status: $('#user-kyc').val(),
                balance: parseFloat($('#user-balance').val()) || 0,
                btc_balance: parseFloat($('#user-btc').val()) || 0,
                two_factor_enabled: $('#user-2fa').is(':checked')
            };
            
            // If password is provided, add it to the data
            if ($('#user-password').val()) {
                userData.password = $('#user-password').val();
            }
            
            // Determine if we're creating or updating
            const userId = $('#user-id').val();
            const isUpdate = !!userId;
            
            showLoading();
            
            // Make API request
            $.ajax({
                url: isUpdate ? `https://website-backendd-1.onrender.com/api/admin/users/${userId}` : 'https://website-backendd-1.onrender.com/api/admin/users',
                type: isUpdate ? 'PUT' : 'POST',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'Content-Type': 'application/json'
                },
                data: JSON.stringify(userData),
                success: function(response) {
                    hideLoading();
                    showSuccess(isUpdate ? 'User updated successfully' : 'User created successfully');
                    
                    // Close modal
                    $('#user-modal').hide();
                    
                    // Refresh users table
                    $('#users-table').DataTable().ajax.reload();
                    
                    // Refresh dashboard stats
                    loadDashboardStats();
                },
                error: function(xhr) {
                    hideLoading();
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Failed to save user';
                    showError(errorMessage);
                }
            });
        }

        // Delete User
        function deleteUser(userId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/users/${userId}`,
                type: 'DELETE',
                headers: {
                    'Authorization': 'Bearer ' + adminToken
                },
                success: function() {
                    hideLoading();
                    showSuccess('User deleted successfully');
                    
                    // Refresh users table
                    $('#users-table').DataTable().ajax.reload();
                    
                    // Refresh dashboard stats
                    loadDashboardStats();
                },
                error: function() {
                    hideLoading();
                    showError('Failed to delete user');
                }
            });
        }

        // Show KYC Modal
        function showKYCModal(kycId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/kyc/${kycId}`,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken
                },
                success: function(response) {
                    hideLoading();
                    
                    // Populate modal
                    $('#kyc-user-name').text(response.user.name);
                    
                    // Set document images
                    $('#kyc-id-front').attr('src', response.id_front_url || 'https://via.placeholder.com/300x200?text=ID+Front');
                    $('#kyc-id-back').attr('src', response.id_back_url || 'https://via.placeholder.com/300x200?text=ID+Back');
                    $('#kyc-selfie').attr('src', response.selfie_url || 'https://via.placeholder.com/300x200?text=Selfie');
                    $('#kyc-poa').attr('src', response.proof_of_address_url || 'https://via.placeholder.com/300x200?text=Proof+of+Address');
                    
                    // Set status
                    $('#kyc-verification-status').val(response.status).trigger('change');
                    
                    // Show rejection reason if status is rejected
                    if (response.status === 'rejected') {
                        $('#rejection-reason-container').show();
                        $('#kyc-rejection-reason').val(response.rejection_reason || '').trigger('change');
                        $('#kyc-rejection-notes').val(response.rejection_notes || '');
                    } else {
                        $('#rejection-reason-container').hide();
                    }
                    
                    // Store KYC ID in hidden field
                    $('#kyc-id').val(response.id);
                    
                    // Show modal
                    $('#kyc-modal').show();
                },
                error: function() {
                    hideLoading();
                    showError('Failed to load KYC details');
                }
            });
        }

        // Save KYC Verification
        function saveKYCVerification() {
            const kycId = $('#kyc-id').val();
            const status = $('#kyc-verification-status').val();
            const rejectionReason = $('#kyc-rejection-reason').val();
            const rejectionNotes = $('#kyc-rejection-notes').val();
            
            // Prepare data
            const kycData = {
                status: status
            };
            
            if (status === 'rejected') {
                if (!rejectionReason) {
                    showError('Please select a rejection reason');
                    return;
                }
                
                kycData.rejection_reason = rejectionReason;
                
                if (rejectionReason === 'other' && !rejectionNotes) {
                    showError('Please provide rejection notes');
                    return;
                }
                
                if (rejectionNotes) {
                    kycData.rejection_notes = rejectionNotes;
                }
            }
            
            showLoading();
            
            // Make API request
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/kyc/${kycId}`,
                type: 'PUT',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'Content-Type': 'application/json'
                },
                data: JSON.stringify(kycData),
                success: function(response) {
                    hideLoading();
                    showSuccess('KYC verification updated successfully');
                    
                    // Close modal
                    $('#kyc-modal').hide();
                    
                    // Refresh KYC tables
                    $('#pending-kyc-table').DataTable().ajax.reload();
                    $('#approved-kyc-table').DataTable().ajax.reload();
                    $('#rejected-kyc-table').DataTable().ajax.reload();
                },
                error: function(xhr) {
                    hideLoading();
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Failed to update KYC verification';
                    showError(errorMessage);
                }
            });
        }

        // Show Transaction Modal
        function showTransactionModal(transactionId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/transactions/${transactionId}`,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken
                },
                success: function(response) {
                    hideLoading();
                    
                    // Populate modal
                    $('#transaction-id').text(response.id);
                    $('#transaction-user').text(`${response.user.name} (ID: ${response.user.id})`);
                    $('#transaction-type').text(response.type);
                    $('#transaction-amount').text('$' + parseFloat(response.amount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                    $('#transaction-fee').text('$' + parseFloat(response.fee).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                    $('#transaction-method').text(response.method);
                    $('#transaction-date').text(response.created_at);
                    $('#transaction-notes').val(response.admin_notes || '');
                    
                    // Set status
                    $('#transaction-status span').removeClass('verified pending suspended').text(response.status);
                    if (response.status === 'completed') {
                        $('#transaction-status span').addClass('verified').text('Completed');
                    } else if (response.status === 'pending') {
                        $('#transaction-status span').addClass('pending').text('Pending');
                    } else {
                        $('#transaction-status span').addClass('suspended').text('Failed');
                    }
                    
                    $('#transaction-status-change').val(response.status).trigger('change');
                    
                    // Store transaction ID in hidden field
                    $('#transaction-id-hidden').val(response.id);
                    
                    // Show modal
                    $('#transaction-modal').show();
                },
                error: function() {
                    hideLoading();
                    showError('Failed to load transaction details');
                }
            });
        }

        // Save Transaction
        function saveTransaction() {
            const transactionId = $('#transaction-id-hidden').val();
            const status = $('#transaction-status-change').val();
            const notes = $('#transaction-notes').val();
            
            showLoading();
            
            // Make API request
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/transactions/${transactionId}`,
                type: 'PUT',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'Content-Type': 'application/json'
                },
                data: JSON.stringify({
                    status: status,
                    admin_notes: notes
                }),
                success: function(response) {
                    hideLoading();
                    showSuccess('Transaction updated successfully');
                    
                    // Close modal
                    $('#transaction-modal').hide();
                    
                    // Refresh transactions table
                    $('#all-transactions-table').DataTable().ajax.reload();
                },
                error: function(xhr) {
                    hideLoading();
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Failed to update transaction';
                    showError(errorMessage);
                }
            });
        }

        // Show Investment Plan Modal
        function showInvestmentPlanModal(action, planId = null) {
            // Reset form
            $('#investment-plan-form')[0].reset();
            
            // Set modal title
            if (action === 'add') {
                $('#investment-plan-modal-title').text('Add Investment Plan');
                $('#save-plan').text('Add Plan').show();
            } else if (action === 'edit') {
                $('#investment-plan-modal-title').text('Edit Investment Plan');
                $('#save-plan').text('Save Changes').show();
            } else {
                $('#investment-plan-modal-title').text('Plan Details');
                $('#save-plan').hide();
            }
            
            // If editing or viewing, load plan data
            if (action !== 'add' && planId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/investment/plans/${planId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken
                    },
                    success: function(response) {
                        hideLoading();
                        
                        // Populate form
                        $('#plan-id').val(response.id);
                        $('#plan-name').val(response.name);
                        $('#plan-min-amount').val(response.min_amount);
                        $('#plan-max-amount').val(response.max_amount);
                        $('#plan-duration').val(response.duration_days);
                        $('#plan-daily-profit').val(response.daily_profit_percent);
                        $('#plan-total-roi').val(response.total_roi_percent);
                        $('#plan-features').val(response.features.join('\n'));
                        $('#plan-status').val(response.status).trigger('change');
                        
                        // Disable fields if viewing
                        if (action === 'view') {
                            $('#investment-plan-form input, #investment-plan-form select, #investment-plan-form textarea').prop('disabled', true);
                        } else {
                            $('#investment-plan-form input, #investment-plan-form select, #investment-plan-form textarea').prop('disabled', false);
                        }
                        
                        // Show modal
                        $('#investment-plan-modal').show();
                    },
                    error: function() {
                        hideLoading();
                        showError('Failed to load investment plan data');
                    }
                });
            } else {
                // Enable all fields for new plan
                $('#investment-plan-form input, #investment-plan-form select, #investment-plan-form textarea').prop('disabled', false);
                
                // Show modal
                $('#investment-plan-modal').show();
            }
        }

        // Save Investment Plan
        function saveInvestmentPlan() {
            // Validate form
            if (!$('#plan-name').val() || !$('#plan-min-amount').val() || !$('#plan-duration').val() || 
                !$('#plan-daily-profit').val() || !$('#plan-total-roi').val()) {
                showError('Please fill in all required fields');
                return;
            }
            
            // Prepare data
            const planData = {
                name: $('#plan-name').val(),
                min_amount: parseFloat($('#plan-min-amount').val()),
                max_amount: $('#plan-max-amount').val() ? parseFloat($('#plan-max-amount').val()) : null,
                duration_days: parseInt($('#plan-duration').val()),
                daily_profit_percent: parseFloat($('#plan-daily-profit').val()),
                total_roi_percent: parseFloat($('#plan-total-roi').val()),
                features: $('#plan-features').val().split('\n').filter(f => f.trim() !== ''),
                status: $('#plan-status').val()
            };
            
            // Determine if we're creating or updating
            const planId = $('#plan-id').val();
            const isUpdate = !!planId;
            
            showLoading();
            
            // Make API request
            $.ajax({
                url: isUpdate ? `https://website-backendd-1.onrender.com/api/admin/investment/plans/${planId}` : 'https://website-backendd-1.onrender.com/api/admin/investment/plans',
                type: isUpdate ? 'PUT' : 'POST',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'Content-Type': 'application/json'
                },
                data: JSON.stringify(planData),
                success: function(response) {
                    hideLoading();
                    showSuccess(isUpdate ? 'Investment plan updated successfully' : 'Investment plan created successfully');
                    
                    // Close modal
                    $('#investment-plan-modal').hide();
                    
                    // Refresh plans table
                    $('#investment-plans-table').DataTable().ajax.reload();
                },
                error: function(xhr) {
                    hideLoading();
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Failed to save investment plan';
                    showError(errorMessage);
                }
            });
        }

        // Show Mining Farm Modal
        function showMiningFarmModal(action, farmId = null) {
            // Reset form
            $('#mining-farm-form')[0].reset();
            
            // Set modal title
            if (action === 'add') {
                $('#mining-farm-modal-title').text('Add Mining Farm');
                $('#save-farm').text('Add Farm').show();
            } else if (action === 'edit') {
                $('#mining-farm-modal-title').text('Edit Mining Farm');
                $('#save-farm').text('Save Changes').show();
            } else {
                $('#mining-farm-modal-title').text('Farm Details');
                $('#save-farm').hide();
            }
            
            // If editing or viewing, load farm data
            if (action !== 'add' && farmId) {
                showLoading();
                
                $.ajax({
                    url: `https://website-backendd-1.onrender.com/api/admin/mining/farms/${farmId}`,
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken
                    },
                    success: function(response) {
                        hideLoading();
                        
                        // Populate form
                        $('#farm-id').val(response.id);
                        $('#farm-name').val(response.name);
                        $('#farm-location').val(response.location);
                        $('#farm-hashrate').val(response.hashrate);
                        $('#farm-miners').val(response.miners_count);
                        $('#farm-energy').val(response.energy_consumption);
                        $('#farm-temperature').val(response.temperature);
                        $('#farm-model').val(response.miner_model);
                        $('#farm-status').val(response.status).trigger('change');
                        
                        // Disable fields if viewing
                        if (action === 'view') {
                            $('#mining-farm-form input, #mining-farm-form select').prop('disabled', true);
                        } else {
                            $('#mining-farm-form input, #mining-farm-form select').prop('disabled', false);
                        }
                        
                        // Show modal
                        $('#mining-farm-modal').show();
                    },
                    error: function() {
                        hideLoading();
                        showError('Failed to load mining farm data');
                    }
                });
            } else {
                // Enable all fields for new farm
                $('#mining-farm-form input, #mining-farm-form select').prop('disabled', false);
                
                // Show modal
                $('#mining-farm-modal').show();
            }
        }

        // Save Mining Farm
        function saveMiningFarm() {
            // Validate form
            if (!$('#farm-name').val() || !$('#farm-location').val() || !$('#farm-hashrate').val() || 
                !$('#farm-miners').val() || !$('#farm-energy').val() || !$('#farm-temperature').val() || 
                !$('#farm-model').val()) {
                showError('Please fill in all required fields');
                return;
            }
            
            // Prepare data
            const farmData = {
                name: $('#farm-name').val(),
                location: $('#farm-location').val(),
                hashrate: parseFloat($('#farm-hashrate').val()),
                miners_count: parseInt($('#farm-miners').val()),
                energy_consumption: parseFloat($('#farm-energy').val()),
                temperature: parseFloat($('#farm-temperature').val()),
                miner_model: $('#farm-model').val(),
                status: $('#farm-status').val()
            };
            
            // Handle file upload if present
            const fileInput = $('#mining-farm-form .file-input')[0];
            if (fileInput.files.length > 0) {
                // For production, you would need to handle file uploads properly
                // This is a simplified example
                farmData.image = fileInput.files[0].name;
            }
            
            // Determine if we're creating or updating
            const farmId = $('#farm-id').val();
            const isUpdate = !!farmId;
            
            showLoading();
            
            // Make API request
            $.ajax({
                url: isUpdate ? `https://website-backendd-1.onrender.com/api/admin/mining/farms/${farmId}` : 'https://website-backendd-1.onrender.com/api/admin/mining/farms',
                type: isUpdate ? 'PUT' : 'POST',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'Content-Type': 'application/json'
                },
                data: JSON.stringify(farmData),
                success: function(response) {
                    hideLoading();
                    showSuccess(isUpdate ? 'Mining farm updated successfully' : 'Mining farm created successfully');
                    
                    // Close modal
                    $('#mining-farm-modal').hide();
                    
                    // Refresh farms table
                    $('#mining-farms-table').DataTable().ajax.reload();
                    
                    // Refresh mining stats
                    loadDashboardStats();
                },
                error: function(xhr) {
                    hideLoading();
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Failed to save mining farm';
                    showError(errorMessage);
                }
            });
        }

        // Show Withdrawal Modal
        function showWithdrawalModal(withdrawalId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/withdrawals/${withdrawalId}`,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken
                },
                success: function(response) {
                    hideLoading();
                    
                    // Populate modal
                    $('#withdrawal-id').text(response.id);
                    $('#withdrawal-user').text(`${response.user.name} (ID: ${response.user.id})`);
                    $('#withdrawal-amount').text('$' + parseFloat(response.amount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                    $('#withdrawal-fee').text('$' + parseFloat(response.fee).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                    $('#withdrawal-method').text(response.method);
                    $('#withdrawal-wallet').text(response.wallet_address || response.bank_account || 'N/A');
                    $('#withdrawal-date').text(response.created_at);
                    $('#withdrawal-notes').val(response.admin_notes || '');
                    
                    // Set status
                    $('#withdrawal-status span').removeClass('verified pending suspended').text(response.status);
                    if (response.status === 'completed') {
                        $('#withdrawal-status span').addClass('verified').text('Completed');
                    } else if (response.status === 'pending') {
                        $('#withdrawal-status span').addClass('pending').text('Pending');
                    } else {
                        $('#withdrawal-status span').addClass('suspended').text('Rejected');
                    }
                    
                    // Store withdrawal ID in hidden field
                    $('#withdrawal-id-hidden').val(response.id);
                    
                    // Show modal
                    $('#withdrawal-modal').show();
                },
                error: function() {
                    hideLoading();
                    showError('Failed to load withdrawal details');
                }
            });
        }

        // Process Withdrawal
        function processWithdrawal() {
            const withdrawalId = $('#withdrawal-id-hidden').val();
            const action = $('#withdrawal-action').val();
            const notes = $('#withdrawal-notes').val();
            const rejectionReason = $('#withdrawal-rejection-reason').val();
            const rejectionNotes = $('#withdrawal-rejection-notes').val();
            
            // Validate rejection if needed
            if (action === 'reject' && !rejectionReason) {
                showError('Please select a rejection reason');
                return;
            }
            
            // Prepare data
            const withdrawalData = {
                action: action,
                admin_notes: notes
            };
            
            if (action === 'reject') {
                withdrawalData.rejection_reason = rejectionReason;
                
                if (rejectionReason === 'other' && rejectionNotes) {
                    withdrawalData.rejection_notes = rejectionNotes;
                }
            }
            
            showLoading();
            
            // Make API request
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/withdrawals/${withdrawalId}/process`,
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'Content-Type': 'application/json'
                },
                data: JSON.stringify(withdrawalData),
                success: function(response) {
                    hideLoading();
                    showSuccess(`Withdrawal ${action === 'approve' ? 'approved' : 'rejected'} successfully`);
                    
                    // Close modal
                    $('#withdrawal-modal').hide();
                    
                    // Refresh withdrawals table
                    $('#pending-withdrawals-table').DataTable().ajax.reload();
                    
                    // Refresh transactions table
                    $('#all-transactions-table').DataTable().ajax.reload();
                },
                error: function(xhr) {
                    hideLoading();
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : `Failed to ${action === 'approve' ? 'approve' : 'reject'} withdrawal`;
                    showError(errorMessage);
                }
            });
        }

        // Show Loan Modal
        function showLoanModal(loanId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/loans/${loanId}`,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken
                },
                success: function(response) {
                    hideLoading();
                    
                    // Populate modal
                    $('#loan-id').text(response.id);
                    $('#loan-user').text(`${response.user.name} (ID: ${response.user.id})`);
                    $('#loan-amount').text('$' + parseFloat(response.amount).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                    $('#loan-collateral').text(parseFloat(response.collateral_amount).toFixed(8) + ' ' + response.collateral_currency);
                    $('#loan-interest').text(response.interest_rate + '%');
                    $('#loan-duration').text(response.duration_days + ' days');
                    $('#loan-start').text(response.start_date);
                    $('#loan-due').text(response.due_date);
                    $('#loan-paid').text('$' + parseFloat(response.amount_paid).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}));
                    $('#loan-notes').val(response.admin_notes || '');
                    
                    // Set status
                    $('#loan-status span').removeClass('active pending suspended').text(response.status);
                    if (response.status === 'active') {
                        $('#loan-status span').addClass('active').text('Active');
                    } else if (response.status === 'pending') {
                        $('#loan-status span').addClass('pending').text('Pending');
                    } else if (response.status === 'completed') {
                        $('#loan-status span').addClass('verified').text('Completed');
                    } else {
                        $('#loan-status span').addClass('suspended').text('Defaulted');
                    }
                    
                    $('#loan-status-change').val(response.status).trigger('change');
                    
                    // Store loan ID in hidden field
                    $('#loan-id-hidden').val(response.id);
                    
                    // Show modal
                    $('#loan-modal').show();
                },
                error: function() {
                    hideLoading();
                    showError('Failed to load loan details');
                }
            });
        }

        // Save Loan
        function saveLoan() {
            const loanId = $('#loan-id-hidden').val();
            const status = $('#loan-status-change').val();
            const notes = $('#loan-notes').val();
            
            showLoading();
            
            // Make API request
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/loans/${loanId}`,
                type: 'PUT',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'Content-Type': 'application/json'
                },
                data: JSON.stringify({
                    status: status,
                    admin_notes: notes
                }),
                success: function(response) {
                    hideLoading();
                    showSuccess('Loan updated successfully');
                    
                    // Close modal
                    $('#loan-modal').hide();
                    
                    // Refresh loans table
                    $('#active-loans-table').DataTable().ajax.reload();
                },
                error: function(xhr) {
                    hideLoading();
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Failed to update loan';
                    showError(errorMessage);
                }
            });
        }

        // Show Ticket Modal
        function showTicketModal(ticketId) {
            showLoading();
            
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/support/tickets/${ticketId}`,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + adminToken
                },
                success: function(response) {
                    hideLoading();
                    
                    // Populate modal
                    $('#ticket-modal-title').text(`Support Ticket #${response.id}`);
                    $('#ticket-user').text(`${response.user.name} (ID: ${response.user.id})`);
                    $('#ticket-category').text(response.category);
                    $('#ticket-subject').text(response.subject);
                    $('.ticket-message p').text(response.message);
                    $('#ticket-created').text(response.created_at);
                    $('#ticket-updated').text(response.updated_at);
                    $('#ticket-reply').val('');
                    
                    // Set priority
                    $('#ticket-priority span').removeClass().addClass('status-badge').text(response.priority);
                    if (response.priority === 'high' || response.priority === 'critical') {
                        $('#ticket-priority span').addClass('error');
                    } else if (response.priority === 'medium') {
                        $('#ticket-priority span').addClass('warning');
                    } else {
                        $('#ticket-priority span').addClass('success');
                    }
                    
                    // Set status
                    $('#ticket-status span').removeClass('verified pending suspended').text(response.status);
                    if (response.status === 'resolved') {
                        $('#ticket-status span').addClass('verified').text('Resolved');
                    } else if (response.status === 'pending') {
                        $('#ticket-status span').addClass('pending').text('Pending');
                    } else {
                        $('#ticket-status span').addClass('error').text('Open');
                    }
                    
                    $('#ticket-status-change').val(response.status).trigger('change');
                    $('#ticket-priority-change').val(response.priority).trigger('change');
                    
                    // Populate conversation
                    const conversationContainer = $('.ticket-conversation');
                    conversationContainer.empty();
                    
                    if (response.replies && response.replies.length > 0) {
                        response.replies.forEach(reply => {
                            const messageClass = reply.is_admin ? 'incoming' : 'outgoing';
                            const sender = reply.is_admin ? 'Support Agent' : response.user.name;
                            
                            const messageHtml = `
                                <div class="message ${messageClass}">
                                    <div class="message-header">
                                        <strong>${sender}</strong> - ${reply.created_at}
                                    </div>
                                    <div class="message-content">
                                        <p>${reply.message}</p>
                                    </div>
                                </div>
                            `;
                            
                            conversationContainer.append(messageHtml);
                        });
                    } else {
                        conversationContainer.append('<p>No replies yet.</p>');
                    }
                    
                    // Handle attachments
                    const attachmentsContainer = $('.ticket-attachments');
                    attachmentsContainer.empty();
                    
                    if (response.attachments && response.attachments.length > 0) {
                        response.attachments.forEach(attachment => {
                            const attachmentHtml = `
                                <a href="${attachment.url}" class="btn btn-sm btn-secondary" target="_blank">
                                    <i class="fas fa-paperclip"></i> ${attachment.name}
                                </a>
                            `;
                            
                            attachmentsContainer.append(attachmentHtml);
                        });
                    } else {
                        attachmentsContainer.append('<p>No attachments.</p>');
                    }
                    
                    // Store ticket ID in hidden field
                    $('#ticket-id-hidden').val(response.id);
                    
                    // Show modal
                    $('#ticket-modal').show();
                },
                error: function() {
                    hideLoading();
                    showError('Failed to load ticket details');
                }
            });
        }

        // Save Ticket
        function saveTicket() {
            const ticketId = $('#ticket-id-hidden').val();
            const status = $('#ticket-status-change').val();
            const priority = $('#ticket-priority-change').val();
            const reply = $('#ticket-reply').val();
            
            // Validate reply if status is being changed to resolved
            if (status === 'resolved' && !reply) {
                showError('Please provide a resolution message when closing the ticket');
                return;
            }
            
            // Prepare form data for potential file upload
            const formData = new FormData();
            formData.append('status', status);
            formData.append('priority', priority);
            if (reply) {
                formData.append('message', reply);
            }
            
            // Handle file upload if present
            const fileInput = $('#ticket-modal .file-input')[0];
            if (fileInput.files.length > 0) {
                formData.append('attachment', fileInput.files[0]);
            }
            
            showLoading();
            
            // Make API request
            $.ajax({
                url: `https://website-backendd-1.onrender.com/api/admin/support/tickets/${ticketId}`,
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + adminToken
                },
                data: formData,
                processData: false,
                contentType: false,
                success: function(response) {
                    hideLoading();
                    showSuccess('Ticket updated successfully');
                    
                    // Close modal
                    $('#ticket-modal').hide();
                    
                    // Refresh tickets table
                    $('#open-tickets-table').DataTable().ajax.reload();
                },
                error: function(xhr) {
                    hideLoading();
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Failed to update ticket';
                    showError(errorMessage);
                }
            });
        }

        // Show API Key Modal
        function showAPIKeyModal() {
            // Reset form
            $('#api-key-form')[0].reset();
            
            // Show modal
            $('#api-key-modal').show();
        }

        // Generate API Key
        function generateAPIKey() {
            // Validate form
            if (!$('#api-key-name').val()) {
                showError('Please enter a key name');
                return;
            }
            
            // Get selected permissions
            const permissions = [];
            $('input[name="api-permissions"]:checked').each(function() {
                permissions.push($(this).val());
            });
            
            if (permissions.length === 0) {
                showError('Please select at least one permission');
                return;
            }
            
            // Prepare data
            const apiKeyData = {
                name: $('#api-key-name').val(),
                permissions: permissions
            };
            
            // Add optional fields if provided
            const ipRestrictions = $('#api-ip-restrictions').val();
            if (ipRestrictions) {
                apiKeyData.ip_restrictions = ipRestrictions.split('\n').filter(ip => ip.trim() !== '');
            }
            
            const expiration = $('#api-expiration').val();
            if (expiration) {
                apiKeyData.expires_at = expiration;
            }
            
            showLoading();
            
            // Make API request
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/api-keys',
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'Content-Type': 'application/json'
                },
                data: JSON.stringify(apiKeyData),
                success: function(response) {
                    hideLoading();
                    
                    // Show API key to user (this would only be shown once)
                    Swal.fire({
                        title: 'API Key Generated',
                        html: `<p>Your new API key has been generated. Please copy it now as it will not be shown again:</p>
                               <input type="text" id="api-key-value" class="swal2-input" value="${response.key}" readonly>
                               <p class="text-muted mt-2">Permissions: ${response.permissions.join(', ')}</p>`,
                        icon: 'success',
                        showCancelButton: false,
                        confirmButtonText: 'I have copied the key',
                        customClass: {
                            popup: 'dark-swal'
                        }
                    });
                    
                    // Close modal
                    $('#api-key-modal').hide();
                    
                    // Refresh API keys table if on settings page
                    if ($('#api-keys-table').length) {
                        $('#api-keys-table').DataTable().ajax.reload();
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Failed to generate API key';
                    showError(errorMessage);
                }
            });
        }

        // Generate Report
        function generateReport() {
            const reportType = $('#report-type').val();
            const startDate = $('#report-start-date').val();
            const endDate = $('#report-end-date').val();
            const format = $('#report-format').val();
            
            // Validate inputs
            if (!reportType) {
                showError('Please select a report type');
                return;
            }
            
            if (!startDate || !endDate) {
                showError('Please select a date range');
                return;
            }
            
            // Prepare data
            const reportData = {
                type: reportType,
                start_date: startDate,
                end_date: endDate,
                format: format
            };
            
            showLoading();
            
            // Make API request
            $.ajax({
                url: 'https://website-backendd-1.onrender.com/api/admin/reports/generate',
                type: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + adminToken,
                    'Content-Type': 'application/json'
                },
                data: JSON.stringify(reportData),
                success: function(response) {
                    hideLoading();
                    
                    // Show success message
                    showSuccess('Report generated successfully');
                    
                    // Refresh report history
                    $('#report-history-table').DataTable().ajax.reload();
                    
                    // Download the report if it's immediately available
                    if (response.download_url) {
                        window.open(response.download_url, '_blank');
                    }
                },
                error: function(xhr) {
                    hideLoading();
                    const errorMessage = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'Failed to generate report';
                    showError(errorMessage);
                }
            });
        }

        // Load Report Data
        function loadReportData() {
            // Initialize report history table
            $('#report-history-table').DataTable({
                responsive: true,
                ajax: {
                    url: 'https://website-backendd-1.onrender.com/api/admin/reports/history',
                    type: 'GET',
                    headers: {
                        'Authorization': 'Bearer ' + adminToken
                    },
                    dataSrc: 'data'
                },
                columns: [
                    { data: 'id' },
                    { data: 'name' },
                    { data: 'type' },
                    { data: null, render: function(data) {
                        return `${data.start_date} to ${data.end_date}`;
                    }},
                    { data: 'created_at' },
                    { data: 'size' },
                    { data: 'status', render: function(data) {
                        if (data === 'completed') {
                            return '<span class="status-badge verified">Completed</span>';
                        } else if (data === 'pending') {
                            return '<span class="status-badge pending">Pending</span>';
                        } else {
                            return '<span class="status-badge suspended">Failed</span>';
                        }
                    }},
                    { data: null, render: function(data) {
                        if (data.status === 'completed' && data.download_url) {
                            return `<a href="${data.download_url}" class="btn btn-sm btn-primary" target="_blank">Download</a>`;
                        } else {
                            return '<button class="btn btn-sm btn-secondary" disabled>Download</button>';
                        }
                    }}
                ]
            });
        }

        // Send Support Message
        function sendSupportMessage() {
            const message = $('#support-input').val().trim();
            
            if (!message) {
                return;
            }
            
            // Add message to chat UI
            const messageHtml = `
                <div class="support-message message-outgoing">
                    <div class="message-user">You (${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})})</div>
                    <div class="message-content">${message}</div>
                </div>
            `;
            
            $('#support-messages').append(messageHtml);
            $('#support-input').val('');
            
            // Scroll to bottom
            $('#support-messages').scrollTop($('#support-messages')[0].scrollHeight);
            
            // In a real implementation, you would send this to the server via WebSocket or API
            // For this example, we'll simulate a response after 1 second
            setTimeout(function() {
                const responseHtml = `
                    <div class="support-message message-incoming">
                        <div class="message-user">Support Agent (${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})})</div>
                        <div class="message-content">Thanks for your message. We'll get back to you shortly.</div>
                    </div>
                `;
                
                $('#support-messages').append(responseHtml);
                $('#support-messages').scrollTop($('#support-messages')[0].scrollHeight);
            }, 1000);
        }

        // Confirm Action
        function confirmAction(title, message, callback) {
            $('#confirmation-title').text(title);
            $('#confirmation-message').text(message);
            $('#confirm-action').off('click').on('click', function() {
                $('#confirmation-modal').hide();
                callback();
            });
            $('#confirmation-modal').show();
        }

        // Show Loading
        function showLoading() {
            $('#loading-overlay').show();
        }

        // Hide Loading
        function hideLoading() {
            $('#loading-overlay').hide();
        }

        // Show Success Message
        function showSuccess(message) {
            toastr.success(message, 'Success', {
                positionClass: 'toast-top-right',
                progressBar: true,
                timeOut: 5000
            });
        }

        // Show Error Message
        function showError(message) {
            toastr.error(message, 'Error', {
                positionClass: 'toast-top-right',
                progressBar: true,
                timeOut: 5000
            });
        }

        // Show Notification
        function showNotification(title, message) {
            // Check if browser supports notifications
            if (!("Notification" in window)) {
                console.log("This browser does not support desktop notification");
                return;
            }
            
            // Check if notification permissions are already granted
            if (Notification.permission === "granted") {
                // Create notification
                new Notification(title, {
                    body: message,
                    icon: 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'
                });
            }
            
            // Otherwise, ask for permission
            else if (Notification.permission !== "denied") {
                Notification.requestPermission().then(function(permission) {
                    if (permission === "granted") {
                        new Notification(title, {
                            body: message,
                            icon: 'https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1'
                        });
                    }
                });
            }
        }

        // Handle KYC Status Change
        $('#kyc-verification-status').on('change', function() {
            if ($(this).val() === 'rejected') {
                $('#rejection-reason-container').show();
            } else {
                $('#rejection-reason-container').hide();
            }
        });

        // Handle KYC Rejection Reason Change
        $('#kyc-rejection-reason').on('change', function() {
            if ($(this).val() === 'other') {
                $('#kyc-rejection-notes').show();
            } else {
                $('#kyc-rejection-notes').hide();
            }
        });

        // Handle Withdrawal Action Change
        $('#withdrawal-action').on('change', function() {
            if ($(this).val() === 'reject') {
                $('#rejection-reason-withdrawal').show();
            } else {
                $('#rejection-reason-withdrawal').hide();
            }
        });

        // Handle Withdrawal Rejection Reason Change
        $('#withdrawal-rejection-reason').on('change', function() {
            if ($(this).val() === 'other') {
                $('#withdrawal-rejection-notes').show();
            } else {
                $('#withdrawal-rejection-notes').hide();
            }
        });

        // Handle File Input Change
        $('.file-input').on('change', function() {
            const fileName = $(this).val().split('\\').pop();
            $(this).closest('.file-input-container').find('.file-name').text(fileName || 'No file selected');
        });

        // Handle 2FA Toggle
        $('#user-2fa').on('change', function() {
            $('#2fa-status').text($(this).is(':checked') ? 'Enabled' : 'Disabled');
        });

        // Close Modal on Outside Click
        $('.modal').on('click', function(e) {
            if ($(e.target).hasClass('modal')) {
                $(this).hide();
            }
        });

        // Close Modal on Escape Key
        $(document).on('keyup', function(e) {
            if (e.key === "Escape") {
                $('.modal').hide();
            }
        });

        // Initialize other UI interactions as needed...
    </script>
</body>
</html>
