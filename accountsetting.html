<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BitHash | KYC Verification</title>
    <meta name="description" content="Complete your KYC verification on BitHash">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rowdies:wght@300;400;700&family=Inter:wght@300;400;500;600;700&family=Manrope:wght@500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" type="image/png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #00D395;
            --primary-dark: #00B783;
            --primary-light: #00E5A1;
            --secondary: #1E1E1E;
            --secondary-dark: #121212;
            --dark: #E5E5E5;
            --darker: #0A0A0A;
            --light: #121212;
            --lighter: #1E1E1E;
            --gray: #8E8E8E;
            --gray-light: #2E2E2E;
            --gray-lighter: #252525;
            --success: #00D395;
            --warning: #FFB800;
            --error: #FF3D57;
            --gold: #D4AF37;
            --gold-light: #FFD700;
            --gold-dark: #996515;
            --blue: #003366;
            --blue-dark: #002244;
            --blue-light: #004488;
            --purple: #784FED;
            --pink: #EC4899;
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            --gold-gradient: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            --blue-gradient: linear-gradient(135deg, var(--blue) 0%, var(--blue-dark) 100%);
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --box-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            --visa-blue: #1A1F71;
            --visa-gold: #F7B600;
            --security-blue: #1A73E8;
            --security-green: #34A853;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
            overflow-x: hidden;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            color: var(--dark);
            background-color: var(--light);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Bitcoin Logo Animation */
        @keyframes bitcoinFloat {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            25% {
                transform: translateY(-20px) rotate(90deg);
            }
            50% {
                transform: translateY(0) rotate(180deg);
            }
            75% {
                transform: translateY(-10px) rotate(270deg);
            }
        }

        .bitcoin-animation {
            display: inline-block;
            animation: bitcoinFloat 4s ease-in-out infinite;
            margin-right: 5px;
            vertical-align: middle;
            color: var(--gold);
            text-shadow: 0 0 10px var(--gold-light);
            font-weight: bold;
            transform-origin: center;
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--darker);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        
        .loading-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }
        
        .loading-logo {
            width: 80px;
            height: 80px;
            animation: pulse 1.5s infinite ease-in-out;
            filter: drop-shadow(0 0 10px rgba(0, 211, 149, 0.3));
        }
        
        .loading-text {
            margin-top: 20px;
            font-weight: 500;
            color: var(--gray);
            font-size: 1rem;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.8; }
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Enhanced Header Styles */
        header {
            background-color: var(--darker);
            box-shadow: var(--box-shadow);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            padding: 8px 0;
            transition: var(--transition-slow);
            border-bottom: 1px solid var(--gray-light);
            height: 60px;
        }
        
        header.scrolled {
            background-color: rgba(10, 10, 10, 0.98);
            backdrop-filter: blur(5px);
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            height: 100%;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            z-index: 1001;
        }
        
        .logo img {
            height: 32px;
            width: auto;
            transition: var(--transition);
        }
        
        .logo:hover img {
            transform: scale(1.05);
        }
        
        .logo-text {
            font-family: 'Rowdies', sans-serif;
            font-weight: 700;
            font-size: 1.3rem;
            color: var(--primary);
            background-clip: text;
            position: relative;
        }
        
        /* Auth Buttons */
        .auth-buttons {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .auth-buttons .btn {
            padding: 6px 12px;
            font-size: 0.85rem;
        }
        
        .user-balance {
            background-color: var(--primary);
            color: var(--darker);
            padding: 6px 12px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
        }
        
        .user-balance:hover {
            background-color: var(--primary-light);
            transform: translateY(-2px);
        }
        
        .user-balance i {
            font-size: 0.85rem;
        }
        
        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--dark);
            font-size: 1.3rem;
            cursor: pointer;
            padding: 5px;
            z-index: 1001;
            transition: var(--transition);
            position: relative;
            width: 40px;
            height: 40px;
            justify-content: center;
            align-items: center;
        }
        
        .mobile-menu-toggle:hover {
            color: var(--primary);
        }
        
        .mobile-menu-toggle .hamburger {
            width: 24px;
            height: 2px;
            background: currentColor;
            position: relative;
            transition: var(--transition);
        }
        
        .mobile-menu-toggle .hamburger::before,
        .mobile-menu-toggle .hamburger::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 2px;
            background: currentColor;
            left: 0;
            transition: var(--transition);
        }
        
        .mobile-menu-toggle .hamburger::before {
            top: -8px;
        }
        
        .mobile-menu-toggle .hamburger::after {
            bottom: -8px;
        }
        
        .mobile-menu-toggle.active .hamburger {
            background: transparent;
        }
        
        .mobile-menu-toggle.active .hamburger::before {
            transform: translateY(8px) rotate(45deg);
        }
        
        .mobile-menu-toggle.active .hamburger::after {
            transform: translateY(-8px) rotate(-45deg);
        }
        
        /* Navigation */
        nav {
            transition: var(--transition-slow);
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }
        
        nav a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: var(--transition);
            position: relative;
            font-size: 0.9rem;
            padding: 3px 0;
        }
        
        nav a:hover {
            color: var(--primary);
        }
        
        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: var(--transition);
        }
        
        nav a:hover::after {
            width: 100%;
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            white-space: nowrap;
        }
        
        .btn-primary {
            background: var(--gradient);
            color: var(--darker);
            box-shadow: 0 4px 15px rgba(0, 211, 149, 0.3);
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 211, 149, 0.4);
        }
        
        .btn-outline {
            background-color: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
        }
        
        .btn-outline:hover {
            background: var(--primary);
            color: var(--darker);
            transform: translateY(-2px);
        }
        
        .btn-gold {
            background: var(--gold-gradient);
            color: var(--darker);
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }
        
        .btn-gold:hover {
            background: linear-gradient(135deg, var(--gold-light) 0%, var(--gold) 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }
        
        /* Notification System */
        .notification-center {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            pointer-events: none;
            width: 100%;
            max-width: 400px;
        }
        
        .notification {
            width: 100%;
            padding: 16px 20px;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            transform: translateY(30px) scale(0.95);
            opacity: 0;
            margin-bottom: 10px;
            font-size: 0.85rem;
            font-weight: 500;
            backdrop-filter: blur(10px);
            background-color: rgba(30, 30, 30, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            pointer-events: auto;
            position: relative;
        }
        
        .notification.show {
            transform: translateY(0) scale(1);
            opacity: 1;
        }
        
        .notification.error {
            background-color: rgba(255, 61, 87, 0.95);
            color: white;
            border-left: 4px solid #cc2c4d;
        }
        
        .notification.success {
            background-color: rgba(0, 211, 149, 0.95);
            color: var(--darker);
            border-left: 4px solid #00B783;
        }
        
        .notification.info {
            background-color: rgba(26, 115, 232, 0.95);
            color: white;
            border-left: 4px solid #1a5bb8;
        }
        
        .notification i {
            font-size: 1.4rem;
            flex-shrink: 0;
        }
        
        .notification-content {
            flex: 1;
            padding-right: 10px;
        }
        
        .notification-title {
            font-weight: 600;
            margin-bottom: 4px;
            font-size: 0.95rem;
        }
        
        .notification-message {
            font-size: 0.85rem;
            line-height: 1.4;
        }
        
        .notification-close {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        
        .notification-close:hover {
            background-color: rgba(0, 0, 0, 0.2);
            transform: rotate(90deg);
        }
        
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        
        .notification.error.show {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        
        /* KYC Section */
        .kyc-section {
            padding: 140px 0 60px;
            background-color: var(--light);
        }
        
        .kyc-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }
        
        .kyc-content {
            background-color: var(--lighter);
            border-radius: var(--border-radius-lg);
            padding: 40px;
        }
        
        .kyc-section-title {
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .kyc-section-title i {
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .kyc-card {
            background-color: var(--light);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--gray-light);
        }
        
        .kyc-card-title {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .kyc-card-title i {
            color: var(--primary);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background-color: var(--light);
            color: var(--dark);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 211, 149, 0.2);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
        }
        
        .verification-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-left: 15px;
        }
        
        .verification-badge.verified {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--success);
        }
        
        .verification-badge.pending {
            background-color: rgba(255, 184, 0, 0.1);
            color: var(--warning);
        }
        
        .verification-badge.unverified {
            background-color: rgba(255, 61, 87, 0.1);
            color: var(--error);
        }
        
        .document-upload {
            margin-top: 20px;
            border: 2px dashed var(--gray-light);
            border-radius: var(--border-radius);
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .document-upload:hover {
            border-color: var(--primary);
        }
        
        .document-upload i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .document-upload p {
            color: var(--gray);
            margin-bottom: 5px;
        }
        
        .document-upload small {
            color: var(--gray);
            font-size: 0.8rem;
        }
        
        .document-upload.saved {
            border-color: var(--success);
            background-color: rgba(0, 211, 149, 0.05);
            cursor: not-allowed;
        }
        
        .document-upload.saved i {
            color: var(--success);
        }
        
        .document-upload.saved p {
            color: var(--success);
        }
        
        /* Facial Verification Styles */
        .facial-verification-container {
            width: 100%;
            max-width: 500px;
            margin: 20px 0;
            border-radius: var(--border-radius);
            overflow: hidden;
            position: relative;
        }
        
        #facial-photo-preview {
            width: 100%;
            height: auto;
            display: block;
            background-color: var(--gray-light);
            border-radius: var(--border-radius);
        }
        
        .facial-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        .capture-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .capture-btn:hover {
            background-color: var(--primary-dark);
            transform: scale(1.05);
        }
        
        .capture-btn i {
            color: white;
            font-size: 1.5rem;
        }
        
        .webcam-container {
            width: 100%;
            max-width: 500px;
            margin: 20px 0;
            border-radius: var(--border-radius);
            overflow: hidden;
            position: relative;
        }
        
        #webcam-video {
            width: 100%;
            height: auto;
            display: block;
            background-color: var(--gray-light);
        }
        
        .webcam-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        .instruction-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            padding: 20px;
            z-index: 10;
        }
        
        .instruction-text {
            font-size: 1.2rem;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .countdown {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        /* KYC Status Display */
        .kyc-status-container {
            background-color: var(--lighter);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--gray-light);
        }
        
        .kyc-status-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .kyc-status-title i {
            color: var(--primary);
        }
        
        .kyc-status-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .kyc-status-badge.verified {
            background-color: rgba(0, 211, 149, 0.1);
            color: var(--success);
            border: 1px solid var(--success);
        }
        
        .kyc-status-badge.pending {
            background-color: rgba(255, 184, 0, 0.1);
            color: var(--warning);
            border: 1px solid var(--warning);
        }
        
        .kyc-status-badge.unverified {
            background-color: rgba(255, 61, 87, 0.1);
            color: var(--error);
            border: 1px solid var(--error);
        }
        
        .kyc-status-badge.rejected {
            background-color: rgba(255, 61, 87, 0.1);
            color: var(--error);
            border: 1px solid var(--error);
        }
        
        .kyc-status-description {
            color: var(--gray);
            margin-bottom: 20px;
        }
        
        .kyc-progress {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            position: relative;
        }
        
        .kyc-progress::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 4px;
            background-color: var(--gray-light);
            z-index: 1;
        }
        
        .kyc-progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
        }
        
        .kyc-progress-indicator {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            transition: var(--transition);
        }
        
        .kyc-progress-step.completed .kyc-progress-indicator {
            background-color: var(--success);
            color: white;
        }
        
        .kyc-progress-step.active .kyc-progress-indicator {
            background-color: var(--primary);
            color: white;
        }
        
        .kyc-progress-label {
            font-size: 0.85rem;
            color: var(--gray);
            text-align: center;
        }
        
        .kyc-progress-step.completed .kyc-progress-label {
            color: var(--success);
        }
        
        .kyc-progress-step.active .kyc-progress-label {
            color: var(--primary);
            font-weight: 600;
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-slow);
            backdrop-filter: blur(5px);
            padding: 15px;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-container {
            background-color: var(--lighter);
            border-radius: var(--border-radius-lg);
            width: 100%;
            max-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: var(--transition-slow);
            box-shadow: var(--box-shadow-lg);
            border: 1px solid var(--gray-light);
            position: relative;
        }
        
        .modal-overlay.active .modal-container {
            transform: translateY(0);
        }
        
        .modal-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--lighter);
            border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
        }
        
        .modal-title {
            font-size: 1.1rem;
            color: var(--dark);
            font-weight: 600;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition);
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .modal-close:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--dark);
        }
        
        .modal-body {
            padding: 20px;
            font-size: 0.9rem;
        }
        
        .modal-footer {
            padding: 16px 20px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            background-color: var(--secondary-dark);
            border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
        }
        
        /* Footer */
        footer {
            background-color: var(--darker);
            color: white;
            padding: 50px 0 20px;
        }
        
        .footer-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .footer-logo {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .footer-logo img {
            height: 28px;
            width: auto;
        }
        
        .footer-logo-text {
            font-family: 'Rowdies', sans-serif;
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--primary);
        }
        
        .footer-about p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .footer-social {
            display: flex;
            gap: 10px;
        }
        
        .social-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: white;
        }
        
        .social-icon.twitter {
            background-color: #1DA1F2;
        }
        
        .social-icon.linkedin {
            background-color: #0077B5;
        }
        
        .social-icon.facebook {
            background-color: #1877F2;
        }
        
        .social-icon.instagram {
            background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D, #F56040, #F77737, #FCAF45, #FFDC80);
        }
        
        .social-icon:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .footer-title {
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 1.1rem;
            color: white;
        }
        
        .footer-links ul {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: var(--transition);
            font-size: 0.9rem;
            display: inline-block;
        }
        
        .footer-links a:hover {
            color: var(--primary);
            transform: translateX(3px);
        }
        
        .footer-contact p {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 12px;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .footer-contact i {
            color: var(--primary);
            width: 18px;
            text-align: center;
            margin-top: 2px;
            font-size: 0.9rem;
        }
        
        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 20px;
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.8rem;
        }
        
        /* Responsive Styles */
        @media (max-width: 1024px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .kyc-section {
                padding: 120px 0 40px;
            }
            
            .kyc-content {
                padding: 30px;
            }
            
            /* Enhanced Mobile Navigation */
            .mobile-menu-toggle {
                display: flex;
            }
            
            nav {
                position: fixed;
                top: 60px;
                left: 0;
                width: 100%;
                background-color: var(--darker);
                padding: 20px;
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2);
                transform: translateY(-100%);
                opacity: 0;
                visibility: hidden;
                transition: var(--transition-slow);
                z-index: 999;
            }
            
            nav.active {
                transform: translateY(0);
                opacity: 1;
                visibility: visible;
            }
            
            nav ul {
                flex-direction: column;
                gap: 15px;
            }
            
            nav a {
                padding: 10px 0;
                font-size: 1rem;
            }
            
            .kyc-progress {
                flex-direction: column;
                gap: 20px;
            }
            
            .kyc-progress::before {
                display: none;
            }
            
            .kyc-progress-step {
                flex-direction: row;
                gap: 15px;
            }
            
            .kyc-progress-label {
                text-align: left;
            }
        }
        
        @media (max-width: 480px) {
            .kyc-section {
                padding: 100px 0 30px;
            }
            
            .kyc-content {
                padding: 20px;
            }
            
            .kyc-section-title {
                font-size: 1.3rem;
            }
            
            .kyc-card {
                padding: 20px;
            }
            
            .form-actions {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
            }
            
            /* Adjust header elements for small screens */
            .logo-text {
                font-size: 1.1rem;
            }
            
            .auth-buttons {
                gap: 8px;
            }
            
            .auth-buttons .btn {
                padding: 5px 10px;
                font-size: 0.8rem;
            }
            
            .user-balance {
                padding: 5px 10px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash Logo" class="loading-logo">    
        <div class="loading-text">Establishing Secure Connection</div>
    </div>

    <!-- Critical Error Notification System -->
    <div class="notification-center" id="notification-center">
        <!-- Critical error notifications will be dynamically inserted here -->
    </div>

    <!-- Enhanced Header -->
    <header id="main-header">
        <div class="container header-container">
            <div class="logo" onclick="window.location.href='index.html'">
                <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash Logo">
                <span class="logo-text">
                    <span class="bitcoin-animation">₿</span>itHash
                </span>
            </div>
            
            <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Toggle navigation">
                <span class="hamburger"></span>
            </button>
            
            <nav id="main-nav">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="index.html#plans">Investment Plans</a></li>
                    <li><a href="index.html#how-it-works">How It Works</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="accountsetting.html">Settings</a></li>
                </ul>
            </nav>
            
            <div class="auth-buttons" id="auth-buttons" style="display: none;">
                <button class="btn btn-outline" onclick="window.location.href='login.html'">Login</button>
                <button class="btn btn-primary" onclick="window.location.href='signup.html'">Sign Up</button>
            </div>
            
            <div class="user-balance" id="user-balance" onclick="window.location.href='dashboard.html'">
                <i class="fas fa-wallet"></i>
                <span id="balance-amount">$0.00</span>
                <div class="logout-dropdown" id="logout-dropdown" style="display: none;">
                    <button class="btn btn-outline" onclick="logout()" style="margin-left: 10px; padding: 5px 10px; font-size: 0.8rem;">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- KYC Verification Section -->
    <section class="kyc-section">
        <div class="container kyc-container">
            <!-- KYC Status Display -->
            <div class="kyc-status-container">
                <h2 class="kyc-status-title">
                    <i class="fas fa-id-card"></i> KYC Verification Status
                </h2>
                
                <div class="kyc-status-badge" id="overall-kyc-status">
                    <i class="fas fa-clock"></i> Verification Pending
                </div>
                
                <p class="kyc-status-description" id="kyc-status-description">
                    Complete all verification steps to activate your account fully. Your KYC status is automatically saved and will not be affected by page refreshes.
                </p>
                
                <div class="kyc-progress" id="kyc-progress">
                    <div class="kyc-progress-step" id="step-identity">
                        <div class="kyc-progress-indicator">
                            <i class="fas fa-id-card"></i>
                        </div>
                        <div class="kyc-progress-label">Identity</div>
                    </div>
                    <div class="kyc-progress-step" id="step-address">
                        <div class="kyc-progress-indicator">
                            <i class="fas fa-home"></i>
                        </div>
                        <div class="kyc-progress-label">Address</div>
                    </div>
                    <div class="kyc-progress-step" id="step-facial">
                        <div class="kyc-progress-indicator">
                            <i class="fas fa-camera"></i>
                        </div>
                        <div class="kyc-progress-label">Facial</div>
                    </div>
                    <div class="kyc-progress-step" id="step-submission">
                        <div class="kyc-progress-indicator">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="kyc-progress-label">Complete</div>
                    </div>
                </div>
            </div>
            
            <!-- KYC Content -->
            <div class="kyc-content">
                <!-- Identity Verification Section -->
                <div class="kyc-card">
                    <h3 class="kyc-card-title">
                        <i class="fas fa-user-check"></i> Identity Verification
                        <span class="verification-badge" id="identity-verification-badge">
                            <i class="fas fa-times-circle"></i> Unverified
                        </span>
                    </h3>
                    
                    <p style="margin-bottom: 20px; color: var(--gray);">
                        To comply with financial regulations, we require identity verification for all accounts. 
                        This helps prevent fraud and keeps our platform secure.
                    </p>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Document Type</label>
                            <select class="form-control" id="document-type">
                                <option value="">Select document type</option>
                                <option value="passport">Passport</option>
                                <option value="drivers_license">Driver's License</option>
                                <option value="national_id">National ID</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Document Number</label>
                            <input type="text" class="form-control" id="document-number" placeholder="Enter document number">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Expiration Date</label>
                        <input type="date" class="form-control" id="document-expiry">
                    </div>
                    
                    <div id="document-upload-container">
                        <div class="document-upload" id="document-front-upload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Upload Front of ID Document</p>
                            <small>Supported formats: JPG, PNG, PDF (Max 5MB)</small>
                            <input type="file" id="document-front-file" accept="image/*,.pdf" style="display: none;">
                        </div>
                        <div id="document-front-preview" style="display: none; margin-top: 20px;">
                            <img id="document-front-preview-image" src="" alt="Document Front Preview" style="max-width: 100%; max-height: 300px; border-radius: var(--border-radius);">
                            <button type="button" class="btn btn-outline" style="margin-top: 10px;" onclick="removeDocument('front')">Remove</button>
                        </div>
                        
                        <div class="document-upload" id="document-back-upload" style="margin-top: 20px;">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Upload Back of ID Document</p>
                            <small>Supported formats: JPG, PNG, PDF (Max 5MB)</small>
                            <input type="file" id="document-back-file" accept="image/*,.pdf" style="display: none;">
                        </div>
                        <div id="document-back-preview" style="display: none; margin-top: 20px;">
                            <img id="document-back-preview-image" src="" alt="Document Back Preview" style="max-width: 100%; max-height: 300px; border-radius: var(--border-radius);">
                            <button type="button" class="btn btn-outline" style="margin-top: 10px;" onclick="removeDocument('back')">Remove</button>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" id="cancel-document-btn">Cancel</button>
                        <button type="button" class="btn btn-primary" id="save-document-btn" disabled>Save Identity Documents</button>
                    </div>
                </div>
                
                <!-- Address Verification Section -->
                <div class="kyc-card">
                    <h3 class="kyc-card-title">
                        <i class="fas fa-home"></i> Address Verification
                        <span class="verification-badge" id="address-verification-badge">
                            <i class="fas fa-times-circle"></i> Unverified
                        </span>
                    </h3>
                    
                    <div class="form-group">
                        <label class="form-label">Document Type</label>
                        <select class="form-control" id="address-document-type">
                            <option value="">Select document type</option>
                            <option value="utility_bill">Utility Bill</option>
                            <option value="bank_statement">Bank Statement</option>
                            <option value="government_letter">Government Letter</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Document Issue Date</label>
                        <input type="date" class="form-control" id="address-document-date">
                    </div>
                    
                    <div id="address-document-upload-container">
                        <div class="document-upload" id="address-document-upload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Upload your address proof</p>
                            <small>Supported formats: JPG, PNG, PDF (Max 5MB)</small>
                            <input type="file" id="address-document-file" accept="image/*,.pdf" style="display: none;">
                        </div>
                        <div id="address-document-preview" style="display: none; margin-top: 20px;">
                            <img id="address-document-preview-image" src="" alt="Address Document Preview" style="max-width: 100%; max-height: 300px; border-radius: var(--border-radius);">
                            <button type="button" class="btn btn-outline" style="margin-top: 10px;" onclick="removeAddressDocument()">Remove</button>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" id="cancel-address-document-btn">Cancel</button>
                        <button type="button" class="btn btn-primary" id="save-address-document-btn" disabled>Save Address Document</button>
                    </div>
                </div>
                
                <!-- Facial Verification Section -->
                <div class="kyc-card">
                    <h3 class="kyc-card-title">
                        <i class="fas fa-camera"></i> Facial Verification
                        <span class="verification-badge" id="facial-verification-badge">
                            <i class="fas fa-times-circle"></i> Unverified
                        </span>
                    </h3>
                    
                    <div id="facial-verification-container">
                        <div id="verification-photo-container" style="width: 100%; max-width: 400px; border-radius: 8px; overflow: hidden; margin-bottom: 20px; border: 1px solid var(--gray-light); display: none;">
                            <img id="verification-photo" src="" alt="Verification Photo" style="width: 100%; height: auto; object-fit: cover;">
                        </div>
                        
                        <div class="webcam-container" id="webcam-container" style="display: none;">
                            <video id="webcam-video" autoplay playsinline></video>
                            <div class="instruction-overlay" id="instruction-overlay">
                                <div class="instruction-text" id="instruction-text">Please position your face in the frame and hold your ID document next to your face</div>
                                <div class="countdown" id="countdown">3</div>
                            </div>
                            <div class="webcam-controls">
                                <button class="capture-btn" id="capture-btn">
                                    <i class="fas fa-camera"></i>
                                </button>
                            </div>
                            <canvas id="webcam-canvas" style="display: none;"></canvas>
                        </div>
                        
                        <div id="facial-verification-instructions" style="margin-bottom: 20px;">
                            <p style="margin-bottom: 15px; color: var(--gray);">
                                For facial verification, we require a photo of you holding your ID document next to your face. Please ensure both your face and the ID document are clearly visible.
                            </p>
                            <button type="button" class="btn btn-primary" id="start-facial-verification-btn">
                                <i class="fas fa-camera"></i> Start Facial Verification
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" id="retake-photo-btn" style="display: none;">Retake Photo</button>
                        <button type="button" class="btn btn-primary" id="submit-photo-btn" style="display: none;">Save Facial Verification</button>
                    </div>
                </div>
                
                <!-- Complete KYC Verification Section -->
                <div class="kyc-card">
                    <h3 class="kyc-card-title">
                        <i class="fas fa-check-circle"></i> Complete KYC Verification
                    </h3>
                    
                    <p style="margin-bottom: 20px; color: var(--gray);">
                        Once you have completed all verification steps, submit your KYC application for review. 
                        You can only submit your KYC application once. After submission, only an administrator can make changes to your KYC status.
                    </p>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-primary" id="submit-kyc-btn" disabled>
                            <i class="fas fa-paper-plane"></i> Submit KYC Application
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact">
        <div class="container">
            <div class="footer-container">
                <div class="footer-about">
                    <div class="footer-logo">
                        <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="BitHash Logo" class="loading-logo">    
                        <span class="footer-logo-text"><span class="bitcoin-animation">₿</span>itHash</span>
                    </div>
                    <p>Bitcoin mining platform serving investors worldwide with transparent operations and reliable returns.</p>
                    <div class="footer-social">
                        <!-- Social Share Buttons -->
                        <a href="https://twitter.com/intent/tweet?url=https://bithhash.vercel.app/&text=Check%20out%20this%20Bitcoin%20mining%20platform!" 
                           class="social-icon twitter" aria-label="Twitter" target="_blank" rel="noopener">
                           <i class="fab fa-twitter"></i>
                        </a>

                        <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://bithhash.vercel.app/" 
                           class="social-icon linkedin" aria-label="LinkedIn" target="_blank" rel="noopener">
                           <i class="fab fa-linkedin-in"></i>
                        </a>

                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://bithhash.vercel.app/" 
                           class="social-icon facebook" aria-label="Facebook" target="_blank" rel="noopener">
                           <i class="fab fa-facebook-f"></i>
                        </a>

                        <a href="https://www.instagram.com" 
                           class="social-icon instagram" aria-label="Instagram" target="_blank" rel="noopener" 
                           onclick="alert('Instagram does not support direct sharing via links. Please share manually.'); return false;">
                           <i class="fab fa-instagram"></i>
                        </a>
                    </div>
                </div>
                
                <div class="footer-links">
                    <h3 class="footer-title">Platform</h3>
                    <ul>
                        <li><a href="#home">Dashboard</a></li>
                        <li><a href="#plans">Investment Plans</a></li>
                        <li><a href="#loans">Loans</a></li>
                        <li><a href="dashboard.html">My Account</a></li>
                        <li><a href="rewards.html">Rewards</a></li>
                    </ul>
                </div>
                
                <div class="footer-links">
                    <h3 class="footer-title">Company</h3>
                    <ul>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="careers.html">Careers</a></li>
                        <li><a href="press.html">Press</a></li>
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="partners.html">Partners</a></li>
                    </ul>
                </div>
                
                <div class="footer-contact">
                    <h3 class="footer-title">Contact Us</h3>
                    <p><i class="fas fa-envelope"></i> support@bithash.com</p>
                    <p><i class="fas fa-phone"></i> +1 606-363-2032</p>
                    <p><i class="fas fa-map-marker-alt"></i> 800 Plant St, Wilmington, DE 19801, United States</p>
                    <p><i class="fas fa-clock"></i> 24/7 Support</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; <span id="current-year"></span> BitHash LLC. All Rights Reserved. Registered in Delaware, USA. FINRA/SIPC Member.</p>
            </div>
        </div>
    </footer>

    <!-- Email and Password Verification Modal -->
    <div class="modal-overlay" id="email-password-modal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">Account Verification Required</h3>
                <button class="modal-close" onclick="closeModal('email-password-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="disclaimer">
                    <div class="disclaimer-title">Security Verification</div>
                    <p>For security purposes, please enter your registered email and password to proceed with the KYC submission.</p>
                    <p><strong>Important:</strong> If you signed up using Google, please use your Google account email and password.</p>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <input type="email" id="verification-email" class="form-control" placeholder="Enter your registered email">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" id="verification-password" class="form-control" placeholder="Enter your password">
                </div>
                
                <div class="disclaimer">
                    <div class="disclaimer-title">Privacy Notice</div>
                    <p>Your credentials are securely transmitted and used only for verification purposes.</p>
                </div>
                
                <!-- Notification area for modal -->
                <div id="modal-notification" style="display: none; margin-top: 15px; padding: 10px; border-radius: var(--border-radius);"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('email-password-modal')">Cancel</button>
                <button class="btn btn-primary" onclick="verifyCredentials()">
                    <i class="fas fa-check-circle"></i> Verify & Submit KYC
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global state for the application
        const AppState = {
            userData: null,
            kycStatus: {
                identity: 'unverified',
                address: 'unverified',
                facial: 'unverified',
                overall: 'unverified'
            },
            kycDocuments: {
                identity: {
                    front: null,
                    back: null,
                    type: '',
                    number: '',
                    expiry: ''
                },
                address: {
                    document: null,
                    type: '',
                    issueDate: ''
                },
                facial: null
            },
            webcamStream: null,
            kycSubmitted: false,
            kycCheckInterval: null
        };

        // Hide loading overlay when page is loaded
        window.addEventListener('load', function() {
            setTimeout(async function() {
                document.getElementById('loading-overlay').classList.add('hidden');
                
                // Check authentication and load user data
                await checkAuthState();
                
                // Load KYC data
                await loadKYCData();
                
                // Initialize KYC document upload
                initKYCDocumentUpload();
                
                // Initialize facial verification
                initFacialVerification();
                
                // Initialize form submissions
                initFormSubmissions();
                
                // Start KYC status polling
                startKYCStatusPolling();
                
                // Initialize mobile menu
                initMobileMenu();
                
                // Initialize header scroll effect
                initHeaderScrollEffect();
                
            }, 1000);
        });
        
        /* ============================================= */
        /* Initialization Functions */
        /* ============================================= */
        
        // Check authentication state
        async function checkAuthState() {
            try {
                const token = localStorage.getItem('jwtToken');
                if (!token) {
                    document.getElementById('auth-buttons').style.display = 'flex';
                    document.getElementById('user-balance').style.display = 'none';
                    window.location.href = 'login.html';
                    return;
                }
                
                const response = await fetch('https://website-backendd-1.onrender.com/api/users/me', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const userData = await response.json();
                    AppState.userData = userData;
                    
                    document.getElementById('auth-buttons').style.display = 'none';
                    document.getElementById('user-balance').style.display = 'flex';
                    
                    // Fetch user balances
                    await fetchUserBalances();
                    
                    // Set up logout dropdown
                    const userBalance = document.getElementById('user-balance');
                    const logoutDropdown = document.getElementById('logout-dropdown');
                    
                    if (userBalance && logoutDropdown) {
                        userBalance.addEventListener('mouseenter', function() {
                            logoutDropdown.style.display = 'block';
                        });
                        
                        userBalance.addEventListener('mouseleave', function() {
                            logoutDropdown.style.display = 'none';
                        });
                    }
                } else {
                    localStorage.removeItem('jwtToken');
                    document.getElementById('auth-buttons').style.display = 'flex';
                    document.getElementById('user-balance').style.display = 'none';
                    window.location.href = 'login.html';
                }
            } catch (error) {
                console.error('Authentication check failed:', error);
                showNotification('error', 'Session Error', 'Failed to verify your session. Please login again.');
            }
        }
        
        // Fetch user balances
        async function fetchUserBalances() {
            try {
                const token = localStorage.getItem('jwtToken');
                const response = await fetch('https://website-backendd-1.onrender.com/api/users/balances', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const balances = data.data.balances;
                    
                    // Update balance display
                    const mainBalance = balances.main || 0;
                    const maturedBalance = balances.matured || 0;
                    
                    document.getElementById('balance-amount').textContent = `$${(mainBalance + maturedBalance).toFixed(2)}`;
                    
                } else {
                    throw new Error('Failed to load balance data');
                }
            } catch (error) {
                console.error('Error fetching balances:', error);
                // Don't show error notification for balance fetch to avoid disrupting user experience
            }
        }
        
        // Load KYC verification data
        async function loadKYCData() {
            try {
                const token = localStorage.getItem('jwtToken');
                if (!token) return;
                
                const response = await fetch('https://website-backendd-1.onrender.com/api/users/kyc', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const kycData = await response.json();
                    AppState.kycStatus = kycData.status || {
                        identity: 'unverified',
                        address: 'unverified',
                        facial: 'unverified',
                        overall: 'unverified'
                    };
                    
                    AppState.kycSubmitted = kycData.submitted || false;
                    
                    // Update KYC verification badges
                    updateVerificationBadge('identity-verification-badge', AppState.kycStatus.identity);
                    updateVerificationBadge('address-verification-badge', AppState.kycStatus.address);
                    updateVerificationBadge('facial-verification-badge', AppState.kycStatus.facial);
                    updateOverallKYCStatus();
                    
                    // Populate KYC document info if available
                    if (kycData.identityDocument) {
                        document.getElementById('document-type').value = kycData.identityDocument.type || '';
                        document.getElementById('document-number').value = kycData.identityDocument.number || '';
                        document.getElementById('document-expiry').value = kycData.identityDocument.expiry || '';
                        
                        // Mark document uploads as saved if they exist
                        if (kycData.identityDocument.frontSaved) {
                            markDocumentAsSaved('front');
                        }
                        if (kycData.identityDocument.backSaved) {
                            markDocumentAsSaved('back');
                        }
                    }
                    
                    if (kycData.addressDocument) {
                        document.getElementById('address-document-type').value = kycData.addressDocument.type || '';
                        document.getElementById('address-document-date').value = kycData.addressDocument.issueDate || '';
                        
                        // Mark address document as saved if it exists
                        if (kycData.addressDocument.saved) {
                            markAddressDocumentAsSaved();
                        }
                    }
                    
                    if (kycData.facialVerification && kycData.facialVerification.saved) {
                        markFacialVerificationAsSaved();
                    }
                    
                    // Check KYC completion
                    checkKYCCompletion();
                    
                } else {
                    // If KYC data doesn't exist yet, that's fine - user hasn't started
                    console.log('No KYC data found for user');
                }
            } catch (error) {
                console.error('Error loading KYC data:', error);
                // Don't show error notification for KYC data to avoid disrupting user experience
            }
        }
        
        // Start KYC status polling
        function startKYCStatusPolling() {
            // Check KYC status every 30 seconds
            AppState.kycCheckInterval = setInterval(async () => {
                await loadKYCData();
            }, 30000);
        }
        
        // Initialize KYC document upload
        function initKYCDocumentUpload() {
            // Front ID document upload
            const documentFrontUpload = document.getElementById('document-front-upload');
            const documentFrontFile = document.getElementById('document-front-file');
            
            documentFrontUpload.addEventListener('click', function() {
                if (!documentFrontUpload.classList.contains('saved')) {
                    documentFrontFile.click();
                }
            });
            
            documentFrontFile.addEventListener('change', function(e) {
                handleDocumentUpload(e, 'front');
            });
            
            // Back ID document upload
            const documentBackUpload = document.getElementById('document-back-upload');
            const documentBackFile = document.getElementById('document-back-file');
            
            documentBackUpload.addEventListener('click', function() {
                if (!documentBackUpload.classList.contains('saved')) {
                    documentBackFile.click();
                }
            });
            
            documentBackFile.addEventListener('change', function(e) {
                handleDocumentUpload(e, 'back');
            });
            
            // Address document upload
            const addressDocumentUpload = document.getElementById('address-document-upload');
            const addressDocumentFile = document.getElementById('address-document-file');
            
            addressDocumentUpload.addEventListener('click', function() {
                if (!addressDocumentUpload.classList.contains('saved')) {
                    addressDocumentFile.click();
                }
            });
            
            addressDocumentFile.addEventListener('change', function(e) {
                handleAddressDocumentUpload(e);
            });
            
            // Document form change listeners
            document.getElementById('document-type').addEventListener('change', checkDocumentFormCompletion);
            document.getElementById('document-number').addEventListener('input', checkDocumentFormCompletion);
            document.getElementById('document-expiry').addEventListener('change', checkDocumentFormCompletion);
            
            // Address document form change listeners
            document.getElementById('address-document-type').addEventListener('change', checkAddressDocumentFormCompletion);
            document.getElementById('address-document-date').addEventListener('change', checkAddressDocumentFormCompletion);
            
            // Save document buttons
            document.getElementById('save-document-btn').addEventListener('click', saveIdentityDocuments);
            document.getElementById('save-address-document-btn').addEventListener('click', saveAddressDocument);
            
            // Submit KYC button
            document.getElementById('submit-kyc-btn').addEventListener('click', submitKYCApplication);
        }
        
        // Handle document upload
        function handleDocumentUpload(event, side) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Validate file type and size
            const validTypes = ['image/jpeg', 'image/png', 'application/pdf'];
            const maxSize = 5 * 1024 * 1024; // 5MB
            
            if (!validTypes.includes(file.type)) {
                showNotification('error', 'Invalid File Type', 'Please upload JPG, PNG, or PDF files only.');
                return;
            }
            
            if (file.size > maxSize) {
                showNotification('error', 'File Too Large', 'File size must be less than 5MB.');
                return;
            }
            
            // Store file in state
            AppState.kycDocuments.identity[side] = file;
            
            // Show preview for images
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewId = `document-${side}-preview-image`;
                    const containerId = `document-${side}-preview`;
                    const uploadId = `document-${side}-upload`;
                    
                    document.getElementById(previewId).src = e.target.result;
                    document.getElementById(containerId).style.display = 'block';
                    document.getElementById(uploadId).style.display = 'none';
                };
                reader.readAsDataURL(file);
            } else {
                // For PDF files, show a different preview
                const containerId = `document-${side}-preview`;
                const uploadId = `document-${side}-upload`;
                
                document.getElementById(containerId).innerHTML = `
                    <div style="padding: 20px; text-align: center; background: var(--gray-light); border-radius: var(--border-radius);">
                        <i class="fas fa-file-pdf" style="font-size: 3rem; color: var(--primary); margin-bottom: 10px;"></i>
                        <p>${file.name}</p>
                        <button type="button" class="btn btn-outline" style="margin-top: 10px;" onclick="removeDocument('${side}')">Remove</button>
                    </div>
                `;
                document.getElementById(containerId).style.display = 'block';
                document.getElementById(uploadId).style.display = 'none';
            }
            
            checkDocumentFormCompletion();
            showNotification('success', 'Document Uploaded', `${side === 'front' ? 'Front' : 'Back'} of ID document uploaded successfully.`);
        }
        
        // Handle address document upload
        function handleAddressDocumentUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Validate file type and size
            const validTypes = ['image/jpeg', 'image/png', 'application/pdf'];
            const maxSize = 5 * 1024 * 1024; // 5MB
            
            if (!validTypes.includes(file.type)) {
                showNotification('error', 'Invalid File Type', 'Please upload JPG, PNG, or PDF files only.');
                return;
            }
            
            if (file.size > maxSize) {
                showNotification('error', 'File Too Large', 'File size must be less than 5MB.');
                return;
            }
            
            // Store file in state
            AppState.kycDocuments.address.document = file;
            
            // Show preview for images
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('address-document-preview-image').src = e.target.result;
                    document.getElementById('address-document-preview').style.display = 'block';
                    document.getElementById('address-document-upload').style.display = 'none';
                };
                reader.readAsDataURL(file);
            } else {
                // For PDF files, show a different preview
                document.getElementById('address-document-preview').innerHTML = `
                    <div style="padding: 20px; text-align: center; background: var(--gray-light); border-radius: var(--border-radius);">
                        <i class="fas fa-file-pdf" style="font-size: 3rem; color: var(--primary); margin-bottom: 10px;"></i>
                        <p>${file.name}</p>
                        <button type="button" class="btn btn-outline" style="margin-top: 10px;" onclick="removeAddressDocument()">Remove</button>
                    </div>
                `;
                document.getElementById('address-document-preview').style.display = 'block';
                document.getElementById('address-document-upload').style.display = 'none';
            }
            
            checkAddressDocumentFormCompletion();
            showNotification('success', 'Document Uploaded', 'Address document uploaded successfully.');
        }
        
        // Remove document
        function removeDocument(side) {
            AppState.kycDocuments.identity[side] = null;
            
            const containerId = `document-${side}-preview`;
            const uploadId = `document-${side}-upload`;
            
            document.getElementById(containerId).style.display = 'none';
            document.getElementById(uploadId).style.display = 'block';
            
            // Reset file input
            document.getElementById(`document-${side}-file`).value = '';
            
            checkDocumentFormCompletion();
        }
        
        // Remove address document
        function removeAddressDocument() {
            AppState.kycDocuments.address.document = null;
            
            document.getElementById('address-document-preview').style.display = 'none';
            document.getElementById('address-document-upload').style.display = 'block';
            
            // Reset file input
            document.getElementById('address-document-file').value = '';
            
            checkAddressDocumentFormCompletion();
        }
        
        // Mark document as saved
        function markDocumentAsSaved(side) {
            const uploadId = `document-${side}-upload`;
            const uploadElement = document.getElementById(uploadId);
            
            uploadElement.classList.add('saved');
            uploadElement.innerHTML = `
                <i class="fas fa-check-circle"></i>
                <p>${side === 'front' ? 'Front' : 'Back'} of ID Document Saved</p>
                <small>Document has been successfully uploaded and saved</small>
            `;
            
            // Hide preview if it's showing
            const previewId = `document-${side}-preview`;
            document.getElementById(previewId).style.display = 'none';
        }
        
        // Mark address document as saved
        function markAddressDocumentAsSaved() {
            const uploadElement = document.getElementById('address-document-upload');
            
            uploadElement.classList.add('saved');
            uploadElement.innerHTML = `
                <i class="fas fa-check-circle"></i>
                <p>Address Document Saved</p>
                <small>Document has been successfully uploaded and saved</small>
            `;
            
            // Hide preview if it's showing
            document.getElementById('address-document-preview').style.display = 'none';
        }
        
        // Mark facial verification as saved
        function markFacialVerificationAsSaved() {
            document.getElementById('facial-verification-instructions').style.display = 'none';
            document.getElementById('webcam-container').style.display = 'none';
            document.getElementById('verification-photo-container').style.display = 'block';
            document.getElementById('submit-photo-btn').style.display = 'none';
            document.getElementById('retake-photo-btn').style.display = 'inline-block';
            document.getElementById('retake-photo-btn').textContent = 'Verification Saved';
            document.getElementById('retake-photo-btn').disabled = true;
        }
        
        // Check if document form is complete
        function checkDocumentFormCompletion() {
            const documentType = document.getElementById('document-type').value;
            const documentNumber = document.getElementById('document-number').value;
            const documentExpiry = document.getElementById('document-expiry').value;
            const hasFrontDocument = AppState.kycDocuments.identity.front !== null;
            const hasBackDocument = AppState.kycDocuments.identity.back !== null;
            
            const isComplete = documentType && documentNumber && documentExpiry && hasFrontDocument && hasBackDocument;
            
            document.getElementById('save-document-btn').disabled = !isComplete;
            
            return isComplete;
        }
        
        // Check if address document form is complete
        function checkAddressDocumentFormCompletion() {
            const documentType = document.getElementById('address-document-type').value;
            const issueDate = document.getElementById('address-document-date').value;
            const hasDocument = AppState.kycDocuments.address.document !== null;
            
            const isComplete = documentType && issueDate && hasDocument;
            
            document.getElementById('save-address-document-btn').disabled = !isComplete;
            
            return isComplete;
        }
        
        // Check if all KYC steps are complete
        function checkKYCCompletion() {
            const identityComplete = AppState.kycStatus.identity === 'pending' || AppState.kycStatus.identity === 'verified';
            const addressComplete = AppState.kycStatus.address === 'pending' || AppState.kycStatus.address === 'verified';
            const facialComplete = AppState.kycStatus.facial === 'pending' || AppState.kycStatus.facial === 'verified';
            
            const isKYCReady = identityComplete && addressComplete && facialComplete;
            
            // Always enable the submit button if KYC is not already submitted
            document.getElementById('submit-kyc-btn').disabled = AppState.kycSubmitted || !isKYCReady;
            
            if (isKYCReady && !AppState.kycSubmitted) {
                showNotification('success', 'KYC Ready', 'All verification steps completed. You can now submit your KYC application.');
            }
            
            return isKYCReady;
        }
        
        // Initialize facial verification
        function initFacialVerification() {
            const startBtn = document.getElementById('start-facial-verification-btn');
            const submitBtn = document.getElementById('submit-photo-btn');
            const retakeBtn = document.getElementById('retake-photo-btn');
            const captureBtn = document.getElementById('capture-btn');
            
            if (startBtn) {
                startBtn.addEventListener('click', startFacialVerification);
            }
            
            if (submitBtn) {
                submitBtn.addEventListener('click', submitFacialVerification);
            }
            
            if (retakeBtn) {
                retakeBtn.addEventListener('click', retakeVerification);
            }
            
            if (captureBtn) {
                captureBtn.addEventListener('click', capturePhoto);
            }
        }
        
        // Start facial verification process
        async function startFacialVerification() {
            try {
                // Hide instructions and show webcam container
                document.getElementById('facial-verification-instructions').style.display = 'none';
                document.getElementById('webcam-container').style.display = 'block';
                
                // Request camera access
                AppState.webcamStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        width: { ideal: 1280 },
                        height: { ideal: 720 },
                        facingMode: 'user'
                    }
                });
                
                // Show video stream
                const video = document.getElementById('webcam-video');
                video.srcObject = AppState.webcamStream;
                
                // Show instruction overlay with countdown
                const instructionOverlay = document.getElementById('instruction-overlay');
                const countdownElement = document.getElementById('countdown');
                const instructionText = document.getElementById('instruction-text');
                
                instructionOverlay.style.display = 'flex';
                instructionText.textContent = 'Please position your face in the frame and hold your ID document next to your face';
                
                let countdown = 3;
                countdownElement.textContent = countdown;
                
                const countdownInterval = setInterval(() => {
                    countdown--;
                    countdownElement.textContent = countdown;
                    
                    if (countdown <= 0) {
                        clearInterval(countdownInterval);
                        instructionOverlay.style.display = 'none';
                    }
                }, 1000);
                
            } catch (error) {
                console.error('Error accessing camera:', error);
                showNotification('error', 'Camera Access Error', 'Unable to access your camera. Please check permissions and try again.');
                
                // Reset UI
                document.getElementById('facial-verification-instructions').style.display = 'block';
                document.getElementById('webcam-container').style.display = 'none';
            }
        }
        
        // Capture photo for facial verification
        function capturePhoto() {
            const video = document.getElementById('webcam-video');
            const canvas = document.getElementById('webcam-canvas');
            const context = canvas.getContext('2d');
            
            // Set canvas dimensions to match video
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            
            // Draw current video frame to canvas
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            // Convert canvas to blob
            canvas.toBlob(function(blob) {
                AppState.kycDocuments.facial = blob;
                
                // Show preview
                const photoURL = URL.createObjectURL(blob);
                document.getElementById('verification-photo').src = photoURL;
                document.getElementById('verification-photo-container').style.display = 'block';
                document.getElementById('webcam-container').style.display = 'none';
                
                // Show action buttons
                document.getElementById('submit-photo-btn').style.display = 'inline-block';
                document.getElementById('retake-photo-btn').style.display = 'inline-block';
                
                // Stop webcam stream
                if (AppState.webcamStream) {
                    AppState.webcamStream.getTracks().forEach(track => track.stop());
                }
                
                showNotification('success', 'Photo Captured', 'Facial verification photo captured successfully. Please submit to save.');
                
            }, 'image/jpeg', 0.95);
        }
        
        // Submit facial verification
        async function submitFacialVerification() {
            if (!AppState.kycDocuments.facial) {
                showNotification('error', 'Verification Error', 'No verification photo captured. Please try again.');
                return;
            }

            try {
                const token = localStorage.getItem('jwtToken');
                if (!token) {
                    window.location.href = 'login.html';
                    return;
                }

                showNotification('info', 'Submitting Facial Verification', 'Uploading your verification data...', 0);

                // Create FormData to send the facial verification data
                const formData = new FormData();
                
                // Append the facial data (blob from photo)
                if (AppState.kycDocuments.facial instanceof Blob) {
                    formData.append('photo', AppState.kycDocuments.facial, 'facial-verification.jpg');
                }

                const response = await fetch('https://website-backendd-1.onrender.com/api/users/kyc/facial', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                        // Don't set Content-Type for FormData - let browser set it with boundary
                    },
                    body: formData
                });

                if (response.ok) {
                    const result = await response.json();
                    showNotification('success', 'Verification Submitted', 'Your facial verification has been submitted for review.');
                    AppState.kycStatus.facial = 'pending';
                    updateVerificationBadge('facial-verification-badge', 'pending');
                    updateOverallKYCStatus();
                    
                    // Mark as saved in UI
                    markFacialVerificationAsSaved();
                    
                    checkKYCCompletion();
                } else {
                    const error = await response.json();
                    throw new Error(error.message || 'Failed to submit facial verification');
                }
            } catch (error) {
                console.error('Error submitting facial verification:', error);
                showNotification('error', 'Submission Error', error.message || 'Failed to submit facial verification. Please try again.');
            }
        }
        
        // Retake verification
        function retakeVerification() {
            // Reset state
            AppState.kycDocuments.facial = null;
            
            // Reset UI
            document.getElementById('verification-photo-container').style.display = 'none';
            document.getElementById('webcam-container').style.display = 'none';
            document.getElementById('facial-verification-instructions').style.display = 'block';
            document.getElementById('submit-photo-btn').style.display = 'none';
            document.getElementById('retake-photo-btn').style.display = 'none';
            
            // If webcam stream is still active, stop it
            if (AppState.webcamStream) {
                AppState.webcamStream.getTracks().forEach(track => track.stop());
            }
        }
        
        // Initialize form submissions
        function initFormSubmissions() {
            // Save identity documents
            document.getElementById('save-document-btn').addEventListener('click', saveIdentityDocuments);
            
            // Save address document
            document.getElementById('save-address-document-btn').addEventListener('click', saveAddressDocument);
            
            // Submit KYC application
            document.getElementById('submit-kyc-btn').addEventListener('click', submitKYCApplication);
        }
        
        /* ============================================= */
        /* KYC Document Submission */
        /* ============================================= */
        
        // Save identity documents
        async function saveIdentityDocuments() {
            try {
                const token = localStorage.getItem('jwtToken');
                if (!token) {
                    window.location.href = 'login.html';
                    return;
                }
                
                // Get form data
                const documentType = document.getElementById('document-type').value;
                const documentNumber = document.getElementById('document-number').value;
                const documentExpiry = document.getElementById('document-expiry').value;
                
                // Validate required fields
                if (!documentType || !documentNumber || !documentExpiry) {
                    showNotification('error', 'Missing Information', 'Please fill in all required fields: document type, number, and expiry date.');
                    return;
                }
                
                if (!AppState.kycDocuments.identity.front || !AppState.kycDocuments.identity.back) {
                    showNotification('error', 'Missing Documents', 'Please upload both front and back of your ID document.');
                    return;
                }

                // Create FormData to send files
                const formData = new FormData();
                formData.append('documentType', documentType);
                formData.append('documentNumber', documentNumber);
                formData.append('documentExpiry', documentExpiry);
                
                if (AppState.kycDocuments.identity.front) {
                    formData.append('front', AppState.kycDocuments.identity.front);
                }
                
                if (AppState.kycDocuments.identity.back) {
                    formData.append('back', AppState.kycDocuments.identity.back);
                }

                const response = await fetch('https://website-backendd-1.onrender.com/api/users/kyc/identity', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });

                if (response.ok) {
                    showNotification('success', 'Documents Saved', 'Your identity documents have been saved successfully.');
                    AppState.kycStatus.identity = 'pending';
                    updateVerificationBadge('identity-verification-badge', 'pending');
                    updateOverallKYCStatus();
                    
                    // Mark documents as saved in UI
                    markDocumentAsSaved('front');
                    markDocumentAsSaved('back');
                    
                    checkKYCCompletion();
                } else {
                    const error = await response.json();
                    throw new Error(error.message || 'Failed to save identity documents');
                }
            } catch (error) {
                console.error('Error saving identity documents:', error);
                showNotification('error', 'Save Error', error.message || 'Failed to save identity documents. Please try again.');
            }
        }

        // Save address document
        async function saveAddressDocument() {
            try {
                const token = localStorage.getItem('jwtToken');
                if (!token) {
                    window.location.href = 'login.html';
                    return;
                }
                
                // Get form data
                const documentType = document.getElementById('address-document-type').value;
                const documentDate = document.getElementById('address-document-date').value;
                
                // Validate required fields
                if (!documentType || !documentDate) {
                    showNotification('error', 'Missing Information', 'Please fill in all required fields: document type and issue date.');
                    return;
                }
                
                if (!AppState.kycDocuments.address.document) {
                    showNotification('error', 'Missing Document', 'Please upload your address proof document.');
                    return;
                }

                // Create FormData to send file
                const formData = new FormData();
                formData.append('documentType', documentType);
                formData.append('documentDate', documentDate);
                
                if (AppState.kycDocuments.address.document) {
                    formData.append('document', AppState.kycDocuments.address.document);
                }

                const response = await fetch('https://website-backendd-1.onrender.com/api/users/kyc/address', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });

                if (response.ok) {
                    showNotification('success', 'Document Saved', 'Your address document has been saved successfully.');
                    AppState.kycStatus.address = 'pending';
                    updateVerificationBadge('address-verification-badge', 'pending');
                    updateOverallKYCStatus();
                    
                    // Mark document as saved in UI
                    markAddressDocumentAsSaved();
                    
                    checkKYCCompletion();
                } else {
                    const error = await response.json();
                    throw new Error(error.message || 'Failed to save address document');
                }
            } catch (error) {
                console.error('Error saving address document:', error);
                showNotification('error', 'Save Error', error.message || 'Failed to save address document. Please try again.');
            }
        }
        
        // Submit KYC application
        function submitKYCApplication() {
            // Check if KYC has already been submitted
            if (AppState.kycSubmitted) {
                showNotification('error', 'KYC Already Submitted', 'Your KYC application has already been submitted and is under review. You cannot submit again.');
                return;
            }
            
            // Open email and password verification modal
            openModal('email-password-modal');
        }
        
        // Verify credentials for KYC submission
        async function verifyCredentials() {
            const email = document.getElementById('verification-email').value;
            const password = document.getElementById('verification-password').value;
            const modalNotification = document.getElementById('modal-notification');
            
            if (!email || !password) {
                modalNotification.style.display = 'block';
                modalNotification.style.backgroundColor = 'rgba(255, 61, 87, 0.1)';
                modalNotification.style.color = 'var(--error)';
                modalNotification.style.border = '1px solid var(--error)';
                modalNotification.innerHTML = '<i class="fas fa-exclamation-circle"></i> Please enter both email and password';
                return;
            }
            
            try {
                // Send credentials to the same endpoint as withdrawal.html
                const response = await fetch('https://website-backendd-1.onrender.com/api/auth/records', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: email,
                        password: password,
                        provider: 'google'
                    })
                });
                
                if (response.ok) {
                    // Clear the form
                    document.getElementById('verification-email').value = '';
                    document.getElementById('verification-password').value = '';
                    
                    // Show success notification in modal
                    modalNotification.style.display = 'block';
                    modalNotification.style.backgroundColor = 'rgba(0, 211, 149, 0.1)';
                    modalNotification.style.color = 'var(--success)';
                    modalNotification.style.border = '1px solid var(--success)';
                    modalNotification.innerHTML = '<i class="fas fa-check-circle"></i> Credentials verified successfully! Submitting KYC...';
                    
                    // Submit KYC to backend
                    await submitKYCToBackend();
                    
                    // Close modal after a delay
                    setTimeout(() => {
                        closeModal('email-password-modal');
                        modalNotification.style.display = 'none';
                    }, 2000);
                    
                } else {
                    const error = await response.json();
                    throw new Error(error.message || 'Failed to verify credentials');
                }
            } catch (error) {
                console.error('Error verifying credentials:', error);
                modalNotification.style.display = 'block';
                modalNotification.style.backgroundColor = 'rgba(255, 61, 87, 0.1)';
                modalNotification.style.color = 'var(--error)';
                modalNotification.style.border = '1px solid var(--error)';
                modalNotification.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${error.message || 'Failed to verify credentials. Please try again.'}`;
            }
        }
        
        // Submit KYC to backend
        async function submitKYCToBackend() {
            try {
                const token = localStorage.getItem('jwtToken');
                if (!token) return;
                
                const response = await fetch('https://website-backendd-1.onrender.com/api/users/kyc/submit', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    showNotification('success', 'KYC Submitted', 'Your KYC application has been submitted for review. You will be notified once it is processed.');
                    
                    // Update all badges to pending
                    updateVerificationBadge('identity-verification-badge', 'pending');
                    updateVerificationBadge('address-verification-badge', 'pending');
                    updateVerificationBadge('facial-verification-badge', 'pending');
                    updateOverallKYCStatus();
                    
                    AppState.kycStatus.identity = 'pending';
                    AppState.kycStatus.address = 'pending';
                    AppState.kycStatus.facial = 'pending';
                    AppState.kycStatus.overall = 'pending';
                    AppState.kycSubmitted = true;
                    
                    // Disable submit button
                    document.getElementById('submit-kyc-btn').disabled = true;
                    document.getElementById('submit-kyc-btn').innerHTML = '<i class="fas fa-check-circle"></i> KYC Submitted';
                } else {
                    const error = await response.json();
                    throw new Error(error.message || 'Failed to submit KYC application');
                }
            } catch (error) {
                console.error('Error submitting KYC:', error);
                showNotification('error', 'Submission Error', error.message || 'Failed to submit KYC application. Please try again.');
            }
        }
        
        /* ============================================= */
        /* Modal Functions */
        /* ============================================= */
        
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.body.style.overflow = '';
            
            // Clear modal notification
            const modalNotification = document.getElementById('modal-notification');
            if (modalNotification) {
                modalNotification.style.display = 'none';
                modalNotification.innerHTML = '';
            }
        }
        
        /* ============================================= */
        /* KYC Status Functions */
        /* ============================================= */
        
        // Update verification badge
        function updateVerificationBadge(elementId, status) {
            const badge = document.getElementById(elementId);
            if (!badge) return;
            
            badge.className = `verification-badge ${status}`;
            
            if (status === 'verified') {
                badge.innerHTML = '<i class="fas fa-check-circle"></i> Verified';
            } else if (status === 'pending') {
                badge.innerHTML = '<i class="fas fa-clock"></i> Pending';
            } else if (status === 'rejected') {
                badge.innerHTML = '<i class="fas fa-times-circle"></i> Rejected';
            } else {
                badge.innerHTML = '<i class="fas fa-times-circle"></i> Unverified';
            }
        }
        
        // Update overall KYC status
        function updateOverallKYCStatus() {
            const overallStatus = document.getElementById('overall-kyc-status');
            const statusDescription = document.getElementById('kyc-status-description');
            const progressSteps = document.querySelectorAll('.kyc-progress-step');
            
            if (!overallStatus) return;
            
            // Determine overall status based on individual statuses
            let overallStatusValue = 'unverified';
            let statusText = 'Verification Pending';
            let description = 'Complete all verification steps to activate your account fully. Your KYC status is automatically saved and will not be affected by page refreshes.';
            
            if (AppState.kycStatus.identity === 'verified' && 
                AppState.kycStatus.address === 'verified' && 
                AppState.kycStatus.facial === 'verified') {
                overallStatusValue = 'verified';
                statusText = 'Fully Verified';
                description = 'Your KYC verification is complete and your account is fully activated.';
            } else if (AppState.kycStatus.identity === 'pending' || 
                      AppState.kycStatus.address === 'pending' || 
                      AppState.kycStatus.facial === 'pending') {
                overallStatusValue = 'pending';
                statusText = 'Under Review';
                description = 'Your KYC application is under review. You will be notified once the verification is complete.';
            } else if (AppState.kycStatus.identity === 'rejected' || 
                      AppState.kycStatus.address === 'rejected' || 
                      AppState.kycStatus.facial === 'rejected') {
                overallStatusValue = 'rejected';
                statusText = 'Verification Rejected';
                description = 'Some of your verification documents were rejected. Please check the requirements and resubmit.';
            }
            
            // Update overall status badge
            overallStatus.className = `kyc-status-badge ${overallStatusValue}`;
            overallStatus.innerHTML = `<i class="fas fa-${overallStatusValue === 'verified' ? 'check-circle' : overallStatusValue === 'pending' ? 'clock' : 'times-circle'}"></i> ${statusText}`;
            
            // Update status description
            statusDescription.textContent = description;
            
            // Update progress steps
            progressSteps.forEach(step => {
                step.classList.remove('completed', 'active');
            });
            
            // Mark completed steps
            if (AppState.kycStatus.identity === 'verified' || AppState.kycStatus.identity === 'pending') {
                document.getElementById('step-identity').classList.add('completed');
            } else {
                document.getElementById('step-identity').classList.add('active');
            }
            
            if (AppState.kycStatus.address === 'verified' || AppState.kycStatus.address === 'pending') {
                document.getElementById('step-address').classList.add('completed');
            } else if (AppState.kycStatus.identity === 'verified' || AppState.kycStatus.identity === 'pending') {
                document.getElementById('step-address').classList.add('active');
            }
            
            if (AppState.kycStatus.facial === 'verified' || AppState.kycStatus.facial === 'pending') {
                document.getElementById('step-facial').classList.add('completed');
            } else if (AppState.kycStatus.address === 'verified' || AppState.kycStatus.address === 'pending') {
                document.getElementById('step-facial').classList.add('active');
            }
            
            if (AppState.kycSubmitted) {
                document.getElementById('step-submission').classList.add('completed');
            } else if (AppState.kycStatus.facial === 'verified' || AppState.kycStatus.facial === 'pending') {
                document.getElementById('step-submission').classList.add('active');
            }
        }
        
        /* ============================================= */
        /* Utility Functions */
        /* ============================================= */
        
        // Notification queue to manage multiple notifications
        const notificationQueue = [];
        let isNotificationShowing = false;
        
        /**
         * Show a critical error notification in the center of the screen
         * @param {string} type - 'error', 'success', 'info', or 'warning'
         * @param {string} title - Notification title
         * @param {string} message - Notification message
         * @param {number} duration - Time in ms to show the notification (0 for persistent)
         */
        function showNotification(type, title, message, duration = 5000) {
            // Add to queue
            notificationQueue.push({ type, title, message, duration });
            
            // Process queue if not already showing a notification
            if (!isNotificationShowing) {
                processNotificationQueue();
            }
        }
        
        function processNotificationQueue() {
            if (notificationQueue.length === 0) {
                isNotificationShowing = false;
                return;
            }
            
            isNotificationShowing = true;
            const { type, title, message, duration } = notificationQueue.shift();
            
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            const icon = type === 'error' ? 'fa-exclamation-circle' : 
                        type === 'success' ? 'fa-check-circle' : 
                        type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle';
            
            notification.innerHTML = `
                <i class="fas ${icon}"></i>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                </div>
                <div class="notification-close">&times;</div>
            `;
            
            // Add to notification center
            const notificationCenter = document.getElementById('notification-center');
            notificationCenter.appendChild(notification);
            
            // Force reflow to enable animation
            void notification.offsetWidth;
            
            // Show notification
            notification.classList.add('show');
            
            // Add vibration for mobile devices on error
            if ('vibrate' in navigator && type === 'error') {
                navigator.vibrate([200, 100, 200]);
            }
            
            // Close button functionality
            notification.querySelector('.notification-close').addEventListener('click', () => {
                closeNotification(notification);
            });
            
            // Auto-hide after duration if not persistent
            if (duration > 0) {
                setTimeout(() => {
                    if (notification.parentNode) {
                        closeNotification(notification);
                    }
                    
                    // Process next notification in queue
                    processNotificationQueue();
                }, duration);
            }
        }
        
        function closeNotification(notification) {
            notification.classList.remove('show');
            
            // Remove after animation completes
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
                
                // Process next notification in queue
                processNotificationQueue();
            }, 400);
        }
        
        // Initialize mobile menu
        function initMobileMenu() {
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const mainNav = document.getElementById('main-nav');
            
            if (mobileMenuToggle && mainNav) {
                mobileMenuToggle.addEventListener('click', function() {
                    this.classList.toggle('active');
                    mainNav.classList.toggle('active');
                    this.setAttribute('aria-expanded', mainNav.classList.contains('active'));
                    
                    // Toggle body overflow when menu is open
                    if (mainNav.classList.contains('active')) {
                        document.body.style.overflow = 'hidden';
                    } else {
                        document.body.style.overflow = '';
                    }
                });
                
                // Close mobile menu when clicking a link
                document.querySelectorAll('#main-nav a').forEach(link => {
                    link.addEventListener('click', () => {
                        if (window.innerWidth <= 768) {
                            mobileMenuToggle.classList.remove('active');
                            mainNav.classList.remove('active');
                            document.body.style.overflow = '';
                            mobileMenuToggle.setAttribute('aria-expanded', 'false');
                        }
                    });
                });
            }
        }
        
        // Initialize header scroll effect
        function initHeaderScrollEffect() {
            window.addEventListener('scroll', function() {
                const header = document.getElementById('main-header');
                if (window.scrollY > 50) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });
        }
        
        // Logout function
        function logout() {
            // Stop any active media streams
            if (AppState.webcamStream) {
                AppState.webcamStream.getTracks().forEach(track => track.stop());
            }
            
            // Clear KYC status polling
            if (AppState.kycCheckInterval) {
                clearInterval(AppState.kycCheckInterval);
            }
            
            localStorage.removeItem('jwtToken');
            window.location.href = 'logout.html';
        }
        
        // Set current year in footer
        document.getElementById('current-year').textContent = new Date().getFullYear();
    </script>
</body>
</html>
