<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bithash | Account Settings</title>
    <meta name="description" content="Manage your Bithash account settings, security preferences, and personal information with our institutional-grade platform.">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rowdies:wght@300;400;700&family=Inter:wght@300;400;500;600;700&family=Manrope:wght@500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" type="image/png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #93c5fd;
            --secondary: #10b981;
            --secondary-dark: #059669;
            --dark: #1e293b;
            --darker: #0f172a;
            --light: #f8fafc;
            --lighter: #ffffff;
            --gray: #64748b;
            --gray-light: #e2e8f0;
            --gray-lighter: #f1f5f9;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --gold: #D4AF37;
            --gold-light: #FFD700;
            --gold-dark: #996515;
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            --box-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.08), 0 4px 6px -2px rgba(0, 0, 0, 0.03);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
            overflow-x: hidden;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            color: var(--dark);
            background-color: var(--light);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            position: relative;
        }
        
        /* Dark mode styles */
        body.dark-mode {
            background-color: var(--darker);
            color: var(--light);
        }
        
        body.dark-mode .card,
        body.dark-mode .login-form-container {
            background-color: #1a2238;
            color: var(--light);
        }
        
        body.dark-mode .form-control {
            background-color: #2d3748;
            color: var(--light);
            border-color: #4a5568;
        }
        
        body.dark-mode .form-label,
        body.dark-mode .card-title,
        body.dark-mode h1, 
        body.dark-mode h2,
        body.dark-mode h3,
        body.dark-mode h4,
        body.dark-mode h5,
        body.dark-mode h6 {
            color: var(--light);
        }
        
        body.dark-mode nav a {
            color: var(--light);
        }
        
        body.dark-mode footer {
            background-color: #0b1120;
        }
        
        /* Loading animation */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--light);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        
        .loading-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }
        
        .loading-logo {
            width: 80px;
            height: 80px;
            animation: pulse 1.5s infinite ease-in-out;
        }
        
        .loading-text {
            margin-top: 20px;
            font-weight: 500;
            color: var(--gray);
            font-size: 1rem;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.8; }
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
        }
        
        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Manrope', sans-serif;
            font-weight: 700;
            line-height: 1.2;
            color: var(--darker);
        }
        
        body.dark-mode h1,
        body.dark-mode h2,
        body.dark-mode h3,
        body.dark-mode h4,
        body.dark-mode h5,
        body.dark-mode h6 {
            color: var(--light);
        }
        
        p {
            margin-bottom: 1rem;
            color: var(--gray);
        }
        
        body.dark-mode p {
            color: #cbd5e0;
        }
        
        a {
            color: var(--primary);
            text-decoration: none;
            transition: var(--transition);
        }
        
        a:hover {
            color: var(--primary-dark);
        }
        
        /* Header Styles */
        header {
            background-color: var(--lighter);
            box-shadow: var(--box-shadow);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            padding: 15px 0;
            transition: var(--transition-slow);
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        body.dark-mode header {
            background-color: #1a2238;
            border-bottom: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        header.scrolled {
            padding: 10px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo img {
            height: 40px;
            width: auto;
            transition: var(--transition);
        }
        
        .logo-text {
            font-family: 'Rowdies', sans-serif;
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--gold);
            transition: var(--transition);
        }
        
        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--dark);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
            z-index: 1001;
        }
        
        body.dark-mode .mobile-menu-toggle {
            color: var(--light);
        }
        
        nav {
            transition: var(--transition-slow);
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 25px;
        }
        
        nav a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: var(--transition);
            position: relative;
            font-size: 0.95rem;
            padding: 5px 0;
        }
        
        nav a:hover {
            color: var(--gold);
        }
        
        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--gold);
            transition: var(--transition);
        }
        
        nav a:hover::after {
            width: 100%;
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            white-space: nowrap;
        }
        
        .btn-primary {
            background-color: var(--gold);
            color: var(--darker);
        }
        
        .btn-primary:hover {
            background-color: var(--gold-dark);
            transform: translateY(-2px);
            box-shadow: var(--box-shadow-lg);
            color: white;
        }
        
        .btn-outline {
            background-color: transparent;
            color: var(--gold);
            border: 1px solid var(--gold);
        }
        
        .btn-outline:hover {
            background-color: var(--gold);
            color: var(--darker);
            transform: translateY(-2px);
            box-shadow: var(--box-shadow-lg);
        }
        
        /* Settings Section */
        .settings-section {
            padding: 160px 0 80px;
            min-height: 100vh;
        }
        
        .settings-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 30px;
        }
        
        .settings-sidebar {
            position: sticky;
            top: 120px;
            height: fit-content;
        }
        
        .settings-sidebar-card {
            background-color: white;
            border-radius: var(--border-radius-lg);
            padding: 20px;
            box-shadow: var(--box-shadow);
            margin-bottom: 20px;
        }
        
        body.dark-mode .settings-sidebar-card {
            background-color: #1a2238;
        }
        
        .user-profile-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        .profile-avatar {
            position: relative;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            overflow: hidden;
            margin-bottom: 15px;
            border: 3px solid var(--gold);
        }
        
        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .avatar-upload {
            position: absolute;
            bottom: 0;
            right: 0;
            background-color: var(--gold);
            color: var(--darker);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .avatar-upload:hover {
            background-color: var(--gold-dark);
            color: white;
        }
        
        .avatar-upload input {
            display: none;
        }
        
        .user-name {
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .user-email {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .settings-menu {
            list-style: none;
        }
        
        .settings-menu li {
            margin-bottom: 5px;
        }
        
        .settings-menu a {
            display: block;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            color: var(--dark);
            font-weight: 500;
            transition: var(--transition);
        }
        
        body.dark-mode .settings-menu a {
            color: var(--light);
        }
        
        .settings-menu a:hover,
        .settings-menu a.active {
            background-color: rgba(212, 175, 55, 0.1);
            color: var(--gold);
        }
        
        .settings-menu a i {
            width: 20px;
            text-align: center;
            margin-right: 10px;
        }
        
        .settings-content {
            background-color: white;
            border-radius: var(--border-radius-lg);
            padding: 40px;
            box-shadow: var(--box-shadow);
        }
        
        body.dark-mode .settings-content {
            background-color: #1a2238;
        }
        
        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--gray-light);
        }
        
        body.dark-mode .settings-header {
            border-bottom-color: #4a5568;
        }
        
        .settings-title {
            font-size: 1.8rem;
        }
        
        .settings-tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 30px;
        }
        
        body.dark-mode .settings-tabs {
            border-bottom-color: #4a5568;
        }
        
        .settings-tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
            position: relative;
        }
        
        .settings-tab.active {
            color: var(--gold);
        }
        
        .settings-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--gold);
        }
        
        .settings-panel {
            display: none;
        }
        
        .settings-panel.active {
            display: block;
        }
        
        .panel-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: var(--darker);
        }
        
        body.dark-mode .panel-title {
            color: var(--light);
        }
        
        .panel-description {
            color: var(--gray);
            margin-bottom: 30px;
            max-width: 700px;
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }
        
        body.dark-mode .form-label {
            color: var(--light);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background-color: var(--gray-lighter);
        }
        
        body.dark-mode .form-control {
            background-color: #2d3748;
            border-color: #4a5568;
            color: var(--light);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
            background-color: white;
        }
        
        body.dark-mode .form-control:focus {
            background-color: #2d3748;
        }
        
        .form-control.error {
            border-color: var(--error);
        }
        
        .form-control.success {
            border-color: var(--success);
        }
        
        .form-feedback {
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
        }
        
        .form-feedback.error {
            color: var(--error);
            display: block;
        }
        
        .form-feedback.success {
            color: var(--success);
            display: block;
        }
        
        .password-toggle {
            position: absolute;
            right: 15px;
            top: 38px;
            color: var(--gray);
            cursor: pointer;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .form-submit {
            padding: 12px 25px;
            font-size: 1rem;
            font-weight: 600;
        }
        
        /* Theme Toggle */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .theme-toggle-label {
            font-weight: 500;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: var(--gold);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        /* Referral Section */
        .referral-card {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        body.dark-mode .referral-card {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(212, 175, 55, 0.08) 100%);
        }
        
        .referral-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .referral-stat {
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            box-shadow: var(--box-shadow);
        }
        
        body.dark-mode .referral-stat {
            background-color: #2d3748;
        }
        
        .referral-stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--gold);
            margin-bottom: 5px;
        }
        
        .referral-stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .referral-link-container {
            display: flex;
            margin-bottom: 20px;
        }
        
        .referral-link {
            flex: 1;
            padding: 12px 15px;
            background-color: white;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius) 0 0 var(--border-radius);
            font-family: monospace;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        body.dark-mode .referral-link {
            background-color: #2d3748;
            border-color: #4a5568;
        }
        
        .btn-copy {
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
            background-color: var(--gold);
            color: var(--darker);
            border: none;
            padding: 0 15px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .btn-copy:hover {
            background-color: var(--gold-dark);
            color: white;
        }
        
        .referral-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .referral-table th,
        .referral-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--gray-light);
        }
        
        body.dark-mode .referral-table th,
        body.dark-mode .referral-table td {
            border-bottom-color: #4a5568;
        }
        
        .referral-table th {
            font-weight: 600;
            color: var(--darker);
        }
        
        body.dark-mode .referral-table th {
            color: var(--light);
        }
        
        .referral-table tr:last-child td {
            border-bottom: none;
        }
        
        /* KYC Section */
        .kyc-status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: var(--border-radius);
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }
        
        .kyc-status.pending {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .kyc-status.verified {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }
        
        .kyc-status.rejected {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }
        
        .document-upload {
            border: 2px dashed var(--gray-light);
            border-radius: var(--border-radius);
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
            transition: var(--transition);
        }
        
        body.dark-mode .document-upload {
            border-color: #4a5568;
        }
        
        .document-upload:hover {
            border-color: var(--gold);
        }
        
        .document-upload i {
            font-size: 2rem;
            color: var(--gray);
            margin-bottom: 10px;
        }
        
        .document-upload p {
            margin-bottom: 15px;
        }
        
        .document-preview {
            display: none;
            margin-top: 20px;
        }
        
        .document-preview img {
            max-width: 100%;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray-light);
        }
        
        /* 2FA Section */
        .two-factor-methods {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .two-factor-method {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            border: 1px solid var(--gray-light);
            transition: var(--transition);
        }
        
        body.dark-mode .two-factor-method {
            background-color: #2d3748;
            border-color: #4a5568;
        }
        
        .two-factor-method.active {
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
        }
        
        .two-factor-method-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .two-factor-method-title {
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .two-factor-method-status {
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 20px;
            background-color: var(--gray-lighter);
            color: var(--gray);
        }
        
        .two-factor-method.active .two-factor-method-status {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }
        
        .two-factor-method-description {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .two-factor-setup {
            display: none;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--gray-light);
        }
        
        body.dark-mode .two-factor-setup {
            border-top-color: #4a5568;
        }
        
        .two-factor-setup.active {
            display: block;
        }
        
        .qr-code-container {
            text-align: center;
            margin: 20px 0;
        }
        
        .qr-code {
            width: 180px;
            height: 180px;
            margin: 0 auto;
            background-color: white;
            padding: 10px;
            border-radius: var(--border-radius);
        }
        
        .backup-codes {
            background-color: var(--gray-lighter);
            padding: 15px;
            border-radius: var(--border-radius);
            margin-top: 20px;
            font-family: monospace;
            text-align: center;
        }
        
        body.dark-mode .backup-codes {
            background-color: #2d3748;
        }
        
        /* Security Log */
        .security-log {
            list-style: none;
        }
        
        .security-log-item {
            padding: 15px 0;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
        }
        
        body.dark-mode .security-log-item {
            border-bottom-color: #4a5568;
        }
        
        .security-log-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(212, 175, 55, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: var(--gold);
            flex-shrink: 0;
        }
        
        .security-log-content {
            flex: 1;
        }
        
        .security-log-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .security-log-meta {
            display: flex;
            gap: 15px;
            color: var(--gray);
            font-size: 0.85rem;
        }
        
        .security-log-action {
            color: var(--gold);
            font-weight: 500;
            cursor: pointer;
        }
        
        /* Notification Preferences */
        .notification-category {
            margin-bottom: 30px;
        }
        
        .notification-category-title {
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .notification-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .notification-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        body.dark-mode .notification-option {
            background-color: #2d3748;
        }
        
        .notification-label {
            font-weight: 500;
        }
        
        /* Account Deactivation */
        .deactivation-warning {
            background-color: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--error);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
        }
        
        .deactivation-warning-title {
            font-weight: 600;
            color: var(--error);
            margin-bottom: 10px;
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-slow);
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal {
            background-color: white;
            border-radius: var(--border-radius-lg);
            width: 100%;
            max-width: 500px;
            box-shadow: var(--box-shadow-lg);
            transform: translateY(20px);
            transition: var(--transition-slow);
            position: relative;
        }
        
        body.dark-mode .modal {
            background-color: #1a2238;
        }
        
        .modal-overlay.active .modal {
            transform: translateY(0);
        }
        
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        body.dark-mode .modal-header {
            border-bottom-color: #4a5568;
        }
        
        .modal-title {
            font-weight: 700;
            font-size: 1.2rem;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        body.dark-mode .modal-footer {
            border-top-color: #4a5568;
        }
        
        /* Notification Popups */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 350px;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-lg);
            padding: 20px;
            display: flex;
            gap: 15px;
            z-index: 1001;
            opacity: 0;
            transform: translateY(-20px);
            transition: var(--transition);
            border-left: 4px solid var(--error);
        }
        
        body.dark-mode .notification {
            background-color: #1a2238;
        }
        
        .notification.success {
            border-left-color: var(--success);
        }
        
        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .notification-icon {
            width: 40px;
            height: 40px;
            background-color: var(--error);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            flex-shrink: 0;
            font-size: 1.2rem;
        }
        
        .notification.success .notification-icon {
            background-color: var(--success);
        }
        
        .notification-content h4 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--darker);
        }
        
        body.dark-mode .notification-content h4 {
            color: var(--light);
        }
        
        .notification-content p {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 0;
        }
        
        .notification-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            font-size: 1rem;
        }
        
        /* Footer */
        footer {
            background-color: var(--darker);
            color: white;
            padding: 40px 0 20px;
        }
        
        .footer-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .footer-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .footer-logo img {
            height: 30px;
            width: auto;
        }
        
        .footer-logo-text {
            font-family: 'Rowdies', sans-serif;
            font-weight: 700;
            font-size: 1.2rem;
            color: white;
        }
        
        .footer-about p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            margin-bottom: 20px;
        }
        
        .footer-social {
            display: flex;
            gap: 12px;
        }
        
        .social-icon {
            width: 38px;
            height: 38px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: white;
        }
        
        .social-icon.twitter { background-color: #1DA1F2; }
        .social-icon.linkedin { background-color: #0077B5; }
        .social-icon.facebook { background-color: #4267B2; }
        .social-icon.instagram { 
            background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D);
        }
        
        .social-icon:hover {
            transform: translateY(-3px);
            box-shadow: var(--box-shadow);
        }
        
        .footer-title {
            font-weight: 700;
            margin-bottom: 20px;
            font-size: 1.1rem;
        }
        
        .footer-links ul {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        
        .footer-links a:hover {
            color: var(--gold);
            padding-left: 5px;
        }
        
        .footer-contact p {
            display: flex;
            align-items: center;
            gap: 10px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        .footer-contact i {
            color: var(--gold);
            width: 20px;
            text-align: center;
        }
        
        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 20px;
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.8rem;
        }
        
        /* Responsive Styles */
        @media (max-width: 1024px) {
            .settings-container {
                grid-template-columns: 1fr;
            }
            
            .settings-sidebar {
                position: static;
                margin-bottom: 30px;
            }
            
            .referral-stats {
                grid-template-columns: 1fr 1fr;
            }
            
            .two-factor-methods {
                grid-template-columns: 1fr;
            }
            
            .footer-container {
                grid-template-columns: repeat(2, 1fr);
                gap: 30px;
            }
        }
        
        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block;
            }
            
            nav {
                position: fixed;
                top: 80px;
                left: 0;
                width: 100%;
                background-color: var(--lighter);
                box-shadow: var(--box-shadow);
                padding: 20px;
                transform: translateY(-150%);
                opacity: 0;
            }
            
            body.dark-mode nav {
                background-color: #1a2238;
            }
            
            nav.active {
                transform: translateY(0);
                opacity: 1;
            }
            
            nav ul {
                flex-direction: column;
                gap: 15px;
            }
            
            .header-container {
                flex-wrap: wrap;
            }
            
            .settings-section {
                padding: 140px 0 60px;
            }
            
            .settings-content {
                padding: 30px 20px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .notification-options {
                grid-template-columns: 1fr;
            }
            
            .footer-container {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .settings-title {
                font-size: 1.5rem;
            }
            
            .panel-title {
                font-size: 1.2rem;
            }
            
            .referral-stats {
                grid-template-columns: 1fr;
            }
            
            .notification {
                width: calc(100% - 40px);
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="Bithash Logo" class="loading-logo">
        <div class="loading-text">Loading Secure Platform...</div>
    </div>

    <!-- Header -->
    <header id="main-header">
        <div class="container header-container">
            <div class="logo">
                <a href="index.html">
                    <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="Bithash Logo">
                    <span class="logo-text">Bithash</span>
                </a>
            </div>
            
            <button class="mobile-menu-toggle" id="mobile-menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            
            <nav id="main-nav">
                <ul>
                    <li><a href="index.html#home">Home</a></li>
                    <li><a href="index.html#about">About</a></li>
                    <li><a href="index.html#plans">Plans</a></li>
                    <li><a href="index.html#how-it-works">How It Works</a></li>
                    <li><a href="index.html#testimonials">Testimonials</a></li>
                    <li><a href="index.html#contact">Contact</a></li>
                    <li><a href="dashboard.html" class="btn btn-outline">Dashboard</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Settings Section -->
    <section class="settings-section">
        <div class="container">
            <div class="settings-container">
                <!-- Settings Sidebar -->
                <div class="settings-sidebar">
                    <div class="settings-sidebar-card user-profile-card">
                        <div class="profile-avatar">
                            <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="User Avatar" id="user-avatar">
                            <label class="avatar-upload" for="avatar-upload">
                                <i class="fas fa-camera"></i>
                                <input type="file" id="avatar-upload" accept="image/*">
                            </label>
                        </div>
                        <div class="user-name" id="user-name">Loading...</div>
                        <div class="user-email" id="user-email">user@example.com</div>
                        <div class="theme-toggle">
                            <span class="theme-toggle-label">Dark Mode</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="theme-toggle">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-sidebar-card">
                        <ul class="settings-menu">
                            <li><a href="#profile" class="active" data-panel="profile"><i class="fas fa-user"></i> Profile</a></li>
                            <li><a href="#security" data-panel="security"><i class="fas fa-shield-alt"></i> Security</a></li>
                            <li><a href="#kyc" data-panel="kyc"><i class="fas fa-id-card"></i> KYC Verification</a></li>
                            <li><a href="#2fa" data-panel="2fa"><i class="fas fa-lock"></i> Two-Factor Auth</a></li>
                            <li><a href="#referrals" data-panel="referrals"><i class="fas fa-user-friends"></i> Referrals</a></li>
                            <li><a href="#notifications" data-panel="notifications"><i class="fas fa-bell"></i> Notifications</a></li>
                            <li><a href="#activity" data-panel="activity"><i class="fas fa-history"></i> Activity Log</a></li>
                            <li><a href="#deactivate" data-panel="deactivate"><i class="fas fa-user-slash"></i> Account Deactivation</a></li>
                        </ul>
                    </div>
                </div>
                
                <!-- Settings Content -->
                <div class="settings-content">
                    <div class="settings-header">
                        <h1 class="settings-title">Account Settings</h1>
                        <div class="account-status">
                            <span class="kyc-status verified" id="account-status">Verified Account</span>
                        </div>
                    </div>
                    
                    <div class="settings-tabs">
                        <div class="settings-tab active" data-panel="profile">Profile</div>
                        <div class="settings-tab" data-panel="security">Security</div>
                        <div class="settings-tab" data-panel="kyc">KYC</div>
                        <div class="settings-tab" data-panel="referrals">Referrals</div>
                    </div>
                    
                    <!-- Profile Panel -->
                    <div class="settings-panel active" id="profile-panel">
                        <h2 class="panel-title">Personal Information</h2>
                        <p class="panel-description">Update your personal details and contact information. Changes may require verification.</p>
                        
                        <form id="profile-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="first-name" class="form-label">First Name</label>
                                    <input type="text" id="first-name" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="last-name" class="form-label">Last Name</label>
                                    <input type="text" id="last-name" class="form-control" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="profile-email" class="form-label">Email Address</label>
                                <input type="email" id="profile-email" class="form-control" required>
                                <div class="form-feedback error" id="email-error"></div>
                            </div>
                            
                            <div class="form-group">
                                <label for="phone" class="form-label">Phone Number</label>
                                <input type="tel" id="phone" class="form-control">
                            </div>
                            
                            <div class="form-group">
                                <label for="city" class="form-label">Nearest City</label>
                                <input type="text" id="city" class="form-control">
                            </div>
                            
                            <button type="submit" class="btn btn-primary form-submit" id="profile-submit">
                                <span id="profile-submit-text">Save Changes</span>
                                <span id="profile-submit-spinner" style="display: none;">
                                    <i class="fas fa-spinner fa-spin"></i>
                                </span>
                            </button>
                        </form>
                    </div>
                    
                    <!-- Security Panel -->
                    <div class="settings-panel" id="security-panel">
                        <h2 class="panel-title">Password & Security</h2>
                        <p class="panel-description">Enhance your account security by updating your password regularly.</p>
                        
                        <form id="password-form">
                            <div class="form-group">
                                <label for="current-password" class="form-label">Current Password</label>
                                <input type="password" id="current-password" class="form-control" required>
                                <i class="fas fa-eye password-toggle" data-target="current-password"></i>
                                <div class="form-feedback error" id="current-password-error"></div>
                            </div>
                            
                            <div class="form-group">
                                <label for="new-password" class="form-label">New Password</label>
                                <input type="password" id="new-password" class="form-control" required>
                                <i class="fas fa-eye password-toggle" data-target="new-password"></i>
                                <div class="form-feedback error" id="new-password-error"></div>
                            </div>
                            
                            <div class="form-group">
                                <label for="confirm-password" class="form-label">Confirm New Password</label>
                                <input type="password" id="confirm-password" class="form-control" required>
                                <i class="fas fa-eye password-toggle" data-target="confirm-password"></i>
                                <div class="form-feedback error" id="confirm-password-error"></div>
                            </div>
                            
                            <div class="password-strength">
                                <div class="strength-meter">
                                    <div class="strength-bar"></div>
                                </div>
                                <div class="strength-feedback"></div>
                            </div>
                            
                            <button type="submit" class="btn btn-primary form-submit" id="password-submit">
                                <span id="password-submit-text">Update Password</span>
                                <span id="password-submit-spinner" style="display: none;">
                                    <i class="fas fa-spinner fa-spin"></i>
                                </span>
                            </button>
                        </form>
                    </div>
                    
                    <!-- KYC Panel -->
                    <div class="settings-panel" id="kyc-panel">
                        <h2 class="panel-title">Identity Verification</h2>
                        <p class="panel-description">Complete KYC verification to unlock all platform features and higher withdrawal limits.</p>
                        
                        <div class="kyc-status pending" id="kyc-status-badge">Pending Verification</div>
                        
                        <form id="kyc-form">
                            <div class="form-group">
                                <label for="document-type" class="form-label">Document Type</label>
                                <select id="document-type" class="form-control" required>
                                    <option value="">Select document type</option>
                                    <option value="passport">Passport</option>
                                    <option value="national_id">National ID</option>
                                    <option value="drivers_license">Driver's License</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Document Upload</label>
                                <div class="document-upload" id="document-upload-area">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <p>Drag & drop your document here or click to browse</p>
                                    <input type="file" id="document-file" accept="image/*,.pdf" style="display: none;">
                                    <button type="button" class="btn btn-outline" id="browse-btn">Browse Files</button>
                                </div>
                                <div class="document-preview" id="document-preview">
                                    <img src="" alt="Document Preview" id="document-preview-img">
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-primary form-submit" id="kyc-submit" disabled>
                                <span id="kyc-submit-text">Submit for Verification</span>
                                <span id="kyc-submit-spinner" style="display: none;">
                                    <i class="fas fa-spinner fa-spin"></i>
                                </span>
                            </button>
                        </form>
                    </div>
                    
                    <!-- 2FA Panel -->
                    <div class="settings-panel" id="2fa-panel">
                        <h2 class="panel-title">Two-Factor Authentication</h2>
                        <p class="panel-description">Add an extra layer of security to your account by enabling two-factor authentication.</p>
                        
                        <div class="two-factor-methods">
                            <div class="two-factor-method" id="email-2fa">
                                <div class="two-factor-method-header">
                                    <div class="two-factor-method-title">Email Verification</div>
                                    <div class="two-factor-method-status">Inactive</div>
                                </div>
                                <div class="two-factor-method-description">
                                    Receive a one-time verification code via email whenever you log in.
                                </div>
                                <button class="btn btn-outline" id="toggle-email-2fa">Enable</button>
                            </div>
                            
                            <div class="two-factor-method" id="authenticator-2fa">
                                <div class="two-factor-method-header">
                                    <div class="two-factor-method-title">Authenticator App</div>
                                    <div class="two-factor-method-status">Inactive</div>
                                </div>
                                <div class="two-factor-method-description">
                                    Use an authenticator app like Google Authenticator or Authy to generate verification codes.
                                </div>
                                <button class="btn btn-outline" id="toggle-authenticator-2fa">Enable</button>
                                
                                <div class="two-factor-setup" id="authenticator-setup">
                                    <div class="qr-code-container">
                                        <p>Scan this QR code with your authenticator app:</p>
                                        <div class="qr-code" id="qr-code"></div>
                                        <p>Or enter this secret key manually:</p>
                                        <div class="backup-codes" id="authenticator-secret">Loading...</div>
                                    </div>
                                    <div class="form-group">
                                        <label for="verification-code" class="form-label">Enter Verification Code</label>
                                        <input type="text" id="verification-code" class="form-control" placeholder="6-digit code">
                                        <div class="form-feedback error" id="verification-code-error"></div>
                                    </div>
                                    <button class="btn btn-primary" id="verify-authenticator">Verify & Activate</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="backup-codes-container" id="backup-codes-container" style="display: none;">
                            <h3>Backup Codes</h3>
                            <p>Save these codes in a secure place. Each code can be used once if you lose access to your 2FA device.</p>
                            <div class="backup-codes" id="backup-codes-display"></div>
                            <button class="btn btn-outline" id="generate-new-codes">Generate New Codes</button>
                        </div>
                    </div>
                    
                    <!-- Referrals Panel -->
                    <div class="settings-panel" id="referrals-panel">
                        <h2 class="panel-title">Referral Program</h2>
                        <p class="panel-description">Earn rewards by inviting friends to join Bithash. You'll both receive bonuses when they sign up and start mining.</p>
                        
                        <div class="referral-card">
                            <div class="referral-stats">
                                <div class="referral-stat">
                                    <div class="referral-stat-value" id="total-referrals">0</div>
                                    <div class="referral-stat-label">Total Referrals</div>
                                </div>
                                <div class="referral-stat">
                                    <div class="referral-stat-value" id="active-referrals">0</div>
                                    <div class="referral-stat-label">Active Referrals</div>
                                </div>
                                <div class="referral-stat">
                                    <div class="referral-stat-value" id="referral-earnings">0 BTC</div>
                                    <div class="referral-stat-label">Total Earnings</div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Your Unique Referral Link</label>
                                <div class="referral-link-container">
                                    <input type="text" class="referral-link" id="referral-link" readonly>
                                    <button class="btn-copy" id="copy-referral-link">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="social-share">
                                <p>Share your link:</p>
                                <div class="footer-social">
                                    <a href="#" class="social-icon twitter" id="share-twitter"><i class="fab fa-twitter"></i></a>
                                    <a href="#" class="social-icon facebook" id="share-facebook"><i class="fab fa-facebook"></i></a>
                                    <a href="#" class="social-icon linkedin" id="share-linkedin"><i class="fab fa-linkedin"></i></a>
                                    <a href="#" class="social-icon whatsapp" id="share-whatsapp"><i class="fab fa-whatsapp"></i></a>
                                </div>
                            </div>
                        </div>
                        
                        <h3>Referral History</h3>
                        <div class="table-responsive">
                            <table class="referral-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Referred User</th>
                                        <th>Status</th>
                                        <th>Earnings</th>
                                    </tr>
                                </thead>
                                <tbody id="referral-history">
                                    <tr>
                                        <td colspan="4" style="text-align: center;">Loading referral history...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Notifications Panel -->
                    <div class="settings-panel" id="notifications-panel">
                        <h2 class="panel-title">Notification Preferences</h2>
                        <p class="panel-description">Choose how you want to receive notifications from Bithash.</p>
                        
                        <form id="notifications-form">
                            <div class="notification-category">
                                <h3 class="notification-category-title">Email Notifications</h3>
                                <div class="notification-options">
                                    <div class="notification-option">
                                        <span class="notification-label">Account Alerts</span>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="email-account-alerts" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <div class="notification-option">
                                        <span class="notification-label">Investment Updates</span>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="email-investment-updates" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <div class="notification-option">
                                        <span class="notification-label">Withdrawal Confirmations</span>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="email-withdrawal-confirmations" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <div class="notification-option">
                                        <span class="notification-label">Promotional Offers</span>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="email-promotional-offers">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="notification-category">
                                <h3 class="notification-category-title">SMS Notifications</h3>
                                <div class="notification-options">
                                    <div class="notification-option">
                                        <span class="notification-label">Security Alerts</span>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="sms-security-alerts" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <div class="notification-option">
                                        <span class="notification-label">Withdrawal Confirmations</span>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="sms-withdrawal-confirmations">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-primary form-submit" id="notifications-submit">
                                <span id="notifications-submit-text">Save Preferences</span>
                                <span id="notifications-submit-spinner" style="display: none;">
                                    <i class="fas fa-spinner fa-spin"></i>
                                </span>
                            </button>
                        </form>
                    </div>
                    
                    <!-- Activity Log Panel -->
                    <div class="settings-panel" id="activity-panel">
                        <h2 class="panel-title">Security Activity Log</h2>
                        <p class="panel-description">Review recent activity on your account. Contact support if you notice any suspicious activity.</p>
                        
                        <ul class="security-log" id="security-log">
                            <li class="security-log-item">
                                <div class="security-log-icon">
                                    <i class="fas fa-sign-in-alt"></i>
                                </div>
                                <div class="security-log-content">
                                    <div class="security-log-title">Successful login</div>
                                    <div class="security-log-meta">
                                        <span>Just now</span>
                                        <span>IP: 192.168.1.1</span>
                                        <span>Chrome on Windows</span>
                                    </div>
                                </div>
                                <div class="security-log-action">Report</div>
                            </li>
                        </ul>
                        
                        <button class="btn btn-outline" id="load-more-activity">Load More Activity</button>
                    </div>
                    
                    <!-- Account Deactivation Panel -->
                    <div class="settings-panel" id="deactivate-panel">
                        <h2 class="panel-title">Account Deactivation</h2>
                        
                        <div class="deactivation-warning">
                            <h3 class="deactivation-warning-title">Warning</h3>
                            <p>Deactivating your account will immediately suspend all mining operations and disable access to your dashboard. Any active investments will be paused and can be resumed if you reactivate your account within 30 days. After 30 days, your account and all associated data will be permanently deleted.</p>
                        </div>
                        
                        <div class="form-group">
                            <label for="deactivation-reason" class="form-label">Reason for Deactivation (Optional)</label>
                            <select id="deactivation-reason" class="form-control">
                                <option value="">Select a reason</option>
                                <option value="privacy">Privacy concerns</option>
                                <option value="service">Dissatisfied with service</option>
                                <option value="technical">Technical issues</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        
                        <div class="form-group" id="other-reason-container" style="display: none;">
                            <label for="other-reason" class="form-label">Please specify</label>
                            <textarea id="other-reason" class="form-control" rows="3"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="deactivation-password" class="form-label">Confirm Your Password</label>
                            <input type="password" id="deactivation-password" class="form-control" required>
                            <i class="fas fa-eye password-toggle" data-target="deactivation-password"></i>
                        </div>
                        
                        <button class="btn btn-primary" id="request-deactivation">Request Account Deactivation</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact">
        <div class="container">
            <div class="footer-container">
                <div class="footer-about">
                    <div class="footer-logo">
                        <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="Bithash Logo">
                        <span class="footer-logo-text">Bithash</span>
                    </div>
                    <p>Premium Bitcoin mining platform serving investors worldwide with transparent, secure operations and daily payouts.</p>
                    <div class="footer-social">
                        <a href="#" class="social-icon twitter"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-icon linkedin"><i class="fab fa-linkedin"></i></a>
                        <a href="#" class="social-icon facebook"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="social-icon instagram"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                
                <div class="footer-links">
                    <h3 class="footer-title">Quick Links</h3>
                    <ul>
                        <li><a href="index.html#home">Home</a></li>
                        <li><a href="index.html#about">About Us</a></li>
                        <li><a href="index.html#plans">Investment Plans</a></li>
                        <li><a href="index.html#how-it-works">How It Works</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                    </ul>
                </div>
                
                <div class="footer-links">
                    <h3 class="footer-title">Legal</h3>
                    <ul>
                        <li><a href="terms.html">Terms of Service</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="aml.html">AML Policy</a></li>
                        <li><a href="risk.html">Risk Disclosure</a></li>
                    </ul>
                </div>
                
                <div class="footer-contact">
                    <h3 class="footer-title">Contact Us</h3>
                    <p><i class="fas fa-envelope"></i> support@bithash.com</p>
                    <p><i class="fas fa-phone"></i> +1 (555) 123-4567</p>
                    <p><i class="fas fa-map-marker-alt"></i> 123 Blockchain Ave, Crypto City, CC 10001</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; <span id="current-year"></span> Bithash. All Rights Reserved. Bithash LLC is registered in Delaware, USA.</p>
            </div>
        </div>
    </footer>

    <!-- Deactivation Confirmation Modal -->
    <div class="modal-overlay" id="deactivation-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Confirm Account Deactivation</h3>
                <button class="modal-close" id="close-deactivation-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to deactivate your account? This action will:</p>
                <ul style="margin: 15px 0; padding-left: 20px;">
                    <li>Immediately suspend all mining operations</li>
                    <li>Disable access to your dashboard</li>
                    <li>Pause any active investments</li>
                    <li>Begin 30-day countdown to permanent deletion</li>
                </ul>
                <p>To reactivate your account, simply log in within the next 30 days.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-deactivation">Cancel</button>
                <button class="btn btn-primary" id="confirm-deactivation">Confirm Deactivation</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <button class="notification-close" id="notification-close">&times;</button>
        <div class="notification-icon">
            <i class="fas fa-exclamation"></i>
        </div>
        <div class="notification-content">
            <h4 id="notification-title">Error</h4>
            <p id="notification-message">An error occurred while processing your request.</p>
        </div>
    </div>

    <!-- QR Code Generator -->
    <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
    
    <!-- AOS Animation -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <script>
        // API Base URL
        const API_BASE_URL = 'https://website-backendd-1.onrender.com';
        
        // Initialize AOS animation
        AOS.init({
            duration: 800,
            once: true,
            easing: 'ease-in-out'
        });
        
        // Hide loading overlay when page is loaded
        window.addEventListener('load', function() {
            setTimeout(function() {
                document.getElementById('loading-overlay').classList.add('hidden');
                loadUserData();
                loadSecurityLog();
                loadReferralData();
                checkKYCStatus();
                check2FAStatus();
                loadNotificationPreferences();
            }, 1000);
        });
        
        // Current year in footer
        document.getElementById('current-year').textContent = new Date().getFullYear();
        
        // Header scroll effect
        window.addEventListener('scroll', function() {
            const header = document.getElementById('main-header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });
        
        // Mobile menu toggle
        const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
        const mainNav = document.getElementById('main-nav');
        
        mobileMenuToggle.addEventListener('click', function() {
            mainNav.classList.toggle('active');
            this.innerHTML = mainNav.classList.contains('active') ? 
                '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
        });
        
        // Close mobile menu when clicking a link
        document.querySelectorAll('#main-nav a').forEach(link => {
            link.addEventListener('click', () => {
                if (window.innerWidth <= 768) {
                    mainNav.classList.remove('active');
                    mobileMenuToggle.innerHTML = '<i class="fas fa-bars"></i>';
                }
            });
        });
        
        // Theme toggle
        const themeToggle = document.getElementById('theme-toggle');
        themeToggle.addEventListener('change', toggleTheme);
        
        // Check for saved theme preference
        function checkTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                themeToggle.checked = true;
            }
        }
        
        // Toggle between light and dark theme
        function toggleTheme() {
            if (themeToggle.checked) {
                document.body.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark');
                updateThemePreference('dark');
            } else {
                document.body.classList.remove('dark-mode');
                localStorage.setItem('theme', 'light');
                updateThemePreference('light');
            }
        }
        
        // Update theme preference on server
        async function updateThemePreference(theme) {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            try {
                await fetch(`${API_BASE_URL}/api/users/theme`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({ theme })
                });
            } catch (error) {
                console.error('Failed to update theme preference:', error);
            }
        }
        
        // Check user authentication state
        async function checkAuthState() {
            const token = localStorage.getItem('jwtToken');
            if (!token) {
                window.location.href = 'login.html';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/users/me`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!response.ok) {
                    localStorage.removeItem('jwtToken');
                    window.location.href = 'login.html';
                }
            } catch (error) {
                console.error('Auth check failed:', error);
                showNotification('Connection Error', 'Unable to verify your session. Please try again later.');
            }
        }
        
        // Load user data
        async function loadUserData() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/users/me`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const user = await response.json();
                    displayUserData(user);
                } else {
                    showNotification('Error', 'Failed to load user data');
                }
            } catch (error) {
                console.error('Failed to load user data:', error);
                showNotification('Error', 'Failed to load user data. Please try again later.');
            }
        }
        
        // Display user data
        function displayUserData(user) {
            document.getElementById('user-name').textContent = `${user.firstName} ${user.lastName}`;
            document.getElementById('user-email').textContent = user.email;
            document.getElementById('first-name').value = user.firstName || '';
            document.getElementById('last-name').value = user.lastName || '';
            document.getElementById('profile-email').value = user.email || '';
            document.getElementById('phone').value = user.phone || '';
            document.getElementById('city').value = user.city || '';
            
            if (user.avatar) {
                document.getElementById('user-avatar').src = user.avatar;
            }
            
            if (user.theme === 'dark') {
                document.body.classList.add('dark-mode');
                themeToggle.checked = true;
            }
            
            if (user.kycStatus) {
                const kycBadge = document.getElementById('account-status');
                kycBadge.textContent = `${user.kycStatus.charAt(0).toUpperCase() + user.kycStatus.slice(1)} Account`;
                kycBadge.className = `kyc-status ${user.kycStatus}`;
            }
        }
        
        // Check KYC status
        async function checkKYCStatus() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/kyc/status`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const kycBadge = document.getElementById('kyc-status-badge');
                    kycBadge.textContent = `${data.status.charAt(0).toUpperCase() + data.status.slice(1)} Verification`;
                    kycBadge.className = `kyc-status ${data.status}`;
                    
                    // Also update the account status badge
                    const accountBadge = document.getElementById('account-status');
                    accountBadge.textContent = `${data.status.charAt(0).toUpperCase() + data.status.slice(1)} Account`;
                    accountBadge.className = `kyc-status ${data.status}`;
                }
            } catch (error) {
                console.error('Failed to check KYC status:', error);
            }
        }
        
        // Check 2FA status
        async function check2FAStatus() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/auth/2fa/status`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    update2FAStatus(data);
                }
            } catch (error) {
                console.error('Failed to check 2FA status:', error);
            }
        }
        
        // Update 2FA status display
        function update2FAStatus(data) {
            const email2FA = document.getElementById('email-2fa');
            const authenticator2FA = document.getElementById('authenticator-2fa');
            
            if (data.email2FA) {
                email2FA.querySelector('.two-factor-method-status').textContent = 'Active';
                email2FA.querySelector('.two-factor-method-status').className = 'two-factor-method-status active';
                email2FA.querySelector('button').textContent = 'Disable';
                email2FA.querySelector('button').id = 'disable-email-2fa';
            }
            
            if (data.authenticator2FA) {
                authenticator2FA.querySelector('.two-factor-method-status').textContent = 'Active';
                authenticator2FA.querySelector('.two-factor-method-status').className = 'two-factor-method-status active';
                authenticator2FA.querySelector('button').textContent = 'Disable';
                authenticator2FA.querySelector('button').id = 'disable-authenticator-2fa';
                
                // Show backup codes if they exist
                if (data.backupCodes && data.backupCodes.length > 0) {
                    document.getElementById('backup-codes-container').style.display = 'block';
                    document.getElementById('backup-codes-display').innerHTML = data.backupCodes.map(code => 
                        `<div>${code}</div>`
                    ).join('');
                }
            }
        }
        
        // Load notification preferences
        async function loadNotificationPreferences() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/users/notifications`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const preferences = await response.json();
                    updateNotificationPreferences(preferences);
                }
            } catch (error) {
                console.error('Failed to load notification preferences:', error);
            }
        }
        
        // Update notification preferences display
        function updateNotificationPreferences(preferences) {
            document.getElementById('email-account-alerts').checked = preferences.email.accountAlerts;
            document.getElementById('email-investment-updates').checked = preferences.email.investmentUpdates;
            document.getElementById('email-withdrawal-confirmations').checked = preferences.email.withdrawalConfirmations;
            document.getElementById('email-promotional-offers').checked = preferences.email.promotionalOffers;
            
            document.getElementById('sms-security-alerts').checked = preferences.sms.securityAlerts;
            document.getElementById('sms-withdrawal-confirmations').checked = preferences.sms.withdrawalConfirmations;
        }
        
        // Load security activity log
        async function loadSecurityLog() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/users/activity`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const activities = await response.json();
                    displaySecurityLog(activities);
                }
            } catch (error) {
                console.error('Failed to load security log:', error);
            }
        }
        
        // Display security log
        function displaySecurityLog(activities) {
            const logContainer = document.getElementById('security-log');
            logContainer.innerHTML = '';
            
            if (activities.length === 0) {
                logContainer.innerHTML = '<li class="security-log-item">No activity found</li>';
                return;
            }
            
            activities.forEach(activity => {
                const logItem = document.createElement('li');
                logItem.className = 'security-log-item';
                
                let iconClass = 'fas fa-question-circle';
                if (activity.type === 'login') iconClass = 'fas fa-sign-in-alt';
                else if (activity.type === 'password_change') iconClass = 'fas fa-key';
                else if (activity.type === '2fa') iconClass = 'fas fa-lock';
                
                const timeAgo = formatTimeAgo(activity.timestamp);
                
                logItem.innerHTML = `
                    <div class="security-log-icon">
                        <i class="${iconClass}"></i>
                    </div>
                    <div class="security-log-content">
                        <div class="security-log-title">${activity.description}</div>
                        <div class="security-log-meta">
                            <span>${timeAgo}</span>
                            <span>IP: ${activity.ipAddress}</span>
                            <span>${activity.device || 'Unknown device'}</span>
                        </div>
                    </div>
                    <div class="security-log-action">Report</div>
                `;
                
                logContainer.appendChild(logItem);
            });
        }
        
        // Format time ago
        function formatTimeAgo(timestamp) {
            const now = new Date();
            const date = new Date(timestamp);
            const seconds = Math.floor((now - date) / 1000);
            
            if (seconds < 60) return 'Just now';
            
            const minutes = Math.floor(seconds / 60);
            if (minutes < 60) return `${minutes} minute${minutes === 1 ? '' : 's'} ago`;
            
            const hours = Math.floor(minutes / 60);
            if (hours < 24) return `${hours} hour${hours === 1 ? '' : 's'} ago`;
            
            const days = Math.floor(hours / 24);
            if (days < 7) return `${days} day${days === 1 ? '' : 's'} ago`;
            
            return date.toLocaleDateString();
        }
        
        // Load referral data
        async function loadReferralData() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            try {
                const [statsResponse, historyResponse] = await Promise.all([
                    fetch(`${API_BASE_URL}/api/referrals/stats`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    }),
                    fetch(`${API_BASE_URL}/api/referrals/history`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    })
                ]);
                
                if (statsResponse.ok && historyResponse.ok) {
                    const stats = await statsResponse.json();
                    const history = await historyResponse.json();
                    
                    displayReferralStats(stats);
                    displayReferralHistory(history);
                }
            } catch (error) {
                console.error('Failed to load referral data:', error);
            }
        }
        
        // Display referral stats
        function displayReferralStats(stats) {
            document.getElementById('total-referrals').textContent = stats.totalReferrals;
            document.getElementById('active-referrals').textContent = stats.activeReferrals;
            document.getElementById('referral-earnings').textContent = `${stats.totalEarnings} BTC`;
            document.getElementById('referral-link').value = `${window.location.origin}/signup.html?ref=${stats.referralCode}`;
        }
        
        // Display referral history
        function displayReferralHistory(history) {
            const historyContainer = document.getElementById('referral-history');
            historyContainer.innerHTML = '';
            
            if (history.length === 0) {
                historyContainer.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center;">No referral history found</td>
                    </tr>
                `;
                return;
            }
            
            history.forEach(referral => {
                const row = document.createElement('tr');
                
                const date = new Date(referral.date).toLocaleDateString();
                let statusClass = '';
                if (referral.status === 'active') statusClass = 'text-success';
                else if (referral.status === 'pending') statusClass = 'text-warning';
                
                row.innerHTML = `
                    <td>${date}</td>
                    <td>${referral.email}</td>
                    <td class="${statusClass}">${referral.status.charAt(0).toUpperCase() + referral.status.slice(1)}</td>
                    <td>${referral.earnings || '0'} BTC</td>
                `;
                
                historyContainer.appendChild(row);
            });
        }
        
        // Show notification
        function showNotification(title, message, isSuccess = false) {
            const notification = document.getElementById('notification');
            const notificationTitle = document.getElementById('notification-title');
            const notificationMessage = document.getElementById('notification-message');
            const notificationIcon = notification.querySelector('.notification-icon i');
            
            notificationTitle.textContent = title;
            notificationMessage.textContent = message;
            
            if (isSuccess) {
                notification.classList.add('success');
                notificationIcon.className = 'fas fa-check';
            } else {
                notification.classList.remove('success');
                notificationIcon.className = 'fas fa-exclamation';
            }
            
            notification.classList.add('show');
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                notification.classList.remove('show');
            }, 5000);
        }
        
        // Close notification
        document.getElementById('notification-close').addEventListener('click', function() {
            document.getElementById('notification').classList.remove('show');
        });
        
        // Toggle password visibility
        document.querySelectorAll('.password-toggle').forEach(toggle => {
            toggle.addEventListener('click', function() {
                const targetId = this.getAttribute('data-target');
                const passwordInput = document.getElementById(targetId);
                const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordInput.setAttribute('type', type);
                this.classList.toggle('fa-eye');
                this.classList.toggle('fa-eye-slash');
            });
        });
        
        // Settings navigation
        document.querySelectorAll('.settings-menu a, .settings-tab').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Update active state in menu
                document.querySelectorAll('.settings-menu a').forEach(link => {
                    link.classList.remove('active');
                });
                
                document.querySelectorAll('.settings-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                this.classList.add('active');
                
                // If this is a tab, also activate the corresponding menu item
                if (this.classList.contains('settings-tab')) {
                    const panel = this.getAttribute('data-panel');
                    document.querySelector(`.settings-menu a[data-panel="${panel}"]`).classList.add('active');
                }
                
                // Show corresponding panel
                const panelId = this.getAttribute('data-panel');
                document.querySelectorAll('.settings-panel').forEach(panel => {
                    panel.classList.remove('active');
                });
                
                document.getElementById(`${panelId}-panel`).classList.add('active');
                
                // Scroll to top of panel
                document.getElementById(`${panelId}-panel`).scrollIntoView({ behavior: 'smooth', block: 'start' });
            });
        });
        
        // Profile form submission
        document.getElementById('profile-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            const submitBtn = document.getElementById('profile-submit');
            const submitText = document.getElementById('profile-submit-text');
            const submitSpinner = document.getElementById('profile-submit-spinner');
            
            submitText.style.display = 'none';
            submitSpinner.style.display = 'inline-block';
            submitBtn.disabled = true;
            
            const formData = {
                firstName: document.getElementById('first-name').value.trim(),
                lastName: document.getElementById('last-name').value.trim(),
                email: document.getElementById('profile-email').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                city: document.getElementById('city').value.trim()
            };
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/users/profile`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    const user = await response.json();
                    displayUserData(user);
                    showNotification('Profile Updated', 'Your profile information has been updated successfully.', true);
                } else {
                    const error = await response.json();
                    showNotification('Error', error.message || 'Failed to update profile');
                }
            } catch (error) {
                console.error('Failed to update profile:', error);
                showNotification('Error', 'Failed to update profile. Please try again later.');
            } finally {
                submitText.style.display = 'inline';
                submitSpinner.style.display = 'none';
                submitBtn.disabled = false;
            }
        });
        
        // Password form submission
        document.getElementById('password-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            // Frontend validation
            if (newPassword !== confirmPassword) {
                document.getElementById('confirm-password-error').textContent = 'Passwords do not match';
                document.getElementById('confirm-password').classList.add('error');
                return;
            }
            
            if (newPassword.length < 8) {
                document.getElementById('new-password-error').textContent = 'Password must be at least 8 characters';
                document.getElementById('new-password').classList.add('error');
                return;
            }
            
            const submitBtn = document.getElementById('password-submit');
            const submitText = document.getElementById('password-submit-text');
            const submitSpinner = document.getElementById('password-submit-spinner');
            
            submitText.style.display = 'none';
            submitSpinner.style.display = 'inline-block';
            submitBtn.disabled = true;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/users/password`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        currentPassword,
                        newPassword
                    })
                });
                
                if (response.ok) {
                    showNotification('Password Updated', 'Your password has been updated successfully.', true);
                    document.getElementById('password-form').reset();
                } else {
                    const error = await response.json();
                    
                    if (error.field) {
                        document.getElementById(`${error.field}-error`).textContent = error.message;
                        document.getElementById(error.field).classList.add('error');
                    } else {
                        showNotification('Error', error.message || 'Failed to update password');
                    }
                }
            } catch (error) {
                console.error('Failed to update password:', error);
                showNotification('Error', 'Failed to update password. Please try again later.');
            } finally {
                submitText.style.display = 'inline';
                submitSpinner.style.display = 'none';
                submitBtn.disabled = false;
            }
        });
        
        // KYC form submission
        document.getElementById('kyc-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            const documentType = document.getElementById('document-type').value;
            const fileInput = document.getElementById('document-file');
            
            if (!documentType || !fileInput.files || fileInput.files.length === 0) {
                showNotification('Error', 'Please select a document type and upload a file');
                return;
            }
            
            const submitBtn = document.getElementById('kyc-submit');
            const submitText = document.getElementById('kyc-submit-text');
            const submitSpinner = document.getElementById('kyc-submit-spinner');
            
            submitText.style.display = 'none';
            submitSpinner.style.display = 'inline-block';
            submitBtn.disabled = true;
            
            const formData = new FormData();
            formData.append('documentType', documentType);
            formData.append('document', fileInput.files[0]);
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/kyc/submit`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });
                
                if (response.ok) {
                    showNotification('KYC Submitted', 'Your documents have been submitted for verification. This process may take up to 48 hours.', true);
                    checkKYCStatus();
                } else {
                    const error = await response.json();
                    showNotification('Error', error.message || 'Failed to submit KYC documents');
                }
            } catch (error) {
                console.error('Failed to submit KYC:', error);
                showNotification('Error', 'Failed to submit KYC documents. Please try again later.');
            } finally {
                submitText.style.display = 'inline';
                submitSpinner.style.display = 'none';
                submitBtn.disabled = false;
            }
        });
        
        // Document upload handling
        document.getElementById('browse-btn').addEventListener('click', function() {
            document.getElementById('document-file').click();
        });
        
        document.getElementById('document-upload-area').addEventListener('dragover', function(e) {
            e.preventDefault();
            this.classList.add('dragover');
        });
        
        document.getElementById('document-upload-area').addEventListener('dragleave', function(e) {
            e.preventDefault();
            this.classList.remove('dragover');
        });
        
        document.getElementById('document-upload-area').addEventListener('drop', function(e) {
            e.preventDefault();
            this.classList.remove('dragover');
            
            if (e.dataTransfer.files.length > 0) {
                handleDocumentUpload(e.dataTransfer.files[0]);
            }
        });
        
        document.getElementById('document-file').addEventListener('change', function() {
            if (this.files.length > 0) {
                handleDocumentUpload(this.files[0]);
            }
        });
        
        function handleDocumentUpload(file) {
            const validTypes = ['image/jpeg', 'image/png', 'image/jpg', 'application/pdf'];
            const maxSize = 5 * 1024 * 1024; // 5MB
            
            if (!validTypes.includes(file.type)) {
                showNotification('Error', 'Invalid file type. Please upload a JPEG, PNG, or PDF file.');
                return;
            }
            
            if (file.size > maxSize) {
                showNotification('Error', 'File is too large. Maximum size is 5MB.');
                return;
            }
            
            document.getElementById('kyc-submit').disabled = false;
            
            // Show preview for images
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('document-preview-img').src = e.target.result;
                    document.getElementById('document-preview').style.display = 'block';
                };
                reader.readAsDataURL(file);
            } else {
                document.getElementById('document-preview').style.display = 'none';
            }
        }
        
        // 2FA Toggle - Email
        document.getElementById('toggle-email-2fa').addEventListener('click', async function() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            const isEnabling = this.textContent === 'Enable';
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/auth/2fa/email`, {
                    method: isEnabling ? 'POST' : 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    showNotification('Success', data.message, true);
                    
                    if (isEnabling) {
                        this.textContent = 'Disable';
                        this.id = 'disable-email-2fa';
                        document.querySelector('#email-2fa .two-factor-method-status').textContent = 'Active';
                        document.querySelector('#email-2fa .two-factor-method-status').className = 'two-factor-method-status active';
                    } else {
                        this.textContent = 'Enable';
                        this.id = 'toggle-email-2fa';
                        document.querySelector('#email-2fa .two-factor-method-status').textContent = 'Inactive';
                        document.querySelector('#email-2fa .two-factor-method-status').className = 'two-factor-method-status';
                    }
                } else {
                    const error = await response.json();
                    showNotification('Error', error.message);
                }
            } catch (error) {
                console.error('Failed to toggle email 2FA:', error);
                showNotification('Error', 'Failed to update 2FA settings. Please try again later.');
            }
        });
        
        // 2FA Toggle - Authenticator
        document.getElementById('toggle-authenticator-2fa').addEventListener('click', async function() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            const isEnabling = this.textContent === 'Enable';
            
            if (isEnabling) {
                // Show setup for enabling
                try {
                    const response = await fetch(`${API_BASE_URL}/api/auth/2fa/authenticator/setup`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        
                        // Generate QR code
                        document.getElementById('qr-code').innerHTML = '';
                        new QRCode(document.getElementById('qr-code'), {
                            text: data.otpauthUrl,
                            width: 180,
                            height: 180
                        });
                        
                        document.getElementById('authenticator-secret').textContent = data.secret;
                        document.getElementById('authenticator-setup').classList.add('active');
                    } else {
                        const error = await response.json();
                        showNotification('Error', error.message);
                    }
                } catch (error) {
                    console.error('Failed to setup authenticator:', error);
                    showNotification('Error', 'Failed to setup authenticator. Please try again later.');
                }
            } else {
                // Disable authenticator
                try {
                    const response = await fetch(`${API_BASE_URL}/api/auth/2fa/authenticator`, {
                        method: 'DELETE',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        showNotification('Success', data.message, true);
                        
                        this.textContent = 'Enable';
                        this.id = 'toggle-authenticator-2fa';
                        document.querySelector('#authenticator-2fa .two-factor-method-status').textContent = 'Inactive';
                        document.querySelector('#authenticator-2fa .two-factor-method-status').className = 'two-factor-method-status';
                        document.getElementById('authenticator-setup').classList.remove('active');
                        document.getElementById('backup-codes-container').style.display = 'none';
                    } else {
                        const error = await response.json();
                        showNotification('Error', error.message);
                    }
                } catch (error) {
                    console.error('Failed to disable authenticator:', error);
                    showNotification('Error', 'Failed to disable authenticator. Please try again later.');
                }
            }
        });
        
        // Verify Authenticator Code
        document.getElementById('verify-authenticator').addEventListener('click', async function() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            const code = document.getElementById('verification-code').value.trim();
            
            if (!code || code.length !== 6) {
                document.getElementById('verification-code-error').textContent = 'Please enter a valid 6-digit code';
                return;
            }
            
            this.disabled = true;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/auth/2fa/authenticator/verify`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({ code })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    showNotification('Success', 'Authenticator 2FA has been activated successfully!', true);
                    
                    document.getElementById('toggle-authenticator-2fa').textContent = 'Disable';
                    document.getElementById('toggle-authenticator-2fa').id = 'disable-authenticator-2fa';
                    document.querySelector('#authenticator-2fa .two-factor-method-status').textContent = 'Active';
                    document.querySelector('#authenticator-2fa .two-factor-method-status').className = 'two-factor-method-status active';
                    
                    // Show backup codes
                    document.getElementById('backup-codes-container').style.display = 'block';
                    document.getElementById('backup-codes-display').innerHTML = data.backupCodes.map(code => 
                        `<div>${code}</div>`
                    ).join('');
                } else {
                    const error = await response.json();
                    document.getElementById('verification-code-error').textContent = error.message || 'Invalid verification code';
                }
            } catch (error) {
                console.error('Failed to verify authenticator:', error);
                showNotification('Error', 'Failed to verify authenticator code. Please try again later.');
            } finally {
                this.disabled = false;
            }
        });
        
        // Generate new backup codes
        document.getElementById('generate-new-codes').addEventListener('click', async function() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            if (!confirm('Generating new backup codes will invalidate all previous codes. Are you sure?')) {
                return;
            }
            
            this.disabled = true;
            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/auth/2fa/backup-codes`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    showNotification('Success', 'New backup codes generated successfully!', true);
                    document.getElementById('backup-codes-display').innerHTML = data.backupCodes.map(code => 
                        `<div>${code}</div>`
                    ).join('');
                } else {
                    const error = await response.json();
                    showNotification('Error', error.message || 'Failed to generate new backup codes');
                }
            } catch (error) {
                console.error('Failed to generate backup codes:', error);
                showNotification('Error', 'Failed to generate backup codes. Please try again later.');
            } finally {
                this.disabled = false;
                this.textContent = 'Generate New Codes';
            }
        });
        
        // Copy referral link
        document.getElementById('copy-referral-link').addEventListener('click', function() {
            const referralLink = document.getElementById('referral-link');
            referralLink.select();
            document.execCommand('copy');
            
            showNotification('Copied', 'Your referral link has been copied to clipboard!', true);
        });
        
        // Share referral link
        document.getElementById('share-twitter').addEventListener('click', function(e) {
            e.preventDefault();
            const link = encodeURIComponent(document.getElementById('referral-link').value);
            window.open(`https://twitter.com/intent/tweet?text=Join%20me%20on%20Bithash,%20the%20premier%20Bitcoin%20mining%20platform!%20Sign%20up%20with%20my%20referral%20link:%20${link}`, '_blank');
        });
        
        document.getElementById('share-facebook').addEventListener('click', function(e) {
            e.preventDefault();
            const link = encodeURIComponent(document.getElementById('referral-link').value);
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${link}`, '_blank');
        });
        
        document.getElementById('share-linkedin').addEventListener('click', function(e) {
            e.preventDefault();
            const link = encodeURIComponent(document.getElementById('referral-link').value);
            window.open(`https://www.linkedin.com/shareArticle?mini=true&url=${link}&title=Bithash%20Referral&summary=Join%20me%20on%20Bithash,%20the%20premier%20Bitcoin%20mining%20platform!`, '_blank');
        });
        
        document.getElementById('share-whatsapp').addEventListener('click', function(e) {
            e.preventDefault();
            const link = encodeURIComponent(document.getElementById('referral-link').value);
            window.open(`https://wa.me/?text=Join%20me%20on%20Bithash,%20the%20premier%20Bitcoin%20mining%20platform!%20Sign%20up%20with%20my%20referral%20link:%20${link}`, '_blank');
        });
        
        // Notifications form submission
        document.getElementById('notifications-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            const submitBtn = document.getElementById('notifications-submit');
            const submitText = document.getElementById('notifications-submit-text');
            const submitSpinner = document.getElementById('notifications-submit-spinner');
            
            submitText.style.display = 'none';
            submitSpinner.style.display = 'inline-block';
            submitBtn.disabled = true;
            
            const preferences = {
                email: {
                    accountAlerts: document.getElementById('email-account-alerts').checked,
                    investmentUpdates: document.getElementById('email-investment-updates').checked,
                    withdrawalConfirmations: document.getElementById('email-withdrawal-confirmations').checked,
                    promotionalOffers: document.getElementById('email-promotional-offers').checked
                },
                sms: {
                    securityAlerts: document.getElementById('sms-security-alerts').checked,
                    withdrawalConfirmations: document.getElementById('sms-withdrawal-confirmations').checked
                }
            };
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/users/notifications`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify(preferences)
                });
                
                if (response.ok) {
                    showNotification('Preferences Saved', 'Your notification preferences have been updated successfully.', true);
                } else {
                    const error = await response.json();
                    showNotification('Error', error.message || 'Failed to update notification preferences');
                }
            } catch (error) {
                console.error('Failed to update notification preferences:', error);
                showNotification('Error', 'Failed to update notification preferences. Please try again later.');
            } finally {
                submitText.style.display = 'inline';
                submitSpinner.style.display = 'none';
                submitBtn.disabled = false;
            }
        });
        
        // Load more activity
        document.getElementById('load-more-activity').addEventListener('click', function() {
            // In a real implementation, this would load more records from the server
            showNotification('Info', 'Loading more activity...');
        });
        
        // Deactivation reason toggle
        document.getElementById('deactivation-reason').addEventListener('change', function() {
            const otherReasonContainer = document.getElementById('other-reason-container');
            otherReasonContainer.style.display = this.value === 'other' ? 'block' : 'none';
        });
        
        // Request deactivation
        document.getElementById('request-deactivation').addEventListener('click', function() {
            const password = document.getElementById('deactivation-password').value;
            
            if (!password) {
                showNotification('Error', 'Please enter your password to confirm deactivation');
                return;
            }
            
            document.getElementById('deactivation-modal').classList.add('active');
        });
        
        // Close deactivation modal
        document.getElementById('close-deactivation-modal').addEventListener('click', function() {
            document.getElementById('deactivation-modal').classList.remove('active');
        });
        
        document.getElementById('cancel-deactivation').addEventListener('click', function() {
            document.getElementById('deactivation-modal').classList.remove('active');
        });
        
        // Confirm deactivation
        document.getElementById('confirm-deactivation').addEventListener('click', async function() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            const password = document.getElementById('deactivation-password').value;
            const reason = document.getElementById('deactivation-reason').value;
            const otherReason = document.getElementById('other-reason').value;
            
            this.disabled = true;
            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/users/deactivate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        password,
                        reason: reason === 'other' ? otherReason : reason
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    showNotification('Account Deactivated', data.message, true);
                    
                    setTimeout(() => {
                        localStorage.removeItem('jwtToken');
                        window.location.href = 'index.html';
                    }, 2000);
                } else {
                    const error = await response.json();
                    showNotification('Error', error.message || 'Failed to deactivate account');
                    document.getElementById('deactivation-modal').classList.remove('active');
                }
            } catch (error) {
                console.error('Failed to deactivate account:', error);
                showNotification('Error', 'Failed to deactivate account. Please try again later.');
                document.getElementById('deactivation-modal').classList.remove('active');
            } finally {
                this.disabled = false;
                this.textContent = 'Confirm Deactivation';
            }
        });
        
        // Avatar upload
        document.getElementById('avatar-upload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const validTypes = ['image/jpeg', 'image/png', 'image/jpg'];
            const maxSize = 2 * 1024 * 1024; // 2MB
            
            if (!validTypes.includes(file.type)) {
                showNotification('Error', 'Invalid file type. Please upload a JPEG or PNG image.');
                return;
            }
            
            if (file.size > maxSize) {
                showNotification('Error', 'Image is too large. Maximum size is 2MB.');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('user-avatar').src = e.target.result;
                uploadAvatar(file);
            };
            reader.readAsDataURL(file);
        });
        
        // Upload avatar to server
        async function uploadAvatar(file) {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            const formData = new FormData();
            formData.append('avatar', file);
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/users/avatar`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });
                
                if (response.ok) {
                    const data = await response.json();
                    showNotification('Avatar Updated', 'Your profile picture has been updated successfully.', true);
                    document.getElementById('user-avatar').src = data.avatarUrl;
                } else {
                    const error = await response.json();
                    showNotification('Error', error.message || 'Failed to update avatar');
                }
            } catch (error) {
                console.error('Failed to upload avatar:', error);
                showNotification('Error', 'Failed to update avatar. Please try again later.');
            }
        }
        
        // Password strength meter
        document.getElementById('new-password').addEventListener('input', function() {
            const password = this.value;
            const strengthBar = document.querySelector('.strength-bar');
            const strengthFeedback = document.querySelector('.strength-feedback');
            
            if (!password) {
                strengthBar.style.width = '0%';
                strengthBar.style.backgroundColor = 'transparent';
                strengthFeedback.textContent = '';
                return;
            }
            
            // Simple strength calculation
            let strength = 0;
            
            // Length
            if (password.length >= 8) strength += 1;
            if (password.length >= 12) strength += 1;
            
            // Complexity
            if (/[A-Z]/.test(password)) strength += 1;
            if (/[0-9]/.test(password)) strength += 1;
            if (/[^A-Za-z0-9]/.test(password)) strength += 1;
            
            // Update UI
            let width = 0;
            let color = '';
            let feedback = '';
            
            if (strength <= 2) {
                width = 33;
                color = 'var(--error)';
                feedback = 'Weak';
            } else if (strength <= 4) {
                width = 66;
                color = 'var(--warning)';
                feedback = 'Moderate';
            } else {
                width = 100;
                color = 'var(--success)';
                feedback = 'Strong';
            }
            
            strengthBar.style.width = `${width}%`;
            strengthBar.style.backgroundColor = color;
            strengthFeedback.textContent = feedback;
            strengthFeedback.style.color = color;
        });
        
        // Initialize theme
        checkTheme();
        
        // Check auth state on page load
        checkAuthState();
    </script>
</body>
</html>
