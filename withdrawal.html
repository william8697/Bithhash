<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BitHash | Secure Withdrawal</title>
    <meta name="description" content="Securely withdraw funds from your BitHash account to your wallet or bank account.">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    
    <style>
        :root {
            --primary: #00D395;
            --primary-dark: #00B783;
            --primary-light: #00E5A1;
            --secondary: #1E1E1E;
            --secondary-dark: #121212;
            --dark: #E5E5E5;
            --darker: #0A0A0A;
            --light: #121212;
            --lighter: #1E1E1E;
            --gray: #8E8E8E;
            --gray-light: #2E2E2E;
            --gray-lighter: #252525;
            --success: #00D395;
            --warning: #FFB800;
            --error: #FF3D57;
            --gold: #D4AF37;
            --gold-light: #FFD700;
            --gold-dark: #996515;
            --blue: #003366;
            --blue-dark: #002244;
            --blue-light: #004488;
            --border-radius: 4px;
            --border-radius-lg: 8px;
            --box-shadow: 0 2px 4px -1px rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.06);
            --box-shadow-lg: 0 8px 20px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            color: var(--dark);
            background-color: var(--light);
            line-height: 1.5;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--darker);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        .loading-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }
        
        .loading-logo {
            width: 80px;
            height: 80px;
            animation: pulse 1.5s infinite ease-in-out;
            filter: drop-shadow(0 0 10px rgba(240, 185, 11, 0.3));
        }
        
        .loading-text {
            margin-top: 20px;
            font-weight: 500;
            color: var(--gray);
            font-size: 0.95rem;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.8; }
        }
        
        /* Header */
        header {
            background-color: var(--darker);
            box-shadow: var(--box-shadow);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            padding: 0;
            transition: var(--transition-slow);
            border-bottom: 1px solid var(--gray-light);
            height: 64px;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px;
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            height: 100%;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            z-index: 1001;
        }
        
        .logo img {
            height: 30px;
            width: auto;
            transition: var(--transition);
        }
        
        .logo:hover img {
            transform: scale(1.05);
        }
        
        .logo-text {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--primary);
            background-clip: text;
            position: relative;
        }
        
        /* Bitcoin Logo Animation */
        @keyframes bitcoinFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-5px) rotate(5deg); }
            50% { transform: translateY(0) rotate(0deg); }
            75% { transform: translateY(-3px) rotate(-5deg); }
        }

        .bitcoin-animation {
            display: inline-block;
            animation: bitcoinFloat 4s ease-in-out infinite;
            margin-right: 3px;
            vertical-align: middle;
            color: var(--gold);
            font-weight: bold;
        }

        /* Security Badge */
        .security-badge {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--darker);
            padding: 10px 14px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-lg);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 100;
            border-left: 3px solid var(--success);
            color: var(--dark);
            border: 1px solid var(--gray-light);
        }
        
        .security-badge i {
            color: var(--success);
            font-size: 0.9rem;
        }
        
        /* Notification System */
        .notification-center {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            pointer-events: none;
            width: 100%;
            max-width: 350px;
        }
        
        .notification {
            width: 100%;
            padding: 12px 16px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-lg);
            display: flex;
            align-items: flex-start;
            gap: 10px;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            transform: translateX(30px) scale(0.95);
            opacity: 0;
            margin-bottom: 10px;
            font-size: 0.85rem;
            font-weight: 500;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            pointer-events: auto;
            position: relative;
        }
        
        .notification.show {
            transform: translateX(0) scale(1);
            opacity: 1;
        }
        
        .notification.error {
            background-color: var(--error);
            color: white;
        }
        
        .notification.success {
            background-color: var(--success);
            color: white;
        }
        
        .notification.info {
            background-color: var(--blue);
            color: white;
        }
        
        .notification.warning {
            background-color: var(--warning);
            color: var(--darker);
        }
        
        .notification-content {
            flex: 1;
            padding-right: 10px;
        }
        
        .notification-title {
            font-weight: 600;
            margin-bottom: 4px;
            font-size: 0.9rem;
        }
        
        .notification-message {
            font-size: 0.8rem;
            line-height: 1.4;
        }
        
        .notification-close {
            position: absolute;
            top: 6px;
            right: 6px;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.7rem;
        }
        
        .notification-close:hover {
            background-color: rgba(0, 0, 0, 0.2);
            transform: rotate(90deg);
        }
        
        /* Professional Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-slow);
            backdrop-filter: blur(5px);
            padding: 15px;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-container {
            background-color: var(--lighter);
            border-radius: var(--border-radius-lg);
            width: 100%;
            max-width: 420px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: var(--transition-slow);
            box-shadow: var(--box-shadow-lg);
            border: 1px solid var(--gray-light);
            position: relative;
        }
        
        .modal-overlay.active .modal-container {
            transform: translateY(0);
        }
        
        .modal-header {
            padding: 12px 16px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--lighter);
            border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
        }
        
        .modal-title {
            font-size: 0.95rem;
            color: var(--dark);
            font-weight: 600;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .modal-close:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--dark);
        }
        
        .modal-body {
            padding: 12px 16px;
            font-size: 0.85rem;
        }
        
        .modal-footer {
            padding: 10px 16px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: flex-end;
            gap: 8px;
            background-color: var(--secondary-dark);
            border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
        }
        
        .btn {
            padding: 10px 16px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            white-space: nowrap;
        }
        
        .btn-primary {
            background: var(--primary);
            color: var(--darker);
            box-shadow: 0 2px 10px rgba(0, 211, 149, 0.2);
        }
        
        .btn-primary:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 211, 149, 0.3);
        }
        
        .btn-outline {
            background-color: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
        }
        
        .btn-outline:hover {
            background: var(--primary);
            color: var(--darker);
            transform: translateY(-2px);
        }
        
        .btn-gold {
            background: var(--gold);
            color: var(--darker);
            box-shadow: 0 2px 10px rgba(212, 175, 55, 0.2);
        }
        
        .btn-gold:hover {
            background: var(--gold-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }
        
        /* Withdrawal Section */
        .withdraw-section {
            padding: 100px 0 30px;
            background-color: var(--light);
        }
        
        .withdraw-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .withdraw-title h1 {
            font-size: 1.6rem;
            color: var(--dark);
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .withdraw-title p {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .withdraw-actions {
            display: flex;
            gap: 10px;
        }
        
        .withdraw-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .withdraw-card {
            grid-column: span 6;
            background-color: var(--lighter);
            border-radius: var(--border-radius-lg);
            padding: 16px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            border: 1px solid var(--gray-light);
        }
        
        .withdraw-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .withdraw-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .withdraw-title {
            font-size: 1rem;
            color: var(--dark);
            font-weight: 600;
        }
        
        .withdraw-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }
        
        .withdraw-icon.btc {
            background-color: rgba(240, 185, 11, 0.1);
            color: var(--gold);
        }
        
        .withdraw-icon.bank {
            background-color: rgba(39, 117, 202, 0.1);
            color: var(--blue);
        }
        
        /* Withdrawal method selector */
        .withdrawal-methods {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            border-bottom: 1px solid var(--gray-light);
            padding-bottom: 12px;
        }
        
        .withdrawal-method {
            flex: 1;
            text-align: center;
            padding: 10px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid transparent;
            background-color: var(--gray-light);
        }
        
        .withdrawal-method.active {
            border-color: var(--primary);
            background-color: rgba(0, 211, 149, 0.1);
        }
        
        .withdrawal-method i {
            font-size: 1.3rem;
            margin-bottom: 6px;
        }
        
        .withdrawal-method .method-name {
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        /* BTC Withdrawal Form */
        .btc-withdraw-form {
            display: none;
        }
        
        .btc-withdraw-form.active {
            display: block;
        }
        
        /* Bank Withdrawal Form */
        .bank-withdraw-form {
            display: none;
        }
        
        .bank-withdraw-form.active {
            display: block;
        }
        
        /* Form styles */
        .form-group {
            margin-bottom: 12px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 6px;
            font-size: 0.85rem;
            color: var(--gray);
        }
        
        .form-control {
            width: 100%;
            padding: 10px 12px;
            background-color: var(--light);
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            color: var(--dark);
            font-size: 0.9rem;
            transition: var(--transition);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 211, 149, 0.2);
        }
        
        .form-row {
            display: flex;
            gap: 12px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        /* Disclaimer */
        .disclaimer {
            background-color: rgba(255, 184, 0, 0.1);
            border-left: 3px solid var(--warning);
            padding: 10px 12px;
            margin: 16px 0;
            border-radius: var(--border-radius);
            font-size: 0.85rem;
        }
        
        .disclaimer-title {
            font-weight: 600;
            color: var(--warning);
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        /* Account Balance Summary */
        .balance-summary {
            display: flex;
            justify-content: space-between;
            background-color: var(--lighter);
            border-radius: var(--border-radius);
            padding: 12px;
            margin-bottom: 16px;
            border: 1px solid var(--gray-light);
        }
        
        .balance-item {
            text-align: center;
            flex: 1;
        }
        
        .balance-label {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 5px;
        }
        
        .balance-amount {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
        }
        
        .balance-amount.available {
            color: var(--success);
        }
        
        .balance-amount.pending {
            color: var(--warning);
        }
        
        /* Verification Status */
        .verification-status {
            background-color: rgba(39, 117, 202, 0.1);
            border-left: 3px solid var(--blue);
            padding: 10px 12px;
            margin: 16px 0;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .verification-status i {
            color: var(--blue);
            font-size: 1.1rem;
        }
        
        .verification-text {
            flex: 1;
        }
        
        .verification-title {
            font-weight: 600;
            color: var(--blue);
            margin-bottom: 3px;
            font-size: 0.9rem;
        }
        
        .verification-message {
            font-size: 0.85rem;
            color: var(--gray);
        }
        
        /* Countdown Timer */
        .countdown-timer {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 16px 0;
        }
        
        .countdown-unit {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: var(--secondary-dark);
            padding: 8px;
            border-radius: var(--border-radius);
            min-width: 50px;
        }
        
        .countdown-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .countdown-label {
            font-size: 0.7rem;
            color: var(--gray);
            text-transform: uppercase;
        }
        
        /* Payment Address */
        .payment-address {
            background: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 12px;
            margin: 12px 0;
            word-break: break-all;
            font-family: monospace;
            font-size: 0.85rem;
            border: 1px solid var(--gray-light);
            text-align: center;
        }
        
        /* Professional QR Code Container */
        .qr-container {
            display: flex;
            justify-content: center;
            margin: 12px 0;
        }
        
        .qr-code {
            width: 200px;
            height: 200px;
            background: white;
            padding: 12px;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Footer */
        footer {
            background-color: var(--darker);
            color: white;
            padding: 40px 0 20px;
        }
        
        .footer-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 24px;
            margin-bottom: 24px;
        }
        
        .footer-logo {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .footer-logo img {
            height: 24px;
            width: auto;
        }
        
        .footer-logo-text {
            font-weight: 700;
            font-size: 1rem;
            color: var(--primary);
        }
        
        .footer-about p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
            margin-bottom: 12px;
            line-height: 1.6;
        }
        
        .footer-social {
            display: flex;
            gap: 8px;
        }
        
        .social-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: white;
        }
        
        .social-icon.twitter {
            background-color: #1DA1F2;
        }
        
        .social-icon.linkedin {
            background-color: #0077B5;
        }
        
        .social-icon.facebook {
            background-color: #1877F2;
        }
        
        .social-icon.instagram {
            background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D, #F56040, #F77737, #FCAF45, #FFDC80);
        }
        
        .social-icon:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .footer-title {
            font-weight: 700;
            margin-bottom: 12px;
            font-size: 0.95rem;
            color: white;
        }
        
        .footer-links ul {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 8px;
        }
        
        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: var(--transition);
            font-size: 0.85rem;
            display: inline-block;
        }
        
        .footer-links a:hover {
            color: var(--primary);
            transform: translateX(3px);
        }
        
        .footer-contact p {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 10px;
            font-size: 0.85rem;
            line-height: 1.5;
        }
        
        .footer-contact i {
            color: var(--primary);
            width: 16px;
            text-align: center;
            margin-top: 2px;
        }
        
        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 12px;
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.75rem;
        }
        
        /* Responsive Styles */
        @media (max-width: 992px) {
            .withdraw-card {
                grid-column: span 12;
            }
            
            .footer-container {
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
            }
        }
        
        @media (max-width: 768px) {
            .withdraw-actions {
                flex-direction: column;
                width: 100%;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .footer-container {
                grid-template-columns: 1fr;
            }
            
            .balance-summary {
                flex-direction: column;
                gap: 12px;
            }
        }
        
        @media (max-width: 576px) {
            .withdraw-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .withdraw-title h1 {
                font-size: 1.4rem;
            }
            
            .withdraw-actions {
                width: 100%;
            }
            
            .withdraw-actions .btn {
                width: 100%;
            }
            
            .withdrawal-methods {
                flex-direction: column;
            }
            
            .footer-container {
                gap: 16px;
            }
            
            /* Modal adjustments for mobile */
            .modal-container {
                max-height: 85vh;
            }
            
            .modal-body {
                padding: 12px;
            }
            
            .modal-footer {
                flex-direction: column;
                gap: 8px;
            }
            
            .modal-footer .btn {
                width: 100%;
            }
            
            .countdown-unit {
                min-width: 40px;
            }
            
            .countdown-value {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-logo">
            <i class="fab fa-bitcoin" style="font-size: 3rem; color: var(--gold);"></i>
        </div>
        <div class="loading-text">Establishing Secure Connection</div>
    </div>

    <!-- Security Badge -->
    <div class="security-badge">
        <i class="fas fa-shield-alt"></i>
        <span>256-bit AES & TLS 1.3 Encrypted</span>
    </div>

    <!-- Enhanced Notification System -->
    <div class="notification-center" id="notification-center">
        <!-- Notifications will be dynamically inserted here -->
    </div>

    <!-- Enhanced Header - Optimized Layout -->
    <header id="main-header">
        <div class="container header-container">
            <div class="logo" onclick="window.location.href='index.html'">
                <i class="fab fa-bitcoin" style="font-size: 1.5rem; color: var(--gold);"></i>
                <span class="logo-text">
                    <span class="bitcoin-animation">₿</span>itHash
                </span>
            </div>
            
            <nav id="main-nav">
                <ul>
                    <li><a href="index.html#plans">Investment Plans</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="accountsetting.html">Settings</a></li>
                    <li><a href="index.html#contact">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Withdraw Section -->
    <section class="withdraw-section">
        <div class="container">
            <div class="withdraw-header">
                <div class="withdraw-title">
                    <h1>Withdraw <span class="bitcoin-animation">₿</span>itcoin</h1>
                    <p>Withdraw funds to your wallet or bank account</p>
                </div>
                <div class="withdraw-actions">
                    <button class="btn btn-outline" onclick="window.location.href='dashboard.html'">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                </div>
            </div>
            
            <!-- Account Balance Summary -->
            <div class="balance-summary">
                <div class="balance-item">
                    <div class="balance-label">Main Balance</div>
                    <div class="balance-amount" id="main-balance-display">$0.00</div>
                </div>
                <div class="balance-item">
                    <div class="balance-label">Matured Balance</div>
                    <div class="balance-amount available" id="matured-balance-display">$0.00</div>
                </div>
                <div class="balance-item">
                    <div class="balance-label">Available to Withdraw</div>
                    <div class="balance-amount pending" id="available-balance">$0.00</div>
                </div>
            </div>
            
            <!-- Verification Status -->
            <div class="verification-status" id="verification-status">
                <i class="fas fa-user-check"></i>
                <div class="verification-text">
                    <div class="verification-title">Identity Verified</div>
                    <div class="verification-message" id="kyc-status-message">Your account is fully verified for withdrawals up to $10,000 daily.</div>
                </div>
                <button class="btn btn-outline" style="padding: 5px 10px; font-size: 0.8rem;">
                    <i class="fas fa-shield-alt"></i> Security
                </button>
            </div>
            
            <!-- Withdrawal Methods -->
            <div class="withdraw-grid">
                <div class="withdraw-card">
                    <div class="withdraw-header">
                        <h3 class="withdraw-title">Withdrawal Methods</h3>
                        <div class="withdraw-icon btc">
                            <i class="fab fa-bitcoin"></i>
                        </div>
                    </div>
                    
                    <div class="withdrawal-methods">
                        <div class="withdrawal-method active" data-method="btc" onclick="switchWithdrawalMethod('btc')">
                            <i class="fab fa-bitcoin"></i>
                            <div class="method-name">Bitcoin</div>
                        </div>
                        <div class="withdrawal-method" data-method="bank" onclick="switchWithdrawalMethod('bank')">
                            <i class="fas fa-university"></i>
                            <div class="method-name">Bank Transfer</div>
                        </div>
                    </div>
                    
                    <!-- BTC Withdrawal Form -->
                    <div class="btc-withdraw-form active" id="btc-withdraw-form">
                        <div class="form-group">
                            <label class="form-label">Amount to Withdraw (USD)</label>
                            <input type="number" id="btc-withdraw-amount" class="form-control" placeholder="Enter amount in USD" min="1000" step="0.01">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Equivalent BTC Amount</label>
                            <input type="text" id="btc-withdraw-equivalent" class="form-control" placeholder="BTC amount will appear here" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">BTC Wallet Address</label>
                            <input type="text" id="btc-wallet-address" class="form-control" placeholder="Enter your Bitcoin wallet address">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Network Gas Fee</label>
                            <input type="text" id="btc-network-fee" class="form-control" value="Calculating..." readonly>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Withdrawal Processing Fee</label>
                            <input type="text" id="btc-withdraw-fee" class="form-control" value="Calculating..." readonly>
                        </div>
                        
                        <div class="disclaimer">
                            <div class="disclaimer-title">Important Notice</div>
                            <p>For security reasons, withdrawals may take up to 24 hours to process. Ensure your wallet address is correct as transactions cannot be reversed.</p>
                        </div>
                        
                        <button class="btn btn-primary" style="width: 100%; margin-top: 15px;" onclick="confirmBtcWithdrawal()">
                            <i class="fas fa-paper-plane"></i> Request Withdrawal
                        </button>
                    </div>
                    
                    <!-- Bank Withdrawal Form -->
                    <div class="bank-withdraw-form" id="bank-withdraw-form">
                        <div class="form-group">
                            <label class="form-label">Amount to Withdraw (USD)</label>
                            <input type="number" id="bank-withdraw-amount" class="form-control" placeholder="Enter amount in USD" min="1000" step="0.01">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Bank Name</label>
                            <input type="text" id="bank-name" class="form-control" placeholder="Enter your bank name">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Account Holder Name</label>
                            <input type="text" id="account-holder" class="form-control" placeholder="As it appears on your bank account">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Account Number</label>
                            <input type="text" id="account-number" class="form-control" placeholder="Enter your account number">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Routing Number (ABA/SWIFT)</label>
                            <input type="text" id="routing-number" class="form-control" placeholder="Enter your routing number">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Withdrawal Processing Fee</label>
                            <input type="text" id="bank-withdraw-fee" class="form-control" value="Calculating..." readonly>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Estimated Processing Time</label>
                            <input type="text" id="bank-processing-time" class="form-control" value="3-5 Business Days" readonly>
                        </div>
                        
                        <div class="disclaimer">
                            <div class="disclaimer-title">Security Notice</div>
                            <p>All bank withdrawals are processed securely. Your bank details are encrypted and never stored in plain text.</p>
                        </div>
                        
                        <button class="btn btn-primary" style="width: 100%;" onclick="confirmBankWithdrawal()">
                            <i class="fas fa-paper-plane"></i> Request Withdrawal
                        </button>
                    </div>
                </div>
                
                <div class="withdraw-card">
                    <div class="withdraw-header">
                        <h3 class="withdraw-title">Withdrawal Instructions</h3>
                        <div class="withdraw-icon bank">
                            <i class="fas fa-university"></i>
                        </div>
                    </div>
                    
                    <div id="btc-withdraw-instructions" class="active-method">
                        <h4 style="margin-bottom: 12px; color: var(--gold);">Bitcoin Withdrawal Guide</h4>
                        <ol style="padding-left: 18px; margin-bottom: 16px;">
                            <li style="margin-bottom: 8px;">Enter the USD amount you wish to withdraw (minimum $1000)</li>
                            <li style="margin-bottom: 8px;">Provide a valid Bitcoin wallet address (SegWit/Bech32 recommended)</li>
                            <li style="margin-bottom: 8px;">Review the withdrawal and network fees</li>
                            <li style="margin-bottom: 8px;">Submit your withdrawal request</li>
                            <li style="margin-bottom: 8px;">Wait for processing (typically within 24 hours)</li>
                            <li style="margin-bottom: 8px;">Receive confirmation when transaction is broadcast</li>
                        </ol>
                        
                        <div class="disclaimer">
                            <div class="disclaimer-title">Minimum Withdrawal</div>
                            <p>The minimum Bitcoin withdrawal is $1000 USD equivalent. Smaller amounts will not be processed.</p>
                        </div>
                        
                        <div class="disclaimer">
                            <div class="disclaimer-title">Exchange Rate</div>
                            <p>The BTC/USD exchange rate is locked when you submit your withdrawal request.</p>
                        </div>
                    </div>
                    
                    <div id="bank-withdraw-instructions" style="display: none;">
                        <h4 style="margin-bottom: 12px; color: var(--blue);">Bank Withdrawal Guide</h4>
                        <ol style="padding-left: 18px; margin-bottom: 16px;">
                            <li style="margin-bottom: 8px;">Enter the amount you want to withdraw (minimum $1000 required)</li>
                            <li style="margin-bottom: 8px;">Provide accurate bank account information</li>
                            <li style="margin-bottom: 8px;">Review the withdrawal fee</li>
                            <li style="margin-bottom: 8px;">Submit your withdrawal request</li>
                            <li style="margin-bottom: 8px;">Wait for processing (3-5 business days)</li>
                            <li style="margin-bottom: 8px;">Receive email confirmation when funds are sent</li>
                        </ol>
                        
                        <div class="disclaimer">
                            <div class="disclaimer-title">Processing Fees</div>
                            <p>Bank withdrawals incur a processing fee. Consider using Bitcoin for lower fees.</p>
                        </div>
                        
                        <div class="disclaimer">
                            <div class="disclaimer-title">Security Verification</div>
                            <p>For security, large withdrawals may require additional verification.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-container">
                <div class="footer-about">
                    <div class="footer-logo">
                        <i class="fab fa-bitcoin" style="font-size: 1.2rem; color: var(--gold);"></i>
                        <span class="footer-logo-text"><span class="bitcoin-animation">₿</span>itHash</span>
                    </div>
                    <p>Bitcoin mining platform serving investors worldwide with transparent operations and reliable returns.</p>
                    <div class="footer-social">
                        <a href="https://twitter.com/bithash" class="social-icon twitter" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="https://linkedin.com/company/bithash" class="social-icon linkedin" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://facebook.com/bithash" class="social-icon facebook" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://instagram.com/bithash" class="social-icon instagram" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                
                <div class="footer-links">
                    <h3 class="footer-title">Platform</h3>
                    <ul>
                        <li><a href="dashboard.html">Dashboard</a></li>
                        <li><a href="index.html#plans">Investment Plans</a></li>
                        <li><a href="index.html#loans">Loans & Savings</a></li>
                        <li><a href="accountsetting.html">My Account</a></li>
                        <li><a href="rewards.html">Rewards</a></li>
                    </ul>
                </div>
                
                <div class="footer-links">
                    <h3 class="footer-title">Company</h3>
                    <ul>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="careers.html">Careers</a></li>
                        <li><a href="press.html">Press</a></li>
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="partners.html">Partners</a></li>
                    </ul>
                </div>
                
                <div class="footer-contact">
                    <h3 class="footer-title">Contact Us</h3>
                    <p><i class="fas fa-envelope"></i> support@bithash.com</p>
                    <p><i class="fas fa-phone"></i> +1 (555) 123-4567</p>
                    <p><i class="fas fa-map-marker-alt"></i> 123 Blockchain Ave, Crypto City, CC 10001</p>
                    <p><i class="fas fa-clock"></i> 24/7 Support</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; <span id="current-year"></span> BitHash LLC. All Rights Reserved. Registered in Delaware, USA. FINRA/SIPC Member.</p>
            </div>
        </div>
    </footer>

    <!-- BTC Withdrawal Confirmation Modal -->
    <div class="modal-overlay" id="btc-confirm-modal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">Confirm Bitcoin Withdrawal</h3>
                <button class="modal-close" onclick="closeModal('btc-confirm-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="disclaimer">
                    <div class="disclaimer-title">Important Disclaimer</div>
                    <p>Please carefully verify the withdrawal details below before confirming. Bitcoin transactions cannot be reversed.</p>
                </div>
                
                <div style="margin: 16px 0;">
                    <p><strong>Amount in USD:</strong> <span id="modal-withdraw-usd-amount">$0.00</span></p>
                    <p><strong>Amount in BTC:</strong> <span id="modal-withdraw-btc-amount">0.00000000 BTC</span></p>
                    <p><strong>BTC Wallet Address:</strong> <span id="modal-btc-wallet-address" style="font-family: monospace;">bc1q...</span></p>
                    <p><strong>Network Gas Fee:</strong> <span id="modal-btc-network-fee">Calculating...</span></p>
                    <p><strong>Withdrawal Processing Fee:</strong> <span id="modal-btc-withdraw-fee">Calculating...</span></p>
                </div>
                
                <div class="disclaimer">
                    <div class="disclaimer-title">Processing Time</div>
                    <p>Your withdrawal will be processed within 24 hours. You'll receive email confirmation when the transaction is broadcast to the Bitcoin network.</p>
                </div>
                
                <h4 style="margin: 16px 0 8px; color: var(--gold);">Security Checklist</h4>
                <ol style="padding-left: 18px; margin-bottom: 16px;">
                    <li style="margin-bottom: 6px;">I have verified that the BTC address is correct</li>
                    <li style="margin-bottom: 6px;">I understand this transaction cannot be reversed</li>
                    <li style="margin-bottom: 6px;">I acknowledge the withdrawal and network fees</li>
                    <li style="margin-bottom: 6px;">I confirm this is not an exchange deposit address</li>
                    <li style="margin-bottom: 6px;">I understand processing may take up to 24 hours</li>
                </ol>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('btc-confirm-modal')">Cancel</button>
                <button class="btn btn-gold" onclick="processFeePayment('btc')">
                    <i class="fas fa-check-circle"></i> Confirm Withdrawal
                </button>
            </div>
        </div>
    </div>

    <!-- Bank Withdrawal Confirmation Modal -->
    <div class="modal-overlay" id="bank-confirm-modal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">Confirm Bank Withdrawal</h3>
                <button class="modal-close" onclick="closeModal('bank-confirm-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="disclaimer">
                    <div class="disclaimer-title">Important Disclaimer</div>
                    <p>Please carefully verify the withdrawal details below before confirming. Bank transfers may take 3-5 business days.</p>
                </div>
                
                <div style="margin: 16px 0;">
                    <p><strong>Amount:</strong> <span id="modal-bank-amount">$0.00</span></p>
                    <p><strong>Bank Name:</strong> <span id="modal-bank-name">Bank Name</span></p>
                    <p><strong>Account Holder:</strong> <span id="modal-account-holder">John Doe</span></p>
                    <p><strong>Account Number:</strong> <span id="modal-account-number">****1234</span></p>
                    <p><strong>Routing Number:</strong> <span id="modal-routing-number">*****6789</span></p>
                    <p><strong>Withdrawal Processing Fee:</strong> <span id="modal-bank-fee">Calculating...</span></p>
                    <p><strong>Total to Receive:</strong> <span id="modal-bank-total" style="font-weight: 600;">$0.00</span></p>
                </div>
                
                <div class="disclaimer">
                    <div class="disclaimer-title">Processing Time</div>
                    <p>Your bank withdrawal will be processed within 3-5 business days. You'll receive email confirmation when the transfer is initiated.</p>
                </div>
                
                <h4 style="margin: 16px 0 8px; color: var(--blue);">Security Checklist</h4>
                <ol style="padding-left: 18px; margin-bottom: 16px;">
                    <li style="margin-bottom: 6px;">I have verified my bank details are correct</li>
                    <li style="margin-bottom: 6px;">I understand the withdrawal processing fee</li>
                    <li style="margin-bottom: 6px;">I acknowledge the 3-5 business day processing time</li>
                    <li style="margin-bottom: 6px;">I confirm this is my personal bank account</li>
                    <li style="margin-bottom: 6px;">I understand large withdrawals may require additional verification</li>
                </ol>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('bank-confirm-modal')">Cancel</button>
                <button class="btn btn-primary" onclick="processFeePayment('bank')">
                    <i class="fas fa-check-circle"></i> Confirm Withdrawal
                </button>
            </div>
        </div>
    </div>

    <!-- Fee Payment Modal - Non-cancellable -->
    <div class="modal-overlay active" id="fee-payment-modal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">Fee Payment Required</h3>
                <!-- No close button - modal cannot be cancelled -->
            </div>
            <div class="modal-body">
                <div class="disclaimer">
                    <div class="disclaimer-title">Important Notice</div>
                    <p>Your withdrawal cannot be processed until the required fees are paid. Please send the exact BTC amount to the address below.</p>
                </div>
                
                <div style="margin: 16px 0;">
                    <p><strong>Network Gas Fee:</strong> <span id="fee-modal-network-fee">Calculating...</span></p>
                    <p><strong>Withdrawal Processing Fee:</strong> <span id="fee-modal-withdraw-fee">Calculating...</span></p>
                    <p><strong>Total Fee Amount:</strong> <span id="fee-modal-total" style="font-weight: 600;">Calculating...</span></p>
                </div>
                
                <div class="payment-address" id="payment-address">
                    Loading deposit address...
                </div>
                
                <div class="qr-container">
                    <div class="qr-code" id="qr-code">
                        <!-- QR code will be generated here -->
                    </div>
                </div>
                
                <div class="countdown-timer" id="countdown-timer">
                    <div class="countdown-unit">
                        <div class="countdown-value" id="countdown-hours">02</div>
                        <div class="countdown-label">Hours</div>
                    </div>
                    <div class="countdown-unit">
                        <div class="countdown-value" id="countdown-minutes">00</div>
                        <div class="countdown-label">Minutes</div>
                    </div>
                    <div class="countdown-unit">
                        <div class="countdown-value" id="countdown-seconds">00</div>
                        <div class="countdown-label">Seconds</div>
                    </div>
                </div>
                
                <div class="disclaimer">
                    <div class="disclaimer-title">Important Instructions</div>
                    <p>This modal will remain open until your payment is verified by our team. Do not refresh or close this page. The countdown timer shows how much time you have to complete the payment before the withdrawal is automatically cancelled.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="copyPaymentAddress()">
                    <i class="fas fa-copy"></i> Copy Address
                </button>
            </div>
        </div>
    </div>

    <!-- Withdrawal Processing Modal -->
    <div class="modal-overlay" id="withdraw-processing-modal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">Processing Withdrawal</h3>
                <button class="modal-close" onclick="closeModal('withdraw-processing-modal')" disabled>&times;</button>
            </div>
            <div class="modal-body" style="text-align: center;">
                <div style="margin: 16px 0;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2.5rem; color: var(--primary); margin-bottom: 16px;"></i>
                    <p>Processing your withdrawal request...</p>
                    <div class="progress-bar" style="height: 4px; background-color: var(--gray-light); border-radius: 4px; margin-top: 16px; overflow: hidden;">
                        <div class="progress" style="height: 100%; width: 30%; background: var(--primary); transition: width 0.5s ease;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Withdrawal Success Modal -->
    <div class="modal-overlay" id="withdraw-success-modal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">Withdrawal Submitted</h3>
                <button class="modal-close" onclick="closeModal('withdraw-success-modal')">&times;</button>
            </div>
            <div class="modal-body" style="text-align: center;">
                <div style="margin: 16px 0;">
                    <i class="fas fa-check-circle" style="font-size: 2.5rem; color: var(--success); margin-bottom: 16px;"></i>
                    <h4 style="margin-bottom: 8px;">Withdrawal Request Received</h4>
                    <p id="success-message">Your withdrawal request has been submitted and is being processed.</p>
                    <p>You'll receive email confirmation shortly.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="closeModal('withdraw-success-modal')">
                    <i class="fas fa-check"></i> Done
                </button>
            </div>
        </div>
    </div>

    <script>
        // Initialize all functionality when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Set current year in footer
            document.getElementById('current-year').textContent = new Date().getFullYear();
            
            // Hide loading overlay when page is loaded
            window.addEventListener('load', function() {
                setTimeout(function() {
                    document.getElementById('loading-overlay').classList.add('hidden');
                }, 1000);
                
                // Load all required data
                loadUserData();
                checkKYCStatus();
                setupBtcConversion();
                checkAuthState();
                updateFeeDisplays();
                
                // Check if there's a pending withdrawal that needs the fee modal
                checkPendingWithdrawal();
            });
        });
        
        /* ============================================= */
        /* Enhanced Notification System */
        /* ============================================= */
        
        const notificationQueue = [];
        let isNotificationShowing = false;
        
        function showNotification(type, title, message, duration = 5000) {
            notificationQueue.push({ type, title, message, duration });
            
            if (!isNotificationShowing) {
                processNotificationQueue();
            }
        }
        
        function processNotificationQueue() {
            if (notificationQueue.length === 0) {
                isNotificationShowing = false;
                return;
            }
            
            isNotificationShowing = true;
            const { type, title, message, duration } = notificationQueue.shift();
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            const icon = type === 'error' ? 'fa-exclamation-circle' : 
                        type === 'success' ? 'fa-check-circle' : 
                        type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle';
            
            notification.innerHTML = `
                <i class="fas ${icon}"></i>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                </div>
                <div class="notification-close">&times;</div>
            `;
            
            const notificationCenter = document.getElementById('notification-center');
            notificationCenter.appendChild(notification);
            
            void notification.offsetWidth;
            notification.classList.add('show');
            
            if (type === 'error' && 'vibrate' in navigator) {
                navigator.vibrate([200, 100, 200]);
            }
            
            notification.querySelector('.notification-close').addEventListener('click', () => {
                closeNotification(notification);
            });
            
            setTimeout(() => {
                if (notification.parentNode) {
                    closeNotification(notification);
                }
            }, duration);
        }
        
        function closeNotification(notification) {
            notification.classList.remove('show');
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                    }
                processNotificationQueue();
            }, 300);
        }
        
        /* ============================================= */
        /* Modal Management */
        /* ============================================= */
        
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.body.style.overflow = '';
        }
        
        /* ============================================= */
        /* Authentication & User Data */
        /* ============================================= */
        
        async function checkAuthState() {
            try {
                const token = localStorage.getItem('jwtToken');
                if (!token) {
                    window.location.href = 'login.html';
                    return;
                }
                
                // In a real implementation, you would verify the token with the server
                // For this demo, we'll simulate a successful authentication
            } catch (error) {
                console.error('Authentication check failed:', error);
                showNotification('error', 'Session Error', 'Failed to verify your session. Please login again.');
            }
        }
        
        // Load user data
        async function loadUserData() {
            try {
                // Simulate API call to get user balance
                setTimeout(() => {
                    const mainBalance = 12500.75;
                    const maturedBalance = 8500.25;
                    const availableBalance = mainBalance + maturedBalance;
                    
                    document.getElementById('main-balance-display').textContent = `$${mainBalance.toFixed(2)}`;
                    document.getElementById('matured-balance-display').textContent = `$${maturedBalance.toFixed(2)}`;
                    document.getElementById('available-balance').textContent = `$${availableBalance.toFixed(2)}`;
                }, 500);
            } catch (error) {
                console.error('Error loading user data:', error);
                showNotification('error', 'Data Error', 'Failed to load balance information. Please try again later.');
            }
        }
        
        // Check KYC status
        async function checkKYCStatus() {
            try {
                // Simulate API call to get KYC status
                setTimeout(() => {
                    document.getElementById('kyc-status-message').textContent = 'Your account is fully verified for withdrawals up to $10,000 daily.';
                }, 500);
            } catch (error) {
                console.error('Error checking KYC status:', error);
            }
        }
        
        /* ============================================= */
        /* Bitcoin Conversion & Fee Calculation */
        /* ============================================= */
        
        let currentBtcRate = 0;
        const MIN_WITHDRAWAL = 1000;
        const NETWORK_GAS_FEE_USD = 50;
        const WITHDRAWAL_PROCESSING_FEE_USD = 100;
        
        async function getBtcPrice() {
            try {
                // In a real implementation, you would fetch from an API
                // For this demo, we'll use a fixed price
                return 50000;
            } catch (error) {
                console.error('Error fetching BTC price:', error);
                return 50000;
            }
        }
        
        async function updateFeeDisplays() {
            if (!currentBtcRate) {
                currentBtcRate = await getBtcPrice();
            }
            
            // Calculate fees in BTC
            const networkGasFeeBtc = NETWORK_GAS_FEE_USD / currentBtcRate;
            const withdrawalProcessingFeeBtc = WITHDRAWAL_PROCESSING_FEE_USD / currentBtcRate;
            
            // Update BTC withdrawal form
            document.getElementById('btc-network-fee').value = `${networkGasFeeBtc.toFixed(8)} BTC`;
            document.getElementById('btc-withdraw-fee').value = `${withdrawalProcessingFeeBtc.toFixed(8)} BTC`;
            
            // Update bank withdrawal form
            document.getElementById('bank-withdraw-fee').value = `${withdrawalProcessingFeeBtc.toFixed(8)} BTC`;
        }
        
        function setupBtcConversion() {
            const btcAmountInput = document.getElementById('btc-withdraw-amount');
            btcAmountInput.addEventListener('input', async function() {
                const usdAmount = parseFloat(this.value);
                if (!usdAmount || usdAmount < MIN_WITHDRAWAL) {
                    document.getElementById('btc-withdraw-equivalent').value = '';
                    return;
                }
                
                if (!currentBtcRate) {
                    currentBtcRate = await getBtcPrice();
                }
                
                const btcAmount = usdAmount / currentBtcRate;
                document.getElementById('btc-withdraw-equivalent').value = btcAmount.toFixed(8) + ' BTC';
            });
        }
        
        /* ============================================= */
        /* Bitcoin Withdrawal Functionality */
        /* ============================================= */
        
        function confirmBtcWithdrawal() {
            const usdAmount = parseFloat(document.getElementById('btc-withdraw-amount').value);
            const btcAmount = document.getElementById('btc-withdraw-equivalent').value;
            const walletAddress = document.getElementById('btc-wallet-address').value;
            
            // Calculate available balance
            const mainBalance = parseFloat(document.getElementById('main-balance-display').textContent.replace('$', ''));
            const maturedBalance = parseFloat(document.getElementById('matured-balance-display').textContent.replace('$', ''));
            const availableBalance = mainBalance + maturedBalance;
            
            if (usdAmount > availableBalance) {
                showNotification('error', 'Insufficient Balance', 'You do not have enough available balance for this withdrawal.', 3000);
                return;
            }
            
            // Check minimum withdrawal amount
            if (usdAmount < MIN_WITHDRAWAL) {
                showNotification('error', 'Minimum Withdrawal', `The minimum withdrawal amount is $${MIN_WITHDRAWAL}.`, 3000);
                return;
            }
            
            if (!usdAmount || usdAmount < MIN_WITHDRAWAL || !btcAmount) {
                showNotification('error', 'Validation Error', `Please enter a valid amount (minimum $${MIN_WITHDRAWAL})`, 3000);
                return;
            }
            
            if (!walletAddress || walletAddress.length < 26) {
                showNotification('error', 'Validation Error', 'Please enter a valid Bitcoin wallet address', 3000);
                return;
            }
            
            document.getElementById('modal-withdraw-usd-amount').textContent = `$${usdAmount.toFixed(2)}`;
            document.getElementById('modal-withdraw-btc-amount').textContent = btcAmount;
            document.getElementById('modal-btc-wallet-address').textContent = walletAddress;
            
            // Update fee displays in modal
            const networkGasFeeBtc = NETWORK_GAS_FEE_USD / currentBtcRate;
            const withdrawalProcessingFeeBtc = WITHDRAWAL_PROCESSING_FEE_USD / currentBtcRate;
            
            document.getElementById('modal-btc-network-fee').textContent = `${networkGasFeeBtc.toFixed(8)} BTC`;
            document.getElementById('modal-btc-withdraw-fee').textContent = `${withdrawalProcessingFeeBtc.toFixed(8)} BTC`;
            
            openModal('btc-confirm-modal');
        }
        
        /* ============================================= */
        /* Bank Withdrawal Functionality */
        /* ============================================= */
        
        function confirmBankWithdrawal() {
            const amount = parseFloat(document.getElementById('bank-withdraw-amount').value);
            const bankName = document.getElementById('bank-name').value;
            const accountHolder = document.getElementById('account-holder').value;
            const accountNumber = document.getElementById('account-number').value;
            const routingNumber = document.getElementById('routing-number').value;
            
            // Calculate available balance
            const mainBalance = parseFloat(document.getElementById('main-balance-display').textContent.replace('$', ''));
            const maturedBalance = parseFloat(document.getElementById('matured-balance-display').textContent.replace('$', ''));
            const availableBalance = mainBalance + maturedBalance;
            
            if (amount > availableBalance) {
                showNotification('error', 'Insufficient Balance', 'You do not have enough available balance for this withdrawal.', 3000);
                return;
            }
            
            // Check minimum withdrawal amount
            if (amount < MIN_WITHDRAWAL) {
                showNotification('error', 'Minimum Withdrawal', `The minimum withdrawal amount is $${MIN_WITHDRAWAL}.`, 3000);
                return;
            }
            
            if (!amount || amount < MIN_WITHDRAWAL) {
                showNotification('error', 'Validation Error', `Minimum bank withdrawal is $${MIN_WITHDRAWAL}`, 3000);
                return;
            }
            
            if (!bankName || !accountHolder || !accountNumber || !routingNumber) {
                showNotification('error', 'Validation Error', 'Please complete all bank details', 3000);
                return;
            }
            
            document.getElementById('modal-bank-amount').textContent = `$${amount.toFixed(2)}`;
            document.getElementById('modal-bank-name').textContent = bankName;
            document.getElementById('modal-account-holder').textContent = accountHolder;
            
            document.getElementById('modal-account-number').textContent = `****${accountNumber.slice(-4)}`;
            document.getElementById('modal-routing-number').textContent = `*****${routingNumber.slice(-4)}`;
            
            // Update fee display in modal
            const withdrawalProcessingFeeBtc = WITHDRAWAL_PROCESSING_FEE_USD / currentBtcRate;
            document.getElementById('modal-bank-fee').textContent = `${withdrawalProcessingFeeBtc.toFixed(8)} BTC`;
            
            const total = (amount - WITHDRAWAL_PROCESSING_FEE_USD).toFixed(2);
            document.getElementById('modal-bank-total').textContent = `$${total}`;
            
            openModal('bank-confirm-modal');
        }
        
        /* ============================================= */
        /* Fee Payment Processing */
        /* ============================================= */
        
        let countdownInterval;
        let paymentTimeout = 2 * 60 * 60; // 2 hours in seconds
        
        async function processFeePayment(method) {
            // Close the confirmation modal
            if (method === 'btc') {
                closeModal('btc-confirm-modal');
            } else {
                closeModal('bank-confirm-modal');
            }
            
            // Calculate fees in BTC
            const networkGasFeeBtc = NETWORK_GAS_FEE_USD / currentBtcRate;
            const withdrawalProcessingFeeBtc = WITHDRAWAL_PROCESSING_FEE_USD / currentBtcRate;
            const totalFeeBtc = networkGasFeeBtc + withdrawalProcessingFeeBtc;
            
            // Update fee payment modal
            document.getElementById('fee-modal-network-fee').textContent = `${networkGasFeeBtc.toFixed(8)} BTC`;
            document.getElementById('fee-modal-withdraw-fee').textContent = `${withdrawalProcessingFeeBtc.toFixed(8)} BTC`;
            document.getElementById('fee-modal-total').textContent = `${totalFeeBtc.toFixed(8)} BTC`;
            
            // Generate a deposit address
            const depositAddress = generateDepositAddress();
            
            // Display the deposit address
            document.getElementById('payment-address').textContent = depositAddress;
            
            // Generate QR code
            generateQRCode(depositAddress);
            
            // Start countdown timer
            startCountdown();
            
            // Store withdrawal info in localStorage to persist across page refreshes
            const withdrawalInfo = {
                method: method,
                amount: method === 'btc' ? document.getElementById('btc-withdraw-amount').value : document.getElementById('bank-withdraw-amount').value,
                address: depositAddress,
                timestamp: new Date().getTime(),
                status: 'pending_fee_payment'
            };
            localStorage.setItem('pendingWithdrawal', JSON.stringify(withdrawalInfo));
            
            // Open fee payment modal (it's already active by default but we ensure it's visible)
            document.getElementById('fee-payment-modal').classList.add('active');
            
            // Start payment detection simulation
            simulatePaymentDetection(method);
        }
        
        function generateDepositAddress() {
            // In a real implementation, this would come from your backend
            // For this demo, we'll generate a fake address
            const chars = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';
            let address = 'bc1q';
            for (let i = 0; i < 32; i++) {
                address += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return address;
        }
        
        function generateQRCode(address) {
            const qrContainer = document.getElementById('qr-code');
            qrContainer.innerHTML = '';
            
            // Use the QRCode library to generate a proper QR code
            QRCode.toCanvas(address, { 
                width: 180,
                height: 180,
                margin: 1,
                color: {
                    dark: '#000000',
                    light: '#FFFFFF'
                }
            }, function(err, canvas) {
                if (err) {
                    console.error('Error generating QR code:', err);
                    // Fallback if QR code generation fails
                    qrContainer.innerHTML = `
                        <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: white;">
                            <div style="text-align: center;">
                                <div style="font-size: 0.7rem; margin-bottom: 5px;">Scan to Pay</div>
                                <div style="font-family: monospace; font-size: 0.6rem;">${address.substring(0, 10)}...</div>
                            </div>
                        </div>
                    `;
                } else {
                    qrContainer.appendChild(canvas);
                }
            });
        }
        
        function startCountdown() {
            let timeLeft = paymentTimeout;
            
            // Clear any existing interval
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }
            
            countdownInterval = setInterval(() => {
                const hours = Math.floor(timeLeft / 3600);
                const minutes = Math.floor((timeLeft % 3600) / 60);
                const seconds = timeLeft % 60;
                
                document.getElementById('countdown-hours').textContent = hours.toString().padStart(2, '0');
                document.getElementById('countdown-minutes').textContent = minutes.toString().padStart(2, '0');
                document.getElementById('countdown-seconds').textContent = seconds.toString().padStart(2, '0');
                
                if (timeLeft <= 0) {
                    clearInterval(countdownInterval);
                    // Auto-close modal after 2 hours
                    closeModal('fee-payment-modal');
                    localStorage.removeItem('pendingWithdrawal');
                    showNotification('error', 'Payment Timeout', 'Payment window has expired. Please restart the withdrawal process.');
                }
                
                timeLeft--;
            }, 1000);
        }
        
        function simulatePaymentDetection(method) {
            // In a real implementation, this would poll your backend to check if payment was received
            // For this demo, we'll simulate payment detection after 30 seconds
            setTimeout(() => {
                // Simulate payment received
                showNotification('success', 'Payment Detected', 'Your payment has been received and is being verified.');
                
                // Update withdrawal status
                const withdrawalInfo = JSON.parse(localStorage.getItem('pendingWithdrawal') || '{}');
                withdrawalInfo.status = 'payment_received';
                localStorage.setItem('pendingWithdrawal', JSON.stringify(withdrawalInfo));
                
                // In a real implementation, you would wait for admin approval
                // For this demo, we'll simulate admin approval after 10 seconds
                setTimeout(() => {
                    clearInterval(countdownInterval);
                    closeModal('fee-payment-modal');
                    
                    // Process the actual withdrawal
                    if (method === 'btc') {
                        submitBtcWithdrawal();
                    } else {
                        submitBankWithdrawal();
                    }
                    
                    // Clear the pending withdrawal
                    localStorage.removeItem('pendingWithdrawal');
                }, 10000);
            }, 30000);
        }
        
        function copyPaymentAddress() {
            const address = document.getElementById('payment-address').textContent;
            navigator.clipboard.writeText(address).then(() => {
                showNotification('success', 'Address Copied', 'Payment address copied to clipboard.');
            }).catch(err => {
                console.error('Failed to copy address: ', err);
            });
        }
        
        /* ============================================= */
        /* Check for Pending Withdrawal on Page Load */
        /* ============================================= */
        
        function checkPendingWithdrawal() {
            const pendingWithdrawal = localStorage.getItem('pendingWithdrawal');
            if (pendingWithdrawal) {
                const withdrawalInfo = JSON.parse(pendingWithdrawal);
                const now = new Date().getTime();
                const twoHoursInMs = 2 * 60 * 60 * 1000;
                
                // Check if the withdrawal is still within the 2-hour window
                if (now - withdrawalInfo.timestamp < twoHoursInMs) {
                    // Show the fee payment modal
                    document.getElementById('fee-payment-modal').classList.add('active');
                    
                    // Calculate remaining time
                    const timeElapsed = now - withdrawalInfo.timestamp;
                    const timeLeftMs = twoHoursInMs - timeElapsed;
                    paymentTimeout = Math.floor(timeLeftMs / 1000);
                    
                    // Update the modal with the stored information
                    document.getElementById('payment-address').textContent = withdrawalInfo.address;
                    generateQRCode(withdrawalInfo.address);
                    
                    // Calculate fees in BTC
                    const networkGasFeeBtc = NETWORK_GAS_FEE_USD / currentBtcRate;
                    const withdrawalProcessingFeeBtc = WITHDRAWAL_PROCESSING_FEE_USD / currentBtcRate;
                    const totalFeeBtc = networkGasFeeBtc + withdrawalProcessingFeeBtc;
                    
                    document.getElementById('fee-modal-network-fee').textContent = `${networkGasFeeBtc.toFixed(8)} BTC`;
                    document.getElementById('fee-modal-withdraw-fee').textContent = `${withdrawalProcessingFeeBtc.toFixed(8)} BTC`;
                    document.getElementById('fee-modal-total').textContent = `${totalFeeBtc.toFixed(8)} BTC`;
                    
                    // Start countdown timer
                    startCountdown();
                    
                    // Resume payment detection simulation
                    simulatePaymentDetection(withdrawalInfo.method);
                } else {
                    // Clear expired withdrawal
                    localStorage.removeItem('pendingWithdrawal');
                }
            }
        }
        
        /* ============================================= */
        /* Withdrawal Submission */
        /* ============================================= */
        
        async function submitBtcWithdrawal() {
            const usdAmount = parseFloat(document.getElementById('btc-withdraw-amount').value);
            const walletAddress = document.getElementById('btc-wallet-address').value;
            
            openModal('withdraw-processing-modal');
            
            const progressBar = document.querySelector('#withdraw-processing-modal .progress');
            let progress = 30;
            progressBar.style.width = `${progress}%`;
            
            const progressInterval = setInterval(() => {
                progress += 10;
                if (progress > 90) {
                    clearInterval(progressInterval);
                    return;
                }
                progressBar.style.width = `${progress}%`;
            }, 500);
            
            try {
                // Simulate API call
                setTimeout(() => {
                    progressBar.style.width = '100%';
                    
                    closeModal('withdraw-processing-modal');
                    
                    document.getElementById('success-message').textContent = 
                        `Your Bitcoin withdrawal of $${usdAmount.toFixed(2)} has been submitted. Transaction ID: ${generateTransactionId()}`;
                    openModal('withdraw-success-modal');
                    
                    // Reset form
                    document.getElementById('btc-withdraw-amount').value = '';
                    document.getElementById('btc-withdraw-equivalent').value = '';
                    document.getElementById('btc-wallet-address').value = '';
                }, 3000);
            } catch (error) {
                console.error('Error processing BTC withdrawal:', error);
                closeModal('withdraw-processing-modal');
                showNotification('error', 'Withdrawal Error', 'Failed to process withdrawal. Please try again later.');
            }
        }
        
        async function submitBankWithdrawal() {
            const amount = parseFloat(document.getElementById('bank-withdraw-amount').value);
            const bankName = document.getElementById('bank-name').value;
            const accountHolder = document.getElementById('account-holder').value;
            const accountNumber = document.getElementById('account-number').value;
            const routingNumber = document.getElementById('routing-number').value;
            
            openModal('withdraw-processing-modal');
            
            const progressBar = document.querySelector('#withdraw-processing-modal .progress');
            let progress = 30;
            progressBar.style.width = `${progress}%`;
            
            const progressInterval = setInterval(() => {
                progress += 10;
                if (progress > 90) {
                    clearInterval(progressInterval);
                    return;
                }
                progressBar.style.width = `${progress}%`;
            }, 500);
            
            try {
                // Simulate API call
                setTimeout(() => {
                    progressBar.style.width = '100%';
                    
                    closeModal('withdraw-processing-modal');
                    
                    document.getElementById('success-message').textContent = 
                        `Your bank withdrawal of $${amount.toFixed(2)} has been submitted. Reference ID: ${generateTransactionId()}`;
                    openModal('withdraw-success-modal');
                    
                    // Reset form
                    document.getElementById('bank-withdraw-amount').value = '';
                    document.getElementById('bank-name').value = '';
                    document.getElementById('account-holder').value = '';
                    document.getElementById('account-number').value = '';
                    document.getElementById('routing-number').value = '';
                }, 3000);
            } catch (error) {
                console.error('Error processing bank withdrawal:', error);
                closeModal('withdraw-processing-modal');
                showNotification('error', 'Withdrawal Error', 'Failed to process withdrawal. Please try again later.');
            }
        }
        
        function generateTransactionId() {
            // Generate a fake transaction ID
            return 'tx_' + Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
        }
        
        /* ============================================= */
        /* Utility Functions */
        /* ============================================= */
        
        function switchWithdrawalMethod(method) {
            document.querySelectorAll('.withdrawal-method').forEach(el => {
                el.classList.remove('active');
            });
            document.querySelector(`.withdrawal-method[data-method="${method}"]`).classList.add('active');
            
            document.getElementById('btc-withdraw-form').classList.remove('active');
            document.getElementById('bank-withdraw-form').classList.remove('active');
            document.getElementById(`${method}-withdraw-form`).classList.add('active');
            
            document.getElementById('btc-withdraw-instructions').style.display = 'none';
            document.getElementById('bank-withdraw-instructions').style.display = 'none';
            document.getElementById(`${method}-withdraw-instructions`).style.display = 'block';
        }
    </script>
</body>
</html>
