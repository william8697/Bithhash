<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Bithash</title>
    <meta name="description" content="Manage your Bitcoin mining investments, savings, and loans on Bithash's institutional-grade platform">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rowdies:wght@700&family=Inter:wght@300;400;500;600;700&family=Manrope:wght@600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" type="image/png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <style>
        :root {
            --primary: #D4AF37; /* Gold primary color */
            --primary-dark: #B7950B;
            --primary-light: #FFD700;
            --secondary: #1A1A1A;
            --secondary-dark: #111111;
            --dark: #2C2C2C;
            --darker: #1E1E1E;
            --light: #FAFAFA;
            --lighter: #FFFFFF;
            --gray: #6B7280;
            --gray-light: #E5E7EB;
            --gray-lighter: #F3F4F6;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --gold: #D4AF37;
            --gold-light: #FFD700;
            --gold-dark: #996515;
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            --box-shadow-lg: 0 4px 12px rgba(0, 0, 0, 0.1);
            --transition: all 0.2s ease;
            --transition-slow: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            color: var(--dark);
            background-color: var(--light);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }
        
        .loading-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }
        
        .loading-logo {
            width: 80px;
            height: 80px;
            animation: pulse 1.5s infinite ease-in-out;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.8; }
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header styles */
        header {
            background-color: var(--lighter);
            box-shadow: var(--box-shadow);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            padding: 12px 0;
            transition: var(--transition-slow);
            border-bottom: 1px solid rgba(0, 0, 0, 0.03);
        }
        
        header.scrolled {
            padding: 8px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo img {
            height: 36px;
            width: auto;
            transition: var(--transition);
        }
        
        .logo-text {
            font-family: 'Rowdies', sans-serif;
            font-weight: 700;
            font-size: 1.4rem;
            color: var(--gold);
            transition: var(--transition);
            letter-spacing: 0.5px;
        }
        
        /* Navigation */
        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }
        
        nav a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: var(--transition);
            position: relative;
            font-size: 0.92rem;
            padding: 8px 0;
        }
        
        nav a:hover {
            color: var(--gold);
        }
        
        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--gold);
            transition: var(--transition);
        }
        
        nav a:hover::after {
            width: 100%;
        }
        
        /* Mobile menu toggle */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--dark);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* User controls */
        .user-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .user-name {
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .logout-btn {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        
        .logout-btn:hover {
            color: var(--error);
        }
        
        /* Dashboard layout */
        .dashboard {
            padding-top: 100px;
            padding-bottom: 50px;
        }
        
        .dashboard-header {
            margin-bottom: 30px;
        }
        
        .dashboard-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .dashboard-subtitle {
            color: var(--gray);
            font-size: 0.95rem;
        }
        
        /* Balance cards */
        .balance-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .balance-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            border: 1px solid var(--gray-light);
            position: relative;
            overflow: hidden;
        }
        
        .balance-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background-color: var(--gold);
        }
        
        .balance-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow-lg);
        }
        
        .balance-title {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .balance-title i {
            font-size: 1rem;
            color: var(--gold);
        }
        
        .balance-amount {
            font-size: 1.8rem;
            font-weight: 700;
            font-family: 'Manrope', sans-serif;
            margin-bottom: 5px;
            transition: var(--transition);
            color: var(--dark);
        }
        
        .balance-amount.updating {
            animation: pulse 0.5s infinite alternate;
        }
        
        .balance-btc {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        /* Action buttons */
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 120px;
        }
        
        .btn-primary {
            background-color: var(--gold);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--gold-dark);
            transform: translateY(-2px);
            box-shadow: var(--box-shadow-lg);
        }
        
        .btn-outline {
            background-color: transparent;
            color: var(--gold);
            border: 1px solid var(--gold);
        }
        
        .btn-outline:hover {
            background-color: var(--gold);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--box-shadow-lg);
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background-color: var(--secondary-dark);
            transform: translateY(-2px);
            box-shadow: var(--box-shadow-lg);
        }
        
        /* Dashboard sections */
        .dashboard-section {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
            border: 1px solid var(--gray-light);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark);
        }
        
        .section-actions {
            display: flex;
            gap: 10px;
        }
        
        /* Transaction table */
        .transactions-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .transactions-table th {
            text-align: left;
            padding: 12px 15px;
            font-weight: 600;
            color: var(--gray);
            font-size: 0.85rem;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .transactions-table td {
            padding: 15px;
            border-bottom: 1px solid var(--gray-light);
            vertical-align: middle;
        }
        
        .transaction-type {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .transaction-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.9rem;
        }
        
        .transaction-icon.deposit {
            background-color: var(--success);
        }
        
        .transaction-icon.withdrawal {
            background-color: var(--error);
        }
        
        .transaction-icon.earning {
            background-color: var(--gold);
        }
        
        .transaction-icon.bonus {
            background-color: var(--primary);
        }
        
        .transaction-details {
            display: flex;
            flex-direction: column;
        }
        
        .transaction-name {
            font-weight: 600;
            margin-bottom: 3px;
        }
        
        .transaction-method {
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        .transaction-amount {
            font-weight: 700;
            font-family: 'Manrope', sans-serif;
        }
        
        .transaction-btc {
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        .transaction-date {
            color: var(--gray);
            font-size: 0.85rem;
        }
        
        .transaction-status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-completed {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }
        
        .status-pending {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .status-failed {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }
        
        /* Investment plans */
        .plans-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .plan-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            border: 1px solid var(--gray-light);
            position: relative;
        }
        
        .plan-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow-lg);
        }
        
        .plan-card.popular {
            border: 1px solid var(--gold);
        }
        
        .plan-card.popular::before {
            content: 'Popular';
            position: absolute;
            top: 15px;
            right: -25px;
            background-color: var(--gold);
            color: white;
            padding: 3px 25px;
            transform: rotate(45deg);
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .plan-name {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .plan-roi {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--gold);
            margin-bottom: 5px;
            font-family: 'Manrope', sans-serif;
        }
        
        .plan-duration {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 15px;
        }
        
        .plan-features {
            margin-bottom: 20px;
        }
        
        .plan-feature {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 0.85rem;
        }
        
        .plan-feature i {
            color: var(--gold);
            font-size: 0.8rem;
        }
        
        .plan-minmax {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 10px 0;
            border-top: 1px solid var(--gray-light);
            border-bottom: 1px solid var(--gray-light);
            font-size: 0.85rem;
        }
        
        .plan-minmax div {
            text-align: center;
        }
        
        .plan-minmax div span:first-child {
            display: block;
            font-size: 0.75rem;
            color: var(--gray);
            margin-bottom: 3px;
        }
        
        .plan-minmax div span:last-child {
            font-weight: 600;
        }
        
        .plan-button {
            width: 100%;
        }
        
        /* Savings and loans */
        .savings-loan-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .savings-card, .loan-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            border: 1px solid var(--gray-light);
        }
        
        .savings-progress {
            height: 8px;
            background-color: var(--gray-light);
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .savings-progress-bar {
            height: 100%;
            background-color: var(--gold);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .savings-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .savings-stat {
            text-align: center;
        }
        
        .savings-stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            font-family: 'Manrope', sans-serif;
        }
        
        .savings-stat-label {
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        .loan-limit {
            font-size: 1.5rem;
            font-weight: 700;
            font-family: 'Manrope', sans-serif;
            margin: 15px 0;
            color: var(--gold);
        }
        
        /* Mining metrics */
        .mining-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .metric-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            border: 1px solid var(--gray-light);
            text-align: center;
        }
        
        .metric-value {
            font-size: 1.8rem;
            font-weight: 700;
            font-family: 'Manrope', sans-serif;
            margin-bottom: 5px;
            color: var(--gold);
        }
        
        .metric-label {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal {
            background-color: white;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 500px;
            box-shadow: var(--box-shadow-lg);
            transform: translateY(20px);
            transition: var(--transition);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-overlay.active .modal {
            transform: translateY(0);
        }
        
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark);
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
            transition: var(--transition);
        }
        
        .modal-close:hover {
            color: var(--dark);
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 0.9rem;
            color: var(--dark);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            font-size: 0.95rem;
            transition: var(--transition);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }
        
        .payment-methods {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .payment-method {
            flex: 1;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .payment-method:hover {
            border-color: var(--gold);
        }
        
        .payment-method.active {
            border-color: var(--gold);
            background-color: rgba(212, 175, 55, 0.05);
        }
        
        .payment-method i {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--gold);
        }
        
        .payment-method-name {
            font-weight: 600;
        }
        
        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        /* Responsive styles */
        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block;
            }
            
            nav {
                position: fixed;
                top: 70px;
                left: 0;
                width: 100%;
                background-color: white;
                box-shadow: var(--box-shadow-lg);
                padding: 20px;
                transform: translateY(-150%);
                transition: var(--transition-slow);
                z-index: 999;
            }
            
            nav.active {
                transform: translateY(0);
            }
            
            nav ul {
                flex-direction: column;
                gap: 15px;
            }
            
            .dashboard {
                padding-top: 80px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .dashboard-title {
                font-size: 1.5rem;
            }
            
            .modal {
                max-width: 95%;
            }
            
            .payment-methods {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="Bithash Logo" class="loading-logo">
    </div>

    <!-- Header -->
    <header id="main-header">
        <div class="container header-container">
            <div class="logo">
                <a href="index.html">
                    <img src="https://www.dropbox.com/scl/fi/1dq16nex1borvvknpcwox/circular_dark_background.png?rlkey=sq2ujl2oxxk9vyvg1j7oz0cdb&raw=1" alt="Bithash Logo">
                    <span class="logo-text">Bithash</span>
                </a>
            </div>
            
            <button class="mobile-menu-toggle" id="mobile-menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            
            <nav id="main-nav">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="dashboard.html" class="active">Dashboard</a></li>
                    <li><a href="investments.html">Investments</a></li>
                    <li><a href="accountsetting.html">Settings</a></li>
                    <li><a href="referrals.html">Referrals</a></li>
                </ul>
            </nav>
            
            <div class="user-controls">
                <div class="user-profile" id="user-profile">
                    <div class="user-avatar" id="user-avatar">JD</div>
                    <span class="user-name" id="user-name">John Doe</span>
                </div>
                <button class="logout-btn" id="logout-btn">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Dashboard Content -->
    <main class="dashboard">
        <div class="container">
            <div class="dashboard-header">
                <h1 class="dashboard-title">Dashboard</h1>
                <p class="dashboard-subtitle">Welcome back! Here's your investment overview</p>
            </div>
            
            <!-- Balance Cards -->
            <div class="balance-cards">
                <div class="balance-card">
                    <div class="balance-title">
                        <i class="fas fa-wallet"></i>
                        <span>Main Balance</span>
                    </div>
                    <div class="balance-amount" id="main-balance">$0.00</div>
                    <div class="balance-btc" id="main-balance-btc">0.000000 BTC</div>
                </div>
                
                <div class="balance-card">
                    <div class="balance-title">
                        <i class="fas fa-chart-line"></i>
                        <span>Active Amount</span>
                    </div>
                    <div class="balance-amount" id="active-balance">$0.00</div>
                    <div class="balance-btc" id="active-balance-btc">0.000000 BTC</div>
                </div>
                
                <div class="balance-card">
                    <div class="balance-title">
                        <i class="fas fa-coins"></i>
                        <span>Matured Amount</span>
                    </div>
                    <div class="balance-amount" id="matured-balance">$0.00</div>
                    <div class="balance-btc" id="matured-balance-btc">0.000000 BTC</div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-primary" id="deposit-btn">
                    <i class="fas fa-plus-circle"></i>
                    <span>Deposit</span>
                </button>
                <button class="btn btn-outline" id="withdraw-btn">
                    <i class="fas fa-minus-circle"></i>
                    <span>Withdraw</span>
                </button>
                <button class="btn btn-success" id="invest-btn">
                    <i class="fas fa-chart-pie"></i>
                    <span>Invest</span>
                </button>
            </div>
            
            <!-- Recent Transactions -->
            <div class="dashboard-section">
                <div class="section-header">
                    <h2 class="section-title">Recent Transactions</h2>
                    <div class="section-actions">
                        <button class="btn btn-outline">
                            <i class="fas fa-history"></i>
                            <span>View All</span>
                        </button>
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table class="transactions-table">
                        <thead>
                            <tr>
                                <th>Transaction</th>
                                <th>Amount</th>
                                <th>Date</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="transactions-body">
                            <!-- Transactions will be loaded here -->
                            <tr>
                                <td colspan="4" style="text-align: center; padding: 30px;">
                                    <div class="loading-spinner">
                                        <i class="fas fa-spinner fa-spin"></i>
                                        <span>Loading transactions...</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Investment Plans -->
            <div class="dashboard-section">
                <div class="section-header">
                    <h2 class="section-title">Investment Plans</h2>
                    <div class="section-actions">
                        <button class="btn btn-outline">
                            <i class="fas fa-info-circle"></i>
                            <span>Learn More</span>
                        </button>
                    </div>
                </div>
                
                <div class="plans-grid" id="plans-container">
                    <!-- Plans will be loaded here -->
                    <div class="plan-card">
                        <div class="loading-spinner">
                            <i class="fas fa-spinner fa-spin"></i>
                            <span>Loading plans...</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Savings & Loans -->
            <div class="dashboard-section">
                <div class="section-header">
                    <h2 class="section-title">Savings & Loans</h2>
                    <div class="section-actions">
                        <button class="btn btn-outline">
                            <i class="fas fa-question-circle"></i>
                            <span>How It Works</span>
                        </button>
                    </div>
                </div>
                
                <div class="savings-loan-container">
                    <div class="savings-card">
                        <h3>Savings Account</h3>
                        <p>Earn interest on your idle funds and qualify for BTC-backed loans</p>
                        
                        <div class="savings-progress">
                            <div class="savings-progress-bar" id="savings-progress" style="width: 0%"></div>
                        </div>
                        
                        <div class="savings-stats">
                            <div class="savings-stat">
                                <div class="savings-stat-value" id="savings-balance">$0.00</div>
                                <div class="savings-stat-label">Your Savings</div>
                            </div>
                            <div class="savings-stat">
                                <div class="savings-stat-value">$5,000</div>
                                <div class="savings-stat-label">Minimum</div>
                            </div>
                        </div>
                        
                        <button class="btn btn-primary" id="add-savings-btn">
                            <i class="fas fa-plus"></i>
                            <span>Add to Savings</span>
                        </button>
                    </div>
                    
                    <div class="loan-card">
                        <h3>BTC-Backed Loans</h3>
                        <p>Access liquidity without selling your Bitcoin holdings</p>
                        
                        <div class="loan-limit" id="loan-limit">$0.00</div>
                        <p>Available loan amount based on your savings balance</p>
                        
                        <button class="btn btn-outline" id="request-loan-btn">
                            <i class="fas fa-hand-holding-usd"></i>
                            <span>Request Loan</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Mining Metrics -->
            <div class="dashboard-section">
                <div class="section-header">
                    <h2 class="section-title">Mining Performance</h2>
                    <div class="section-actions">
                        <button class="btn btn-outline">
                            <i class="fas fa-sync-alt"></i>
                            <span>Refresh</span>
                        </button>
                    </div>
                </div>
                
                <div class="mining-metrics">
                    <div class="metric-card">
                        <div class="metric-value" id="hash-rate">0 EH/s</div>
                        <div class="metric-label">Hash Rate</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-value" id="uptime">0%</div>
                        <div class="metric-label">Uptime</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-value" id="btc-mined">0 BTC</div>
                        <div class="metric-label">BTC Mined</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-value" id="estimated-daily">$0.00</div>
                        <div class="metric-label">Estimated Daily</div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Deposit Modal -->
    <div class="modal-overlay" id="deposit-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Deposit Funds</h3>
                <button class="modal-close" id="deposit-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="payment-methods">
                    <div class="payment-method active" id="btc-method">
                        <i class="fab fa-bitcoin"></i>
                        <div class="payment-method-name">Bitcoin</div>
                    </div>
                    <div class="payment-method" id="card-method">
                        <i class="far fa-credit-card"></i>
                        <div class="payment-method-name">Credit Card</div>
                    </div>
                </div>
                
                <div id="btc-deposit-form">
                    <div class="form-group">
                        <label for="deposit-amount" class="form-label">Amount (USD)</label>
                        <input type="number" id="deposit-amount" class="form-control" placeholder="Enter amount">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">You will send</label>
                        <div class="form-control" id="btc-amount" style="font-weight: 600;">0.000000 BTC</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Deposit Address</label>
                        <div class="form-control" id="deposit-address" style="font-family: monospace; font-size: 0.9rem;">1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa</div>
                        <button class="btn btn-outline" style="margin-top: 10px; width: 100%;" id="copy-address-btn">
                            <i class="far fa-copy"></i>
                            <span>Copy Address</span>
                        </button>
                    </div>
                </div>
                
                <div id="card-deposit-form" style="display: none;">
                    <div class="form-group">
                        <label for="card-amount" class="form-label">Amount (USD)</label>
                        <input type="number" id="card-amount" class="form-control" placeholder="Enter amount">
                    </div>
                    
                    <div class="form-group">
                        <label for="card-number" class="form-label">Card Number</label>
                        <input type="text" id="card-number" class="form-control" placeholder="1234 5678 9012 3456">
                    </div>
                    
                    <div class="form-group" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label for="card-expiry" class="form-label">Expiry Date</label>
                            <input type="text" id="card-expiry" class="form-control" placeholder="MM/YY">
                        </div>
                        <div>
                            <label for="card-cvv" class="form-label">CVV</label>
                            <input type="text" id="card-cvv" class="form-control" placeholder="123">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="deposit-cancel">Cancel</button>
                <button class="btn btn-primary" id="deposit-submit">Submit Deposit</button>
            </div>
        </div>
    </div>
    
    <!-- Withdrawal Modal -->
    <div class="modal-overlay" id="withdraw-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Withdraw Funds</h3>
                <button class="modal-close" id="withdraw-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="withdraw-method" class="form-label">Withdrawal Method</label>
                    <select id="withdraw-method" class="form-control" disabled>
                        <option value="">Loading methods...</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="withdraw-amount" class="form-label">Amount (USD)</label>
                    <input type="number" id="withdraw-amount" class="form-control" placeholder="Enter amount">
                    <div style="font-size: 0.8rem; color: var(--gray); margin-top: 5px;">Available: <span id="available-withdraw">$0.00</span></div>
                </div>
                
                <div class="form-group">
                    <label for="withdraw-address" class="form-label">Withdrawal Address</label>
                    <input type="text" id="withdraw-address" class="form-control" placeholder="Enter your wallet address">
                </div>
                
                <div class="form-group">
                    <label for="withdraw-notes" class="form-label">Notes (Optional)</label>
                    <textarea id="withdraw-notes" class="form-control" rows="3" placeholder="Any additional information"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="withdraw-cancel">Cancel</button>
                <button class="btn btn-primary" id="withdraw-submit">Request Withdrawal</button>
            </div>
        </div>
    </div>
    
    <!-- Add to Savings Modal -->
    <div class="modal-overlay" id="savings-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Add to Savings</h3>
                <button class="modal-close" id="savings-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="savings-amount" class="form-label">Amount (USD)</label>
                    <input type="number" id="savings-amount" class="form-control" placeholder="Enter amount">
                    <div style="font-size: 0.8rem; color: var(--gray); margin-top: 5px;">Available: <span id="available-savings">$0.00</span></div>
                </div>
                
                <div class="form-group">
                    <label for="savings-duration" class="form-label">Duration</label>
                    <select id="savings-duration" class="form-control">
                        <option value="30">30 days (2% interest)</option>
                        <option value="60">60 days (4% interest)</option>
                        <option value="90">90 days (6% interest)</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="savings-cancel">Cancel</button>
                <button class="btn btn-primary" id="savings-submit">Add to Savings</button>
            </div>
        </div>
    </div>
    
    <!-- Request Loan Modal -->
    <div class="modal-overlay" id="loan-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Request Loan</h3>
                <button class="modal-close" id="loan-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="loan-amount" class="form-label">Loan Amount (USD)</label>
                    <input type="number" id="loan-amount" class="form-control" placeholder="Enter amount">
                    <div style="font-size: 0.8rem; color: var(--gray); margin-top: 5px;">Maximum: <span id="max-loan">$0.00</span></div>
                </div>
                
                <div class="form-group">
                    <label for="loan-duration" class="form-label">Loan Duration</label>
                    <select id="loan-duration" class="form-control">
                        <option value="30">30 days (5% interest)</option>
                        <option value="60">60 days (8% interest)</option>
                        <option value="90">90 days (10% interest)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="loan-purpose" class="form-label">Purpose (Optional)</label>
                    <textarea id="loan-purpose" class="form-control" rows="3" placeholder="What will you use this loan for?"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="loan-cancel">Cancel</button>
                <button class="btn btn-primary" id="loan-submit">Request Loan</button>
            </div>
        </div>
    </div>
    
    <!-- Invest Modal -->
    <div class="modal-overlay" id="invest-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Invest in Plan</h3>
                <button class="modal-close" id="invest-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="invest-plan" class="form-label">Select Plan</label>
                    <select id="invest-plan" class="form-control">
                        <option value="">Loading plans...</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="invest-amount" class="form-label">Investment Amount (USD)</label>
                    <input type="number" id="invest-amount" class="form-control" placeholder="Enter amount">
                    <div style="font-size: 0.8rem; color: var(--gray); margin-top: 5px;">Available: <span id="available-invest">$0.00</span></div>
                </div>
                
                <div class="form-group">
                    <label for="invest-duration" class="form-label">Investment Duration</label>
                    <select id="invest-duration" class="form-control" disabled>
                        <option value="">Select a plan first</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="invest-return" class="form-label">Estimated Return</label>
                    <input type="text" id="invest-return" class="form-control" readonly>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="invest-cancel">Cancel</button>
                <button class="btn btn-primary" id="invest-submit">Confirm Investment</button>
            </div>
        </div>
    </div>

    <!-- AOS Animation -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <script>
        // Initialize AOS animation
        AOS.init({
            duration: 800,
            once: true,
            easing: 'ease-in-out'
        });
        
        // API Base URL
        const API_BASE_URL = 'https://website-backendd-1.onrender.com';
        
        // Global variables
        let currentUser = null;
        let btcPrice = 0;
        let userBalances = {
            main: 0,
            active: 0,
            matured: 0,
            savings: 0
        };
        let investmentPlans = [];
        let withdrawalMethods = [];
        
        // DOM Elements
        const loadingOverlay = document.getElementById('loading-overlay');
        const logoutBtn = document.getElementById('logout-btn');
        const userAvatar = document.getElementById('user-avatar');
        const userName = document.getElementById('user-name');
        const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
        const mainNav = document.getElementById('main-nav');
        
        // Balance elements
        const mainBalance = document.getElementById('main-balance');
        const mainBalanceBtc = document.getElementById('main-balance-btc');
        const activeBalance = document.getElementById('active-balance');
        const activeBalanceBtc = document.getElementById('active-balance-btc');
        const maturedBalance = document.getElementById('matured-balance');
        const maturedBalanceBtc = document.getElementById('matured-balance-btc');
        const savingsBalance = document.getElementById('savings-balance');
        const loanLimit = document.getElementById('loan-limit');
        const savingsProgress = document.getElementById('savings-progress');
        
        // Mining metrics
        const hashRateElement = document.getElementById('hash-rate');
        const uptimeElement = document.getElementById('uptime');
        const btcMinedElement = document.getElementById('btc-mined');
        const estimatedDailyElement = document.getElementById('estimated-daily');
        
        // Transaction table
        const transactionsBody = document.getElementById('transactions-body');
        
        // Investment plans
        const plansContainer = document.getElementById('plans-container');
        
        // Modal elements
        const depositModal = document.getElementById('deposit-modal');
        const depositClose = document.getElementById('deposit-close');
        const depositCancel = document.getElementById('deposit-cancel');
        const depositSubmit = document.getElementById('deposit-submit');
        const btcMethod = document.getElementById('btc-method');
        const cardMethod = document.getElementById('card-method');
        const btcDepositForm = document.getElementById('btc-deposit-form');
        const cardDepositForm = document.getElementById('card-deposit-form');
        const depositAmount = document.getElementById('deposit-amount');
        const btcAmount = document.getElementById('btc-amount');
        const depositAddress = document.getElementById('deposit-address');
        const copyAddressBtn = document.getElementById('copy-address-btn');
        
        const withdrawModal = document.getElementById('withdraw-modal');
        const withdrawClose = document.getElementById('withdraw-close');
        const withdrawCancel = document.getElementById('withdraw-cancel');
        const withdrawSubmit = document.getElementById('withdraw-submit');
        const withdrawMethod = document.getElementById('withdraw-method');
        const withdrawAmount = document.getElementById('withdraw-amount');
        const availableWithdraw = document.getElementById('available-withdraw');
        const withdrawAddress = document.getElementById('withdraw-address');
        const withdrawNotes = document.getElementById('withdraw-notes');
        
        const savingsModal = document.getElementById('savings-modal');
        const savingsClose = document.getElementById('savings-close');
        const savingsCancel = document.getElementById('savings-cancel');
        const savingsSubmit = document.getElementById('savings-submit');
        const savingsAmount = document.getElementById('savings-amount');
        const availableSavings = document.getElementById('available-savings');
        const savingsDuration = document.getElementById('savings-duration');
        
        const loanModal = document.getElementById('loan-modal');
        const loanClose = document.getElementById('loan-close');
        const loanCancel = document.getElementById('loan-cancel');
        const loanSubmit = document.getElementById('loan-submit');
        const loanAmount = document.getElementById('loan-amount');
        const maxLoan = document.getElementById('max-loan');
        const loanDuration = document.getElementById('loan-duration');
        const loanPurpose = document.getElementById('loan-purpose');
        
        const investModal = document.getElementById('invest-modal');
        const investClose = document.getElementById('invest-close');
        const investCancel = document.getElementById('invest-cancel');
        const investSubmit = document.getElementById('invest-submit');
        const investPlan = document.getElementById('invest-plan');
        const investAmount = document.getElementById('invest-amount');
        const availableInvest = document.getElementById('available-invest');
        const investDuration = document.getElementById('invest-duration');
        const investReturn = document.getElementById('invest-return');
        
        // Action buttons
        const depositBtn = document.getElementById('deposit-btn');
        const withdrawBtn = document.getElementById('withdraw-btn');
        const investBtn = document.getElementById('invest-btn');
        const addSavingsBtn = document.getElementById('add-savings-btn');
        const requestLoanBtn = document.getElementById('request-loan-btn');
        
        // Helper functions
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }
        
        function formatBtc(amount) {
            return new Intl.NumberFormat('en-US', {
                minimumFractionDigits: 6,
                maximumFractionDigits: 6
            }).format(amount) + ' BTC';
        }
        
        function animateValue(element, start, end, duration, prefix = '') {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const value = Math.floor(progress * (end - start) + start);
                element.textContent = prefix + formatCurrency(value).substring(1);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }
        
        function animateBtcValue(element, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const value = progress * (end - start) + start;
                element.textContent = formatBtc(value);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }
        
        function showModal(modal) {
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function hideModal(modal) {
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }
        
        function updateBalances() {
            // Update main balance
            animateValue(mainBalance, parseFloat(mainBalance.textContent.replace(/[^0-9.-]+/g,"")) || 0, userBalances.main, 500);
            mainBalanceBtc.textContent = formatBtc(userBalances.main / btcPrice);
            
            // Update active balance
            animateValue(activeBalance, parseFloat(activeBalance.textContent.replace(/[^0-9.-]+/g,"")) || 0, userBalances.active, 500);
            activeBalanceBtc.textContent = formatBtc(userBalances.active / btcPrice);
            
            // Update matured balance
            animateValue(maturedBalance, parseFloat(maturedBalance.textContent.replace(/[^0-9.-]+/g,"")) || 0, userBalances.matured, 500);
            maturedBalanceBtc.textContent = formatBtc(userBalances.matured / btcPrice);
            
            // Update savings balance
            animateValue(savingsBalance, parseFloat(savingsBalance.textContent.replace(/[^0-9.-]+/g,"")) || 0, userBalances.savings, 500);
            
            // Update loan limit (50% of savings)
            const loanLimitValue = userBalances.savings * 0.5;
            animateValue(loanLimit, parseFloat(loanLimit.textContent.replace(/[^0-9.-]+/g,"")) || 0, loanLimitValue, 500);
            
            // Update savings progress (toward $5,000 minimum)
            const progressPercent = Math.min((userBalances.savings / 5000) * 100, 100);
            savingsProgress.style.width = `${progressPercent}%`;
            
            // Update available amounts in modals
            availableWithdraw.textContent = formatCurrency(userBalances.matured);
            availableSavings.textContent = formatCurrency(userBalances.main);
            availableInvest.textContent = formatCurrency(userBalances.main);
            maxLoan.textContent = formatCurrency(userBalances.savings * 0.5);
        }
        
        // Fetch BTC price from CoinGecko
        async function fetchBtcPrice() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd');
                const data = await response.json();
                btcPrice = data.bitcoin.usd;
                
                // Update all BTC values
                updateBalances();
                
                // Update every minute
                setTimeout(fetchBtcPrice, 60000);
            } catch (error) {
                console.error('Failed to fetch BTC price:', error);
                // Retry after 10 seconds if failed
                setTimeout(fetchBtcPrice, 10000);
            }
        }
        
        // Fetch user data
        async function fetchUserData() {
            const token = localStorage.getItem('jwtToken');
            if (!token) {
                window.location.href = 'login.html';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/users/me`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const userData = await response.json();
                    currentUser = userData;
                    
                    // Update user profile
                    userAvatar.textContent = userData.name.substring(0, 2).toUpperCase();
                    userName.textContent = userData.name;
                    
                    // Update balances
                    userBalances.main = userData.balance.main;
                    userBalances.active = userData.balance.active;
                    userBalances.matured = userData.balance.matured;
                    userBalances.savings = userData.balance.savings;
                    updateBalances();
                    
                    // Start balance updates
                    startBalanceUpdates(token);
                } else {
                    localStorage.removeItem('jwtToken');
                    window.location.href = 'login.html';
                }
            } catch (error) {
                console.error('Failed to fetch user data:', error);
            }
        }
        
        // Start balance updates
        function startBalanceUpdates(token) {
            setInterval(async () => {
                try {
                    const response = await fetch(`${API_BASE_URL}/api/users/balance`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        userBalances.main = data.main;
                        userBalances.active = data.active;
                        userBalances.matured = data.matured;
                        userBalances.savings = data.savings;
                        updateBalances();
                    }
                } catch (error) {
                    console.error('Balance update failed:', error);
                }
            }, 30000); // Update every 30 seconds
        }
        
        // Fetch transactions
        async function fetchTransactions() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/transactions`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const transactions = await response.json();
                    renderTransactions(transactions);
                }
            } catch (error) {
                console.error('Failed to fetch transactions:', error);
            }
        }
        
        // Render transactions
        function renderTransactions(transactions) {
            transactionsBody.innerHTML = '';
            
            if (transactions.length === 0) {
                transactionsBody.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 30px;">
                            No transactions found
                        </td>
                    </tr>
                `;
                return;
            }
            
            transactions.forEach(transaction => {
                const row = document.createElement('tr');
                
                // Determine icon and type based on transaction type
                let iconClass = '';
                let typeName = '';
                let method = '';
                
                switch (transaction.type) {
                    case 'deposit':
                        iconClass = 'deposit';
                        typeName = 'Deposit';
                        method = transaction.method === 'btc' ? 'Bitcoin' : 'Credit Card';
                        break;
                    case 'withdrawal':
                        iconClass = 'withdrawal';
                        typeName = 'Withdrawal';
                        method = transaction.method === 'btc' ? 'Bitcoin' : 'Bank Transfer';
                        break;
                    case 'earning':
                        iconClass = 'earning';
                        typeName = 'Mining Earnings';
                        method = 'Daily Payout';
                        break;
                    case 'bonus':
                        iconClass = 'bonus';
                        typeName = 'Referral Bonus';
                        method = 'From ' + transaction.referral;
                        break;
                }
                
                // Determine status
                let statusClass = '';
                let statusText = '';
                
                switch (transaction.status) {
                    case 'completed':
                        statusClass = 'status-completed';
                        statusText = 'Completed';
                        break;
                    case 'pending':
                        statusClass = 'status-pending';
                        statusText = 'Pending';
                        break;
                    case 'failed':
                        statusClass = 'status-failed';
                        statusText = 'Failed';
                        break;
                }
                
                // Format date
                const date = new Date(transaction.date);
                const formattedDate = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
                
                row.innerHTML = `
                    <td>
                        <div class="transaction-type">
                            <div class="transaction-icon ${iconClass}">
                                <i class="fas fa-${transaction.type === 'deposit' ? 'plus' : 'minus'}"></i>
                            </div>
                            <div class="transaction-details">
                                <div class="transaction-name">${typeName}</div>
                                <div class="transaction-method">${method}</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="transaction-amount">${formatCurrency(transaction.amount)}</div>
                        <div class="transaction-btc">${formatBtc(transaction.amount / btcPrice)}</div>
                    </td>
                    <td>
                        <div class="transaction-date">${formattedDate}</div>
                    </td>
                    <td>
                        <span class="transaction-status ${statusClass}">${statusText}</span>
                    </td>
                `;
                
                transactionsBody.appendChild(row);
            });
        }
        
        // Fetch investment plans
        async function fetchInvestmentPlans() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/plans`);
                const plans = await response.json();
                investmentPlans = plans;
                renderInvestmentPlans(plans);
                populateInvestPlanDropdown(plans);
            } catch (error) {
                console.error('Failed to fetch investment plans:', error);
            }
        }
        
        // Render investment plans
        function renderInvestmentPlans(plans) {
            plansContainer.innerHTML = '';
            
            plans.forEach((plan, index) => {
                const planElement = document.createElement('div');
                planElement.className = 'plan-card';
                if (index === 1) planElement.classList.add('popular'); // Mark second plan as popular
                
                planElement.innerHTML = `
                    <h3 class="plan-name">${plan.name}</h3>
                    <div class="plan-roi">${plan.returnRate}%</div>
                    <div class="plan-duration">${plan.duration} hours</div>
                    <div class="plan-features">
                        <div class="plan-feature">
                            <i class="fas fa-check"></i> <span>Daily Payouts</span>
                        </div>
                        <div class="plan-feature">
                            <i class="fas fa-check"></i> <span>${plan.referralBonus}% Referral Bonus</span>
                        </div>
                        <div class="plan-feature">
                            <i class="fas fa-check"></i> <span>24/7 Support</span>
                        </div>
                    </div>
                    <div class="plan-minmax">
                        <div>
                            <span>Min Investment</span>
                            <span>$${plan.minInvestment.toLocaleString('en-US')}</span>
                        </div>
                        <div>
                            <span>Max Investment</span>
                            <span>$${plan.maxInvestment.toLocaleString('en-US')}</span>
                        </div>
                    </div>
                    <button class="btn btn-primary plan-button invest-plan-btn" data-plan-id="${plan._id}">
                        Invest Now
                    </button>
                `;
                
                plansContainer.appendChild(planElement);
            });
            
            // Add event listeners to invest buttons
            document.querySelectorAll('.invest-plan-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const planId = e.target.getAttribute('data-plan-id');
                    openInvestModal(planId);
                });
            });
        }
        
        // Populate invest plan dropdown
        function populateInvestPlanDropdown(plans) {
            investPlan.innerHTML = '';
            
            plans.forEach(plan => {
                const option = document.createElement('option');
                option.value = plan._id;
                option.textContent = `${plan.name} (${plan.returnRate}% in ${plan.duration} hours)`;
                investPlan.appendChild(option);
            });
        }
        
        // Fetch withdrawal methods
        async function fetchWithdrawalMethods() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/users/withdrawal-methods`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const methods = await response.json();
                    withdrawalMethods = methods;
                    populateWithdrawalMethods(methods);
                }
            } catch (error) {
                console.error('Failed to fetch withdrawal methods:', error);
            }
        }
        
        // Populate withdrawal methods dropdown
        function populateWithdrawalMethods(methods) {
            withdrawMethod.innerHTML = '';
            
            if (methods.length === 0) {
                const option = document.createElement('option');
                option.value = '';
                option.textContent = 'No withdrawal methods available';
                withdrawMethod.appendChild(option);
                return;
            }
            
            methods.forEach(method => {
                const option = document.createElement('option');
                option.value = method._id;
                option.textContent = `${method.type === 'btc' ? 'Bitcoin' : 'Bank Transfer'} (${method.details})`;
                withdrawMethod.appendChild(option);
            });
            
            withdrawMethod.disabled = false;
        }
        
        // Fetch mining metrics
        async function fetchMiningMetrics() {
            const token = localStorage.getItem('jwtToken');
            if (!token) return;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/mining/metrics`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const metrics = await response.json();
                    updateMiningMetrics(metrics);
                }
            } catch (error) {
                console.error('Failed to fetch mining metrics:', error);
            }
        }
        
        // Update mining metrics
        function updateMiningMetrics(metrics) {
            hashRateElement.textContent = `${metrics.hashRate} EH/s`;
            uptimeElement.textContent = `${metrics.uptime}%`;
            btcMinedElement.textContent = `${metrics.btcMined.toFixed(6)} BTC`;
            estimatedDailyElement.textContent = formatCurrency(metrics.estimatedDaily);
        }
        
        // Open invest modal with specific plan selected
        function openInvestModal(planId) {
            showModal(investModal);
            
            // Find the plan
            const plan = investmentPlans.find(p => p._id === planId);
            if (plan) {
                investPlan.value = planId;
                investDuration.value = plan.duration;
                investDuration.innerHTML = `<option value="${plan.duration}">${plan.duration} hours</option>`;
                
                // Calculate estimated return if amount is already entered
                if (investAmount.value) {
                    const amount = parseFloat(investAmount.value);
                    const returnAmount = amount * (plan.returnRate / 100);
                    investReturn.value = formatCurrency(returnAmount);
                }
            }
        }
        
        // Event listeners
        depositBtn.addEventListener('click', () => {
            showModal(depositModal);
            depositAmount.value = '';
            btcAmount.textContent = '0.000000 BTC';
        });
        
        withdrawBtn.addEventListener('click', () => {
            showModal(withdrawModal);
            withdrawAmount.value = '';
            withdrawAddress.value = '';
            withdrawNotes.value = '';
        });
        
        investBtn.addEventListener('click', () => {
            showModal(investModal);
            investAmount.value = '';
            investReturn.value = '';
        });
        
        addSavingsBtn.addEventListener('click', () => {
            showModal(savingsModal);
            savingsAmount.value = '';
        });
        
        requestLoanBtn.addEventListener('click', () => {
            showModal(loanModal);
            loanAmount.value = '';
            loanPurpose.value = '';
        });
        
        // Modal close buttons
        depositClose.addEventListener('click', () => hideModal(depositModal));
        depositCancel.addEventListener('click', () => hideModal(depositModal));
        withdrawClose.addEventListener('click', () => hideModal(withdrawModal));
        withdrawCancel.addEventListener('click', () => hideModal(withdrawModal));
        savingsClose.addEventListener('click', () => hideModal(savingsModal));
        savingsCancel.addEventListener('click', () => hideModal(savingsModal));
        loanClose.addEventListener('click', () => hideModal(loanModal));
        loanCancel.addEventListener('click', () => hideModal(loanModal));
        investClose.addEventListener('click', () => hideModal(investModal));
        investCancel.addEventListener('click', () => hideModal(investModal));
        
        // Payment method selection
        btcMethod.addEventListener('click', () => {
            btcMethod.classList.add('active');
            cardMethod.classList.remove('active');
            btcDepositForm.style.display = 'block';
            cardDepositForm.style.display = 'none';
        });
        
        cardMethod.addEventListener('click', () => {
            cardMethod.classList.add('active');
            btcMethod.classList.remove('active');
            cardDepositForm.style.display = 'block';
            btcDepositForm.style.display = 'none';
        });
        
        // BTC amount calculation
        depositAmount.addEventListener('input', () => {
            const amount = parseFloat(depositAmount.value) || 0;
            const btcValue = amount / btcPrice;
            btcAmount.textContent = formatBtc(btcValue);
        });
        
        // Copy BTC address
        copyAddressBtn.addEventListener('click', () => {
            navigator.clipboard.writeText(depositAddress.textContent);
            copyAddressBtn.innerHTML = '<i class="fas fa-check"></i> <span>Copied!</span>';
            setTimeout(() => {
                copyAddressBtn.innerHTML = '<i class="far fa-copy"></i> <span>Copy Address</span>';
            }, 2000);
        });
        
        // Invest amount calculation
        investAmount.addEventListener('input', () => {
            const planId = investPlan.value;
            const amount = parseFloat(investAmount.value) || 0;
            
            if (planId) {
                const plan = investmentPlans.find(p => p._id === planId);
                if (plan) {
                    const returnAmount = amount * (plan.returnRate / 100);
                    investReturn.value = formatCurrency(returnAmount);
                }
            }
        });
        
        investPlan.addEventListener('change', () => {
            const planId = investPlan.value;
            const amount = parseFloat(investAmount.value) || 0;
            
            if (planId) {
                const plan = investmentPlans.find(p => p._id === planId);
                if (plan) {
                    investDuration.value = plan.duration;
                    investDuration.innerHTML = `<option value="${plan.duration}">${plan.duration} hours</option>`;
                    
                    if (amount > 0) {
                        const returnAmount = amount * (plan.returnRate / 100);
                        investReturn.value = formatCurrency(returnAmount);
                    }
                }
            }
        });
        
        // Mobile menu toggle
        mobileMenuToggle.addEventListener('click', () => {
            mainNav.classList.toggle('active');
        });
        
        // Logout button
        logoutBtn.addEventListener('click', () => {
            localStorage.removeItem('jwtToken');
            window.location.href = 'login.html';
        });
        
        // Form submissions
        depositSubmit.addEventListener('click', async () => {
            const amount = parseFloat(depositAmount.value);
            const method = btcMethod.classList.contains('active') ? 'btc' : 'card';
            
            if (!amount || amount <= 0) {
                alert('Please enter a valid amount');
                return;
            }
            
            const token = localStorage.getItem('jwtToken');
            if (!token) {
                window.location.href = 'login.html';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/transactions/deposit`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        amount,
                        method
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    alert('Deposit request submitted successfully');
                    hideModal(depositModal);
                    fetchTransactions();
                } else {
                    const error = await response.json();
                    alert(error.message || 'Deposit failed');
                }
            } catch (error) {
                console.error('Deposit error:', error);
                alert('Deposit failed. Please try again.');
            }
        });
        
        withdrawSubmit.addEventListener('click', async () => {
            const amount = parseFloat(withdrawAmount.value);
            const methodId = withdrawMethod.value;
            const address = withdrawAddress.value;
            const notes = withdrawNotes.value;
            
            if (!amount || amount <= 0) {
                alert('Please enter a valid amount');
                return;
            }
            
            if (amount > userBalances.matured) {
                alert('Amount exceeds your available balance');
                return;
            }
            
            if (!methodId) {
                alert('Please select a withdrawal method');
                return;
            }
            
            if (!address) {
                alert('Please enter a withdrawal address');
                return;
            }
            
            const token = localStorage.getItem('jwtToken');
            if (!token) {
                window.location.href = 'login.html';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/transactions/withdraw`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        amount,
                        methodId,
                        address,
                        notes
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    alert('Withdrawal request submitted successfully');
                    hideModal(withdrawModal);
                    fetchTransactions();
                } else {
                    const error = await response.json();
                    alert(error.message || 'Withdrawal failed');
                }
            } catch (error) {
                console.error('Withdrawal error:', error);
                alert('Withdrawal failed. Please try again.');
            }
        });
        
        savingsSubmit.addEventListener('click', async () => {
            const amount = parseFloat(savingsAmount.value);
            const duration = parseInt(savingsDuration.value);
            
            if (!amount || amount <= 0) {
                alert('Please enter a valid amount');
                return;
            }
            
            if (amount > userBalances.main) {
                alert('Amount exceeds your available balance');
                return;
            }
            
            const token = localStorage.getItem('jwtToken');
            if (!token) {
                window.location.href = 'login.html';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/savings`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        amount,
                        duration
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    alert('Savings added successfully');
                    hideModal(savingsModal);
                    fetchUserData();
                } else {
                    const error = await response.json();
                    alert(error.message || 'Failed to add to savings');
                }
            } catch (error) {
                console.error('Savings error:', error);
                alert('Failed to add to savings. Please try again.');
            }
        });
        
        loanSubmit.addEventListener('click', async () => {
            const amount = parseFloat(loanAmount.value);
            const duration = parseInt(loanDuration.value);
            const purpose = loanPurpose.value;
            
            if (!amount || amount <= 0) {
                alert('Please enter a valid amount');
                return;
            }
            
            if (amount > userBalances.savings * 0.5) {
                alert('Amount exceeds your available loan limit');
                return;
            }
            
            const token = localStorage.getItem('jwtToken');
            if (!token) {
                window.location.href = 'login.html';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/loans`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        amount,
                        duration,
                        purpose
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    alert('Loan request submitted successfully');
                    hideModal(loanModal);
                    fetchUserData();
                } else {
                    const error = await response.json();
                    alert(error.message || 'Loan request failed');
                }
            } catch (error) {
                console.error('Loan error:', error);
                alert('Loan request failed. Please try again.');
            }
        });
        
        investSubmit.addEventListener('click', async () => {
            const planId = investPlan.value;
            const amount = parseFloat(investAmount.value);
            const duration = parseInt(investDuration.value);
            
            if (!planId) {
                alert('Please select an investment plan');
                return;
            }
            
            if (!amount || amount <= 0) {
                alert('Please enter a valid amount');
                return;
            }
            
            const plan = investmentPlans.find(p => p._id === planId);
            if (!plan) {
                alert('Invalid investment plan selected');
                return;
            }
            
            if (amount < plan.minInvestment) {
                alert(`Minimum investment for this plan is ${formatCurrency(plan.minInvestment)}`);
                return;
            }
            
            if (amount > plan.maxInvestment) {
                alert(`Maximum investment for this plan is ${formatCurrency(plan.maxInvestment)}`);
                return;
            }
            
            if (amount > userBalances.main) {
                alert('Amount exceeds your available balance');
                return;
            }
            
            const token = localStorage.getItem('jwtToken');
            if (!token) {
                window.location.href = 'login.html';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/investments`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        planId,
                        amount,
                        duration
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    alert('Investment created successfully');
                    hideModal(investModal);
                    fetchUserData();
                    fetchTransactions();
                } else {
                    const error = await response.json();
                    alert(error.message || 'Investment failed');
                }
            } catch (error) {
                console.error('Investment error:', error);
                alert('Investment failed. Please try again.');
            }
        });
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', () => {
            // Hide loading overlay after 1 second
            setTimeout(() => {
                loadingOverlay.classList.add('hidden');
            }, 1000);
            
            // Check if user is authenticated
            const token = localStorage.getItem('jwtToken');
            if (!token) {
                window.location.href = 'login.html';
                return;
            }
            
            // Fetch initial data
            fetchUserData();
            fetchBtcPrice();
            fetchTransactions();
            fetchInvestmentPlans();
            fetchWithdrawalMethods();
            fetchMiningMetrics();
            
            // Add scroll event listener for header
            window.addEventListener('scroll', () => {
                const header = document.getElementById('main-header');
                if (window.scrollY > 10) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });
        });
    </script>
</body>
</html>
